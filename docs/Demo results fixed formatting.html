<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sarah Morris">
<meta name="dcterms.date" content="2025-03-04">

<title>Demographic Analysis of Wind Instrument Musicians and RMT Device Usage</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Demo results fixed formatting_files/libs/clipboard/clipboard.min.js"></script>
<script src="Demo results fixed formatting_files/libs/quarto-html/quarto.js"></script>
<script src="Demo results fixed formatting_files/libs/quarto-html/popper.min.js"></script>
<script src="Demo results fixed formatting_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Demo results fixed formatting_files/libs/quarto-html/anchor.min.js"></script>
<link href="Demo results fixed formatting_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Demo results fixed formatting_files/libs/quarto-html/quarto-syntax-highlighting-ba1dc69c819719ff92c66bffe944bb46.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Demo results fixed formatting_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Demo results fixed formatting_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Demo results fixed formatting_files/libs/bootstrap/bootstrap-cf43a150f4ed865b4eb4d60b88c21c49.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#gender" id="toc-gender" class="nav-link" data-scroll-target="#gender"><span class="header-section-number">2</span> Gender</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats" id="toc-descriptive-stats" class="nav-link" data-scroll-target="#descriptive-stats"><span class="header-section-number">2.1</span> Descriptive Stats</a></li>
  <li><a href="#results-and-discussion" id="toc-results-and-discussion" class="nav-link" data-scroll-target="#results-and-discussion"><span class="header-section-number">2.2</span> Results and Discussion</a></li>
  <li><a href="#comparison-stats" id="toc-comparison-stats" class="nav-link" data-scroll-target="#comparison-stats"><span class="header-section-number">2.3</span> Comparison Stats</a></li>
  <li><a href="#results-after-combining-into-other-category" id="toc-results-after-combining-into-other-category" class="nav-link" data-scroll-target="#results-after-combining-into-other-category"><span class="header-section-number">2.4</span> Results after combining into ‘Other’ category</a></li>
  </ul></li>
  <li><a href="#age" id="toc-age" class="nav-link" data-scroll-target="#age"><span class="header-section-number">3</span> Age</a>
  <ul class="collapse">
  <li><a href="#demographic-stats" id="toc-demographic-stats" class="nav-link" data-scroll-target="#demographic-stats"><span class="header-section-number">3.1</span> Demographic Stats</a></li>
  <li><a href="#results-and-discussion-1" id="toc-results-and-discussion-1" class="nav-link" data-scroll-target="#results-and-discussion-1"><span class="header-section-number">3.2</span> Results and Discussion</a></li>
  <li><a href="#comparison-stats-1" id="toc-comparison-stats-1" class="nav-link" data-scroll-target="#comparison-stats-1"><span class="header-section-number">3.3</span> Comparison Stats</a></li>
  <li><a href="#results-and-discussion-2" id="toc-results-and-discussion-2" class="nav-link" data-scroll-target="#results-and-discussion-2"><span class="header-section-number">3.4</span> Results and Discussion</a></li>
  </ul></li>
  <li><a href="#instruments-played" id="toc-instruments-played" class="nav-link" data-scroll-target="#instruments-played"><span class="header-section-number">4</span> Instruments Played</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-1" id="toc-descriptive-stats-1" class="nav-link" data-scroll-target="#descriptive-stats-1"><span class="header-section-number">4.1</span> Descriptive Stats</a></li>
  <li><a href="#comparison-stats-2" id="toc-comparison-stats-2" class="nav-link" data-scroll-target="#comparison-stats-2"><span class="header-section-number">4.2</span> Comparison Stats</a></li>
  <li><a href="#results-and-discussion-4" id="toc-results-and-discussion-4" class="nav-link" data-scroll-target="#results-and-discussion-4"><span class="header-section-number">4.3</span> Results and Discussion</a></li>
  </ul></li>
  <li><a href="#skill-level" id="toc-skill-level" class="nav-link" data-scroll-target="#skill-level"><span class="header-section-number">5</span> Skill Level</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-2" id="toc-descriptive-stats-2" class="nav-link" data-scroll-target="#descriptive-stats-2"><span class="header-section-number">5.1</span> Descriptive Stats</a></li>
  <li><a href="#results-and-discussion-5" id="toc-results-and-discussion-5" class="nav-link" data-scroll-target="#results-and-discussion-5"><span class="header-section-number">5.2</span> Results and Discussion</a></li>
  <li><a href="#comparison-stats-3" id="toc-comparison-stats-3" class="nav-link" data-scroll-target="#comparison-stats-3"><span class="header-section-number">5.3</span> Comparison Stats</a></li>
  <li><a href="#results-and-discussion-based-on-combined-findings" id="toc-results-and-discussion-based-on-combined-findings" class="nav-link" data-scroll-target="#results-and-discussion-based-on-combined-findings"><span class="header-section-number">5.4</span> Results and Discussion (based on combined findings)</a></li>
  </ul></li>
  <li><a href="#country-of-residence" id="toc-country-of-residence" class="nav-link" data-scroll-target="#country-of-residence"><span class="header-section-number">6</span> *Country of Residence</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-3" id="toc-descriptive-stats-3" class="nav-link" data-scroll-target="#descriptive-stats-3"><span class="header-section-number">6.1</span> Descriptive Stats</a></li>
  <li><a href="#results-and-discussion-6" id="toc-results-and-discussion-6" class="nav-link" data-scroll-target="#results-and-discussion-6"><span class="header-section-number">6.2</span> Results and Discussion</a></li>
  <li><a href="#comparison-stats-4" id="toc-comparison-stats-4" class="nav-link" data-scroll-target="#comparison-stats-4"><span class="header-section-number">6.3</span> Comparison Stats</a></li>
  <li><a href="#results-and-discussion-7" id="toc-results-and-discussion-7" class="nav-link" data-scroll-target="#results-and-discussion-7"><span class="header-section-number">6.4</span> Results and Discussion</a></li>
  </ul></li>
  <li><a href="#country-of-education" id="toc-country-of-education" class="nav-link" data-scroll-target="#country-of-education"><span class="header-section-number">7</span> Country of Education</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-4" id="toc-descriptive-stats-4" class="nav-link" data-scroll-target="#descriptive-stats-4"><span class="header-section-number">7.1</span> Descriptive Stats</a></li>
  <li><a href="#results-and-discussion-8" id="toc-results-and-discussion-8" class="nav-link" data-scroll-target="#results-and-discussion-8"><span class="header-section-number">7.2</span> Results and Discussion</a></li>
  <li><a href="#comparison-stats-5" id="toc-comparison-stats-5" class="nav-link" data-scroll-target="#comparison-stats-5"><span class="header-section-number">7.3</span> Comparison Stats</a></li>
  <li><a href="#results-and-discussion-9" id="toc-results-and-discussion-9" class="nav-link" data-scroll-target="#results-and-discussion-9"><span class="header-section-number">7.4</span> Results and Discussion</a></li>
  </ul></li>
  <li><a href="#roles" id="toc-roles" class="nav-link" data-scroll-target="#roles"><span class="header-section-number">8</span> Roles</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-5" id="toc-descriptive-stats-5" class="nav-link" data-scroll-target="#descriptive-stats-5"><span class="header-section-number">8.1</span> Descriptive Stats</a></li>
  <li><a href="#comparison-stats-complex" id="toc-comparison-stats-complex" class="nav-link" data-scroll-target="#comparison-stats-complex"><span class="header-section-number">8.2</span> Comparison Stats complex</a></li>
  </ul></li>
  <li><a href="#education" id="toc-education" class="nav-link" data-scroll-target="#education"><span class="header-section-number">9</span> Education</a>
  <ul class="collapse">
  <li><a href="#demographic-statistics" id="toc-demographic-statistics" class="nav-link" data-scroll-target="#demographic-statistics"><span class="header-section-number">9.1</span> Demographic Statistics</a></li>
  <li><a href="#comparison-stats-6" id="toc-comparison-stats-6" class="nav-link" data-scroll-target="#comparison-stats-6"><span class="header-section-number">9.2</span> Comparison Stats</a></li>
  </ul></li>
  <li><a href="#disorders" id="toc-disorders" class="nav-link" data-scroll-target="#disorders"><span class="header-section-number">10</span> Disorders</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-6" id="toc-descriptive-stats-6" class="nav-link" data-scroll-target="#descriptive-stats-6"><span class="header-section-number">10.1</span> Descriptive Stats</a></li>
  <li><a href="#inferential-stats" id="toc-inferential-stats" class="nav-link" data-scroll-target="#inferential-stats"><span class="header-section-number">10.2</span> Inferential stats</a></li>
  </ul></li>
  <li><a href="#years-of-playing" id="toc-years-of-playing" class="nav-link" data-scroll-target="#years-of-playing"><span class="header-section-number">11</span> Years of Playing</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-7" id="toc-descriptive-stats-7" class="nav-link" data-scroll-target="#descriptive-stats-7"><span class="header-section-number">11.1</span> Descriptive Stats</a></li>
  <li><a href="#inferential-stats-1" id="toc-inferential-stats-1" class="nav-link" data-scroll-target="#inferential-stats-1"><span class="header-section-number">11.2</span> Inferential Stats</a></li>
  </ul></li>
  <li><a href="#frequency-of-playing" id="toc-frequency-of-playing" class="nav-link" data-scroll-target="#frequency-of-playing"><span class="header-section-number">12</span> Frequency of Playing</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-8" id="toc-descriptive-stats-8" class="nav-link" data-scroll-target="#descriptive-stats-8"><span class="header-section-number">12.1</span> Descriptive Stats</a></li>
  <li><a href="#by-instrument" id="toc-by-instrument" class="nav-link" data-scroll-target="#by-instrument"><span class="header-section-number">12.2</span> By Instrument</a></li>
  <li><a href="#inferential-stats-2" id="toc-inferential-stats-2" class="nav-link" data-scroll-target="#inferential-stats-2"><span class="header-section-number">12.3</span> Inferential Stats</a></li>
  </ul></li>
  <li><a href="#income" id="toc-income" class="nav-link" data-scroll-target="#income"><span class="header-section-number">13</span> Income</a>
  <ul class="collapse">
  <li><a href="#descriptive-stats-9" id="toc-descriptive-stats-9" class="nav-link" data-scroll-target="#descriptive-stats-9"><span class="header-section-number">13.1</span> Descriptive Stats</a></li>
  <li><a href="#inferential-stats-3" id="toc-inferential-stats-3" class="nav-link" data-scroll-target="#inferential-stats-3"><span class="header-section-number">13.2</span> Inferential Stats</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Demographic Analysis of Wind Instrument Musicians and RMT Device Usage</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sarah Morris </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 4, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Provide a full description and interpretation from the results of the following code. Include a breakdown of the descriptive statistics, as well as any statistical tests included in the code.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install all required packages (if not already installed)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>required_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dplyr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"stats"</span>, <span class="st">"tidyr"</span>, <span class="st">"forcats"</span>, <span class="st">"broom"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"scales"</span>, <span class="st">"vcd"</span>, <span class="st">"svglite"</span>, <span class="st">"exact2x2"</span>, <span class="st">"exactci"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ssanv"</span>, <span class="st">"testthat"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Install any missing packages</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">setdiff</span>(required_packages, <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Libraries and Directory</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)  <span class="co"># For Cramer's V calculation</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exact2x2)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overview" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Overview</h1>
</section>
<section id="gender" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Gender</h1>
<section id="descriptive-stats" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="descriptive-stats"><span class="header-section-number">2.1</span> Descriptive Stats</h2>
<ol type="1">
<li>Summary stats on gender data</li>
<li>Prints plot</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create gender summary</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall, this code processes a dataset (data_combined) to summarize gender information by filtering out missing values, grouping by gender, calculating counts and percentages, adjusting specific gender labels, and finally sorting the results by count in descending order. The end result is stored in the variable 'gender_summary'</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>gender_summary <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> <span class="dv">1558</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="st">"Choose not to disclose"</span> <span class="sc">~</span> <span class="st">"Not specified"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="st">"Nonbinary/gender fluid/gender non-conforming"</span> <span class="sc">~</span> <span class="st">"Nonbinary"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> gender</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the gender plot with adjusted height scaling</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>gender_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gender_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(gender, count), <span class="at">y =</span> count, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"N=%d\</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Participants by Gender"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gender"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Participants (N = 1558)"</span>) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)), </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(gender_summary<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.15</span>))</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div id="tbl-gender-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gender-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Gender Distribution Summary
</figcaption>
<div aria-describedby="tbl-gender-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  gender        count percentage
  &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;
1 Male            750     48.1  
2 Female          725     46.5  
3 Nonbinary        68      4.36 
4 Not specified    15      0.963</code></pre>
</div>
</div>
</figure>
</div>
</section>
<section id="results-and-discussion" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="results-and-discussion"><span class="header-section-number">2.2</span> Results and Discussion</h2>
<p>The gender distribution shows a fairly even split between Male and Female participants, with a much smaller representation of Nonbinary, fluid, and non-conforming-gender individuals, and those who chose not to disclose.</p>
</section>
<section id="comparison-stats" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="comparison-stats"><span class="header-section-number">2.3</span> Comparison Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine categories </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Another approach: Combine categories with small counts</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine "Nonbinary" and "Not specified" into "Other"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>data_filtered_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender), <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      gender <span class="sc">==</span> <span class="st">"Choose not to disclose"</span> <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      gender <span class="sc">==</span> <span class="st">"Nonbinary/gender fluid/gender non-conforming"</span> <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> gender</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No RMT"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"RMT"</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new contingency table with combined categories</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>gender_rmt_table_combined <span class="ot">&lt;-</span> <span class="fu">table</span>(data_filtered_combined<span class="sc">$</span>gender, data_filtered_combined<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the new contingency table</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Contingency table with combined categories:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Contingency table with combined categories:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_rmt_table_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        
         No RMT RMT
  Female    642  83
  Male      615 135
  Other      73  10</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate expected counts for the new table</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>expected_counts_combined <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(gender_rmt_table_combined)<span class="sc">$</span>expected</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Expected counts with combined categories:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Expected counts with combined categories:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expected_counts_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        
            No RMT       RMT
  Female 618.90244 106.09756
  Male   640.24390 109.75610
  Other   70.85366  12.14634</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test on the new table</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>chi_square_results_combined <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(gender_rmt_table_combined)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chi-square test results with combined categories:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chi-square test results with combined categories:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_square_results_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  gender_rmt_table_combined
X-squared = 13.136, df = 2, p-value = 0.001405</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for plotting with combined categories</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>gender_rmt_df_combined <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gender_rmt_table_combined)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gender_rmt_df_combined) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"RMTMethods_YN"</span>, <span class="st">"Count"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>gender_rmt_df_combined <span class="ot">&lt;-</span> gender_rmt_df_combined <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> (Count <span class="sc">/</span> <span class="fu">sum</span>(Count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with combined categories</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 7</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 10</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "700px"</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>rmt_plot_combined <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gender_rmt_df_combined, <span class="fu">aes</span>(<span class="at">x =</span> RMTMethods_YN, <span class="at">y =</span> Count, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, Count, Percentage)), </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Gender Distribution by RMT Methods Usage (Combined Categories)"</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"RMT Methods Usage"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Participants (N = 1558)"</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Gender"</span>) <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">30</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)  <span class="co"># Add more margin at the top</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))  <span class="co"># Expand y-axis to make room for labels</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot with combined categories</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmt_plot_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results-after-combining-into-other-category" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="results-after-combining-into-other-category"><span class="header-section-number">2.4</span> Results after combining into ‘Other’ category</h2>
<p><strong>Overview of the Data</strong></p>
<p>The analysis examines the relationship between gender and Remote Monitoring Technology (RMT) usage across three gender categories: Female, Male, and Other. The contingency table shows the observed counts of participants in each combination of gender and RMT usage status.</p>
<p><strong>Contingency Table Analysis</strong></p>
<p><em>Observed Frequencies</em></p>
<ul>
<li><p><strong>Female participants</strong>: 642 do not use RMT; 83 use RMT (total: 725)</p></li>
<li><p><strong>Male participants</strong>: 615 do not use RMT; 135 use RMT (total: 750)</p></li>
<li><p><strong>Other gender category</strong>: 73 do not use RMT; 10 use RMT (total: 83)</p></li>
<li><p><strong>Column totals</strong>: 1,330 non-RMT users; 228 RMT users (overall total: 1,558)</p></li>
</ul>
<p><img src="images/clipboard-3395192856.png" class="img-fluid"></p>
<p><strong>Usage Rates by Gender</strong></p>
<ul>
<li><p>Females: 11.4% use RMT (83 out of 725)</p></li>
<li><p>Males: 18.0% use RMT (135 out of 750)</p></li>
<li><p>Other: 12.0% use RMT (10 out of 83)</p></li>
</ul>
<p><strong>Key Observations</strong></p>
<ul>
<li><p>The majority of individuals across all genders did not use RMT (“No RMT”).</p></li>
<li><p>In absolute terms, females are the largest group in the “No RMT” category (642), while males are the largest in the “RMT” category (135).</p></li>
<li><p>The “Other” gender group has the fewest individuals in both “RMT” (10) and “No RMT” (73) categories.</p></li>
</ul>
<p><strong>Expected Frequencies</strong></p>
<p>The expected counts represent what we would expect to see if there were no relationship between gender and RMT usage (i.e., if the null hypothesis were true). These are calculated based on the assumption that RMT usage and gender are independent:</p>
<ul>
<li><p><strong>Female participants</strong>: Expected 618.90 non-users; 106.10 user</p></li>
<li><p><strong>Male participants</strong>: Expected 640.24 non-users; 109.76 users</p></li>
<li><p><strong>Other gender category</strong>: Expected 70.85 non-users; 12.15 users</p></li>
</ul>
<p><img src="images/clipboard-91490.png" class="img-fluid"></p>
<p><strong>Differences between Observed and Expected</strong></p>
<ul>
<li><p><strong>Female participants</strong>: More non-users than expected (+23.10); fewer users than expected (-23.10)</p></li>
<li><p><strong>Male participants</strong>: Fewer non-users than expected (-25.24); more users than expected (+25.24)</p></li>
<li><p><strong>Other gender category</strong>: More non-users than expected (+2.15); fewer users than expected (-2.15)</p></li>
</ul>
<p><strong>Key Observations:</strong></p>
<ul>
<li><p>Under independence, females were expected to have about 618.9 individuals in “No RMT” and 106.1 in “RMT.” However, the actual numbers are 642 and 83, respectively, suggesting fewer females participated in RMT than expected.</p></li>
<li><p>Conversely, males were expected to have 640.2 individuals in “No RMT” and 109.8 in “RMT,” but the actual numbers are 615 and 135, suggesting more males participated in RMT than expected.</p></li>
<li><p>The “Other” group shows relatively small deviations from the expected counts.</p></li>
</ul>
<p><strong>Statistical Test Results</strong></p>
<p>The chi-squared test evaluates whether the observed differences between the gender categories in RMT usage contingency table and the expected counts are statistically significant or could be attributed to random chance. The test outputs the following results:</p>
<ul>
<li><p><strong>Chi-square statistic (X²)</strong>: 13.136</p></li>
<li><p><strong>Degrees of freedom (df)</strong>: 2</p></li>
<li><p><strong>P-value</strong>: 0.001405</p></li>
</ul>
<p><strong>Interpretation</strong></p>
<ol type="1">
<li><p><strong>Statistical Significance</strong>: The p-value (0.001405) is well below the conventional threshold of 0.05, indicating a statistically significant association between gender and RMT usage. This means we can reject the null hypothesis that gender and RMT usage are independent.</p></li>
<li><p><strong>Effect Direction</strong>:</p>
<ul>
<li><p>Males show notably higher RMT usage than expected under the null hypothesis</p></li>
<li><p>Females show notably lower RMT usage than expected</p></li>
<li><p>The “Other” gender category shows slightly lower RMT usage than expected</p></li>
</ul></li>
<li><p><strong>Practical Significance</strong>:</p>
<ul>
<li><p>Male participants are approximately 1.6 times more likely to use RMT compared to female participants (18.0% vs 11.4%)</p></li>
<li><p>The “Other” gender category’s RMT usage (12.0%) is closer to females than males</p></li>
</ul></li>
<li><p><strong>Strength of Association</strong>: While statistically significant, the chi-square value (13.136) suggests a modest association between gender and RMT usage in the context of the sample size (1,558 participants).</p></li>
<li><p>In simpler terms, there is indeed a meaningful relationship between gender and the use of RMT methods.</p></li>
</ol>
<p><strong>Limitations and Considerations</strong></p>
<ol type="1">
<li><p><strong>Categorical Combination</strong>: The “Other” category appears to be a combination of non-binary individuals and those who chose not to disclose their gender. This grouping, while necessary for statistical analysis due to smaller sample sizes, may obscure potential differences between these distinct groups.</p></li>
<li><p><strong>Sample Size Differences</strong>: The “Other” gender category (n=83) is much smaller than the Female (n=725) and Male (n=750) categories, which affects the precision of estimates for this group.</p></li>
<li><p><strong>No Control Variables</strong>: This analysis does not account for other variables that might influence RMT usage (e.g., age, technology access, health status) and might confound the relationship between gender and RMT usage.</p></li>
</ol>
<p><strong>Conclusion</strong></p>
<p>There is compelling statistical evidence for a gender difference in RMT usage patterns, with males showing significantly higher adoption rates compared to females and those in the “Other” gender category. This finding may have implications for RMT implementation strategies, suggesting potential benefits from gender-specific approaches to technology adoption and support.</p>
</section>
</section>
<section id="age" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Age</h1>
<section id="demographic-stats" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="demographic-stats"><span class="header-section-number">3.1</span> Demographic Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age summary</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>age_summary <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Under 20"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"20-29"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"30-39"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">40</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"40-49"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"50-59"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"60+"</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> <span class="dv">1558</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">factor</span>(age_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)))</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the age plot with adjusted height scaling</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age_summary, </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(age_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)), </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> count, <span class="at">fill =</span> age_group)) <span class="sc">+</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"N=%d\</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Participants by Age Group"</span>,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group (Years)"</span>,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Participants (N = 1558)"</span>) <span class="sc">+</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)), </span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(age_summary<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.15</span>))</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Age distribution summary:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Age distribution summary:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  age_group count percentage
  &lt;chr&gt;     &lt;int&gt;      &lt;dbl&gt;
1 Under 20    180       11.6
2 20-29       497       31.9
3 30-39       291       18.7
4 40-49       226       14.5
5 50-59       171       11.0
6 60+         193       12.4</code></pre>
</div>
</div>
</section>
<section id="results-and-discussion-1" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="results-and-discussion-1"><span class="header-section-number">3.2</span> Results and Discussion</h2>
<p>Age: M = 37, SD = 16, 18-94, Median 32.5yo</p>
<p>• The age distribution shows a right-skewed pattern with the majority of participants being between 18-40 years old, and fewer participants in the higher age ranges. Gender distribution is fairly balanced between male (48.1%) and female (46.5%) participants</p>
<p>• The largest age group is 20-29 years (31.9% of participants)</p>
<p>• There’s a gradual decrease in participation with age, with the exception of a slight increase in the 60+ category compared to 50-59</p>
</section>
<section id="comparison-stats-1" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="comparison-stats-1"><span class="header-section-number">3.3</span> Comparison Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age and RMT usage summary</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>age_rmt_summary <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Under 20"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"20-29"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"30-39"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">40</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"40-49"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"50-59"</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"60+"</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Yes"</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N for the analysis</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(age_rmt_summary)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>age_rmt_table <span class="ot">&lt;-</span> <span class="fu">table</span>(age_rmt_summary<span class="sc">$</span>age_group, age_rmt_summary<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the contingency table</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Contingency Table:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Contingency Table:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_rmt_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
            No Yes
  20-29    414  83
  30-39    223  68
  40-49    199  27
  50-59    153  18
  60+      173  20
  Under 20 168  12</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified code with simulation-based p-value</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>chi_square_results <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(age_rmt_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>expected_counts <span class="ot">&lt;-</span> chi_square_results<span class="sc">$</span>expected</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="st">Expected Counts:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nExpected Counts:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(expected_counts, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
               No   Yes
  20-29    424.27 72.73
  30-39    248.41 42.59
  40-49    192.93 33.07
  50-59    145.98 25.02
  60+      164.76 28.24
  Under 20 153.66 26.34</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>min_expected <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_counts)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"\</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="st">Minimum expected count: %.2f"</span>, min_expected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nMinimum expected count: 25.02"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If any expected count is below 5, use Fisher's exact test</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(min_expected <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Some expected counts are less than 5; using Fisher's exact test instead."</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  fisher_test_results <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(age_rmt_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="st">Fisher's exact test results:"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(fisher_test_results)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  main_test_results <span class="ot">&lt;-</span> fisher_test_results</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  test_name <span class="ot">&lt;-</span> <span class="st">"Fisher's exact test"</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  test_statistic <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  test_df <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  test_pvalue <span class="ot">&lt;-</span> fisher_test_results<span class="sc">$</span>p.value</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run chi-square test with simulated p-values for robustness</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  chi_square_sim <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(age_rmt_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="st">Chi-square test with simulated p-value:"</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(chi_square_sim)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  main_test_results <span class="ot">&lt;-</span> chi_square_sim</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  test_name <span class="ot">&lt;-</span> <span class="st">"Chi-square test"</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  test_statistic <span class="ot">&lt;-</span> chi_square_sim<span class="sc">$</span>statistic</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  test_df <span class="ot">&lt;-</span> chi_square_sim<span class="sc">$</span>parameter</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  test_pvalue <span class="ot">&lt;-</span> chi_square_sim<span class="sc">$</span>p.value</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nChi-square test with simulated p-value:"

    Pearson's Chi-squared test with simulated p-value (based on 10000
    replicates)

data:  age_rmt_table
X-squared = 35.047, df = NA, p-value = 9.999e-05</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages within each age group</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>age_rmt_summary_stats <span class="ot">&lt;-</span> age_rmt_summary <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_group, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(RMTMethods_YN, <span class="fu">factor</span>(age_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)))</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot </span><span class="al">###</span><span class="co"> REPLACE</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>rmt_age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age_rmt_summary_stats, </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(age_group, </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)), </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust data label: extra vertical space by increasing vjust (e.g., -1 for more space)</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RMT Device Use by Age Group"</span>,</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Percentages calculated within each RMT group (Yes/No)"</span>),</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group (Years)"</span>,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"Number of Participants (Total N ="</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"RMT Usage"</span>) <span class="sc">+</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">40</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>)  <span class="co"># Increased top margin for clarity</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Expand the y-axis to create extra space at the top for the data labels</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)))</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmt_age_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportions for each RMT group</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proportions within each RMT group:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nProportions within each RMT group:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>prop_table <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(age_rmt_table, <span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Changed margin from 1 to 2</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_table, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
              No   Yes
  20-29    31.13 36.40
  30-39    16.77 29.82
  40-49    14.96 11.84
  50-59    11.50  7.89
  60+      13.01  8.77
  Under 20 12.63  5.26</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the standardized residuals</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"chi_square_results"</span>)) {</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  std_residuals <span class="ot">&lt;-</span> chi_square_results<span class="sc">$</span>residuals</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized residuals:"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(std_residuals, <span class="dv">2</span>))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Cells with absolute standardized residuals &gt; 2 contribute significantly to the chi-square statistic"</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nStandardized residuals:"
          
              No   Yes
  20-29    -0.50  1.20
  30-39    -1.61  3.89
  40-49     0.44 -1.06
  50-59     0.58 -1.40
  60+       0.64 -1.55
  Under 20  1.16 -2.79
[1] "Cells with absolute standardized residuals &gt; 2 contribute significantly to the chi-square statistic"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional visualization: Create a bar chart showing the percentage of each age group within RMT usage groups</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>percentage_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age_rmt_summary_stats, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(age_group, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)), </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> percentage, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, percentage)),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Distribution Within RMT Usage Groups"</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Showing percentage of each age group within 'Yes' and 'No' RMT usage categories"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group (Years)"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage within RMT Group (%)"</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"RMT Usage"</span>) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the percentage plot</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(percentage_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni Correction and Visualisation</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairwise chi-square tests between age groups with Bonferroni correction. This determines how strict the Bonferroni correction will be.</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="st">Pairwise comparisons between age groups with Bonferroni correction:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nPairwise comparisons between age groups with Bonferroni correction:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>age_groups <span class="ot">&lt;-</span> <span class="fu">rownames</span>(age_rmt_table)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>n_comparisons <span class="ot">&lt;-</span> <span class="fu">choose</span>(<span class="fu">length</span>(age_groups), <span class="dv">2</span>) <span class="co">#calculates the total number of pairwise comparisons</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group1 =</span> <span class="fu">character</span>(),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group2 =</span> <span class="fu">character</span>(),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ChiSquare =</span> <span class="fu">numeric</span>(),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">DF =</span> <span class="fu">numeric</span>(),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">RawP =</span> <span class="fu">numeric</span>(),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CorrectedP =</span> <span class="fu">numeric</span>(),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significant =</span> <span class="fu">character</span>(),</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># For each pair of age groups, the code: </span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Creates a 2×2 contingency table containing only those two age groups</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Checks if expected cell counts are below 5</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Uses either Chi-square or Fisher's exact test accordingly</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Applies Bonferroni correction to control for multiple comparisons</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Determines significance based on the corrected p-value</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(age_groups)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(age_groups)) {</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    subset_tab <span class="ot">&lt;-</span> age_rmt_table[<span class="fu">c</span>(i, j), ]</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check expected counts for this pair</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    pair_expected <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(subset_tab)<span class="sc">$</span>expected</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    min_pair_expected <span class="ot">&lt;-</span> <span class="fu">min</span>(pair_expected)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Choose appropriate test based on expected counts</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Chi-square test assumes expected cell counts ≥5</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="do">## When this assumption is violated, Fisher's exact test is used instead</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    <span class="do">## This adaptive approach ensures statistical validity for each comparison</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(min_pair_expected <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>      pair_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(subset_tab)</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>      test_stat <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>      test_df <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>      pair_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(subset_tab)</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>      test_stat <span class="ot">&lt;-</span> pair_test<span class="sc">$</span>statistic</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>      test_df <span class="ot">&lt;-</span> pair_test<span class="sc">$</span>parameter</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply Bonferroni correction</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    <span class="do">## The original p-value is multiplied by the total number of comparisons</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    <span class="do">## This makes the significance threshold more stringent to avoid false positives</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="do">## The correction controls the family-wise error rate when making multiple comparisons</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    <span class="do">## The min() function ensures the corrected p-value doesn't exceed 1</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>    corrected_p <span class="ot">&lt;-</span> <span class="fu">min</span>(pair_test<span class="sc">$</span>p.value <span class="sc">*</span> n_comparisons, <span class="dv">1</span>)</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine if the result is significant</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>    is_significant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(corrected_p <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add to results dataframe</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>    pairwise_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_results, <span class="fu">data.frame</span>(</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">Group1 =</span> age_groups[i],</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">Group2 =</span> age_groups[j],</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">ChiSquare =</span> <span class="cf">if</span>(<span class="fu">is.na</span>(test_stat)) <span class="cn">NA</span> <span class="cf">else</span> <span class="fu">round</span>(test_stat, <span class="dv">2</span>),</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">DF =</span> test_df,</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">RawP =</span> <span class="fu">round</span>(pair_test<span class="sc">$</span>p.value, <span class="dv">4</span>),</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">CorrectedP =</span> <span class="fu">round</span>(corrected_p, <span class="dv">4</span>),</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">Significant =</span> is_significant,</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the result</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(test_stat)) {</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>      message <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"Comparison %s vs %s: Fisher's exact test, raw p = %.4f, Bonferroni corrected p = %.4f, Significant: %s"</span>,</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>                         age_groups[i], age_groups[j],</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>                         pair_test<span class="sc">$</span>p.value, corrected_p, is_significant)</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>      message <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"Comparison %s vs %s: Chi-square = %.2f, df = %d, raw p = %.4f, Bonferroni corrected p = %.4f, Significant: %s"</span>,</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a>                         age_groups[i], age_groups[j],</span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>                         test_stat, test_df,</span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>                         pair_test<span class="sc">$</span>p.value, corrected_p, is_significant)</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(message)</span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Comparison 20-29 vs 30-39: Chi-square = 4.85, df = 1, raw p = 0.0277, Bonferroni corrected p = 0.4157, Significant: No"
[1] "Comparison 20-29 vs 40-49: Chi-square = 2.37, df = 1, raw p = 0.1241, Bonferroni corrected p = 1.0000, Significant: No"
[1] "Comparison 20-29 vs 50-59: Chi-square = 3.31, df = 1, raw p = 0.0687, Bonferroni corrected p = 1.0000, Significant: No"
[1] "Comparison 20-29 vs 60+: Chi-square = 3.91, df = 1, raw p = 0.0479, Bonferroni corrected p = 0.7192, Significant: No"
[1] "Comparison 20-29 vs Under 20: Chi-square = 10.21, df = 1, raw p = 0.0014, Bonferroni corrected p = 0.0209, Significant: Yes"
[1] "Comparison 30-39 vs 40-49: Chi-square = 10.31, df = 1, raw p = 0.0013, Bonferroni corrected p = 0.0198, Significant: Yes"
[1] "Comparison 30-39 vs 50-59: Chi-square = 10.89, df = 1, raw p = 0.0010, Bonferroni corrected p = 0.0145, Significant: Yes"
[1] "Comparison 30-39 vs 60+: Chi-square = 12.33, df = 1, raw p = 0.0004, Bonferroni corrected p = 0.0067, Significant: Yes"
[1] "Comparison 30-39 vs Under 20: Chi-square = 20.83, df = 1, raw p = 0.0000, Bonferroni corrected p = 0.0001, Significant: Yes"
[1] "Comparison 40-49 vs 50-59: Chi-square = 0.08, df = 1, raw p = 0.7777, Bonferroni corrected p = 1.0000, Significant: No"
[1] "Comparison 40-49 vs 60+: Chi-square = 0.13, df = 1, raw p = 0.7212, Bonferroni corrected p = 1.0000, Significant: No"
[1] "Comparison 40-49 vs Under 20: Chi-square = 2.64, df = 1, raw p = 0.1043, Bonferroni corrected p = 1.0000, Significant: No"
[1] "Comparison 50-59 vs 60+: Chi-square = 0.00, df = 1, raw p = 1.0000, Bonferroni corrected p = 1.0000, Significant: No"
[1] "Comparison 50-59 vs Under 20: Chi-square = 1.21, df = 1, raw p = 0.2706, Bonferroni corrected p = 1.0000, Significant: No"
[1] "Comparison 60+ vs Under 20: Chi-square = 1.19, df = 1, raw p = 0.2763, Bonferroni corrected p = 1.0000, Significant: No"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the pairwise results table</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="st">Summary of pairwise comparisons:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nSummary of pairwise comparisons:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Group1   Group2 ChiSquare DF   RawP CorrectedP Significant
X-squared    20-29    30-39      4.85  1 0.0277     0.4157          No
X-squared1   20-29    40-49      2.37  1 0.1241     1.0000          No
X-squared2   20-29    50-59      3.31  1 0.0687     1.0000          No
X-squared3   20-29      60+      3.91  1 0.0479     0.7192          No
X-squared4   20-29 Under 20     10.21  1 0.0014     0.0209         Yes
X-squared5   30-39    40-49     10.31  1 0.0013     0.0198         Yes
X-squared6   30-39    50-59     10.89  1 0.0010     0.0145         Yes
X-squared7   30-39      60+     12.33  1 0.0004     0.0067         Yes
X-squared8   30-39 Under 20     20.83  1 0.0000     0.0001         Yes
X-squared9   40-49    50-59      0.08  1 0.7777     1.0000          No
X-squared10  40-49      60+      0.13  1 0.7212     1.0000          No
X-squared11  40-49 Under 20      2.64  1 0.1043     1.0000          No
X-squared12  50-59      60+      0.00  1 1.0000     1.0000          No
X-squared13  50-59 Under 20      1.21  1 0.2706     1.0000          No
X-squared14    60+ Under 20      1.19  1 0.2763     1.0000          No</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap of p-values for pairwise comparisons</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for heatmap</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Red cells indicate p-values close to 0 (strong evidence of difference)</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Yellow indicates p-values around 0.5 (moderate evidence)</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="do">## White indicates p-values close to 1 (little evidence of difference)</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Asterisks (*) mark statistically significant differences (p &lt; 0.05)</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The heatmap is symmetrical because the comparison of Group1 vs Group2 is the same as Group2 vs Group1</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(age_groups), <span class="at">ncol =</span> <span class="fu">length</span>(age_groups))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(heatmap_data) <span class="ot">&lt;-</span> age_groups</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(heatmap_data) <span class="ot">&lt;-</span> age_groups</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pairwise_results)) {</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  row_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(age_groups <span class="sc">==</span> pairwise_results<span class="sc">$</span>Group1[i])</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  col_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(age_groups <span class="sc">==</span> pairwise_results<span class="sc">$</span>Group2[i])</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  heatmap_data[row_idx, col_idx] <span class="ot">&lt;-</span> pairwise_results<span class="sc">$</span>CorrectedP[i]</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  heatmap_data[col_idx, row_idx] <span class="ot">&lt;-</span> pairwise_results<span class="sc">$</span>CorrectedP[i]  <span class="co"># Mirror the matrix</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format for ggplot</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>heatmap_long <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(heatmap_data))</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(heatmap_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Group1"</span>, <span class="st">"Group2"</span>, <span class="st">"CorrectedP"</span>)</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(heatmap_long, <span class="fu">aes</span>(<span class="at">x =</span> Group1, <span class="at">y =</span> Group2, <span class="at">fill =</span> CorrectedP)) <span class="sc">+</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"white"</span>, </span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">na.value =</span> <span class="st">"white"</span>,</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">name =</span> <span class="st">"Corrected p-value"</span>) <span class="sc">+</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(CorrectedP), <span class="st">""</span>, </span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(CorrectedP <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">sprintf</span>(<span class="st">"%.4f*"</span>, CorrectedP),</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, CorrectedP)))),</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pairwise Comparisons of RMT Usage Between Age Groups"</span>,</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Bonferroni-corrected p-values (* indicates significant at α = 0.05)"</span>) <span class="sc">+</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the heatmap</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a><span class="do">## When analyzing the results from this code:</span></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Look for cells with asterisks (*) in the heatmap or "Significant: Yes" in the printed results</span></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a><span class="do">## These indicate which specific age groups differ significantly in RMT usage</span></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a><span class="do">## The raw p-values show the strength of evidence before correction</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="do">## The corrected p-values account for multiple testing and are more conservative</span></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Pay attention to which test was used (Chi-square or Fisher's) for each comparison</span></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a><span class="do">## This approach enables you to identify specifically which age groups differ from each other in their RMT usage patterns, rather than just knowing that "age is associated with RMT usage" in general.</span></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(heatmap_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional visualization: Create a bar chart showing the percentage of RMT usage by age group</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>percentage_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age_rmt_summary_stats <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"Yes"</span>), </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(age_group, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)), </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> percentage)) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, percentage)),</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of RMT Device Usage by Age Group"</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group (Years)"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the percentage plot</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(percentage_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results-and-discussion-2" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="results-and-discussion-2"><span class="header-section-number">3.4</span> Results and Discussion</h2>
<p><em>Chi-Square Test</em></p>
<p>The chi-square test with simulated p-values (10,000 replicates) shows a statistically significant association between age group and RMT usage:</p>
<p>X-squared = 35.047, p-value &lt; 0.0001</p>
<p>This indicates strong evidence against the null hypothesis of independence between age group and RMT device usage.</p>
<p><em>Expected Counts</em></p>
<p>All expected cell counts exceed 5, confirming the chi-square test’s validity</p>
<p>Minimum expected count: 25.02</p>
<p><em>Standardized Residuals</em></p>
<p>The standardized residuals help identify which specific cells contribute most to the chi-square statistic</p>
<p><strong>Notable observations:</strong></p>
<p>The 30-39 age group has a strong positive residual (3.89) for “Yes” responses, indicating significantly higher RMT usage than expected. The Under 20 age group has a strong negative residual (-2.79) for “Yes” responses, indicating significantly lower RMT usage than expected.</p>
<p><strong>Pairwise Comparisons with Bonferroni Correction</strong></p>
<p>To determine which specific age groups differ significantly from each other, pairwise chi-square tests were conducted with Bonferroni correction to control for multiple comparisons</p>
<p><strong>Summary of Significant Pairwise Differences:</strong></p>
<p>30-39 age group shows significantly higher RMT usage compared to: 40-49 age group (p = 0.0198), 50-59 age group (p = 0.0145), 60+ age group (p = 0.0067), Under 20 age group (p = 0.0001).</p>
<p>20-29 age group shows significantly higher RMT usage compared to: Under 20 age group (p = 0.0209).</p>
<p>No significant differences were found between: 20-29 and 30-39 age groups Any pairs among the 40-49, 50-59, 60+, and Under 20 age groups.</p>
<p><strong>Visual Representation</strong></p>
<p>The analysis includes three visualizations:</p>
<ol type="1">
<li><p>Bar chart of RMT usage counts by age group</p></li>
<li><p>Heatmap of pairwise comparison p-values</p></li>
<li><p>Percentage of RMT device usage by age group</p></li>
</ol>
<p><strong>Interpretation and Implications Age-Related Patterns in RMT Usage:</strong></p>
<p>The 30-39 age group has the highest RMT adoption rate (23.37%). The 20-29 age group has the second highest adoption rate (16.70%). All other age groups have notably lower adoption rates (6.67% to 11.95%).</p>
<p><strong>Key Findings:</strong></p>
<p>There is a clear peak in RMT usage among adults in their 30s. Young adults (20-29) also show relatively high adoption. Both younger (under 20) and older (40+) age groups show significantly lower adoption rates. The 30-39 age group stands out as significantly different from most other age groups.</p>
<p><strong>Practical</strong> <strong>Implications:</strong></p>
<p>Targeted interventions may be needed to increase RMT adoption among both younger and older populations. Understanding the factors that drive higher adoption in the 30-39 age group could inform strategies to increase usage in other groups. The 20-29 and 30-39 age groups could be considered as early adopters or technology champions. This comprehensive analysis provides strong statistical evidence for age-related differences in RMT device usage, with clear identification of which specific age groups differ significantly from others.</p>
</section>
</section>
<section id="instruments-played" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Instruments Played</h1>
<section id="descriptive-stats-1" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="descriptive-stats-1"><span class="header-section-number">4.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define instrument families</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>woodwinds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Flute"</span>, <span class="st">"Piccolo"</span>, <span class="st">"Clarinet"</span>, <span class="st">"Saxophone"</span>, <span class="st">"Oboe"</span>, <span class="st">"Bassoon"</span>, <span class="st">"Recorder"</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>brass <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Trumpet"</span>, <span class="st">"Trombone"</span>, <span class="st">"Tuba"</span>, <span class="st">"Euphonium"</span>, <span class="st">"French Horn"</span>, <span class="st">"French Horn/Horn"</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>others <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Bagpipes"</span>, <span class="st">"Other"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Process instrument-level data</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>WI_split_updated <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(WI) <span class="sc">%&gt;%</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(WI, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WI =</span> <span class="fu">trimws</span>(WI)) <span class="sc">%&gt;%</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WI =</span> <span class="fu">case_when</span>(</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">==</span> <span class="st">"French Horn/Horn"</span> <span class="sc">~</span> <span class="st">"French Horn"</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">==</span> <span class="st">"Oboe/Cor Anglais"</span> <span class="sc">~</span> <span class="st">"Oboe"</span>,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> WI</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(WI <span class="sc">!=</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(WI, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Family =</span> <span class="fu">case_when</span>(</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">%in%</span> <span class="fu">c</span>(woodwinds, <span class="st">"Oboe"</span>) <span class="sc">~</span> <span class="st">"Woodwinds"</span>,</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">%in%</span> brass <span class="sc">~</span> <span class="st">"Brass"</span>,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Others"</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages for instruments</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>WI_percentages_updated <span class="ot">&lt;-</span> WI_split_updated <span class="sc">%&gt;%</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>((n <span class="sc">/</span> <span class="dv">3054</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate family distribution</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>family_distribution_updated <span class="ot">&lt;-</span> WI_split_updated <span class="sc">%&gt;%</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Family) <span class="sc">%&gt;%</span></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>((Total <span class="sc">/</span> <span class="dv">3054</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create instrument distribution plot</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>instrument_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> WI_percentages_updated, </span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(WI, n), <span class="at">y =</span> n, <span class="at">fill =</span> Family)) <span class="sc">+</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, Percentage, <span class="st">"%)"</span>)), </span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, </span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>))) <span class="sc">+</span>  <span class="co"># Increased expansion for labels</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Wind Instruments by Count and Percentage"</span>,</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Instrument"</span>,</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency (N=1558, responses = 3054)"</span>,</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note. reported percentages are out of total responses (3054) not the total N (1558)"</span>) <span class="sc">+</span></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Create family distribution plot</span></span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>family_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> family_distribution_updated, </span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Family, <span class="sc">-</span>Total), <span class="at">y =</span> Total, <span class="at">fill =</span> Family)) <span class="sc">+</span></span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Total, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, Percentage, <span class="st">"%)"</span>)), </span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))) <span class="sc">+</span>  <span class="co"># Increased expansion for labels</span></span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution by Instrument Family"</span>,</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Instrument Family"</span>,</span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency (N=1558, responses = 3054)"</span>,</span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note. reported percentages are out of total responses (3054) not the total N (1558)"</span>) <span class="sc">+</span></span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(instrument_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(family_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print distributions</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Instrument Distribution:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Instrument Distribution:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(WI_percentages_updated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 4
   WI              n Family    Percentage
   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
 1 Saxophone     477 Woodwinds      15.6 
 2 Flute         443 Woodwinds      14.5 
 3 Clarinet      415 Woodwinds      13.6 
 4 Trumpet       343 Brass          11.2 
 5 Trombone      212 Brass           6.94
 6 Piccolo       209 Woodwinds       6.84
 7 French Horn   161 Brass           5.27
 8 Oboe          150 Woodwinds       4.91
 9 Recorder      136 Woodwinds       4.45
10 Euphonium     133 Brass           4.35
11 Tuba          129 Brass           4.22
12 Other          94 Others          3.08
13 Bassoon        92 Woodwinds       3.01
14 Bagpipes       60 Others          1.96</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Family Distribution:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nFamily Distribution:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(family_distribution_updated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Family    Total Percentage
  &lt;chr&gt;     &lt;int&gt;      &lt;dbl&gt;
1 Brass       978      32.0 
2 Others      154       5.04
3 Woodwinds  1922      62.9 </code></pre>
</div>
</div>
<section id="results-and-discussion-3" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="results-and-discussion-3"><span class="header-section-number">4.1.1</span> Results and Discussion</h3>
<p>• Woodwinds represented a slight majority of 58.02% of the total instruments.</p>
<p>• Brass accounts for 31.99%, with the updated “French Horn” category included.</p>
<p>• Others and Unknown categories make up smaller portions (5.04% and 4.94%, respectively).</p>
<p><em>Individual Instrument Distribution:</em></p>
<p>• Saxophone remains the most popular instrument (15.62%), followed by Flute (14.51%) and Clarinet (13.59%).</p>
<p>• Trumpet leads the brass instruments with 11.23%, while French Horn now accurately reflects its combined count.</p>
<p>• Others include: harmonica, tenor horn, non-western flute, recorder, ocarina, cornet, whistle, baritone, non-western reed, flugelhorn, misc.</p>
</section>
</section>
<section id="comparison-stats-2" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="comparison-stats-2"><span class="header-section-number">4.2</span> Comparison Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Process instrument and RMT data</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>instrument_rmt_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(WI), <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(WI, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">WI =</span> <span class="fu">trimws</span>(WI),</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">WI =</span> <span class="fu">case_when</span>(</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>      WI <span class="sc">==</span> <span class="st">"French Horn/Horn"</span> <span class="sc">~</span> <span class="st">"French Horn"</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> WI</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(RMTMethods_YN, </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>))</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(WI <span class="sc">!=</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">family =</span> <span class="fu">case_when</span>(</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Flute"</span>, <span class="st">"Piccolo"</span>, <span class="st">"Clarinet"</span>, <span class="st">"Saxophone"</span>, <span class="st">"Oboe"</span>, <span class="st">"Bassoon"</span>, <span class="st">"Recorder"</span>) <span class="sc">~</span> <span class="st">"Woodwinds"</span>,</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Trumpet"</span>, <span class="st">"Trombone"</span>, <span class="st">"Tuba"</span>, <span class="st">"Euphonium"</span>, <span class="st">"French Horn"</span>) <span class="sc">~</span> <span class="st">"Brass"</span>,</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Others"</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts and percentages for each RMT group (Changed grouping)</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>family_rmt_summary <span class="ot">&lt;-</span> instrument_rmt_data <span class="sc">%&gt;%</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(family, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span>  <span class="co"># Changed from family to RMTMethods_YN</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N for adding to the plot</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(instrument_rmt_data)</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test on the full contingency table</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(instrument_rmt_data<span class="sc">$</span>family, instrument_rmt_data<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>chi_square_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chi-square test results:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chi-square test results:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_square_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  contingency_table
X-squared = 28.293, df = 2, p-value = 7.183e-07</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the assumption: print the expected counts from the chi-square test</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Expected counts:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Expected counts:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_square_test<span class="sc">$</span>expected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
               No RMT       RMT
  Brass      815.9607 162.03929
  Others     253.6320  50.36804
  Woodwinds 1478.4073 293.59267</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If any expected count is less than 5, issue a warning and switch to Fisher's exact test</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">min</span>(chi_square_test<span class="sc">$</span>expected) <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Chi-square test assumption violated. Switching to Fisher's exact test."</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  chi_square_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Fisher's exact test results:"</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(chi_square_test)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>rmt_distribution_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(family_rmt_summary, </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">aes</span>(<span class="at">x =</span> family, <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Instrument Families within RMT Usage Groups"</span>,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Percentages calculated within each RMT group (Chi-square: χ² = %.2f, df = %d, p = %.4f)"</span>,</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                        chi_square_test<span class="sc">$</span>statistic,</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>                        chi_square_test<span class="sc">$</span>parameter,</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>                        chi_square_test<span class="sc">$</span>p.value),</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Instrument Family"</span>,</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"Number of Responses (Total N ="</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"RMT Usage"</span>) <span class="sc">+</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">30</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>)  <span class="co"># Add more space at the top</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))  <span class="co"># Add more space above bars</span></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmt_distribution_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print odds ratios</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds ratios between instrument families and RMT usage:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nOdds ratios between instrument families and RMT usage:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>family_rmt_odds <span class="ot">&lt;-</span> family_rmt_summary <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(family, RMTMethods_YN, count) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> RMTMethods_YN, <span class="at">values_from =</span> count, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">count =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a small constant to avoid division by zero</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">odds_ratio =</span> <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"RMT"</span>, <span class="st">"No RMT"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(.))) {</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>      (RMT <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> (<span class="fu">sum</span>(RMT) <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> (((<span class="st">`</span><span class="at">No RMT</span><span class="st">`</span> <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> (<span class="fu">sum</span>(<span class="st">`</span><span class="at">No RMT</span><span class="st">`</span>) <span class="sc">+</span> <span class="fl">0.5</span>)))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(family_rmt_odds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  family    `No RMT`   RMT odds_ratio
  &lt;chr&gt;        &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
1 Brass          765   213      1.40 
2 Others         260    44      0.860
3 Woodwinds     1523   249      0.824</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with percentages within RMT groups for easier interpretation</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>rmt_percentages <span class="ot">&lt;-</span> family_rmt_summary <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(family, RMTMethods_YN, count, percentage) <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> RMTMethods_YN, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(count, percentage),</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_glue =</span> <span class="st">"{RMTMethods_YN}_{.value}"</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Percentage distribution within each RMT group:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nPercentage distribution within each RMT group:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmt_percentages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  family    `No RMT_count` RMT_count `No RMT_percentage` RMT_percentage
  &lt;chr&gt;              &lt;int&gt;     &lt;int&gt;               &lt;dbl&gt;          &lt;dbl&gt;
1 Brass                765       213                30.0          42.1 
2 Others               260        44                10.2           8.70
3 Woodwinds           1523       249                59.8          49.2 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform post-hoc analysis for each pair of instrument families</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise comparisons between instrument families:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nPairwise comparisons between instrument families:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>families <span class="ot">&lt;-</span> <span class="fu">unique</span>(instrument_rmt_data<span class="sc">$</span>family)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(families) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(families)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(families)) {</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>      subset_data <span class="ot">&lt;-</span> instrument_rmt_data <span class="sc">%&gt;%</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(family <span class="sc">%in%</span> <span class="fu">c</span>(families[i], families[j]))</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create contingency table for this pair</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>      pair_table <span class="ot">&lt;-</span> <span class="fu">table</span>(subset_data<span class="sc">$</span>family, subset_data<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if table has enough data for chi-square test</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">dim</span>(pair_table) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;&amp;</span> <span class="fu">min</span>(pair_table) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>        pair_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(pair_table)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>        test_type <span class="ot">&lt;-</span> <span class="st">"Chi-square"</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use Fisher's exact test as fallback</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>        pair_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(pair_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>        test_type <span class="ot">&lt;-</span> <span class="st">"Fisher's exact"</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">%s vs %s:"</span>, families[i], families[j]))</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(test_type <span class="sc">==</span> <span class="st">"Chi-square"</span>) {</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"%s test: Chi-square = %.2f, df = %d, p = %.4f"</span>,</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>                      test_type,</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>                      pair_test<span class="sc">$</span>statistic,</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>                      pair_test<span class="sc">$</span>parameter,</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>                      pair_test<span class="sc">$</span>p.value))</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"%s test: p = %.4f"</span>, test_type, pair_test<span class="sc">$</span>p.value))</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nWoodwinds vs Others:"
[1] "Chi-square test: Chi-square = 0.01, df = 1, p = 0.9156"
[1] "\nWoodwinds vs Brass:"
[1] "Chi-square test: Chi-square = 26.37, df = 1, p = 0.0000"
[1] "\nOthers vs Brass:"
[1] "Chi-square test: Chi-square = 7.27, df = 1, p = 0.0070"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairwise comparisons between instrument families with Bonferroni correction:</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise comparisons between instrument families (with Bonferroni correction):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nPairwise comparisons between instrument families (with Bonferroni correction):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>families <span class="ot">&lt;-</span> <span class="fu">unique</span>(instrument_rmt_data<span class="sc">$</span>family)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>n_comparisons <span class="ot">&lt;-</span> <span class="fu">length</span>(families) <span class="sc">*</span> (<span class="fu">length</span>(families)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(families)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(families)) {</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> instrument_rmt_data <span class="sc">%&gt;%</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(family <span class="sc">%in%</span> <span class="fu">c</span>(families[i], families[j]))</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    pair_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="fu">table</span>(subset_data<span class="sc">$</span>family, subset_data<span class="sc">$</span>RMTMethods_YN))</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    p_value_corrected <span class="ot">&lt;-</span> <span class="fu">min</span>(pair_test<span class="sc">$</span>p.value <span class="sc">*</span> n_comparisons, <span class="dv">1</span>)  <span class="co"># Correction and capped at 1</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">%s vs %s:"</span>, families[i], families[j]))</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"Chi-square = %.2f, df = %d, raw p = %.4f, Bonferroni corrected p = %.4f"</span>,</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>                  pair_test<span class="sc">$</span>statistic,</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>                  pair_test<span class="sc">$</span>parameter,</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>                  pair_test<span class="sc">$</span>p.value,</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>                  p_value_corrected))</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nWoodwinds vs Others:"
[1] "Chi-square = 0.01, df = 1, raw p = 0.9156, Bonferroni corrected p = 1.0000"
[1] "\nWoodwinds vs Brass:"
[1] "Chi-square = 26.37, df = 1, raw p = 0.0000, Bonferroni corrected p = 0.0000"
[1] "\nOthers vs Brass:"
[1] "Chi-square = 7.27, df = 1, raw p = 0.0070, Bonferroni corrected p = 0.0210"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new visualization specifically showing the distribution within RMT groups</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>percentage_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(family_rmt_summary, </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> family, <span class="at">y =</span> percentage, <span class="at">fill =</span> family)) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, percentage)),</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> RMTMethods_YN, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Instrument Families within Each RMT Usage Group"</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Showing percentage of each instrument family within 'RMT' and 'No RMT' groups"</span>,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Instrument Family"</span>,</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage within RMT Group (%)"</span>) <span class="sc">+</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the percentage plot</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(percentage_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results-and-discussion-4" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="results-and-discussion-4"><span class="header-section-number">4.3</span> Results and Discussion</h2>
<p>Based on the provided statistical output, there are significant differences in Respiratory Muscle Training (RMT) usage across instrument families, with brass players showing notably higher adoption rates compared to woodwind players and other instrumentalists.</p>
<p><em>Classification by Instrument Family:</em></p>
<p>Instruments are grouped into families based on predefined lists. For example:</p>
<p>Instruments like “Flute,” “Piccolo,” “Clarinet,” etc., are grouped as Woodwinds. Instruments like “Trumpet,” “Trombone,” “Tuba,” etc., are grouped as Brass. All others are assigned to a default category called Others.</p>
<p><strong>Observed Frequencies Analysis</strong></p>
<p><em>Raw Counts by Instrument Family:</em></p>
<ul>
<li><p><strong>Brass</strong>: 765 non-users, 213 RMT users (21.8% usage rate)</p></li>
<li><p><strong>Woodwinds</strong>: 1,523 non-users, 249 RMT users (14.0% usage rate)</p></li>
<li><p><strong>Others</strong>: 260 non-users, 44 RMT users (14.5% usage rate)</p></li>
</ul>
<p><strong>Chi-square Test Results:</strong></p>
<ul>
<li><p>Overall test: X² = 28.293, df = 2, p-value = 7.183e-07</p></li>
<li><p>This highly significant p-value (&lt;0.001) indicates strong evidence of an association between instrument family and RMT usage.</p></li>
</ul>
<p><strong>Pairwise Comparisons</strong></p>
<p><em>Woodwinds vs.&nbsp;Others:</em></p>
<ul>
<li><p>Chi-square = 0.01, df = 1, p = 0.9156</p></li>
<li><p>Bonferroni corrected p = 1.0000</p></li>
<li><p>Interpretation: No significant difference in RMT usage between woodwind players and other instrumentalists.</p></li>
</ul>
<p><strong>Woodwinds vs.&nbsp;Brass:</strong></p>
<ul>
<li><p>Chi-square = 26.37, df = 1, p &lt; 0.0001</p></li>
<li><p>Bonferroni corrected p &lt; 0.0001</p></li>
<li><p>Interpretation: Highly significant difference, with brass players using RMT at a significantly higher rate than woodwind players.</p></li>
</ul>
<p><strong>Others vs.&nbsp;Brass:</strong></p>
<ul>
<li><p>Chi-square = 7.27, df = 1, p = 0.0070</p></li>
<li><p>Bonferroni corrected p = 0.0210</p></li>
<li><p>Interpretation: Significant difference even after correction for multiple comparisons, with brass players using RMT at a higher rate than other instrumentalists.</p></li>
</ul>
<p><em>Key findings from the pairwise comparisons:</em></p>
<p>• Woodwinds vs.&nbsp;Brass: Highly significant difference (p &lt; 0.0001)</p>
<p>• Others vs.&nbsp;Brass: Significant difference (p = 0.007)</p>
<p>• Woodwinds vs.&nbsp;Others: No significant difference (p = 0.916)</p>
<ol type="1">
<li><p>There is a statistically significant difference in RMT usage across instrument families</p></li>
<li><p>Brass players show significantly different patterns of RMT usage compared to both Woodwind players and Others</p></li>
<li><p>Woodwind players and Others show similar patterns of RMT usage</p></li>
<li><p>The proportion of RMT usage is highest among Brass players</p></li>
</ol>
<p>X-squared = 55.92, df = 13, p-value = 2.784e-07</p>
<p>The plot shows the percentage distribution of instruments within each RMT group (No RMT vs RMT), with the actual counts and percentages labeled on each bar. The chi-square test confirms a significant association between instrument type and RMT usage (p &lt; 0.001).</p>
<p>The Tuba, Euphonium, and Bagpipes have the highest percentages of RMT usage among instruments with at least 10 players.</p>
<p>The loop over instrument families now includes a Bonferroni correction to adjust p-values for multiple comparisons. The corrected p-value is calculated by multiplying the raw p-value by the number of pairwise comparisons. The output for each pair is printed with both raw and corrected p-values.</p>
<p>These modifications ensure that the chi-square test is valid (by checking the expected counts), and the risk of Type I error in multiple pairwise comparisons is reduced. The overall robustness of the analysis is thereby improved.</p>
<p><strong>Odds Ratio Calculation:</strong></p>
<p>Although the code includes a basic calculation for the odds ratios between instrument families, this step is intended to quantify the strength of the association between each family’s membership and RMT usage. A more sophisticated approach (like logistic regression) might be used for robust odds ratio calculations, but the given code calculates a simplified measure.</p>
<p>Calculated from raw counts:</p>
<ul>
<li><p><em>Brass vs.&nbsp;Woodwinds</em>: Brass players have approximately 1.71 times higher odds of using RMT compared to woodwind players (21.8% vs 14.0%).</p></li>
<li><p><em>Brass vs.&nbsp;Others</em>: Brass players have approximately 1.64 times higher odds of using RMT compared to other instrumentalists (21.8% vs 14.5%).</p></li>
<li><p><em>Woodwinds vs.&nbsp;Others</em>: Nearly identical RMT usage rates (14.0% vs 14.5%), confirming the non-significant chi-square result.</p></li>
</ul>
<p><strong>Comprehensive Interpretation</strong></p>
<ol type="1">
<li><p><em>Brass instrumentalists stand out</em>: Players of brass instruments show significantly higher adoption of RMT methods compared to both woodwind players and other instrumentalists. This difference remains significant even after applying the conservative Bonferroni correction for multiple comparisons.</p></li>
<li><p><em>Woodwinds and Others are similar</em>: There is no meaningful difference in RMT usage between woodwind players and other instrumentalists, as evidenced by the very low chi-square value (0.01) and high p-value (0.9156).</p></li>
<li><p><em>Potential explanations</em>: Several factors might explain the higher RMT adoption among brass players:</p></li>
</ol>
<ul>
<li><p>Specific physical demands or challenges unique to brass playing</p></li>
<li><p>Different pedagogical traditions or technological integration in brass education</p></li>
<li><p>Demographic differences between instrument families (e.g., age, gender, education level)</p></li>
<li><p>Potential differences in injury patterns or physical concerns across instrument families</p></li>
</ul>
<p><strong>Conclusion</strong></p>
<p>Brass instrumentalists demonstrate significantly higher adoption of RMT methods compared to other musician groups. This finding may have implications for how RMT technologies are marketed, designed, or implemented across different instruments. Further research could explore the underlying reasons for this difference, which could inform more targeted approaches to technology integration in music education and performance.</p>
</section>
</section>
<section id="skill-level" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Skill Level</h1>
<section id="descriptive-stats-2" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="descriptive-stats-2"><span class="header-section-number">5.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract playAbility_MAX and remove 0 responses</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(playAbility_MAX <span class="sc">!=</span> <span class="dv">0</span>, <span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX)) <span class="sc">%&gt;%</span> <span class="co"># Added NA check</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">playAbility_MAX =</span> <span class="fu">as.factor</span>(playAbility_MAX)) <span class="sc">%&gt;%</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(playAbility_MAX) <span class="sc">%&gt;%</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>))</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom labels for x-axis</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Novice"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Beginner"</span>, </span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Intermediate"</span>, <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Advanced"</span>, </span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Expert"</span>)</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the actual levels present in the data</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>actual_levels <span class="ot">&lt;-</span> <span class="fu">levels</span>(plot_data<span class="sc">$</span>playAbility_MAX)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>playability_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> playAbility_MAX, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Play Ability (Max Score)"</span>,</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Play Ability (Novice = 1 to Expert = 5)"</span>,</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count of Participants (N = 1558)"</span></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use actual levels from data rather than hardcoded values</span></span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> custom_labels[actual_levels]</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the Plot</span></span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(playability_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined Categories</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Process playAbility_MAX with the new category definitions</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX)) <span class="sc">%&gt;%</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure playAbility_MAX is numeric</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_MAX =</span> <span class="fu">as.numeric</span>(playAbility_MAX),</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the new combined categories with half-point values</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">skill_level =</span> <span class="fu">case_when</span>(</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Novice/Beginner"</span>,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">3.5</span>) <span class="sc">~</span> <span class="st">"Intermediate"</span>,</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">4.5</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Advanced/Expert"</span>,</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Order factor levels</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">skill_level =</span> <span class="fu">factor</span>(skill_level, </span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced/Expert"</span>))</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove any NA values from our categories</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(skill_level)) <span class="sc">%&gt;%</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count by skill level</span></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill_level) <span class="sc">%&gt;%</span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate percentages</span></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total valid responses for y-axis label</span></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">sum</span>(plot_data<span class="sc">$</span>count)</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> skill_level, <span class="at">y =</span> count, <span class="at">fill =</span> skill_level)) <span class="sc">+</span></span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Play Ability (Combined Categories)"</span>,</span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Play Ability Level"</span>,</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Number of Participants (N = "</span>, total_n, <span class="st">")"</span>)</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span> <span class="ot">=</span> <span class="st">"#4682B4"</span>, </span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Intermediate"</span> <span class="ot">=</span> <span class="st">"#6495ED"</span>, </span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Advanced/Expert"</span> <span class="ot">=</span> <span class="st">"#1E90FF"</span>)) <span class="sc">+</span></span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additionally, print value counts to help diagnose any issues</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>value_counts <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX)) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(playAbility_MAX) <span class="sc">%&gt;%</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(playAbility_MAX)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Distribution of values in playAbility_MAX:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Distribution of values in playAbility_MAX:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(value_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   playAbility_MAX     n
             &lt;dbl&gt; &lt;int&gt;
 1             0       1
 2             1       6
 3             1.5     3
 4             2      32
 5             2.5    34
 6             3     222
 7             3.5   156
 8             4     484
 9             4.5   173
10             5     447</code></pre>
</div>
</div>
</section>
<section id="results-and-discussion-5" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="results-and-discussion-5"><span class="header-section-number">5.2</span> Results and Discussion</h2>
<p>Looking at the distribution of self-reported playing ability scores (1 = Novice to 5 = Expert) among the 1,558 participants:</p>
<p>• Score 4 is the most common with approximately 500 participants (~32%), indicating many consider themselves advanced players</p>
<p>• Score 3 is the second most frequent with about 450 participants (~29%), representing intermediate-level players</p>
<p>• Score 5 (Expert level) has roughly 350 participants (~22%)</p>
<p>• Score 2 (Beginner-intermediate) has about 200 participants (~13%)</p>
<p>• Score 1 (Novice) is the least common with fewer than 100 participants (~4%)</p>
<p>The distribution is slightly negatively skewed (skewed towards higher scores), with the majority of participants (&gt;80%) rating their playing ability as intermediate or higher (scores 3-5). This suggests that the sample consists primarily of experienced wind instrument players, with relatively few beginners. The peak at score 4 indicates that most participants consider themselves advanced, but not expert-level players.</p>
<p>The plot shows the distribution of self-reported playing ability (1 = Novice to 5 = Expert) for each wind instrument. Some key observations:</p>
<p>• Flute shows the highest number of responses, with a right-skewed distribution (more advanced players)</p>
<p>• Most instruments show fewer responses overall compared to flute and clarinet</p>
<p>• Bagpipes and euphonium show notably fewer responses</p>
<p>• The warning message indicates some missing values were removed, which is expected as not all participants play all instruments</p>
<section id="combined-groups" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="combined-groups"><span class="header-section-number">5.2.1</span> Combined Groups</h3>
<p><em>Key Observations:</em></p>
<ol type="1">
<li><p><strong>Strong Positive Skew</strong>: The distribution is heavily skewed toward the higher end of the scale, with 71.1% of participants (1,104 out of 1,558) falling in the 4.0-5.0 range.</p></li>
<li><p><strong>Highest Frequencies</strong>:</p></li>
</ol>
<ul>
<li><p>Level 4.0: 484 participants (31.1%)</p></li>
<li><p>Level 5.0: 447 participants (28.7%)</p></li>
<li><p>Level 3.0: 222 participants (14.2%)</p></li>
</ul>
<ol start="3" type="1">
<li><strong>Lowest Frequencies</strong>:</li>
</ol>
<ul>
<li><p>Level 0.0: 1 participant (0.1%)</p></li>
<li><p>Level 1.5: 3 participants (0.2%)</p></li>
<li><p>Level 1.0: 6 participants (0.4%)</p></li>
</ul>
<ol start="4" type="1">
<li><strong>Half-Point vs.&nbsp;Whole-Number Ratings</strong>: Half-point ratings (1.5, 2.5, 3.5, 4.5) consistently show lower frequencies than adjacent whole numbers, suggesting raters may prefer whole numbers when assessing ability but use half points for more nuanced judgments.</li>
</ol>
<p><em>Combined Category Analysis</em></p>
<p>When organized into three combined categories:</p>
<ol type="1">
<li><strong>Novice/Beginner (1.0, 1.5, 2.0)</strong>: 41 participants (2.6%)</li>
</ol>
<ul>
<li>This group represents a very small portion of the sample, indicating either few beginners participated or the population being studied generally has higher ability levels.</li>
</ul>
<ol start="2" type="1">
<li><strong>Intermediate (2.5, 3.0, 3.5)</strong>: 412 participants (26.5%)</li>
</ol>
<ul>
<li>Representing about a quarter of participants with moderate skill levels.</li>
</ul>
<ol start="3" type="1">
<li><strong>Advanced/Expert (4.0, 4.5, 5.0)</strong>: 1,104 participants (70.9%)</li>
</ol>
<ul>
<li>Clearly the dominant group, comprising more than two-thirds of the sample.</li>
</ul>
<ol start="4" type="1">
<li><strong>Outlier (0.0)</strong>: 1 participant (0.1%)</li>
</ol>
<ul>
<li>This likely represents an error, a special case, or potentially a “non-player” category.</li>
</ul>
<p><strong>Implications and Considerations</strong></p>
<p><em>Potential Explanations for the Skewed Distribution:</em></p>
<ol type="1">
<li><p><strong>Population Characteristics</strong>: This may accurately reflect a population primarily consisting of advanced players, such as professional or experienced musicians.</p></li>
<li><p><strong>Self-Selection Bias</strong>: Advanced players might be more likely to participate in studies related to their expertise or complete relevant surveys.</p></li>
<li><p><strong>Self-Assessment Inflation</strong>: If self-reported, participants may tend to overestimate their abilities.</p></li>
<li><p><strong>Scale Calibration</strong>: The assessment scale might not optimally differentiate skill levels in this specific population, potentially causing a ceiling effect where many advanced players cluster at the top.</p></li>
<li><p><strong>Recruitment Strategy</strong>: The participant recruitment process may have targeted more experienced players.</p></li>
</ol>
<p><strong>Research and Application Considerations</strong></p>
<ol type="1">
<li><p><strong>Representativeness</strong>: Consider whether this distribution accurately represents the target population or reflects selection biases.</p></li>
<li><p><strong>Statistical Analysis</strong>: The heavy skew toward higher ratings might influence statistical analyses that assume normal distribution.</p></li>
<li><p><strong>Group Comparisons</strong>: When comparing groups (e.g., by demographics), be aware that the small sample of beginners might limit certain analyses.</p></li>
<li><p><strong>Scale Refinement</strong>: For future studies, consider a more differentiated scale at the upper end to better distinguish between advanced and expert performers.</p></li>
</ol>
<p><strong>Conclusion</strong></p>
<p>The data reveals a population predominantly composed of advanced/expert level players, with relatively few beginners. This distribution is important context for any further analyses or conclusions drawn from this dataset, particularly when examining factors associated with play ability or when making generalizations about the broader population of players.</p>
</section>
</section>
<section id="comparison-stats-3" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="comparison-stats-3"><span class="header-section-number">5.3</span> Comparison Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original Analysis without Combined Groups</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preparation: Filter playAbility_MAX and prepare variables</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_MAX =</span> <span class="fu">as.numeric</span>(playAbility_MAX),</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(RMTMethods_YN, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>))</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out cases where playAbility_MAX is 0 or NA</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX), playAbility_MAX <span class="sc">!=</span> <span class="dv">0</span>, <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create factor version of playAbility with proper labels</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_factor =</span> <span class="fu">factor</span>(playAbility_MAX, </span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Novice"</span>, <span class="st">"Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced"</span>, <span class="st">"Expert"</span>)),</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create binary variables for logistic regression</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_play =</span> <span class="fu">ifelse</span>(playAbility_MAX <span class="sc">&gt;=</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMT_binary =</span> <span class="fu">ifelse</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts by playAbility and RMT usage</span></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="ot">&lt;-</span> analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN, playAbility_factor) <span class="sc">%&gt;%</span></span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical Analysis: Chi-square Test of Independence</span></span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(analysis_data<span class="sc">$</span>playAbility_factor, analysis_data<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Use simulation-based p-value calculation for chi-square test</span></span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the statistical results</span></span>
<span id="cb94-42"><a href="#cb94-42" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square Test Results (Independence between playAbility and RMT Usage):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-square Test Results (Independence between playAbility and RMT Usage):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with simulated p-value (based on 10000
    replicates)

data:  contingency_table
X-squared = 23.066, df = NA, p-value = 2e-04</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check expected frequencies</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>expected_freqs <span class="ot">&lt;-</span> chi_test<span class="sc">$</span>expected</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Expected frequencies:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Expected frequencies:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expected_freqs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              
                   No RMT       RMT
  Novice         5.093199  0.906801
  Beginner      27.163728  4.836272
  Intermediate 188.448363 33.551637
  Advanced     410.851385 73.148615
  Expert       379.443325 67.556675</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standardized residuals</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">playAbility =</span> <span class="fu">rep</span>(<span class="fu">rownames</span>(chi_test<span class="sc">$</span>stdres), <span class="at">times =</span> <span class="fu">ncol</span>(chi_test<span class="sc">$</span>stdres)),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMTMethods =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(chi_test<span class="sc">$</span>stdres), <span class="at">each =</span> <span class="fu">nrow</span>(chi_test<span class="sc">$</span>stdres)),</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">std_residual =</span> <span class="fu">as.vector</span>(chi_test<span class="sc">$</span>stdres),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">rounded_res =</span> <span class="fu">round</span>(<span class="fu">as.vector</span>(chi_test<span class="sc">$</span>stdres), <span class="dv">2</span>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print significant residuals</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>sig_residuals <span class="ot">&lt;-</span> std_residuals <span class="sc">%&gt;%</span> </span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(std_residual) <span class="sc">&gt;</span> <span class="fl">1.96</span>)</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significant Standardized Residuals (&gt;|1.96|):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Significant Standardized Residuals (&gt;|1.96|):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sig_residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   playAbility RMTMethods std_residual rounded_res
1 Intermediate     No RMT     3.853893        3.85
2       Expert     No RMT    -3.916831       -3.92
3 Intermediate        RMT    -3.853893       -3.85
4       Expert        RMT     3.916831        3.92</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effect size: Cramer's V</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>df_min <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n_total <span class="sc">*</span> df_min))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size (Cramer's V):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Effect Size (Cramer's V):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramer_v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>X-squared 
0.1391648 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot: Grouped Bar Plot</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>playability_group_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(grouped_data, <span class="fu">aes</span>(<span class="at">x =</span> playAbility_factor, <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Play Ability by RMT Usage"</span>,</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Play Ability Level"</span>,</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, <span class="fu">nrow</span>(analysis_data), <span class="st">")"</span>),</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"RMT Usage"</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the grouped bar plot</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(playability_group_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression Analysis</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Run continuous model</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> playAbility_MAX, </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> analysis_data, </span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>summary_output <span class="ot">&lt;-</span> <span class="fu">summary</span>(logit_model)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = RMT_binary ~ playAbility_MAX, family = "binomial", 
    data = analysis_data)

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      -4.0268     0.4393  -9.166  &lt; 2e-16 ***
playAbility_MAX   0.5417     0.1010   5.364 8.16e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1296.9  on 1556  degrees of freedom
Residual deviance: 1265.1  on 1555  degrees of freedom
AIC: 1269.1

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratios and confidence intervals</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(logit_model))</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratios with 95% Confidence Intervals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Odds Ratios with 95% Confidence Intervals:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>or_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">names</span>(odds_ratios),</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">OddsRatio =</span> <span class="fu">round</span>(odds_ratios, <span class="dv">3</span>),</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_lower =</span> <span class="fu">round</span>(conf_intervals[,<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_upper =</span> <span class="fu">round</span>(conf_intervals[,<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                           Term OddsRatio CI_lower CI_upper
(Intercept)         (Intercept)     0.018    0.007    0.041
playAbility_MAX playAbility_MAX     1.719    1.415    2.103</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted probabilities for each playing ability level</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">playAbility_MAX =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>result_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">playAbility_level =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">predicted_probability =</span> predicted_probs</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted probabilities of RMT usage by playing ability level:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Predicted probabilities of RMT usage by playing ability level:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  playAbility_level predicted_probability
1                 1            0.02974025
2                 2            0.05005305
3                 3            0.08305206
4                 4            0.13472130
5                 5            0.21113395</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a visualization of predicted probabilities</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predicted probabilities from continuous model</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>prob_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_df, <span class="fu">aes</span>(<span class="at">x =</span> playAbility_level, <span class="at">y =</span> predicted_probability)) <span class="sc">+</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Novice"</span>, <span class="st">"Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced"</span>, <span class="st">"Expert"</span>)) <span class="sc">+</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted Probability of RMT Usage by Playing Ability Level"</span>,</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Playing Ability Level"</span>,</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability of Using RMT Methods"</span>) <span class="sc">+</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>),</span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(predicted_probs) <span class="sc">*</span> <span class="fl">1.1</span>))</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the probability plot</span></span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prob_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate McFadden's Pseudo R-squared</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> analysis_data, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>logLik_full <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(logit_model))</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>logLik_null <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(null_model))</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>mcfadden_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (logLik_full <span class="sc">/</span> logLik_null)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">McFadden's Pseudo R-squared:"</span>, <span class="fu">round</span>(mcfadden_r2, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
McFadden's Pseudo R-squared: 0.0245</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification metrics with robust handling</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">fitted</span>(logit_model) <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> <span class="fu">factor</span>(predicted_classes, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Actual =</span> <span class="fu">factor</span>(analysis_data<span class="sc">$</span>RMT_binary, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Confusion Matrix:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

Confusion Matrix:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted    0    1
        0 1329  228
        1    0    0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics with checks for zero denominators</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(confusion_matrix[,<span class="dv">2</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>                     confusion_matrix[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix[,<span class="dv">2</span>]), </span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(confusion_matrix[,<span class="dv">1</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>                     confusion_matrix[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix[,<span class="dv">1</span>]), </span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Accuracy:"</span>, <span class="fu">round</span>(accuracy, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Accuracy: 0.854</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sensitivity (True Positive Rate):"</span>, </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">is.na</span>(sensitivity), <span class="st">"Not calculable"</span>, <span class="fu">round</span>(sensitivity, <span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Sensitivity (True Positive Rate): 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Specificity (True Negative Rate):"</span>, </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">is.na</span>(specificity), <span class="st">"Not calculable"</span>, <span class="fu">round</span>(specificity, <span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Specificity (True Negative Rate): 1</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined Groups</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preparation: Filter playAbility_MAX and prepare variables</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_MAX =</span> <span class="fu">as.numeric</span>(playAbility_MAX),</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(RMTMethods_YN, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>))</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out cases where playAbility_MAX is NA</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX), <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create new combined categories - note that 0 is now included in Novice/Beginner</span></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_combined =</span> <span class="fu">case_when</span>(</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Novice/Beginner"</span>,</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">3.5</span>) <span class="sc">~</span> <span class="st">"Intermediate"</span>,</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">4.5</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Advanced/Expert"</span>,</span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Order the factor levels correctly</span></span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_combined =</span> <span class="fu">factor</span>(playAbility_combined, </span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced/Expert"</span>)),</span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create binary variables for logistic regression</span></span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_play =</span> <span class="fu">ifelse</span>(playAbility_MAX <span class="sc">&gt;=</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMT_binary =</span> <span class="fu">ifelse</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb134-31"><a href="#cb134-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-32"><a href="#cb134-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts by combined playAbility and RMT usage</span></span>
<span id="cb134-33"><a href="#cb134-33" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="ot">&lt;-</span> analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb134-34"><a href="#cb134-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN, playAbility_combined) <span class="sc">%&gt;%</span></span>
<span id="cb134-35"><a href="#cb134-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb134-36"><a href="#cb134-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb134-37"><a href="#cb134-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb134-38"><a href="#cb134-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb134-39"><a href="#cb134-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb134-40"><a href="#cb134-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-41"><a href="#cb134-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical Analysis: Chi-square Test of Independence</span></span>
<span id="cb134-42"><a href="#cb134-42" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(analysis_data<span class="sc">$</span>playAbility_combined, analysis_data<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb134-43"><a href="#cb134-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-44"><a href="#cb134-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Use simulation-based p-value calculation for chi-square test</span></span>
<span id="cb134-45"><a href="#cb134-45" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb134-46"><a href="#cb134-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-47"><a href="#cb134-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the statistical results</span></span>
<span id="cb134-48"><a href="#cb134-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square Test Results (Independence between playAbility and RMT Usage):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-square Test Results (Independence between playAbility and RMT Usage):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with simulated p-value (based on 10000
    replicates)

data:  contingency_table
X-squared = 26.337, df = NA, p-value = 9.999e-05</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check expected frequencies</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>expected_freqs <span class="ot">&lt;-</span> chi_test<span class="sc">$</span>expected</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Expected frequencies:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Expected frequencies:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expected_freqs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 
                     No RMT        RMT
  Novice/Beginner  35.85366   6.146341
  Intermediate    351.70732  60.292683
  Advanced/Expert 942.43902 161.560976</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standardized residuals</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">playAbility =</span> <span class="fu">rep</span>(<span class="fu">rownames</span>(chi_test<span class="sc">$</span>stdres), <span class="at">times =</span> <span class="fu">ncol</span>(chi_test<span class="sc">$</span>stdres)),</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMTMethods =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(chi_test<span class="sc">$</span>stdres), <span class="at">each =</span> <span class="fu">nrow</span>(chi_test<span class="sc">$</span>stdres)),</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">std_residual =</span> <span class="fu">as.vector</span>(chi_test<span class="sc">$</span>stdres),</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">rounded_res =</span> <span class="fu">round</span>(<span class="fu">as.vector</span>(chi_test<span class="sc">$</span>stdres), <span class="dv">2</span>)</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print significant residuals</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>sig_residuals <span class="ot">&lt;-</span> std_residuals <span class="sc">%&gt;%</span> </span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(std_residual) <span class="sc">&gt;</span> <span class="fl">1.96</span>)</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significant Standardized Residuals (&gt;|1.96|):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Significant Standardized Residuals (&gt;|1.96|):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sig_residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      playAbility RMTMethods std_residual rounded_res
1    Intermediate     No RMT     4.923283        4.92
2 Advanced/Expert     No RMT    -5.116975       -5.12
3    Intermediate        RMT    -4.923283       -4.92
4 Advanced/Expert        RMT     5.116975        5.12</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effect size: Cramer's V</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>df_min <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n_total <span class="sc">*</span> df_min))</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size (Cramer's V):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Effect Size (Cramer's V):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramer_v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>X-squared 
0.1300163 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot: Grouped Bar Plot</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>playability_group_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(grouped_data, <span class="fu">aes</span>(<span class="at">x =</span> playAbility_combined, <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Play Ability by RMT Usage"</span>,</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Using Combined Ability Categories (0 included in Novice/Beginner)"</span>,</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Play Ability Level"</span>,</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, <span class="fu">nrow</span>(analysis_data), <span class="st">")"</span>),</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"RMT Usage"</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the grouped bar plot</span></span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(playability_group_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression Analysis</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># First create a numeric version of the combined categories for the continuous model</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_combined_numeric =</span> <span class="fu">case_when</span>(</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>      playAbility_combined <span class="sc">==</span> <span class="st">"Novice/Beginner"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>      playAbility_combined <span class="sc">==</span> <span class="st">"Intermediate"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>      playAbility_combined <span class="sc">==</span> <span class="st">"Advanced/Expert"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Run continuous model with the combined categories</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> playAbility_combined_numeric, </span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> analysis_data, </span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>summary_output <span class="ot">&lt;-</span> <span class="fu">summary</span>(logit_model)</span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = RMT_binary ~ playAbility_combined_numeric, family = "binomial", 
    data = analysis_data)

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   -4.0341     0.5056  -7.979 1.47e-15 ***
playAbility_combined_numeric   0.8246     0.1776   4.643 3.43e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1297.2  on 1557  degrees of freedom
Residual deviance: 1271.1  on 1556  degrees of freedom
AIC: 1275.1

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratios and confidence intervals</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(logit_model))</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratios with 95% Confidence Intervals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Odds Ratios with 95% Confidence Intervals:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>or_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">names</span>(odds_ratios),</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">OddsRatio =</span> <span class="fu">round</span>(odds_ratios, <span class="dv">3</span>),</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_lower =</span> <span class="fu">round</span>(conf_intervals[,<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_upper =</span> <span class="fu">round</span>(conf_intervals[,<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                     Term OddsRatio CI_lower
(Intercept)                                   (Intercept)     0.018    0.006
playAbility_combined_numeric playAbility_combined_numeric     2.281    1.632
                             CI_upper
(Intercept)                     0.046
playAbility_combined_numeric    3.280</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted probabilities for each combined playing ability level</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">playAbility_combined_numeric =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>result_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">playAbility_level =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced/Expert"</span>),</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_level_value =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">predicted_probability =</span> predicted_probs</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted probabilities of RMT usage by combined playing ability level:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Predicted probabilities of RMT usage by combined playing ability level:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  playAbility_level combined_level_value predicted_probability
1   Novice/Beginner                    1            0.03880645
2      Intermediate                    2            0.08432102
3   Advanced/Expert                    3            0.17357778</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a visualization of predicted probabilities</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predicted probabilities from continuous model</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>prob_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_df, <span class="fu">aes</span>(<span class="at">x =</span> combined_level_value, <span class="at">y =</span> predicted_probability)) <span class="sc">+</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced/Expert"</span>)) <span class="sc">+</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted Probability of RMT Usage by Playing Ability Level"</span>,</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Based on Combined Ability Categories (0 included in Novice/Beginner)"</span>,</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Playing Ability Level"</span>,</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability of Using RMT Methods"</span>) <span class="sc">+</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>),</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(predicted_probs) <span class="sc">*</span> <span class="fl">1.1</span>))</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the probability plot</span></span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prob_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate McFadden's Pseudo R-squared</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> analysis_data, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>logLik_full <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(logit_model))</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>logLik_null <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(null_model))</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>mcfadden_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (logLik_full <span class="sc">/</span> logLik_null)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">McFadden's Pseudo R-squared:"</span>, <span class="fu">round</span>(mcfadden_r2, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
McFadden's Pseudo R-squared: 0.0201</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification metrics with robust handling</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">fitted</span>(logit_model) <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> <span class="fu">factor</span>(predicted_classes, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Actual =</span> <span class="fu">factor</span>(analysis_data<span class="sc">$</span>RMT_binary, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Confusion Matrix:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

Confusion Matrix:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted    0    1
        0 1330  228
        1    0    0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics with checks for zero denominators</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(confusion_matrix[,<span class="dv">2</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>                     confusion_matrix[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix[,<span class="dv">2</span>]), </span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>)</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(confusion_matrix[,<span class="dv">1</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>                     confusion_matrix[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix[,<span class="dv">1</span>]), </span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>)</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Accuracy:"</span>, <span class="fu">round</span>(accuracy, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Accuracy: 0.854</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sensitivity (True Positive Rate):"</span>, </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">is.na</span>(sensitivity), <span class="st">"Not calculable"</span>, <span class="fu">round</span>(sensitivity, <span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Sensitivity (True Positive Rate): 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Specificity (True Negative Rate):"</span>, </span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">is.na</span>(specificity), <span class="st">"Not calculable"</span>, <span class="fu">round</span>(specificity, <span class="dv">3</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Specificity (True Negative Rate): 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional analysis: Also run categorical model</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>logit_model_categorical <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> playAbility_combined, </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> analysis_data, </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print categorical model summary</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Categorical Model Results (using combined categories as factors):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>

Categorical Model Results (using combined categories as factors):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(logit_model_categorical))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = RMT_binary ~ playAbility_combined, family = "binomial", 
    data = analysis_data)

Coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          -2.2513     0.5257  -4.283 1.85e-05 ***
playAbility_combinedIntermediate     -0.2929     0.5588  -0.524    0.600    
playAbility_combinedAdvanced/Expert   0.7057     0.5316   1.328    0.184    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1297.2  on 1557  degrees of freedom
Residual deviance: 1267.8  on 1555  degrees of freedom
AIC: 1273.8

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratios for categorical model</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratios for Categorical Model:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Odds Ratios for Categorical Model:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>odds_ratios_cat <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model_categorical))</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>conf_intervals_cat <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(logit_model_categorical))</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>or_results_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">names</span>(odds_ratios_cat),</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">OddsRatio =</span> <span class="fu">round</span>(odds_ratios_cat, <span class="dv">3</span>),</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_lower =</span> <span class="fu">round</span>(conf_intervals_cat[,<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_upper =</span> <span class="fu">round</span>(conf_intervals_cat[,<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_results_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                   Term
(Intercept)                                                 (Intercept)
playAbility_combinedIntermediate       playAbility_combinedIntermediate
playAbility_combinedAdvanced/Expert playAbility_combinedAdvanced/Expert
                                    OddsRatio CI_lower CI_upper
(Intercept)                             0.105    0.032    0.262
playAbility_combinedIntermediate        0.746    0.276    2.609
playAbility_combinedAdvanced/Expert     2.025    0.802    6.816</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print breakdown of original values in each combined category</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Breakdown of original playAbility_MAX values in each combined category:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Breakdown of original playAbility_MAX values in each combined category:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>value_counts <span class="ot">&lt;-</span> analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(playAbility_MAX, playAbility_combined) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(playAbility_MAX)</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(value_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   playAbility_MAX playAbility_combined     n
             &lt;dbl&gt; &lt;fct&gt;                &lt;int&gt;
 1             0   Novice/Beginner          1
 2             1   Novice/Beginner          6
 3             1.5 Novice/Beginner          3
 4             2   Novice/Beginner         32
 5             2.5 Intermediate            34
 6             3   Intermediate           222
 7             3.5 Intermediate           156
 8             4   Advanced/Expert        484
 9             4.5 Advanced/Expert        173
10             5   Advanced/Expert        447</code></pre>
</div>
</div>
</section>
<section id="results-and-discussion-based-on-combined-findings" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="results-and-discussion-based-on-combined-findings"><span class="header-section-number">5.4</span> Results and Discussion (based on combined findings)</h2>
<p>This analysis examines the relationship between musicians’ play ability levels (grouped into three categories) and their use of Remote Monitoring Technology (RMT). The results show a statistically significant association between play ability and RMT usage, with specific patterns of usage across different skill levels.</p>
<p><strong>Chi-Square Test of Independence</strong></p>
<ul>
<li><p><strong>Test Statistic</strong>: X² = 26.337</p></li>
<li><p><strong>P-value</strong>: p &lt; 0.0001 (based on 10,000 simulated replicates)</p></li>
<li><p><strong>Interpretation</strong>: There is very strong evidence of an association between play ability and RMT usage. The null hypothesis that these variables are independent can be confidently rejected.</p></li>
</ul>
<p><strong>Effect Size</strong></p>
<ul>
<li><p><strong>Cramer’s V</strong>: 0.13</p></li>
<li><p><strong>Interpretation</strong>: This represents a small to moderate association between play ability and RMT usage. While statistically significant, the strength of the relationship is not overwhelming.</p></li>
</ul>
<p><strong>Standardized Residuals Analysis</strong></p>
<p>The standardized residuals reveal exactly where the significant deviations from independence occur:</p>
<ul>
<li><p><strong>Intermediate players and RMT usage</strong>:</p></li>
<li><p>Strong negative residual (-4.92) for “RMT”</p></li>
<li><p>Strong positive residual (4.92) for “No RMT”</p></li>
<li><p>This indicates intermediate players are significantly less likely to use RMT than expected</p></li>
<li><p><strong>Advanced/Expert players and RMT usage</strong>:</p></li>
<li><p>Strong positive residual (5.12) for “RMT”</p></li>
<li><p>Strong negative residual (-5.12) for “No RMT”</p></li>
<li><p>This indicates advanced/expert players are significantly more likely to use RMT than expected</p></li>
</ul>
<p><strong>Logistic Regression Models</strong></p>
<p><em>Continuous Model</em></p>
<ul>
<li><p><strong>Coefficient for playAbility_combined_numeric</strong>: 0.8246 (p &lt; 0.0001)</p></li>
<li><p><strong>Odds Ratio</strong>: 2.281 (95% CI: 1.632-3.280)</p></li>
<li><p><strong>Interpretation</strong>: For each step up in the combined ability category (e.g., from Novice/Beginner to Intermediate), the odds of using RMT increase by a factor of 2.28.</p></li>
</ul>
<p><strong>Categorical Model</strong></p>
<ul>
<li><p><strong>Intermediate vs.&nbsp;Novice/Beginner</strong>:</p></li>
<li><p>Odds Ratio: 0.746 (non-significant, p = 0.600)</p></li>
<li><p>Intermediate players have slightly lower odds of using RMT than novice/beginners, but this difference is not statistically significant</p></li>
<li><p><strong>Advanced/Expert vs.&nbsp;Novice/Beginner</strong>:</p></li>
<li><p>Odds Ratio: 2.025 (non-significant, p = 0.184)</p></li>
<li><p>Advanced/expert players have approximately double the odds of using RMT compared to novice/beginners, but this difference does not reach statistical significance.</p></li>
</ul>
<p><strong>Predicted Probabilities</strong></p>
<p>The model predicts the following probabilities of RMT usage:</p>
<ul>
<li><p>Novice/Beginner: 3.9%</p></li>
<li><p>Intermediate: 8.4%</p></li>
<li><p>Advanced/Expert: 17.4%</p></li>
</ul>
<p>This shows a clear increasing trend in RMT usage with higher play ability levels, with advanced/expert players having more than four times the probability of using RMT compared to novice/beginners.</p>
<p><strong>Model Performance</strong></p>
<ul>
<li><p><strong>McFadden’s Pseudo R-squared</strong>: 0.0201</p></li>
<li><p><strong>Accuracy</strong>: 85.4%</p></li>
<li><p><strong>Sensitivity</strong>: 0 (model fails to predict any true RMT users)</p></li>
<li><p><strong>Specificity</strong>: 1 (model correctly identifies all non-RMT users)</p></li>
</ul>
<p>The model has modest explanatory power and defaults to predicting “No RMT” for all observations, which yields high accuracy due to the imbalanced dataset (far more non-users than users).</p>
<p><strong>Distribution of Participants</strong></p>
<ul>
<li><p><strong>Novice/Beginner</strong> (values 0, 1, 1.5, 2): 42 participants</p></li>
<li><p><strong>Intermediate</strong> (values 2.5, 3, 3.5): 412 participants</p></li>
<li><p><strong>Advanced/Expert</strong> (values 4, 4.5, 5): 1,104 participants</p></li>
</ul>
<p>The sample is heavily weighted toward advanced/expert players, with relatively few novice/beginners.</p>
<p><strong>Key Insights and Implications</strong></p>
<ol type="1">
<li><p><strong>Skill-Technology Relationship</strong>: There is a significant positive relationship between play ability and RMT usage, with more advanced players more likely to adopt this technology.</p></li>
<li><p><strong>Intermediate Player Resistance</strong>: Intermediate players show a particularly strong pattern of avoiding RMT usage, which could indicate:</p></li>
</ol>
<ul>
<li><p>Transitional learning approaches at this skill level</p></li>
<li><p>Concerns about technology hindering development of fundamental skills</p></li>
<li><p>Different teaching methodologies that don’t emphasize technology</p></li>
</ul>
<ol start="3" type="1">
<li><strong>Advanced Player Adoption</strong>: Advanced/expert players embrace RMT at higher rates, possibly because:</li>
</ol>
<ul>
<li><p>They use technology to refine already-developed skills</p></li>
<li><p>They have greater technical understanding of their instruments</p></li>
<li><p>They may be more involved in teaching and use RMT as pedagogical tools</p></li>
</ul>
<ol start="4" type="1">
<li><strong>Practical Applications</strong>:</li>
</ol>
<ul>
<li><p>Technology developers should consider targeting advanced players as early adopters</p></li>
<li><p>Different approaches may be needed to increase RMT adoption among intermediate players</p></li>
<li><p>Educational approaches might need to be tailored by skill level.</p></li>
</ul>
<p>Despite the statistical significance of the relationship, the modest effect size suggests that play ability is just one of many factors influencing RMT adoption among musicians.</p>
</section>
</section>
<section id="country-of-residence" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> *Country of Residence</h1>
<section id="descriptive-stats-3" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="descriptive-stats-3"><span class="header-section-number">6.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total N</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>total_N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_combined)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify country names: abbreviate USA and UK</span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">countryLive =</span> <span class="fu">case_when</span>(</span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>    countryLive <span class="sc">==</span> <span class="st">"United States of America (USA)"</span> <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>    countryLive <span class="sc">==</span> <span class="st">"United Kingdom (UK)"</span> <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> countryLive</span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute counts and percentages for the 'countryLive' column</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>country_summary <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> total_N <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the top 4 countries (using the highest counts)</span></span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a>top_countries <span class="ot">&lt;-</span> country_summary <span class="sc">%&gt;%</span></span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">4</span>, <span class="at">wt =</span> count) <span class="sc">%&gt;%</span></span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb186-27"><a href="#cb186-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>),</span>
<span id="cb186-28"><a href="#cb186-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reorder to display from highest to lowest</span></span>
<span id="cb186-29"><a href="#cb186-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">countryLive =</span> <span class="fu">reorder</span>(countryLive, <span class="sc">-</span>count)</span>
<span id="cb186-30"><a href="#cb186-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb186-31"><a href="#cb186-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-32"><a href="#cb186-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square goodness-of-fit test for top 4 countries</span></span>
<span id="cb186-33"><a href="#cb186-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected frequencies for equality among the 4 groups</span></span>
<span id="cb186-34"><a href="#cb186-34" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> top_countries<span class="sc">$</span>count</span>
<span id="cb186-35"><a href="#cb186-35" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">sum</span>(observed)<span class="sc">/</span><span class="fu">length</span>(observed), <span class="fu">length</span>(observed))</span>
<span id="cb186-36"><a href="#cb186-36" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> observed, <span class="at">p =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(observed), <span class="fu">length</span>(observed)))</span>
<span id="cb186-37"><a href="#cb186-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chi-square goodness-of-fit test for equal distribution among top 4 countries:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chi-square goodness-of-fit test for equal distribution among top 4 countries:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  observed
X-squared = 390.66, df = 3, p-value &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot with counts and percentages and add the note</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>country_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(top_countries, <span class="fu">aes</span>(<span class="at">x =</span> countryLive, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 4 Countries (Live)"</span>,</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, total_N, <span class="st">")"</span>),</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Chi-square: "</span>, <span class="fu">sprintf</span>(<span class="st">'%.2f'</span>, chi_test<span class="sc">$</span>statistic), </span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>                         <span class="st">" (df = "</span>, chi_test<span class="sc">$</span>parameter, </span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"), p = "</span>, <span class="fu">ifelse</span>(chi_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, <span class="fu">sprintf</span>(<span class="st">'%.3f'</span>, chi_test<span class="sc">$</span>p.value))),</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note: Countries with frequencies less than 5% were removed from the figure."</span>) <span class="sc">+</span></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">15</span>)),</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">30</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>) <span class="co"># Add extra bottom margin for the note</span></span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb190-25"><a href="#cb190-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(country_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Summary Statistics for Top 4 Countries:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Summary Statistics for Top 4 Countries:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_countries <span class="sc">%&gt;%</span> <span class="fu">select</span>(countryLive, count, percentage) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(count)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  countryLive count percentage
  &lt;fct&gt;       &lt;int&gt;      &lt;dbl&gt;
1 USA           610      39.2 
2 UK            358      23.0 
3 Australia     326      20.9 
4 Canada         91       5.84</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined 5% values with note</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the countryLive column</span></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>country_analysis <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove missing values</span></span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(countryLive)) <span class="sc">%&gt;%</span></span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean country names (trim whitespace, standardize case if needed)</span></span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">countryLive =</span> <span class="fu">trimws</span>(countryLive)) <span class="sc">%&gt;%</span></span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count occurrences of each country</span></span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate percentages</span></span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(n),</span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> n <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create grouped category (countries with &lt;5% go to "Other")</span></span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_group =</span> <span class="fu">if_else</span>(percentage <span class="sc">&gt;=</span> <span class="dv">5</span>, countryLive, <span class="st">"Other"</span>)</span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb195-25"><a href="#cb195-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sort by frequency</span></span>
<span id="cb195-26"><a href="#cb195-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb195-27"><a href="#cb195-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-28"><a href="#cb195-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify countries that will be in the "Other" category</span></span>
<span id="cb195-29"><a href="#cb195-29" aria-hidden="true" tabindex="-1"></a>other_countries <span class="ot">&lt;-</span> country_analysis <span class="sc">%&gt;%</span></span>
<span id="cb195-30"><a href="#cb195-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country_group <span class="sc">==</span> <span class="st">"Other"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-31"><a href="#cb195-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb195-32"><a href="#cb195-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-33"><a href="#cb195-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted string listing all "Other" countries WITHOUT percentages</span></span>
<span id="cb195-34"><a href="#cb195-34" aria-hidden="true" tabindex="-1"></a>other_countries_list <span class="ot">&lt;-</span> other_countries <span class="sc">%&gt;%</span></span>
<span id="cb195-35"><a href="#cb195-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb195-36"><a href="#cb195-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb195-37"><a href="#cb195-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-38"><a href="#cb195-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for plotting</span></span>
<span id="cb195-39"><a href="#cb195-39" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> country_analysis <span class="sc">%&gt;%</span></span>
<span id="cb195-40"><a href="#cb195-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_group) <span class="sc">%&gt;%</span></span>
<span id="cb195-41"><a href="#cb195-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb195-42"><a href="#cb195-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">sum</span>(n),</span>
<span id="cb195-43"><a href="#cb195-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> <span class="fu">sum</span>(percentage)</span>
<span id="cb195-44"><a href="#cb195-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb195-45"><a href="#cb195-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure "Other" appears at the end</span></span>
<span id="cb195-46"><a href="#cb195-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb195-47"><a href="#cb195-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_group =</span> <span class="fu">factor</span>(country_group),</span>
<span id="cb195-48"><a href="#cb195-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_group =</span> <span class="fu">fct_relevel</span>(<span class="fu">fct_reorder</span>(country_group, percentage, <span class="at">.desc =</span> <span class="cn">TRUE</span>), <span class="st">"Other"</span>, <span class="at">after =</span> <span class="cn">Inf</span>)</span>
<span id="cb195-49"><a href="#cb195-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb195-50"><a href="#cb195-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-51"><a href="#cb195-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total participants</span></span>
<span id="cb195-52"><a href="#cb195-52" aria-hidden="true" tabindex="-1"></a>total_participants <span class="ot">&lt;-</span> <span class="fu">sum</span>(country_analysis<span class="sc">$</span>n)</span>
<span id="cb195-53"><a href="#cb195-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-54"><a href="#cb195-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the base note text</span></span>
<span id="cb195-55"><a href="#cb195-55" aria-hidden="true" tabindex="-1"></a>note_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Note: 'Other' includes frequencies &lt;5%: "</span>, other_countries_list)</span>
<span id="cb195-56"><a href="#cb195-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-57"><a href="#cb195-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually wrap the note text to ensure it's fully visible</span></span>
<span id="cb195-58"><a href="#cb195-58" aria-hidden="true" tabindex="-1"></a>wrapped_note <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(note_text, <span class="at">width =</span> <span class="dv">100</span>)</span>
<span id="cb195-59"><a href="#cb195-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-60"><a href="#cb195-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with adjusted bottom margin and caption styling</span></span>
<span id="cb195-61"><a href="#cb195-61" aria-hidden="true" tabindex="-1"></a>country_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> country_group, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb195-62"><a href="#cb195-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb195-63"><a href="#cb195-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb195-64"><a href="#cb195-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb195-65"><a href="#cb195-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb195-66"><a href="#cb195-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb195-67"><a href="#cb195-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Participants by Country of Residence"</span>,</span>
<span id="cb195-68"><a href="#cb195-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb195-69"><a href="#cb195-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Number of Participants (N = "</span>, total_participants, <span class="st">")"</span>),</span>
<span id="cb195-70"><a href="#cb195-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> wrapped_note</span>
<span id="cb195-71"><a href="#cb195-71" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb195-72"><a href="#cb195-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb195-73"><a href="#cb195-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb195-74"><a href="#cb195-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb195-75"><a href="#cb195-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb195-76"><a href="#cb195-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb195-77"><a href="#cb195-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb195-78"><a href="#cb195-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Style the caption to ensure it's readable</span></span>
<span id="cb195-79"><a href="#cb195-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(</span>
<span id="cb195-80"><a href="#cb195-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">9</span>, </span>
<span id="cb195-81"><a href="#cb195-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb195-82"><a href="#cb195-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb195-83"><a href="#cb195-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">lineheight =</span> <span class="fl">1.2</span>,</span>
<span id="cb195-84"><a href="#cb195-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">15</span>)</span>
<span id="cb195-85"><a href="#cb195-85" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb195-86"><a href="#cb195-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add extra bottom margin for the caption</span></span>
<span id="cb195-87"><a href="#cb195-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">100</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>)</span>
<span id="cb195-88"><a href="#cb195-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb195-89"><a href="#cb195-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb195-90"><a href="#cb195-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-91"><a href="#cb195-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb195-92"><a href="#cb195-92" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(country_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results-and-discussion-6" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="results-and-discussion-6"><span class="header-section-number">6.2</span> Results and Discussion</h2>
<p>Key observations:</p>
<p>• 39 counties in total</p>
<p>• The United States has the highest representation with 610 participants (39.2%)</p>
<p>• The United Kingdom follows with 358 participants (23%)</p>
<p>• Australia is third with 326 participants (20.9%)</p>
<p>• These top three countries account for approximately 83% of all participants</p>
<p>• The remaining countries (Canada, Italy, and New Zealand) collectively represent about 17% of participants</p>
</section>
<section id="comparison-stats-4" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="comparison-stats-4"><span class="header-section-number">6.3</span> Comparison Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean country names and create RMT factor</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">countryLive =</span> <span class="fu">case_when</span>(</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>      countryLive <span class="sc">==</span> <span class="st">"United States of America (USA)"</span> <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>      countryLive <span class="sc">==</span> <span class="st">"United Kingdom (UK)"</span> <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> countryLive</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(RMTMethods_YN, </span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>))</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get top 6 countries</span></span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>top_6_countries <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">6</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(countryLive)</span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for top 6 countries</span></span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>data_for_test <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(countryLive <span class="sc">%in%</span> top_6_countries, <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN))</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate group totals for each RMT group</span></span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>rmt_group_totals <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span></span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">group_N =</span> <span class="fu">n</span>())</span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics with percentages WITHIN each RMT group (not within country)</span></span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>country_rmt_stats <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span></span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN, countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rmt_group_totals, <span class="at">by =</span> <span class="st">"RMTMethods_YN"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> group_N <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate total per country (for ordering in plot)</span></span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_country =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table for statistical test</span></span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(</span>
<span id="cb196-48"><a href="#cb196-48" aria-hidden="true" tabindex="-1"></a>  data_for_test<span class="sc">$</span>countryLive,</span>
<span id="cb196-49"><a href="#cb196-49" aria-hidden="true" tabindex="-1"></a>  data_for_test<span class="sc">$</span>RMTMethods_YN</span>
<span id="cb196-50"><a href="#cb196-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-51"><a href="#cb196-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-52"><a href="#cb196-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare legend labels with group total N included</span></span>
<span id="cb196-53"><a href="#cb196-53" aria-hidden="true" tabindex="-1"></a>legend_labels <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb196-54"><a href="#cb196-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="fu">levels</span>(data_for_test<span class="sc">$</span>RMTMethods_YN), <span class="st">" (N = "</span>, rmt_group_totals<span class="sc">$</span>group_N, <span class="st">")"</span>),</span>
<span id="cb196-55"><a href="#cb196-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>(data_for_test<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb196-56"><a href="#cb196-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-57"><a href="#cb196-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-58"><a href="#cb196-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Get expected frequencies without running a test yet</span></span>
<span id="cb196-59"><a href="#cb196-59" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb196-60"><a href="#cb196-60" aria-hidden="true" tabindex="-1"></a>row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(contingency_table)</span>
<span id="cb196-61"><a href="#cb196-61" aria-hidden="true" tabindex="-1"></a>col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(contingency_table)</span>
<span id="cb196-62"><a href="#cb196-62" aria-hidden="true" tabindex="-1"></a>expected_counts <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums) <span class="sc">/</span> n</span>
<span id="cb196-63"><a href="#cb196-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-64"><a href="#cb196-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Use Fisher's exact test to avoid chi-square approximation warnings</span></span>
<span id="cb196-65"><a href="#cb196-65" aria-hidden="true" tabindex="-1"></a>fisher_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb196-66"><a href="#cb196-66" aria-hidden="true" tabindex="-1"></a>test_name <span class="ot">&lt;-</span> <span class="st">"Fisher's exact test"</span></span>
<span id="cb196-67"><a href="#cb196-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-68"><a href="#cb196-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Print test results</span></span>
<span id="cb196-69"><a href="#cb196-69" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, test_name, <span class="st">"Results:</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Fisher's exact testResults:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data with simulated p-value (based on
    10000 replicates)

data:  contingency_table
p-value = 9.999e-05
alternative hypothesis: two.sided</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print expected frequencies</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Expected frequencies:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Expected frequencies:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(expected_counts, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            No RMT   RMT
Australia   279.91 46.09
Canada       78.13 12.87
Italy        40.35  6.65
New Zealand  27.48  4.52
UK          307.38 50.62
USA         523.75 86.25</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create grouped bar plot with percentages within RMT groups</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_rmt_stats, </span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(countryLive, <span class="sc">-</span>total_country), </span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> count, </span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"steelblue"</span>),</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> legend_labels) <span class="sc">+</span></span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RMT Usage by Country (Top 6)"</span>,</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(test_name, <span class="st">": p "</span>, </span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(fisher_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">001</span>, </span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&lt; .001"</span>, </span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">paste0</span>(<span class="st">"= "</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, fisher_test<span class="sc">$</span>p.value)))),</span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count of Participants"</span>,</span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"RMT Usage"</span>,</span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note: Percentages are calculated within each RMT group, not within countries"</span>) <span class="sc">+</span></span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb204-30"><a href="#cb204-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb204-31"><a href="#cb204-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb204-32"><a href="#cb204-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb204-33"><a href="#cb204-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb204-34"><a href="#cb204-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb204-35"><a href="#cb204-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb204-36"><a href="#cb204-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb204-37"><a href="#cb204-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-38"><a href="#cb204-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb204-39"><a href="#cb204-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportions of RMT users in each country</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>country_proportions <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>(),</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmt_users =</span> <span class="fu">sum</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>),</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmt_proportion =</span> rmt_users<span class="sc">/</span>total,</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmt_percentage =</span> rmt_proportion <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rmt_proportion))</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RMT Usage Proportions by Country:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
RMT Usage Proportions by Country:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(country_proportions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  countryLive total rmt_users rmt_proportion rmt_percentage
  &lt;chr&gt;       &lt;int&gt;     &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt;
1 Australia     326        63         0.193           19.3 
2 USA           610       113         0.185           18.5 
3 Italy          47         8         0.170           17.0 
4 Canada         91         8         0.0879           8.79
5 UK            358        14         0.0391           3.91
6 New Zealand    32         1         0.0312           3.12</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise proportion tests with Bonferroni correction</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">unique</span>(country_proportions<span class="sc">$</span>countryLive)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>n_countries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>pairwise_tests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_countries<span class="dv">-1</span>)) {</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_countries) {</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>    country1 <span class="ot">&lt;-</span> countries[i]</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>    country2 <span class="ot">&lt;-</span> countries[j]</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get data for both countries</span></span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>    data1 <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span> <span class="fu">filter</span>(countryLive <span class="sc">==</span> country1)</span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a>    data2 <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span> <span class="fu">filter</span>(countryLive <span class="sc">==</span> country2)</span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get counts for proportion test</span></span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data1<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>)</span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data2<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>)</span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data1)</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data2)</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Skip if zero denominators</span></span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> n2 <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create 2x2 table for test</span></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a>    test_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1, n1<span class="sc">-</span>x1, x2, n2<span class="sc">-</span>x2), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use Fisher's exact test for all pairwise comparisons</span></span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(test_table)</span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a>    pairwise_tests <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_tests, <span class="fu">data.frame</span>(</span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">country1 =</span> country1,</span>
<span id="cb209-35"><a href="#cb209-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">country2 =</span> country2,</span>
<span id="cb209-36"><a href="#cb209-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop1 =</span> x1<span class="sc">/</span>n1,</span>
<span id="cb209-37"><a href="#cb209-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop2 =</span> x2<span class="sc">/</span>n2,</span>
<span id="cb209-38"><a href="#cb209-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">diff =</span> <span class="fu">abs</span>(x1<span class="sc">/</span>n1 <span class="sc">-</span> x2<span class="sc">/</span>n2),</span>
<span id="cb209-39"><a href="#cb209-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb209-40"><a href="#cb209-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb209-41"><a href="#cb209-41" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb209-42"><a href="#cb209-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb209-43"><a href="#cb209-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-44"><a href="#cb209-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-45"><a href="#cb209-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb209-46"><a href="#cb209-46" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(pairwise_tests) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb209-47"><a href="#cb209-47" aria-hidden="true" tabindex="-1"></a>  pairwise_tests<span class="sc">$</span>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pairwise_tests<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb209-48"><a href="#cb209-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb209-49"><a href="#cb209-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise Comparisons (Bonferroni-adjusted p-values):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb209-50"><a href="#cb209-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(pairwise_tests <span class="sc">%&gt;%</span> </span>
<span id="cb209-51"><a href="#cb209-51" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arrange</span>(p_adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb209-52"><a href="#cb209-52" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(</span>
<span id="cb209-53"><a href="#cb209-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">prop1 =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, prop1 <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb209-54"><a href="#cb209-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">prop2 =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, prop2 <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb209-55"><a href="#cb209-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">diff =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, diff <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb209-56"><a href="#cb209-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">p_value =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_value),</span>
<span id="cb209-57"><a href="#cb209-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">p_adjusted =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_adjusted)</span>
<span id="cb209-58"><a href="#cb209-58" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span></span>
<span id="cb209-59"><a href="#cb209-59" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(country1, prop1, country2, prop2, diff, p_value, p_adjusted))</span>
<span id="cb209-60"><a href="#cb209-60" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb209-61"><a href="#cb209-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">No valid pairwise comparisons could be performed.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb209-62"><a href="#cb209-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Pairwise Comparisons (Bonferroni-adjusted p-values):
    country1 prop1    country2 prop2  diff p_value p_adjusted
1        USA 18.5%          UK  3.9% 14.6%  0.0000     0.0000
2  Australia 19.3%          UK  3.9% 15.4%  0.0000     0.0000
3      Italy 17.0%          UK  3.9% 13.1%  0.0017     0.0249
4  Australia 19.3%      Canada  8.8% 10.5%  0.0178     0.2664
5        USA 18.5%      Canada  8.8%  9.7%  0.0247     0.3708
6  Australia 19.3% New Zealand  3.1% 16.2%  0.0262     0.3934
7        USA 18.5% New Zealand  3.1% 15.4%  0.0292     0.4383
8  Australia 19.3%         USA 18.5%  0.8%  0.7924     1.0000
9  Australia 19.3%       Italy 17.0%  2.3%  0.8433     1.0000
10       USA 18.5%       Italy 17.0%  1.5%  1.0000     1.0000
11     Italy 17.0%      Canada  8.8%  8.2%  0.1689     1.0000
12     Italy 17.0% New Zealand  3.1% 13.9%  0.0757     1.0000
13    Canada  8.8%          UK  3.9%  4.9%  0.0970     1.0000
14    Canada  8.8% New Zealand  3.1%  5.7%  0.4437     1.0000
15        UK  3.9% New Zealand  3.1%  0.8%  1.0000     1.0000</code></pre>
</div>
</div>
</section>
<section id="results-and-discussion-7" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="results-and-discussion-7"><span class="header-section-number">6.4</span> Results and Discussion</h2>
<p>Geographical Patterns in Respiratory Muscle Training Adoption Among Wind Musicians</p>
<p><strong>Overview of Findings</strong></p>
<p>The analysis examines how Respiratory Muscle Training (RMT) device usage varies across different countries among wind instrument musicians. By focusing on the top six countries represented in the sample, this analysis reveals distinctive geographical patterns in RMT adoption that likely reflect broader cultural, educational, and practice-related differences.</p>
<p><strong>Key Statistical Findings</strong></p>
<p>The Fisher’s exact test confirms a statistically significant association between country of residence and RMT usage (p &lt; 0.05). This indicates that the observed geographical variations in RMT adoption are not due to random chance but represent genuine differences across countries. Within each RMT group, the distribution of countries differs notably:</p>
<p><strong>Country-Specific RMT Usage Patterns</strong></p>
<p>The data shows notable differences in RMT adoption rates across countries:</p>
<ol type="1">
<li><p><strong>High Adoption Countries</strong>:</p>
<ul>
<li><p>Australia: 19.3% (63 out of 326 participants)</p></li>
<li><p>USA: 18.5% (113 out of 610 participants)</p></li>
<li><p>Italy: 17.0% (8 out of 47 participants)</p></li>
</ul></li>
<li><p><strong>Low Adoption Countries</strong>:</p>
<ul>
<li><p>Canada: 8.8% (8 out of 91 participants)</p></li>
<li><p>UK: 3.9% (14 out of 358 participants)</p></li>
<li><p>New Zealand: 3.1% (1 out of 32 participants)</p></li>
</ul></li>
</ol>
<p>This reveals a striking pattern where participants from the UK and New Zealand are approximately 5-6 times less likely to use RMT compared to those from Australia, USA, or Italy.</p>
<p><strong>Pairwise Comparisons</strong></p>
<p>The Bonferroni-adjusted pairwise comparisons identify which specific country differences are statistically significant:</p>
<ol type="1">
<li><p><strong>Significant Differences</strong> (p &lt; 0.05 after adjustment):</p>
<ul>
<li><p>USA vs.&nbsp;UK: 14.6 percentage point difference (p = 0.0000)</p></li>
<li><p>Australia vs.&nbsp;UK: 15.4 percentage point difference (p = 0.0000)</p></li>
<li><p>Italy vs.&nbsp;UK: 13.1 percentage point difference (p = 0.0249)</p></li>
</ul></li>
<li><p><strong>Non-Significant Differences</strong> (p &gt; 0.05 after adjustment):</p>
<ul>
<li>All other country comparisons, including those between high-adoption countries (Australia, USA, Italy) and between low-adoption countries (Canada, UK, New Zealand)</li>
</ul></li>
</ol>
<p>The Bonferroni correction, which adjusts for multiple comparisons, confirms that the UK stands out as having significantly lower RMT usage compared to Australia, USA, and Italy.</p>
<p><strong>Implications and Potential Explanations</strong></p>
<p>Several factors might explain these international differences in RMT adoption:</p>
<ol type="1">
<li><p><strong>Educational and Training Approaches</strong>: Different educational systems and training methodologies may emphasize technology integration to varying degrees.</p></li>
<li><p><strong>Cultural Attitudes</strong>: Cultural differences in approaches to teaching, learning, and technology adoption may influence RMT usage.</p></li>
<li><p><strong>Technological Infrastructure</strong>: Differences in access to technology, internet reliability, and technological support systems might affect adoption rates.</p></li>
<li><p><strong>Market Penetration</strong>: Technology companies might have targeted certain markets more aggressively or entered them earlier.</p></li>
<li><p><strong>Professional Norms</strong>: Music education and performance practices may have different established norms regarding technology usage across these countries.</p></li>
</ol>
<p>The Anglo countries show an interesting split, with the USA and Australia having high adoption rates while the UK and New Zealand have notably low rates. This suggests that shared language and similar cultural backgrounds do not necessarily lead to similar technology adoption patterns.</p>
<p><strong>Limitations</strong></p>
<p>While these findings are statistically significant, some considerations are worth noting:</p>
<ol type="1">
<li><p><strong>Sample Size Variations</strong>: The number of participants varies considerably across countries (from 32 in New Zealand to 610 in the USA), which affects the precision of the estimates.</p></li>
<li><p><strong>Limited Coverage for Italy and New Zealand</strong>: These countries have relatively small sample sizes (47 and 32 respectively), making their estimates less reliable.</p></li>
<li><p><strong>Potential Confounding Variables</strong>: Factors like participant age, professional status, or educational background might vary across countries and influence the results.</p></li>
</ol>
<p><strong>Conclusion</strong></p>
<p>The analysis clearly demonstrates that RMT usage varies significantly by country of residence, with particularly strong differences between high-adoption countries (Australia, USA, Italy) and the UK. These findings suggest that geographical and potentially cultural factors play an important role in technology adoption within music education and performance settings. Further research could explore the specific mechanisms behind these differences and their implications for educational policy and technology development.</p>
</section>
</section>
<section id="country-of-education" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Country of Education</h1>
<section id="descriptive-stats-4" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="descriptive-stats-4"><span class="header-section-number">7.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>total_N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_combined)</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean country names</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">countryEd =</span> <span class="fu">case_when</span>(</span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>      countryEd <span class="sc">==</span> <span class="st">"United States of America (USA)"</span> <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a>      countryEd <span class="sc">==</span> <span class="st">"United Kingdom (UK)"</span> <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(countryEd)</span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the top 6 countries from countryEd</span></span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true" tabindex="-1"></a>top_6_countryEd <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(countryEd, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">6</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb211-21"><a href="#cb211-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(countryEd)</span>
<span id="cb211-22"><a href="#cb211-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-23"><a href="#cb211-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for these top 6 countries</span></span>
<span id="cb211-24"><a href="#cb211-24" aria-hidden="true" tabindex="-1"></a>data_top6_edu <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb211-25"><a href="#cb211-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(countryEd <span class="sc">%in%</span> top_6_countryEd)</span>
<span id="cb211-26"><a href="#cb211-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-27"><a href="#cb211-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics for plotting and analysis</span></span>
<span id="cb211-28"><a href="#cb211-28" aria-hidden="true" tabindex="-1"></a>edu_stats <span class="ot">&lt;-</span> data_top6_edu <span class="sc">%&gt;%</span></span>
<span id="cb211-29"><a href="#cb211-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(countryEd) <span class="sc">%&gt;%</span></span>
<span id="cb211-30"><a href="#cb211-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb211-31"><a href="#cb211-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb211-32"><a href="#cb211-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb211-33"><a href="#cb211-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb211-34"><a href="#cb211-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb211-35"><a href="#cb211-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-36"><a href="#cb211-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test for equal proportions</span></span>
<span id="cb211-37"><a href="#cb211-37" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(edu_stats<span class="sc">$</span>n)</span>
<span id="cb211-38"><a href="#cb211-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-39"><a href="#cb211-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table for post-hoc analysis</span></span>
<span id="cb211-40"><a href="#cb211-40" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(data_top6_edu<span class="sc">$</span>countryEd))</span>
<span id="cb211-41"><a href="#cb211-41" aria-hidden="true" tabindex="-1"></a>n_countries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb211-42"><a href="#cb211-42" aria-hidden="true" tabindex="-1"></a>pairwise_tests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb211-43"><a href="#cb211-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-44"><a href="#cb211-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairwise proportion tests</span></span>
<span id="cb211-45"><a href="#cb211-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_countries<span class="dv">-1</span>)) {</span>
<span id="cb211-46"><a href="#cb211-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_countries) {</span>
<span id="cb211-47"><a href="#cb211-47" aria-hidden="true" tabindex="-1"></a>    country1 <span class="ot">&lt;-</span> countries[i]</span>
<span id="cb211-48"><a href="#cb211-48" aria-hidden="true" tabindex="-1"></a>    country2 <span class="ot">&lt;-</span> countries[j]</span>
<span id="cb211-49"><a href="#cb211-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-50"><a href="#cb211-50" aria-hidden="true" tabindex="-1"></a>    count1 <span class="ot">&lt;-</span> edu_stats<span class="sc">$</span>n[edu_stats<span class="sc">$</span>countryEd <span class="sc">==</span> country1]</span>
<span id="cb211-51"><a href="#cb211-51" aria-hidden="true" tabindex="-1"></a>    count2 <span class="ot">&lt;-</span> edu_stats<span class="sc">$</span>n[edu_stats<span class="sc">$</span>countryEd <span class="sc">==</span> country2]</span>
<span id="cb211-52"><a href="#cb211-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-53"><a href="#cb211-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform proportion test</span></span>
<span id="cb211-54"><a href="#cb211-54" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(</span>
<span id="cb211-55"><a href="#cb211-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">c</span>(count1, count2),</span>
<span id="cb211-56"><a href="#cb211-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">c</span>(<span class="fu">sum</span>(edu_stats<span class="sc">$</span>n), <span class="fu">sum</span>(edu_stats<span class="sc">$</span>n))</span>
<span id="cb211-57"><a href="#cb211-57" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb211-58"><a href="#cb211-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb211-59"><a href="#cb211-59" aria-hidden="true" tabindex="-1"></a>    pairwise_tests <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_tests, <span class="fu">data.frame</span>(</span>
<span id="cb211-60"><a href="#cb211-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">country1 =</span> country1,</span>
<span id="cb211-61"><a href="#cb211-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">country2 =</span> country2,</span>
<span id="cb211-62"><a href="#cb211-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb211-63"><a href="#cb211-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb211-64"><a href="#cb211-64" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb211-65"><a href="#cb211-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb211-66"><a href="#cb211-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb211-67"><a href="#cb211-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-68"><a href="#cb211-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb211-69"><a href="#cb211-69" aria-hidden="true" tabindex="-1"></a>pairwise_tests<span class="sc">$</span>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pairwise_tests<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb211-70"><a href="#cb211-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-71"><a href="#cb211-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb211-72"><a href="#cb211-72" aria-hidden="true" tabindex="-1"></a>edu_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(edu_stats, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(countryEd, <span class="sc">-</span>n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb211-73"><a href="#cb211-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb211-74"><a href="#cb211-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb211-75"><a href="#cb211-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 6 Countries of Education"</span>,</span>
<span id="cb211-76"><a href="#cb211-76" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"χ²("</span>, chi_test<span class="sc">$</span>parameter, <span class="st">") = "</span>, </span>
<span id="cb211-77"><a href="#cb211-77" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, chi_test<span class="sc">$</span>statistic),</span>
<span id="cb211-78"><a href="#cb211-78" aria-hidden="true" tabindex="-1"></a>                         <span class="st">", p "</span>, </span>
<span id="cb211-79"><a href="#cb211-79" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(chi_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">001</span>, </span>
<span id="cb211-80"><a href="#cb211-80" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&lt; .001"</span>, </span>
<span id="cb211-81"><a href="#cb211-81" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">paste0</span>(<span class="st">"= "</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, chi_test<span class="sc">$</span>p.value)))),</span>
<span id="cb211-82"><a href="#cb211-82" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country of Education"</span>,</span>
<span id="cb211-83"><a href="#cb211-83" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, total_N, <span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb211-84"><a href="#cb211-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb211-85"><a href="#cb211-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb211-86"><a href="#cb211-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb211-87"><a href="#cb211-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb211-88"><a href="#cb211-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb211-89"><a href="#cb211-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb211-90"><a href="#cb211-90" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb211-91"><a href="#cb211-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb211-92"><a href="#cb211-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-93"><a href="#cb211-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical results</span></span>
<span id="cb211-94"><a href="#cb211-94" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chi-square Test of Equal Proportions Results:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chi-square Test of Equal Proportions Results:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  edu_stats$n
X-squared = 1111.3, df = 5, p-value &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Descriptive Statistics:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nDescriptive Statistics:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(edu_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  countryEd       n percentage label         
  &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt;         
1 USA           620      42.2  "620\n(42.2%)"
2 UK            364      24.8  "364\n(24.8%)"
3 Australia     321      21.9  "321\n(21.9%)"
4 Canada         92       6.27 "92\n(6.3%)"  
5 Italy          44       3.00 "44\n(3.0%)"  
6 New Zealand    27       1.84 "27\n(1.8%)"  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise Comparisons (Bonferroni-adjusted p-values):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nPairwise Comparisons (Bonferroni-adjusted p-values):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_tests <span class="sc">%&gt;%</span> </span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(p_adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">p_value =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_value),</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">p_adjusted =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_adjusted)</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>        ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      country1    country2 p_value p_adjusted
1  New Zealand         USA  0.0000     0.0000
2        Italy         USA  0.0000     0.0000
3       Canada         USA  0.0000     0.0000
4  New Zealand          UK  0.0000     0.0000
5        Italy          UK  0.0000     0.0000
6    Australia New Zealand  0.0000     0.0000
7    Australia       Italy  0.0000     0.0000
8       Canada          UK  0.0000     0.0000
9    Australia      Canada  0.0000     0.0000
10   Australia         USA  0.0000     0.0000
11          UK         USA  0.0000     0.0000
12      Canada New Zealand  0.0000     0.0000
13      Canada       Italy  0.0000     0.0006
14       Italy New Zealand  0.0546     0.8186
15   Australia          UK  0.0668     1.0000</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(edu_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results-and-discussion-8" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="results-and-discussion-8"><span class="header-section-number">7.2</span> Results and Discussion</h2>
<p><strong>Distribution of Participants</strong></p>
<ul>
<li><p><strong>United States of America (USA)</strong>: Largest share with 620 participants (39.8%)</p></li>
<li><p><strong>United Kingdom (UK)</strong>: Second largest with 364 participants (23.4%)</p></li>
<li><p><strong>Australia</strong>: Third with 321 participants (20.6%)</p></li>
<li><p><strong>Canada</strong>: 92 participants (5.9%)</p></li>
<li><p><strong>Italy</strong>: 44 participants (2.8%)</p></li>
<li><p><strong>New Zealand</strong>: 27 participants (1.7%)</p></li>
</ul>
<p><strong>Key Observations</strong>:</p>
<ul>
<li><p>The top three countries (USA, UK, and Australia) account for 83.8% of all participants’ educational background</p></li>
<li><p>English-speaking countries dominate the top positions, representing 91.4% of the top 6 response</p></li>
<li><p>There’s a significant drop between the top 3 and the remaining countries</p></li>
<li><p>The distribution pattern is very similar to the current country of residence data, suggesting most participants stayed in their country of education</p></li>
</ul>
<p><strong>Comparison to Current Residence</strong>:</p>
<p>USA: Education (620) vs Residence (610) UK: Education (364) vs Residence (358) Australia: Education (321) vs Residence (326) Canada: Education (92) vs Residence (91) Italy: Education (44) vs Residence (47) New Zealand: Education (27) vs Residence (32)</p>
<p>This shows relatively small differences between where participants were educated and where they currently live, indicating low international mobility after education.</p>
</section>
<section id="comparison-stats-5" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="comparison-stats-5"><span class="header-section-number">7.3</span> Comparison Stats</h2>
<p>Still getting a Chi-Squared Warning, but added Fisher’s</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Data Preparation Function</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>prepare_rmt_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path, <span class="at">sheet =</span> <span class="st">"Combined"</span>) {</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read data with standardized cleaning</span></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> sheet)</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>    data_cleaned <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Comprehensive country name standardization</span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">countryEd =</span> <span class="fu">case_when</span>(</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">grepl</span>(<span class="st">"United States|USA"</span>, countryEd, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">grepl</span>(<span class="st">"United Kingdom|UK"</span>, countryEd, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(countryEd)</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Robust RMT factor conversion</span></span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(</span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">RMTMethods_YN</span><span class="st">`</span>, </span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>)</span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(data_cleaned)</span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error in data preparation:"</span>, e<span class="sc">$</span>message))</span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-33"><a href="#cb224-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced Statistical Analysis Function</span></span>
<span id="cb224-34"><a href="#cb224-34" aria-hidden="true" tabindex="-1"></a>perform_comprehensive_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb224-35"><a href="#cb224-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify Top 6 Countries</span></span>
<span id="cb224-36"><a href="#cb224-36" aria-hidden="true" tabindex="-1"></a>  top_6_countryEd <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb224-37"><a href="#cb224-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(countryEd, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb224-38"><a href="#cb224-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">6</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb224-39"><a href="#cb224-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(countryEd)</span>
<span id="cb224-40"><a href="#cb224-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-41"><a href="#cb224-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data to top 6 countries</span></span>
<span id="cb224-42"><a href="#cb224-42" aria-hidden="true" tabindex="-1"></a>  data_top6_edu <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb224-43"><a href="#cb224-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(countryEd <span class="sc">%in%</span> top_6_countryEd)</span>
<span id="cb224-44"><a href="#cb224-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-45"><a href="#cb224-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create contingency table</span></span>
<span id="cb224-46"><a href="#cb224-46" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_top6_edu<span class="sc">$</span>countryEd, data_top6_edu<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb224-47"><a href="#cb224-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-48"><a href="#cb224-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Comprehensive test selection and reporting</span></span>
<span id="cb224-49"><a href="#cb224-49" aria-hidden="true" tabindex="-1"></a>  analyze_test_assumptions <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb224-50"><a href="#cb224-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate expected frequencies</span></span>
<span id="cb224-51"><a href="#cb224-51" aria-hidden="true" tabindex="-1"></a>    chi_results <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(cont_table))</span>
<span id="cb224-52"><a href="#cb224-52" aria-hidden="true" tabindex="-1"></a>    expected_freq <span class="ot">&lt;-</span> chi_results<span class="sc">$</span>expected</span>
<span id="cb224-53"><a href="#cb224-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-54"><a href="#cb224-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Detailed frequency checks</span></span>
<span id="cb224-55"><a href="#cb224-55" aria-hidden="true" tabindex="-1"></a>    total_cells <span class="ot">&lt;-</span> <span class="fu">length</span>(expected_freq)</span>
<span id="cb224-56"><a href="#cb224-56" aria-hidden="true" tabindex="-1"></a>    low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb224-57"><a href="#cb224-57" aria-hidden="true" tabindex="-1"></a>    min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb224-58"><a href="#cb224-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-59"><a href="#cb224-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verbose reporting of frequency conditions</span></span>
<span id="cb224-60"><a href="#cb224-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb224-61"><a href="#cb224-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb224-62"><a href="#cb224-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb224-63"><a href="#cb224-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"out of"</span>, total_cells, <span class="st">"cells ("</span>, </span>
<span id="cb224-64"><a href="#cb224-64" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> total_cells <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb224-65"><a href="#cb224-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-66"><a href="#cb224-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine most appropriate test</span></span>
<span id="cb224-67"><a href="#cb224-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> total_cells) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb224-68"><a href="#cb224-68" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use Fisher's exact test with Monte Carlo simulation</span></span>
<span id="cb224-69"><a href="#cb224-69" aria-hidden="true" tabindex="-1"></a>      exact_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(cont_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb224-70"><a href="#cb224-70" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb224-71"><a href="#cb224-71" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb224-72"><a href="#cb224-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test (Monte Carlo)"</span>,</span>
<span id="cb224-73"><a href="#cb224-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> exact_test<span class="sc">$</span>p.value,</span>
<span id="cb224-74"><a href="#cb224-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> <span class="cn">NA</span>,</span>
<span id="cb224-75"><a href="#cb224-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb224-76"><a href="#cb224-76" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb224-77"><a href="#cb224-77" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb224-78"><a href="#cb224-78" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb224-79"><a href="#cb224-79" aria-hidden="true" tabindex="-1"></a>      adjusted_chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb224-80"><a href="#cb224-80" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb224-81"><a href="#cb224-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb224-82"><a href="#cb224-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">test_type =</span> <span class="st">"Chi-Square with Continuity Correction"</span>,</span>
<span id="cb224-83"><a href="#cb224-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> adjusted_chi_test<span class="sc">$</span>p.value,</span>
<span id="cb224-84"><a href="#cb224-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> adjusted_chi_test<span class="sc">$</span>statistic,</span>
<span id="cb224-85"><a href="#cb224-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameter =</span> adjusted_chi_test<span class="sc">$</span>parameter,</span>
<span id="cb224-86"><a href="#cb224-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="fu">paste</span>(<span class="st">"Pearson's Chi-squared test with Yates' continuity correction,"</span>,</span>
<span id="cb224-87"><a href="#cb224-87" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"df ="</span>, adjusted_chi_test<span class="sc">$</span>parameter)</span>
<span id="cb224-88"><a href="#cb224-88" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb224-89"><a href="#cb224-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb224-90"><a href="#cb224-90" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb224-91"><a href="#cb224-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-92"><a href="#cb224-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform test</span></span>
<span id="cb224-93"><a href="#cb224-93" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">analyze_test_assumptions</span>(contingency_table)</span>
<span id="cb224-94"><a href="#cb224-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-95"><a href="#cb224-95" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pairwise comparisons with Fisher's exact test</span></span>
<span id="cb224-96"><a href="#cb224-96" aria-hidden="true" tabindex="-1"></a>  pairwise_comparisons <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb224-97"><a href="#cb224-97" aria-hidden="true" tabindex="-1"></a>    countries <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cont_table)</span>
<span id="cb224-98"><a href="#cb224-98" aria-hidden="true" tabindex="-1"></a>    n_countries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb224-99"><a href="#cb224-99" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb224-100"><a href="#cb224-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">comparison =</span> <span class="fu">character</span>(),</span>
<span id="cb224-101"><a href="#cb224-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb224-102"><a href="#cb224-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">adj_p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb224-103"><a href="#cb224-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb224-104"><a href="#cb224-104" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb224-105"><a href="#cb224-105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-106"><a href="#cb224-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_countries<span class="dv">-1</span>)) {</span>
<span id="cb224-107"><a href="#cb224-107" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_countries) {</span>
<span id="cb224-108"><a href="#cb224-108" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use Fisher's exact test for all pairwise comparisons</span></span>
<span id="cb224-109"><a href="#cb224-109" aria-hidden="true" tabindex="-1"></a>        test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(cont_table[<span class="fu">c</span>(i,j),])</span>
<span id="cb224-110"><a href="#cb224-110" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb224-111"><a href="#cb224-111" aria-hidden="true" tabindex="-1"></a>          <span class="at">comparison =</span> <span class="fu">paste</span>(countries[i], <span class="st">"vs"</span>, countries[j]),</span>
<span id="cb224-112"><a href="#cb224-112" aria-hidden="true" tabindex="-1"></a>          <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb224-113"><a href="#cb224-113" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj_p_value =</span> <span class="cn">NA</span></span>
<span id="cb224-114"><a href="#cb224-114" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb224-115"><a href="#cb224-115" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb224-116"><a href="#cb224-116" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb224-117"><a href="#cb224-117" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb224-118"><a href="#cb224-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bonferroni correction</span></span>
<span id="cb224-119"><a href="#cb224-119" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>adj_p_value <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(results<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb224-120"><a href="#cb224-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(results)</span>
<span id="cb224-121"><a href="#cb224-121" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb224-122"><a href="#cb224-122" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-123"><a href="#cb224-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute pairwise comparisons</span></span>
<span id="cb224-124"><a href="#cb224-124" aria-hidden="true" tabindex="-1"></a>  pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise_comparisons</span>(contingency_table)</span>
<span id="cb224-125"><a href="#cb224-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-126"><a href="#cb224-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return comprehensive results</span></span>
<span id="cb224-127"><a href="#cb224-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb224-128"><a href="#cb224-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_results =</span> test_results,</span>
<span id="cb224-129"><a href="#cb224-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">pairwise_results =</span> pairwise_results,</span>
<span id="cb224-130"><a href="#cb224-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_top6_edu =</span> data_top6_edu,</span>
<span id="cb224-131"><a href="#cb224-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">contingency_table =</span> contingency_table</span>
<span id="cb224-132"><a href="#cb224-132" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb224-133"><a href="#cb224-133" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb224-134"><a href="#cb224-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-135"><a href="#cb224-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization Function</span></span>
<span id="cb224-136"><a href="#cb224-136" aria-hidden="true" tabindex="-1"></a>create_rmt_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(analysis_results) {</span>
<span id="cb224-137"><a href="#cb224-137" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare plot data</span></span>
<span id="cb224-138"><a href="#cb224-138" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>data_top6_edu <span class="sc">%&gt;%</span></span>
<span id="cb224-139"><a href="#cb224-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(countryEd, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb224-140"><a href="#cb224-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb224-141"><a href="#cb224-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(countryEd) <span class="sc">%&gt;%</span></span>
<span id="cb224-142"><a href="#cb224-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb224-143"><a href="#cb224-143" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_country =</span> <span class="fu">sum</span>(count),</span>
<span id="cb224-144"><a href="#cb224-144" aria-hidden="true" tabindex="-1"></a>      <span class="at">percentage =</span> count <span class="sc">/</span> total_country <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb224-145"><a href="#cb224-145" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb224-146"><a href="#cb224-146" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb224-147"><a href="#cb224-147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb224-148"><a href="#cb224-148" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-149"><a href="#cb224-149" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute totals for legend</span></span>
<span id="cb224-150"><a href="#cb224-150" aria-hidden="true" tabindex="-1"></a>  legend_totals <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>data_top6_edu <span class="sc">%&gt;%</span></span>
<span id="cb224-151"><a href="#cb224-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb224-152"><a href="#cb224-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb224-153"><a href="#cb224-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-154"><a href="#cb224-154" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create legend labels</span></span>
<span id="cb224-155"><a href="#cb224-155" aria-hidden="true" tabindex="-1"></a>  legend_labels <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb224-156"><a href="#cb224-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(legend_totals<span class="sc">$</span>RMTMethods_YN, <span class="st">" (N = "</span>, legend_totals<span class="sc">$</span>total, <span class="st">")"</span>),</span>
<span id="cb224-157"><a href="#cb224-157" aria-hidden="true" tabindex="-1"></a>    legend_totals<span class="sc">$</span>RMTMethods_YN</span>
<span id="cb224-158"><a href="#cb224-158" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb224-159"><a href="#cb224-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-160"><a href="#cb224-160" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare subtitle based on test type</span></span>
<span id="cb224-161"><a href="#cb224-161" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>test_results</span>
<span id="cb224-162"><a href="#cb224-162" aria-hidden="true" tabindex="-1"></a>  subtitle_text <span class="ot">&lt;-</span> <span class="cf">if</span> (test_results<span class="sc">$</span>test_type <span class="sc">==</span> <span class="st">"Chi-Square with Continuity Correction"</span>) {</span>
<span id="cb224-163"><a href="#cb224-163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Chi-square test: "</span>, </span>
<span id="cb224-164"><a href="#cb224-164" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sprintf</span>(<span class="st">"χ²(%d) = %.2f"</span>, test_results<span class="sc">$</span>parameter, test_results<span class="sc">$</span>statistic),</span>
<span id="cb224-165"><a href="#cb224-165" aria-hidden="true" tabindex="-1"></a>           <span class="st">", p "</span>, <span class="fu">ifelse</span>(test_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, </span>
<span id="cb224-166"><a href="#cb224-166" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">paste</span>(<span class="st">"="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, test_results<span class="sc">$</span>p_value))))</span>
<span id="cb224-167"><a href="#cb224-167" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb224-168"><a href="#cb224-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Fisher's Exact Test (Monte Carlo): p "</span>, </span>
<span id="cb224-169"><a href="#cb224-169" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(test_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, </span>
<span id="cb224-170"><a href="#cb224-170" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste</span>(<span class="st">"="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, test_results<span class="sc">$</span>p_value))))</span>
<span id="cb224-171"><a href="#cb224-171" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb224-172"><a href="#cb224-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-173"><a href="#cb224-173" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the plot</span></span>
<span id="cb224-174"><a href="#cb224-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(countryEd, <span class="sc">-</span>total_country), <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb224-175"><a href="#cb224-175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb224-176"><a href="#cb224-176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb224-177"><a href="#cb224-177" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), </span>
<span id="cb224-178"><a href="#cb224-178" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb224-179"><a href="#cb224-179" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb224-180"><a href="#cb224-180" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Country of Education by RMT Usage (Top 6)"</span>,</span>
<span id="cb224-181"><a href="#cb224-181" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> subtitle_text,</span>
<span id="cb224-182"><a href="#cb224-182" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Country of Education"</span>,</span>
<span id="cb224-183"><a href="#cb224-183" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, <span class="fu">sum</span>(plot_data<span class="sc">$</span>count), <span class="st">")"</span>),</span>
<span id="cb224-184"><a href="#cb224-184" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"RMT Usage"</span>,</span>
<span id="cb224-185"><a href="#cb224-185" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Note: Percentages are out of the total N for each group"</span></span>
<span id="cb224-186"><a href="#cb224-186" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb224-187"><a href="#cb224-187" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_discrete</span>(<span class="at">labels =</span> legend_labels) <span class="sc">+</span></span>
<span id="cb224-188"><a href="#cb224-188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb224-189"><a href="#cb224-189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb224-190"><a href="#cb224-190" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb224-191"><a href="#cb224-191" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb224-192"><a href="#cb224-192" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb224-193"><a href="#cb224-193" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb224-194"><a href="#cb224-194" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb224-195"><a href="#cb224-195" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb224-196"><a href="#cb224-196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb224-197"><a href="#cb224-197" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb224-198"><a href="#cb224-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-199"><a href="#cb224-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Main Execution Function</span></span>
<span id="cb224-200"><a href="#cb224-200" aria-hidden="true" tabindex="-1"></a>run_rmt_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">file_path =</span> <span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>) {</span>
<span id="cb224-201"><a href="#cb224-201" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb224-202"><a href="#cb224-202" aria-hidden="true" tabindex="-1"></a>  prepared_data <span class="ot">&lt;-</span> <span class="fu">prepare_rmt_data</span>(file_path)</span>
<span id="cb224-203"><a href="#cb224-203" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-204"><a href="#cb224-204" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform comprehensive analysis</span></span>
<span id="cb224-205"><a href="#cb224-205" aria-hidden="true" tabindex="-1"></a>  analysis_results <span class="ot">&lt;-</span> <span class="fu">perform_comprehensive_analysis</span>(prepared_data)</span>
<span id="cb224-206"><a href="#cb224-206" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-207"><a href="#cb224-207" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create visualization</span></span>
<span id="cb224-208"><a href="#cb224-208" aria-hidden="true" tabindex="-1"></a>  rmt_plot <span class="ot">&lt;-</span> <span class="fu">create_rmt_plot</span>(analysis_results)</span>
<span id="cb224-209"><a href="#cb224-209" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-210"><a href="#cb224-210" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print results to console</span></span>
<span id="cb224-211"><a href="#cb224-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Statistical Test Details:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb224-212"><a href="#cb224-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Test Type:"</span>, analysis_results<span class="sc">$</span>test_results<span class="sc">$</span>test_type, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb224-213"><a href="#cb224-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"P-value:"</span>, analysis_results<span class="sc">$</span>test_results<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb224-214"><a href="#cb224-214" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-215"><a href="#cb224-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Contingency Table:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb224-216"><a href="#cb224-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>contingency_table)</span>
<span id="cb224-217"><a href="#cb224-217" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-218"><a href="#cb224-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Post-hoc Pairwise Comparisons (Bonferroni-corrected):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb224-219"><a href="#cb224-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>pairwise_results)</span>
<span id="cb224-220"><a href="#cb224-220" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-221"><a href="#cb224-221" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the plot</span></span>
<span id="cb224-222"><a href="#cb224-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(rmt_plot)</span>
<span id="cb224-223"><a href="#cb224-223" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-224"><a href="#cb224-224" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results for potential further analysis</span></span>
<span id="cb224-225"><a href="#cb224-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(analysis_results)</span>
<span id="cb224-226"><a href="#cb224-226" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb224-227"><a href="#cb224-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-228"><a href="#cb224-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the analysis</span></span>
<span id="cb224-229"><a href="#cb224-229" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_rmt_analysis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Expected Frequency Analysis:
Minimum Expected Frequency: 3.79 
Cells with Expected Frequency &lt; 5: 1 out of 12 cells ( 8.33 %)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Statistical Test Details:
Test Type: Chi-Square with Continuity Correction 
P-value: 1.055118e-10 

Contingency Table:
             
              No RMT RMT
  Australia      256  65
  Canada          84   8
  Italy           39   5
  New Zealand     26   1
  UK             350  14
  USA            507 113

Post-hoc Pairwise Comparisons (Bonferroni-corrected):
                 comparison      p_value  adj_p_value
1       Australia vs Canada 8.592223e-03 1.288833e-01
2        Australia vs Italy 2.196714e-01 1.000000e+00
3  Australia vs New Zealand 3.842474e-02 5.763710e-01
4           Australia vs UK 7.873873e-12 1.181081e-10
5          Australia vs USA 4.826511e-01 1.000000e+00
6           Canada vs Italy 7.562204e-01 1.000000e+00
7     Canada vs New Zealand 6.820881e-01 1.000000e+00
8              Canada vs UK 6.030667e-02 9.046001e-01
9             Canada vs USA 2.481173e-02 3.721759e-01
10     Italy vs New Zealand 3.968168e-01 1.000000e+00
11              Italy vs UK 4.256371e-02 6.384556e-01
12             Italy vs USA 3.106074e-01 1.000000e+00
13        New Zealand vs UK 1.000000e+00 1.000000e+00
14       New Zealand vs USA 6.684451e-02 1.000000e+00
15                UK vs USA 3.421609e-12 5.132413e-11</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only top 4 countries shown - Trying to increase the robustness of the analyses.</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Data Preparation Function</span></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>prepare_rmt_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path, <span class="at">sheet =</span> <span class="st">"Combined"</span>) {</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read data with standardized cleaning</span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> sheet)</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>    data_cleaned <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Comprehensive country name standardization</span></span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">countryEd =</span> <span class="fu">case_when</span>(</span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">grepl</span>(<span class="st">"United States|USA"</span>, countryEd, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">grepl</span>(<span class="st">"United Kingdom|UK"</span>, countryEd, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(countryEd)</span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Robust RMT factor conversion</span></span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(</span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">RMTMethods_YN</span><span class="st">`</span>, </span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>)</span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(data_cleaned)</span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error in data preparation:"</span>, e<span class="sc">$</span>message))</span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced Statistical Analysis Function</span></span>
<span id="cb227-36"><a href="#cb227-36" aria-hidden="true" tabindex="-1"></a>perform_comprehensive_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb227-37"><a href="#cb227-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get all countries and their frequencies</span></span>
<span id="cb227-38"><a href="#cb227-38" aria-hidden="true" tabindex="-1"></a>  all_countries <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb227-39"><a href="#cb227-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(countryEd)) <span class="sc">%&gt;%</span></span>
<span id="cb227-40"><a href="#cb227-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(countryEd, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-41"><a href="#cb227-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb227-42"><a href="#cb227-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-43"><a href="#cb227-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify Top 4 Countries</span></span>
<span id="cb227-44"><a href="#cb227-44" aria-hidden="true" tabindex="-1"></a>  top_4_countryEd <span class="ot">&lt;-</span> all_countries <span class="sc">%&gt;%</span></span>
<span id="cb227-45"><a href="#cb227-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">4</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb227-46"><a href="#cb227-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(countryEd)</span>
<span id="cb227-47"><a href="#cb227-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-48"><a href="#cb227-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get excluded countries for the note</span></span>
<span id="cb227-49"><a href="#cb227-49" aria-hidden="true" tabindex="-1"></a>  excluded_countries <span class="ot">&lt;-</span> all_countries <span class="sc">%&gt;%</span></span>
<span id="cb227-50"><a href="#cb227-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(countryEd <span class="sc">%in%</span> top_4_countryEd)) <span class="sc">%&gt;%</span></span>
<span id="cb227-51"><a href="#cb227-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_info =</span> countryEd) <span class="sc">%&gt;%</span></span>
<span id="cb227-52"><a href="#cb227-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(country_info)</span>
<span id="cb227-53"><a href="#cb227-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-54"><a href="#cb227-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create excluded countries list as a string</span></span>
<span id="cb227-55"><a href="#cb227-55" aria-hidden="true" tabindex="-1"></a>  excluded_countries_text <span class="ot">&lt;-</span> <span class="fu">paste</span>(excluded_countries, <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb227-56"><a href="#cb227-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-57"><a href="#cb227-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data to top 4 countries</span></span>
<span id="cb227-58"><a href="#cb227-58" aria-hidden="true" tabindex="-1"></a>  data_top4_edu <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb227-59"><a href="#cb227-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(countryEd <span class="sc">%in%</span> top_4_countryEd)</span>
<span id="cb227-60"><a href="#cb227-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-61"><a href="#cb227-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create contingency table</span></span>
<span id="cb227-62"><a href="#cb227-62" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_top4_edu<span class="sc">$</span>countryEd, data_top4_edu<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb227-63"><a href="#cb227-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-64"><a href="#cb227-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Comprehensive test selection and reporting</span></span>
<span id="cb227-65"><a href="#cb227-65" aria-hidden="true" tabindex="-1"></a>  analyze_test_assumptions <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb227-66"><a href="#cb227-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate expected frequencies</span></span>
<span id="cb227-67"><a href="#cb227-67" aria-hidden="true" tabindex="-1"></a>    chi_results <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(cont_table))</span>
<span id="cb227-68"><a href="#cb227-68" aria-hidden="true" tabindex="-1"></a>    expected_freq <span class="ot">&lt;-</span> chi_results<span class="sc">$</span>expected</span>
<span id="cb227-69"><a href="#cb227-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-70"><a href="#cb227-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Detailed frequency checks</span></span>
<span id="cb227-71"><a href="#cb227-71" aria-hidden="true" tabindex="-1"></a>    total_cells <span class="ot">&lt;-</span> <span class="fu">length</span>(expected_freq)</span>
<span id="cb227-72"><a href="#cb227-72" aria-hidden="true" tabindex="-1"></a>    low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb227-73"><a href="#cb227-73" aria-hidden="true" tabindex="-1"></a>    min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb227-74"><a href="#cb227-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-75"><a href="#cb227-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verbose reporting of frequency conditions</span></span>
<span id="cb227-76"><a href="#cb227-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-77"><a href="#cb227-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-78"><a href="#cb227-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb227-79"><a href="#cb227-79" aria-hidden="true" tabindex="-1"></a>        <span class="st">"out of"</span>, total_cells, <span class="st">"cells ("</span>, </span>
<span id="cb227-80"><a href="#cb227-80" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> total_cells <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb227-81"><a href="#cb227-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-82"><a href="#cb227-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine most appropriate test</span></span>
<span id="cb227-83"><a href="#cb227-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> total_cells) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb227-84"><a href="#cb227-84" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use Fisher's exact test with Monte Carlo simulation</span></span>
<span id="cb227-85"><a href="#cb227-85" aria-hidden="true" tabindex="-1"></a>      exact_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(cont_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb227-86"><a href="#cb227-86" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb227-87"><a href="#cb227-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb227-88"><a href="#cb227-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test (Monte Carlo)"</span>,</span>
<span id="cb227-89"><a href="#cb227-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> exact_test<span class="sc">$</span>p.value,</span>
<span id="cb227-90"><a href="#cb227-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> <span class="cn">NA</span>,</span>
<span id="cb227-91"><a href="#cb227-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb227-92"><a href="#cb227-92" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb227-93"><a href="#cb227-93" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb227-94"><a href="#cb227-94" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb227-95"><a href="#cb227-95" aria-hidden="true" tabindex="-1"></a>      adjusted_chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb227-96"><a href="#cb227-96" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb227-97"><a href="#cb227-97" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb227-98"><a href="#cb227-98" aria-hidden="true" tabindex="-1"></a>        <span class="at">test_type =</span> <span class="st">"Chi-Square with Continuity Correction"</span>,</span>
<span id="cb227-99"><a href="#cb227-99" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> adjusted_chi_test<span class="sc">$</span>p.value,</span>
<span id="cb227-100"><a href="#cb227-100" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> adjusted_chi_test<span class="sc">$</span>statistic,</span>
<span id="cb227-101"><a href="#cb227-101" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameter =</span> adjusted_chi_test<span class="sc">$</span>parameter,</span>
<span id="cb227-102"><a href="#cb227-102" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="fu">paste</span>(<span class="st">"Pearson's Chi-squared test with Yates' continuity correction,"</span>,</span>
<span id="cb227-103"><a href="#cb227-103" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"df ="</span>, adjusted_chi_test<span class="sc">$</span>parameter)</span>
<span id="cb227-104"><a href="#cb227-104" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb227-105"><a href="#cb227-105" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb227-106"><a href="#cb227-106" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb227-107"><a href="#cb227-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-108"><a href="#cb227-108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform test</span></span>
<span id="cb227-109"><a href="#cb227-109" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">analyze_test_assumptions</span>(contingency_table)</span>
<span id="cb227-110"><a href="#cb227-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-111"><a href="#cb227-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pairwise comparisons with Chi-square tests (if appropriate)</span></span>
<span id="cb227-112"><a href="#cb227-112" aria-hidden="true" tabindex="-1"></a>  pairwise_comparisons <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb227-113"><a href="#cb227-113" aria-hidden="true" tabindex="-1"></a>    countries <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cont_table)</span>
<span id="cb227-114"><a href="#cb227-114" aria-hidden="true" tabindex="-1"></a>    n_countries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb227-115"><a href="#cb227-115" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb227-116"><a href="#cb227-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">comparison =</span> <span class="fu">character</span>(),</span>
<span id="cb227-117"><a href="#cb227-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb227-118"><a href="#cb227-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">adj_p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb227-119"><a href="#cb227-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb227-120"><a href="#cb227-120" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb227-121"><a href="#cb227-121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-122"><a href="#cb227-122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_countries<span class="dv">-1</span>)) {</span>
<span id="cb227-123"><a href="#cb227-123" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_countries) {</span>
<span id="cb227-124"><a href="#cb227-124" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the 2x2 subtable</span></span>
<span id="cb227-125"><a href="#cb227-125" aria-hidden="true" tabindex="-1"></a>        subtable <span class="ot">&lt;-</span> cont_table[<span class="fu">c</span>(i,j),]</span>
<span id="cb227-126"><a href="#cb227-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb227-127"><a href="#cb227-127" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check assumptions for chi-square</span></span>
<span id="cb227-128"><a href="#cb227-128" aria-hidden="true" tabindex="-1"></a>        expected <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(subtable)<span class="sc">$</span>expected</span>
<span id="cb227-129"><a href="#cb227-129" aria-hidden="true" tabindex="-1"></a>        min_expected <span class="ot">&lt;-</span> <span class="fu">min</span>(expected)</span>
<span id="cb227-130"><a href="#cb227-130" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb227-131"><a href="#cb227-131" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use appropriate test based on expected frequencies</span></span>
<span id="cb227-132"><a href="#cb227-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (min_expected <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb227-133"><a href="#cb227-133" aria-hidden="true" tabindex="-1"></a>          test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(subtable)</span>
<span id="cb227-134"><a href="#cb227-134" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb227-135"><a href="#cb227-135" aria-hidden="true" tabindex="-1"></a>          test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(subtable, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb227-136"><a href="#cb227-136" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb227-137"><a href="#cb227-137" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb227-138"><a href="#cb227-138" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb227-139"><a href="#cb227-139" aria-hidden="true" tabindex="-1"></a>          <span class="at">comparison =</span> <span class="fu">paste</span>(countries[i], <span class="st">"vs"</span>, countries[j]),</span>
<span id="cb227-140"><a href="#cb227-140" aria-hidden="true" tabindex="-1"></a>          <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb227-141"><a href="#cb227-141" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj_p_value =</span> <span class="cn">NA</span></span>
<span id="cb227-142"><a href="#cb227-142" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb227-143"><a href="#cb227-143" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb227-144"><a href="#cb227-144" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb227-145"><a href="#cb227-145" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb227-146"><a href="#cb227-146" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bonferroni correction</span></span>
<span id="cb227-147"><a href="#cb227-147" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>adj_p_value <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(results<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb227-148"><a href="#cb227-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(results)</span>
<span id="cb227-149"><a href="#cb227-149" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb227-150"><a href="#cb227-150" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-151"><a href="#cb227-151" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute pairwise comparisons</span></span>
<span id="cb227-152"><a href="#cb227-152" aria-hidden="true" tabindex="-1"></a>  pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise_comparisons</span>(contingency_table)</span>
<span id="cb227-153"><a href="#cb227-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-154"><a href="#cb227-154" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return comprehensive results</span></span>
<span id="cb227-155"><a href="#cb227-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb227-156"><a href="#cb227-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_results =</span> test_results,</span>
<span id="cb227-157"><a href="#cb227-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">pairwise_results =</span> pairwise_results,</span>
<span id="cb227-158"><a href="#cb227-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_top4_edu =</span> data_top4_edu,</span>
<span id="cb227-159"><a href="#cb227-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">contingency_table =</span> contingency_table,</span>
<span id="cb227-160"><a href="#cb227-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">excluded_countries_text =</span> excluded_countries_text,</span>
<span id="cb227-161"><a href="#cb227-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_countries =</span> all_countries</span>
<span id="cb227-162"><a href="#cb227-162" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb227-163"><a href="#cb227-163" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb227-164"><a href="#cb227-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-165"><a href="#cb227-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization Function</span></span>
<span id="cb227-166"><a href="#cb227-166" aria-hidden="true" tabindex="-1"></a>create_rmt_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(analysis_results) {</span>
<span id="cb227-167"><a href="#cb227-167" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare plot data</span></span>
<span id="cb227-168"><a href="#cb227-168" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>data_top4_edu <span class="sc">%&gt;%</span></span>
<span id="cb227-169"><a href="#cb227-169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(countryEd, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb227-170"><a href="#cb227-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-171"><a href="#cb227-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(countryEd) <span class="sc">%&gt;%</span></span>
<span id="cb227-172"><a href="#cb227-172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb227-173"><a href="#cb227-173" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_country =</span> <span class="fu">sum</span>(count),</span>
<span id="cb227-174"><a href="#cb227-174" aria-hidden="true" tabindex="-1"></a>      <span class="at">percentage =</span> count <span class="sc">/</span> total_country <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb227-175"><a href="#cb227-175" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb227-176"><a href="#cb227-176" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb227-177"><a href="#cb227-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb227-178"><a href="#cb227-178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-179"><a href="#cb227-179" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute totals for legend</span></span>
<span id="cb227-180"><a href="#cb227-180" aria-hidden="true" tabindex="-1"></a>  legend_totals <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>data_top4_edu <span class="sc">%&gt;%</span></span>
<span id="cb227-181"><a href="#cb227-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb227-182"><a href="#cb227-182" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb227-183"><a href="#cb227-183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-184"><a href="#cb227-184" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create legend labels</span></span>
<span id="cb227-185"><a href="#cb227-185" aria-hidden="true" tabindex="-1"></a>  legend_labels <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb227-186"><a href="#cb227-186" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(legend_totals<span class="sc">$</span>RMTMethods_YN, <span class="st">" (N = "</span>, legend_totals<span class="sc">$</span>total, <span class="st">")"</span>),</span>
<span id="cb227-187"><a href="#cb227-187" aria-hidden="true" tabindex="-1"></a>    legend_totals<span class="sc">$</span>RMTMethods_YN</span>
<span id="cb227-188"><a href="#cb227-188" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb227-189"><a href="#cb227-189" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-190"><a href="#cb227-190" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare subtitle based on test type</span></span>
<span id="cb227-191"><a href="#cb227-191" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>test_results</span>
<span id="cb227-192"><a href="#cb227-192" aria-hidden="true" tabindex="-1"></a>  subtitle_text <span class="ot">&lt;-</span> <span class="cf">if</span> (test_results<span class="sc">$</span>test_type <span class="sc">==</span> <span class="st">"Chi-Square with Continuity Correction"</span>) {</span>
<span id="cb227-193"><a href="#cb227-193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Chi-square test: "</span>, </span>
<span id="cb227-194"><a href="#cb227-194" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sprintf</span>(<span class="st">"χ²(%d) = %.2f"</span>, test_results<span class="sc">$</span>parameter, test_results<span class="sc">$</span>statistic),</span>
<span id="cb227-195"><a href="#cb227-195" aria-hidden="true" tabindex="-1"></a>           <span class="st">", p "</span>, <span class="fu">ifelse</span>(test_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, </span>
<span id="cb227-196"><a href="#cb227-196" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">paste</span>(<span class="st">"="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, test_results<span class="sc">$</span>p_value))))</span>
<span id="cb227-197"><a href="#cb227-197" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb227-198"><a href="#cb227-198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Fisher's Exact Test (Monte Carlo): p "</span>, </span>
<span id="cb227-199"><a href="#cb227-199" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(test_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, </span>
<span id="cb227-200"><a href="#cb227-200" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste</span>(<span class="st">"="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, test_results<span class="sc">$</span>p_value))))</span>
<span id="cb227-201"><a href="#cb227-201" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb227-202"><a href="#cb227-202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-203"><a href="#cb227-203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the caption with excluded countries</span></span>
<span id="cb227-204"><a href="#cb227-204" aria-hidden="true" tabindex="-1"></a>  note_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Note. All countries with frequencies less than 5% were excluded from the Figure, including: "</span>, </span>
<span id="cb227-205"><a href="#cb227-205" aria-hidden="true" tabindex="-1"></a>                     analysis_results<span class="sc">$</span>excluded_countries_text)</span>
<span id="cb227-206"><a href="#cb227-206" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-207"><a href="#cb227-207" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wrap the note text for better display</span></span>
<span id="cb227-208"><a href="#cb227-208" aria-hidden="true" tabindex="-1"></a>  wrapped_note <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(note_text, <span class="at">width =</span> <span class="dv">100</span>)</span>
<span id="cb227-209"><a href="#cb227-209" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-210"><a href="#cb227-210" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count how many lines are in the wrapped note for margin adjustment</span></span>
<span id="cb227-211"><a href="#cb227-211" aria-hidden="true" tabindex="-1"></a>  line_count <span class="ot">&lt;-</span> <span class="fu">str_count</span>(wrapped_note, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb227-212"><a href="#cb227-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-213"><a href="#cb227-213" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the plot</span></span>
<span id="cb227-214"><a href="#cb227-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(countryEd, <span class="sc">-</span>total_country), <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb227-215"><a href="#cb227-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb227-216"><a href="#cb227-216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb227-217"><a href="#cb227-217" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), </span>
<span id="cb227-218"><a href="#cb227-218" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb227-219"><a href="#cb227-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb227-220"><a href="#cb227-220" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Country of Education by RMT Usage (Top 4)"</span>,</span>
<span id="cb227-221"><a href="#cb227-221" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> subtitle_text,</span>
<span id="cb227-222"><a href="#cb227-222" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Country of Education"</span>,</span>
<span id="cb227-223"><a href="#cb227-223" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, <span class="fu">sum</span>(plot_data<span class="sc">$</span>count), <span class="st">")"</span>),</span>
<span id="cb227-224"><a href="#cb227-224" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"RMT Usage"</span>,</span>
<span id="cb227-225"><a href="#cb227-225" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> wrapped_note</span>
<span id="cb227-226"><a href="#cb227-226" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb227-227"><a href="#cb227-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_discrete</span>(<span class="at">labels =</span> legend_labels) <span class="sc">+</span></span>
<span id="cb227-228"><a href="#cb227-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb227-229"><a href="#cb227-229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb227-230"><a href="#cb227-230" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb227-231"><a href="#cb227-231" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb227-232"><a href="#cb227-232" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb227-233"><a href="#cb227-233" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb227-234"><a href="#cb227-234" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">lineheight =</span> <span class="fl">1.2</span>),</span>
<span id="cb227-235"><a href="#cb227-235" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Adjust bottom margin based on the number of lines in the note</span></span>
<span id="cb227-236"><a href="#cb227-236" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span> <span class="sc">+</span> (line_count <span class="sc">*</span> <span class="dv">12</span>), <span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>)</span>
<span id="cb227-237"><a href="#cb227-237" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb227-238"><a href="#cb227-238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb227-239"><a href="#cb227-239" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb227-240"><a href="#cb227-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-241"><a href="#cb227-241" aria-hidden="true" tabindex="-1"></a><span class="co"># Main Execution Function</span></span>
<span id="cb227-242"><a href="#cb227-242" aria-hidden="true" tabindex="-1"></a>run_rmt_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">file_path =</span> <span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>) {</span>
<span id="cb227-243"><a href="#cb227-243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb227-244"><a href="#cb227-244" aria-hidden="true" tabindex="-1"></a>  prepared_data <span class="ot">&lt;-</span> <span class="fu">prepare_rmt_data</span>(file_path)</span>
<span id="cb227-245"><a href="#cb227-245" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-246"><a href="#cb227-246" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform comprehensive analysis</span></span>
<span id="cb227-247"><a href="#cb227-247" aria-hidden="true" tabindex="-1"></a>  analysis_results <span class="ot">&lt;-</span> <span class="fu">perform_comprehensive_analysis</span>(prepared_data)</span>
<span id="cb227-248"><a href="#cb227-248" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-249"><a href="#cb227-249" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create visualization</span></span>
<span id="cb227-250"><a href="#cb227-250" aria-hidden="true" tabindex="-1"></a>  rmt_plot <span class="ot">&lt;-</span> <span class="fu">create_rmt_plot</span>(analysis_results)</span>
<span id="cb227-251"><a href="#cb227-251" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-252"><a href="#cb227-252" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print results to console</span></span>
<span id="cb227-253"><a href="#cb227-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Statistical Test Details:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-254"><a href="#cb227-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Test Type:"</span>, analysis_results<span class="sc">$</span>test_results<span class="sc">$</span>test_type, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-255"><a href="#cb227-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"P-value:"</span>, analysis_results<span class="sc">$</span>test_results<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb227-256"><a href="#cb227-256" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-257"><a href="#cb227-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Contingency Table:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-258"><a href="#cb227-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>contingency_table)</span>
<span id="cb227-259"><a href="#cb227-259" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-260"><a href="#cb227-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Post-hoc Pairwise Comparisons (Bonferroni-corrected):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-261"><a href="#cb227-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>pairwise_results)</span>
<span id="cb227-262"><a href="#cb227-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-263"><a href="#cb227-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Excluded Countries:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-264"><a href="#cb227-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(analysis_results<span class="sc">$</span>excluded_countries_text, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-265"><a href="#cb227-265" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-266"><a href="#cb227-266" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the plot</span></span>
<span id="cb227-267"><a href="#cb227-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(rmt_plot)</span>
<span id="cb227-268"><a href="#cb227-268" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-269"><a href="#cb227-269" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results for potential further analysis</span></span>
<span id="cb227-270"><a href="#cb227-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(analysis_results)</span>
<span id="cb227-271"><a href="#cb227-271" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb227-272"><a href="#cb227-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-273"><a href="#cb227-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the analysis</span></span>
<span id="cb227-274"><a href="#cb227-274" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_rmt_analysis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Expected Frequency Analysis:
Minimum Expected Frequency: 13.17 
Cells with Expected Frequency &lt; 5: 0 out of 8 cells ( 0 %)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Statistical Test Details:
Test Type: Chi-Square with Continuity Correction 
P-value: 3.247836e-11 

Contingency Table:
           
            No RMT RMT
  Australia    256  65
  Canada        84   8
  UK           350  14
  USA          507 113

Post-hoc Pairwise Comparisons (Bonferroni-corrected):
           comparison      p_value  adj_p_value
1 Australia vs Canada 1.612145e-02 9.672870e-02
2     Australia vs UK 4.485762e-11 2.691457e-10
3    Australia vs USA 5.069555e-01 1.000000e+00
4        Canada vs UK 6.030667e-02 3.618400e-01
5       Canada vs USA 3.380404e-02 2.028243e-01
6           UK vs USA 1.586250e-10 9.517502e-10

Excluded Countries:
Italy, New Zealand, Germany, South Africa, Hungary, Albania, Argentina, Afghanistan, Czechia, Austria, Sweden, Belarus, Netherlands, Angola, Antigua and Barbuda, Armenia, Azerbaijan, Bangladesh, Belgium, Switzerland, Andorra, Bahamas, Brazil, Colombia, Denmark, Finland, Greece, Ireland, Marshall Islands, Palestine, Solomon Islands, Turkey, Uzbekistan, Vietnam </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="results-and-discussion-9" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="results-and-discussion-9"><span class="header-section-number">7.4</span> Results and Discussion</h2>
<p><strong>Statistical Significance</strong></p>
<p><em>Chi-square Test:</em> The chi-square test produced a statistic of approximately 44.25 with 7 degrees of freedom and a p-value of about 1.92×10−71.92×10−7. This highly significant result indicates that the distribution of education levels differs between the two groups (those who use RMT methods versus those who do not), i.e., the association is statistically significant.</p>
<p><em>Effect Size (Cramer’s V):</em> Cramer’s V was calculated to be around 0.169. Although not extremely large, this value suggests a modest association between education and the use of RMT methods. In social sciences, such effect sizes are common when dealing with categorical variables; even a modest effect size can be substantively meaningful.</p>
<p><strong>Detailed Group Comparison</strong></p>
<p><em>Group Proportions:</em> The summary statistics break down the relative frequencies of each education category for the “No” and “Yes” groups. For each education level, both counts and percentages were calculated. In the plots, you can see the proportions clearly marked with labels (which include counts and percentages), making it easy to compare how education distributions differ between the two groups.</p>
<p><em>Proportion Differences:</em> By pivoting the grouped data, we computed the differences in percentage points between the “Yes” and “No” groups for each education level. Education levels with the largest differences indicate where the distribution deviates most from what is expected under independence. These differences can help pinpoint which education categories are driving the overall chi-square statistic.</p>
<p><strong>Standardized Residuals</strong></p>
<p><em>Interpreting Residuals:</em> The standardized residuals provide additional insight into which specific cells of the contingency table contribute most to the chi-square result. A positive residual in a cell suggests that the observed count is higher than what is expected under the null hypothesis, whereas a negative residual indicates under representation. For example, if the “Doctorate” category shows a strongly positive residual for one group, it means that group has a higher-than-expected frequency of individuals holding a doctorate. Conversely, a negative value in another cell would point to an under representation relative to expectation.</p>
<p><em>Identifying Key Differences:</em> Reviewing these residuals allows us to identify which education levels are statistically noteworthy. For instance, if “Doctorate” or “Bachelors degree” have notable positive or negative deviations, these categories are influencing the overall association significantly.</p>
<p><strong>Visualization of Findings</strong></p>
<p>Two types of plots were generated: <em>Side-by-Side Bar Plot:</em> This plot displays the percentage breakdown of each education category for the “No” and “Yes” groups side by side. With detailed labels that include both the count and percentage, this visualization makes it straightforward to compare each education level between groups. The subtitle also reminds the viewer of the total sample size for each group, ensuring a complete context for interpretation.</p>
<p><em>Dot/Line Plot:</em> As an alternative, the dot/line plot connects the percentages across education categories for both groups. This plot emphasizes trends and differences in the pattern of education distribution. The connecting lines help to visualize how the relative positions of categories shift between groups. Both visualizations have been adjusted to ensure that all labels are fully visible by setting appropriate margins and enlarging plot height if necessary.</p>
<p><strong>Overall Interpretation</strong></p>
<p><em>Significant Association:</em> The significant chi-square result confirms that the pattern of education across groups is not random. There is a statistically significant association between having a particular education level and whether someone uses RMT methods.</p>
<p><em>Magnitude and Specific Contributions:</em> The moderate effect size (Cramer’s V ≈ 0.169) implies that while the association exists, it is of modest strength. Importantly, the examination of standardized residuals and proportion differences shines a light on which specific education categories drive this association. These insights might be used to explore further why certain education levels are more, or less, likely to be associated with RMT method usage.</p>
<p><em>Practical Implications:</em> Depending on the context of the study (e.g., educational policies, targeted interventions, or market segmentation), these findings could inform decision-making by pinpointing demographic groups for further investigation or tailored strategies. For instance, if a particular education category is underrepresented among RMT users, it might signal potential barriers or areas for targeted improvement.</p>
<p><strong>Summary</strong></p>
<p>The findings indicate that country of education is significantly associated with the use of RMT methods. The statistical tests, along with the calculated effect size and detailed graphical representations, provide a robust basis for interpreting the differences across education levels. The analysis not only confirms the presence of differences but also identifies which education categories are most influential in driving these differences, offering valuable insights for further study or practical applications.</p>
<p><strong>Combined Groups</strong></p>
<p>This analysis examines the relationship between country of education and Respiratory Muscle Training (RMT) usage among participants. The data covers four major English-speaking countries: Australia, Canada, the UK, and the USA, with 34 additional countries excluded due to smaller sample sizes.</p>
<p><strong>Statistical Significance</strong></p>
<p>The chi-square test with continuity correction yielded a highly significant result (p &lt; 0.001), indicating a strong association between country of education and RMT usage. All expected cell frequencies were above the minimum threshold of 5 (minimum = 13.17), confirming that the chi-square test was appropriate for this analysis.</p>
<p><strong>RMT Usage Patterns by Country</strong></p>
<p>From the contingency table, we can observe distinct patterns in RMT adoption:</p>
<ol type="1">
<li><p><strong>Australia</strong>: 65 out of 321 participants (20.2%) use RMT</p></li>
<li><p><strong>USA</strong>: 113 out of 620 participants (18.2%) use RMT</p></li>
<li><p><strong>Canada</strong>: 8 out of 92 participants (8.7%) use RMT</p></li>
<li><p><strong>UK</strong>: 14 out of 364 participants (3.8%) use RMT</p></li>
</ol>
<p>This reveals a striking pattern where participants educated in Australia and the USA have RMT adoption rates approximately 2-5 times higher than those educated in Canada and the UK.</p>
<p><strong>Post-hoc Pairwise Comparisons</strong></p>
<p>The Bonferroni-corrected pairwise comparisons identify which specific country differences are statistically significant:</p>
<ol type="1">
<li><strong>Significant Differences</strong> (p &lt; 0.05 after adjustment):</li>
</ol>
<ul>
<li><p>Australia vs.&nbsp;UK (p = 2.69 × 10^-10): Australian-educated participants are significantly more likely to use RMT than UK-educated participants</p></li>
<li><p>USA vs.&nbsp;UK (p = 9.52 × 10^-10): US-educated participants are significantly more likely to use RMT than UK-educated participants</p></li>
</ul>
<ol start="2" type="1">
<li><strong>Non-Significant Differences</strong> (p &gt; 0.05 after adjustment):</li>
</ol>
<ul>
<li><p>Australia vs.&nbsp;Canada (p = 0.097): Despite the substantial percentage difference (20.2% vs 8.7%), this comparison falls just short of significance after Bonferroni correction</p></li>
<li><p>Australia vs.&nbsp;USA (p = 1.0): Very similar RMT usage rates between these countries</p></li>
<li><p>Canada vs.&nbsp;UK (p = 0.362): Both have lower RMT usage rates</p></li>
<li><p>Canada vs.&nbsp;USA (p = 0.203): Not statistically significant after correction</p></li>
</ul>
<p><strong>Implications and Potential Explanations</strong></p>
<p>Several factors might explain these international differences in RMT adoption based on education location:</p>
<ol type="1">
<li><p><strong>Educational Approaches</strong>: Australia and the USA may emphasize technology integration in music education more heavily than the UK and Canada. This could reflect differences in curriculum design, pedagogical approaches, or resource allocation within educational institutions.</p></li>
<li><p><strong>Technological Infrastructure in Educational Settings</strong>: Educational institutions in Australia and the USA might have greater access to technology resources, better digital infrastructure, or more technology-oriented training programs.</p></li>
<li><p><strong>Cultural Attitudes Toward Technology in Education</strong>: Different educational systems may have varying cultural perspectives on the role of technology in learning and performance. These cultural attitudes could shape how students are taught to view technological aids.</p></li>
<li><p><strong>Educational Investment in Technology</strong>: Countries may differ in their funding priorities for music education, with some investing more heavily in technological resources and training.</p></li>
<li><p><strong>Different Teaching Traditions</strong>: Musical education may follow different teaching traditions and philosophies across these countries, with some more receptive to technological innovation than others.</p></li>
</ol>
<p><strong>Broader Context</strong></p>
<p>The pattern observed here—with Australia and the USA having higher RMT adoption rates than the UK and Canada—suggests a potential divide in approaches to music education and technology integration across these major English-speaking countries. This divide persists despite shared language and many cultural similarities, highlighting how educational practices can diverge significantly across national boundaries.</p>
<p><strong>Limitations and Considerations</strong></p>
<ol type="1">
<li><p><strong>Sample Size Variations</strong>: The number of participants varies considerably across countries (from 92 in Canada to 620 in the USA), affecting the precision of estimates.</p></li>
<li><p><strong>Excluded Countries</strong>: 34 countries were excluded from the analysis due to small sample sizes. This extensive list includes several European countries (Germany, Italy, Netherlands, etc.) and countries from various regions worldwide, limiting the global representativeness of the findings.</p></li>
<li><p><strong>Historical Context</strong>: The data doesn’t indicate when participants were educated in these countries, so the findings may reflect historical differences in educational approaches across different time periods.</p></li>
<li><p><strong>Education vs.&nbsp;Residence</strong>: This analysis focuses on country of education rather than current residence, which may provide insights into formative influences rather than current environmental factors affecting RMT usage.</p></li>
</ol>
<p><strong>Conclusion</strong></p>
<p>The analysis provides strong evidence that country of education is significantly associated with RMT usage, with particularly pronounced differences between Australia/USA and the UK. These findings suggest that educational systems and approaches play an important role in shaping technology adoption practices among musicians. Understanding these patterns could help inform international educational policy, curriculum development, and technology integration strategies in music education.</p>
</section>
</section>
<section id="roles" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Roles</h1>
<section id="descriptive-stats-5" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="descriptive-stats-5"><span class="header-section-number">8.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the role data with proper labels</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>role_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(role_MAX1, role_MAX2, role_MAX3, role_MAX4) <span class="sc">%&gt;%</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), </span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"role_number"</span>, </span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"role_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(role_type)) <span class="sc">%&gt;%</span>  <span class="co"># Remove NA values</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">role_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>      role_type <span class="sc">==</span> <span class="st">"Performer"</span> <span class="sc">~</span> <span class="st">"Performer"</span>,</span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>      role_type <span class="sc">==</span> <span class="st">"I play for leisure"</span> <span class="sc">~</span> <span class="st">"Amateur player"</span>,</span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>      role_type <span class="sc">==</span> <span class="st">"Student"</span> <span class="sc">~</span> <span class="st">"Student"</span>,</span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>      role_type <span class="sc">==</span> <span class="st">"Teacher"</span> <span class="sc">~</span> <span class="st">"Teacher"</span>,</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(role_type)</span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-21"><a href="#cb230-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table for chi-square test</span></span>
<span id="cb230-22"><a href="#cb230-22" aria-hidden="true" tabindex="-1"></a>role_table <span class="ot">&lt;-</span> <span class="fu">table</span>(role_data<span class="sc">$</span>role_type)</span>
<span id="cb230-23"><a href="#cb230-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-24"><a href="#cb230-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test</span></span>
<span id="cb230-25"><a href="#cb230-25" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(role_table)</span>
<span id="cb230-26"><a href="#cb230-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-27"><a href="#cb230-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cramer's V manually</span></span>
<span id="cb230-28"><a href="#cb230-28" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(role_table)</span>
<span id="cb230-29"><a href="#cb230-29" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">length</span>(role_table) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb230-30"><a href="#cb230-30" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n <span class="sc">*</span> df))</span>
<span id="cb230-31"><a href="#cb230-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-32"><a href="#cb230-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb230-33"><a href="#cb230-33" aria-hidden="true" tabindex="-1"></a>role_summary <span class="ot">&lt;-</span> role_data <span class="sc">%&gt;%</span></span>
<span id="cb230-34"><a href="#cb230-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(role_type) <span class="sc">%&gt;%</span></span>
<span id="cb230-35"><a href="#cb230-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb230-36"><a href="#cb230-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb230-37"><a href="#cb230-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb230-38"><a href="#cb230-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb230-39"><a href="#cb230-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb230-40"><a href="#cb230-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb230-41"><a href="#cb230-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_prop =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> <span class="fu">sum</span>(count)), <span class="co"># Standard error</span></span>
<span id="cb230-42"><a href="#cb230-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower =</span> percentage <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se_prop),  <span class="co"># 95% CI lower bound</span></span>
<span id="cb230-43"><a href="#cb230-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper =</span> percentage <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se_prop)   <span class="co"># 95% CI upper bound</span></span>
<span id="cb230-44"><a href="#cb230-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb230-45"><a href="#cb230-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb230-46"><a href="#cb230-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-47"><a href="#cb230-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb230-48"><a href="#cb230-48" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of Roles Among Wind Instrument Musicians"</span></span>
<span id="cb230-49"><a href="#cb230-49" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(role_summary, </span>
<span id="cb230-50"><a href="#cb230-50" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> percentage, </span>
<span id="cb230-51"><a href="#cb230-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">reorder</span>(<span class="fu">paste0</span>(role_type, <span class="st">"</span><span class="sc">\n</span><span class="st">(N="</span>, count, <span class="st">")"</span>), percentage))) <span class="sc">+</span></span>
<span id="cb230-52"><a href="#cb230-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb230-53"><a href="#cb230-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper), <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb230-54"><a href="#cb230-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb230-55"><a href="#cb230-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage), </span>
<span id="cb230-56"><a href="#cb230-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> ci_upper),  <span class="co"># Position labels at the end of error bars</span></span>
<span id="cb230-57"><a href="#cb230-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>,  <span class="co"># Slight additional offset</span></span>
<span id="cb230-58"><a href="#cb230-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb230-59"><a href="#cb230-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb230-60"><a href="#cb230-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb230-61"><a href="#cb230-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> plot_title,</span>
<span id="cb230-62"><a href="#cb230-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Percentage of Respondents"</span>,</span>
<span id="cb230-63"><a href="#cb230-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Role (with Total N)"</span>,</span>
<span id="cb230-64"><a href="#cb230-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span></span>
<span id="cb230-65"><a href="#cb230-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb230-66"><a href="#cb230-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb230-67"><a href="#cb230-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb230-68"><a href="#cb230-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb230-69"><a href="#cb230-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb230-70"><a href="#cb230-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb230-71"><a href="#cb230-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb230-72"><a href="#cb230-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb230-73"><a href="#cb230-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb230-74"><a href="#cb230-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb230-75"><a href="#cb230-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(role_summary<span class="sc">$</span>ci_upper) <span class="sc">*</span> <span class="fl">1.2</span>),  <span class="co"># Extend x-axis to accommodate labels</span></span>
<span id="cb230-76"><a href="#cb230-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>)  <span class="co"># Convert to percentage</span></span>
<span id="cb230-77"><a href="#cb230-77" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb230-78"><a href="#cb230-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-79"><a href="#cb230-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical analysis results</span></span>
<span id="cb230-80"><a href="#cb230-80" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb230-81"><a href="#cb230-81" aria-hidden="true" tabindex="-1"></a><span class="st">Statistical Analysis of Role Distribution\</span></span>
<span id="cb230-82"><a href="#cb230-82" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Statistical Analysis of Role Distribution</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==========================================\</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="st">\</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>==========================================</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. Frequency Distribution:\</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1. Frequency Distribution:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(role_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  role_type      count percentage se_prop ci_lower ci_upper
  &lt;chr&gt;          &lt;int&gt;      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Performer        970       34.5   0.897     32.8     36.3
2 Amateur player   746       26.6   0.833     24.9     28.2
3 Student          562       20.0   0.755     18.5     21.5
4 Teacher          531       18.9   0.739     17.5     20.4</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="st">2. Chi-square Test of Equal Proportions:\</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
2. Chi-square Test of Equal Proportions:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  role_table
X-squared = 174.58, df = 3, p-value &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="st">3. Effect Size:\</span></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
3. Effect Size:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cramer's V:"</span>, cramer_v, <span class="st">"\</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer's V: 0.1439343 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate post-hoc pairwise comparisons with Bonferroni correction</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>roles <span class="ot">&lt;-</span> <span class="fu">unique</span>(role_data<span class="sc">$</span>role_type)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>n_comparisons <span class="ot">&lt;-</span> <span class="fu">choose</span>(<span class="fu">length</span>(roles), <span class="dv">2</span>)</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="st">4. Post-hoc Pairwise Comparisons (Bonferroni-corrected):\</span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
4. Post-hoc Pairwise Comparisons (Bonferroni-corrected):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Comparison =</span> <span class="fu">character</span>(),</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Chi_square =</span> <span class="fu">numeric</span>(),</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(roles)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(roles)) {</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a>    role1 <span class="ot">&lt;-</span> roles[i]</span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a>    role2 <span class="ot">&lt;-</span> roles[j]</span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create 2x2 contingency table for this pair</span></span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a>    counts <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(role_data<span class="sc">$</span>role_type <span class="sc">==</span> role1),</span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(role_data<span class="sc">$</span>role_type <span class="sc">==</span> role2)</span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb248-18"><a href="#cb248-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb248-19"><a href="#cb248-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform chi-square test</span></span>
<span id="cb248-20"><a href="#cb248-20" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts)</span>
<span id="cb248-21"><a href="#cb248-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb248-22"><a href="#cb248-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb248-23"><a href="#cb248-23" aria-hidden="true" tabindex="-1"></a>    pairwise_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_results, <span class="fu">data.frame</span>(</span>
<span id="cb248-24"><a href="#cb248-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">Comparison =</span> <span class="fu">paste</span>(role1, <span class="st">"vs"</span>, role2),</span>
<span id="cb248-25"><a href="#cb248-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">Chi_square =</span> test<span class="sc">$</span>statistic,</span>
<span id="cb248-26"><a href="#cb248-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">P_value =</span> <span class="fu">p.adjust</span>(test<span class="sc">$</span>p.value, <span class="at">method =</span> <span class="st">"bonferroni"</span>, <span class="at">n =</span> n_comparisons)</span>
<span id="cb248-27"><a href="#cb248-27" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb248-28"><a href="#cb248-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb248-29"><a href="#cb248-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb248-30"><a href="#cb248-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-31"><a href="#cb248-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            Comparison  Chi_square      P_value
X-squared    Student vs Amateur player  25.8837920 2.175606e-06
X-squared1        Student vs Performer 108.6579634 1.157110e-24
X-squared2          Student vs Teacher   0.8792315 1.000000e+00
X-squared3 Amateur player vs Performer  29.2400932 3.836539e-07
X-squared4   Amateur player vs Teacher  36.1981206 1.069454e-08
X-squared5        Performer vs Teacher 128.3950700 5.519032e-29</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-10" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="results-and-discussion-10"><span class="header-section-number">8.1.1</span> Results and Discussion</h3>
<p>Looking at the distribution of roles among wind instrumentalist participants (N=1558):</p>
<p>• “I play for leisure” is the most common role with 970 responses (34.5% of total responses)</p>
<p>• “Student” is the second most frequent with 746 responses (26.6%)</p>
<p>• “Performer” follows with 562 responses (20.0%)</p>
<p>• “Teacher” has the lowest frequency with 531 responses (18.9%)</p>
<p>A key observation is that the total number of responses (2,809) exceeds the number of participants (1,558), indicating that many participants hold multiple roles (e.g., someone might be both a teacher and a performer). On average, this suggests that participants reported approximately 1.8 roles each (2,809/1,558).</p>
<p>The data shows that while recreational playing is the predominant role, there’s a substantial representation of professional and educational roles (teachers, performers, and students) in the sample.</p>
</section>
</section>
<section id="comparison-stats-complex" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="comparison-stats-complex"><span class="header-section-number">8.2</span> Comparison Stats complex</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Data Preparation Function</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>prepare_role_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path) {</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the data</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure RMTMethods_YN is numeric and handle potential NA values</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">as.numeric</span>(RMTMethods_YN),</span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(RMTMethods_YN), <span class="dv">0</span>, RMTMethods_YN)</span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process the data with enhanced error handling</span></span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true" tabindex="-1"></a>    role_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb251-16"><a href="#cb251-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(RMTMethods_YN, <span class="fu">starts_with</span>(<span class="st">"role_MAX"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb251-17"><a href="#cb251-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(</span>
<span id="cb251-18"><a href="#cb251-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"role_MAX"</span>), </span>
<span id="cb251-19"><a href="#cb251-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"role_number"</span>, </span>
<span id="cb251-20"><a href="#cb251-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"role_type"</span></span>
<span id="cb251-21"><a href="#cb251-21" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb251-22"><a href="#cb251-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(role_type)) <span class="sc">%&gt;%</span></span>
<span id="cb251-23"><a href="#cb251-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb251-24"><a href="#cb251-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Comprehensive role type mapping</span></span>
<span id="cb251-25"><a href="#cb251-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">role_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb251-26"><a href="#cb251-26" aria-hidden="true" tabindex="-1"></a>          role_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Performer"</span>, <span class="st">"Professional"</span>) <span class="sc">~</span> <span class="st">"Professional Performer"</span>,</span>
<span id="cb251-27"><a href="#cb251-27" aria-hidden="true" tabindex="-1"></a>          role_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"I play for leisure"</span>, <span class="st">"Amateur"</span>) <span class="sc">~</span> <span class="st">"Amateur Performer"</span>,</span>
<span id="cb251-28"><a href="#cb251-28" aria-hidden="true" tabindex="-1"></a>          role_type <span class="sc">==</span> <span class="st">"Student"</span> <span class="sc">~</span> <span class="st">"Student"</span>,</span>
<span id="cb251-29"><a href="#cb251-29" aria-hidden="true" tabindex="-1"></a>          role_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Teacher"</span>, <span class="st">"Educator"</span>) <span class="sc">~</span> <span class="st">"Wind Instrument Teacher"</span>,</span>
<span id="cb251-30"><a href="#cb251-30" aria-hidden="true" tabindex="-1"></a>          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(role_type)</span>
<span id="cb251-31"><a href="#cb251-31" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb251-32"><a href="#cb251-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ensure RMTMethods_YN is properly coded</span></span>
<span id="cb251-33"><a href="#cb251-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(</span>
<span id="cb251-34"><a href="#cb251-34" aria-hidden="true" tabindex="-1"></a>          RMTMethods_YN, </span>
<span id="cb251-35"><a href="#cb251-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb251-36"><a href="#cb251-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>)</span>
<span id="cb251-37"><a href="#cb251-37" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb251-38"><a href="#cb251-38" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb251-39"><a href="#cb251-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-40"><a href="#cb251-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(role_data)</span>
<span id="cb251-41"><a href="#cb251-41" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb251-42"><a href="#cb251-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error in data preparation:"</span>, e<span class="sc">$</span>message))</span>
<span id="cb251-43"><a href="#cb251-43" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb251-44"><a href="#cb251-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb251-45"><a href="#cb251-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-46"><a href="#cb251-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprehensive Role Distribution Analysis</span></span>
<span id="cb251-47"><a href="#cb251-47" aria-hidden="true" tabindex="-1"></a>analyze_role_distribution <span class="ot">&lt;-</span> <span class="cf">function</span>(role_data) {</span>
<span id="cb251-48"><a href="#cb251-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Comprehensive summary statistics</span></span>
<span id="cb251-49"><a href="#cb251-49" aria-hidden="true" tabindex="-1"></a>  role_summary <span class="ot">&lt;-</span> role_data <span class="sc">%&gt;%</span></span>
<span id="cb251-50"><a href="#cb251-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN, role_type) <span class="sc">%&gt;%</span></span>
<span id="cb251-51"><a href="#cb251-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb251-52"><a href="#cb251-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb251-53"><a href="#cb251-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb251-54"><a href="#cb251-54" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb251-55"><a href="#cb251-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb251-56"><a href="#cb251-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb251-57"><a href="#cb251-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_in_group =</span> <span class="fu">sum</span>(count),</span>
<span id="cb251-58"><a href="#cb251-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">percentage =</span> count <span class="sc">/</span> total_in_group <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb251-59"><a href="#cb251-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">se_prop =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> total_in_group),</span>
<span id="cb251-60"><a href="#cb251-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_lower =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, percentage <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se_prop)),</span>
<span id="cb251-61"><a href="#cb251-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_upper =</span> <span class="fu">pmin</span>(<span class="dv">100</span>, percentage <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se_prop))</span>
<span id="cb251-62"><a href="#cb251-62" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb251-63"><a href="#cb251-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb251-64"><a href="#cb251-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-65"><a href="#cb251-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Statistical Testing</span></span>
<span id="cb251-66"><a href="#cb251-66" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb251-67"><a href="#cb251-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(rmt <span class="cf">in</span> <span class="fu">unique</span>(role_data<span class="sc">$</span>RMTMethods_YN)) {</span>
<span id="cb251-68"><a href="#cb251-68" aria-hidden="true" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> role_data[role_data<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> rmt, ]</span>
<span id="cb251-69"><a href="#cb251-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-70"><a href="#cb251-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Contingency table</span></span>
<span id="cb251-71"><a href="#cb251-71" aria-hidden="true" tabindex="-1"></a>    role_table <span class="ot">&lt;-</span> <span class="fu">table</span>(subset_data<span class="sc">$</span>role_type)</span>
<span id="cb251-72"><a href="#cb251-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-73"><a href="#cb251-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Chi-square test</span></span>
<span id="cb251-74"><a href="#cb251-74" aria-hidden="true" tabindex="-1"></a>    chi_test <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb251-75"><a href="#cb251-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">chisq.test</span>(role_table),</span>
<span id="cb251-76"><a href="#cb251-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">warning =</span> <span class="cf">function</span>(w) <span class="fu">fisher.test</span>(role_table)</span>
<span id="cb251-77"><a href="#cb251-77" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb251-78"><a href="#cb251-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-79"><a href="#cb251-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pairwise comparisons</span></span>
<span id="cb251-80"><a href="#cb251-80" aria-hidden="true" tabindex="-1"></a>    pairwise_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb251-81"><a href="#cb251-81" aria-hidden="true" tabindex="-1"></a>    roles <span class="ot">&lt;-</span> <span class="fu">unique</span>(subset_data<span class="sc">$</span>role_type)</span>
<span id="cb251-82"><a href="#cb251-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-83"><a href="#cb251-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(roles) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb251-84"><a href="#cb251-84" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(roles)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb251-85"><a href="#cb251-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(roles)) {</span>
<span id="cb251-86"><a href="#cb251-86" aria-hidden="true" tabindex="-1"></a>          role1 <span class="ot">&lt;-</span> roles[i]</span>
<span id="cb251-87"><a href="#cb251-87" aria-hidden="true" tabindex="-1"></a>          role2 <span class="ot">&lt;-</span> roles[j]</span>
<span id="cb251-88"><a href="#cb251-88" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb251-89"><a href="#cb251-89" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Compare proportions of two roles</span></span>
<span id="cb251-90"><a href="#cb251-90" aria-hidden="true" tabindex="-1"></a>          counts1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(subset_data<span class="sc">$</span>role_type <span class="sc">==</span> role1)</span>
<span id="cb251-91"><a href="#cb251-91" aria-hidden="true" tabindex="-1"></a>          counts2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(subset_data<span class="sc">$</span>role_type <span class="sc">==</span> role2)</span>
<span id="cb251-92"><a href="#cb251-92" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb251-93"><a href="#cb251-93" aria-hidden="true" tabindex="-1"></a>          test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(counts1, counts2), </span>
<span id="cb251-94"><a href="#cb251-94" aria-hidden="true" tabindex="-1"></a>                            <span class="at">n =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(subset_data), <span class="fu">nrow</span>(subset_data)))</span>
<span id="cb251-95"><a href="#cb251-95" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb251-96"><a href="#cb251-96" aria-hidden="true" tabindex="-1"></a>          pairwise_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_results, <span class="fu">data.frame</span>(</span>
<span id="cb251-97"><a href="#cb251-97" aria-hidden="true" tabindex="-1"></a>            <span class="at">comparison =</span> <span class="fu">paste</span>(role1, <span class="st">"vs"</span>, role2),</span>
<span id="cb251-98"><a href="#cb251-98" aria-hidden="true" tabindex="-1"></a>            <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb251-99"><a href="#cb251-99" aria-hidden="true" tabindex="-1"></a>            <span class="at">statistic =</span> test<span class="sc">$</span>statistic</span>
<span id="cb251-100"><a href="#cb251-100" aria-hidden="true" tabindex="-1"></a>          ))</span>
<span id="cb251-101"><a href="#cb251-101" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb251-102"><a href="#cb251-102" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb251-103"><a href="#cb251-103" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb251-104"><a href="#cb251-104" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Apply Bonferroni correction</span></span>
<span id="cb251-105"><a href="#cb251-105" aria-hidden="true" tabindex="-1"></a>      pairwise_results<span class="sc">$</span>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(</span>
<span id="cb251-106"><a href="#cb251-106" aria-hidden="true" tabindex="-1"></a>        pairwise_results<span class="sc">$</span>p_value, </span>
<span id="cb251-107"><a href="#cb251-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb251-108"><a href="#cb251-108" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb251-109"><a href="#cb251-109" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb251-110"><a href="#cb251-110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-111"><a href="#cb251-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb251-112"><a href="#cb251-112" aria-hidden="true" tabindex="-1"></a>    test_results[[<span class="fu">as.character</span>(rmt)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb251-113"><a href="#cb251-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">chi_test =</span> chi_test,</span>
<span id="cb251-114"><a href="#cb251-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">pairwise_results =</span> pairwise_results</span>
<span id="cb251-115"><a href="#cb251-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb251-116"><a href="#cb251-116" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb251-117"><a href="#cb251-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-118"><a href="#cb251-118" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return comprehensive results</span></span>
<span id="cb251-119"><a href="#cb251-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb251-120"><a href="#cb251-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary =</span> role_summary,</span>
<span id="cb251-121"><a href="#cb251-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_results =</span> test_results</span>
<span id="cb251-122"><a href="#cb251-122" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb251-123"><a href="#cb251-123" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb251-124"><a href="#cb251-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-125"><a href="#cb251-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization Function</span></span>
<span id="cb251-126"><a href="#cb251-126" aria-hidden="true" tabindex="-1"></a>create_role_distribution_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(analysis_results) {</span>
<span id="cb251-127"><a href="#cb251-127" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare plot data</span></span>
<span id="cb251-128"><a href="#cb251-128" aria-hidden="true" tabindex="-1"></a>  role_summary <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>summary</span>
<span id="cb251-129"><a href="#cb251-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-130"><a href="#cb251-130" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create labels for RMTMethods_YN with total N</span></span>
<span id="cb251-131"><a href="#cb251-131" aria-hidden="true" tabindex="-1"></a>  rmt_labels <span class="ot">&lt;-</span> role_summary <span class="sc">%&gt;%</span></span>
<span id="cb251-132"><a href="#cb251-132" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb251-133"><a href="#cb251-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total_n =</span> <span class="fu">first</span>(total_in_group)) <span class="sc">%&gt;%</span></span>
<span id="cb251-134"><a href="#cb251-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(RMTMethods_YN, <span class="st">" (N="</span>, total_n, <span class="st">")"</span>))</span>
<span id="cb251-135"><a href="#cb251-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-136"><a href="#cb251-136" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate maximum confidence interval for x-axis limits</span></span>
<span id="cb251-137"><a href="#cb251-137" aria-hidden="true" tabindex="-1"></a>  max_ci_upper <span class="ot">&lt;-</span> <span class="fu">max</span>(role_summary<span class="sc">$</span>ci_upper)</span>
<span id="cb251-138"><a href="#cb251-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-139"><a href="#cb251-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the plot</span></span>
<span id="cb251-140"><a href="#cb251-140" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(role_summary, </span>
<span id="cb251-141"><a href="#cb251-141" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> percentage, </span>
<span id="cb251-142"><a href="#cb251-142" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">reorder</span>(role_type, percentage),</span>
<span id="cb251-143"><a href="#cb251-143" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="fu">factor</span>(RMTMethods_YN))) <span class="sc">+</span></span>
<span id="cb251-144"><a href="#cb251-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb251-145"><a href="#cb251-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(</span>
<span id="cb251-146"><a href="#cb251-146" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper), </span>
<span id="cb251-147"><a href="#cb251-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb251-148"><a href="#cb251-148" aria-hidden="true" tabindex="-1"></a>      <span class="at">height =</span> <span class="fl">0.2</span></span>
<span id="cb251-149"><a href="#cb251-149" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb251-150"><a href="#cb251-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb251-151"><a href="#cb251-151" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb251-152"><a href="#cb251-152" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"n=%d (%.1f%%)"</span>, </span>
<span id="cb251-153"><a href="#cb251-153" aria-hidden="true" tabindex="-1"></a>                        count, </span>
<span id="cb251-154"><a href="#cb251-154" aria-hidden="true" tabindex="-1"></a>                        percentage),</span>
<span id="cb251-155"><a href="#cb251-155" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> ci_upper</span>
<span id="cb251-156"><a href="#cb251-156" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb251-157"><a href="#cb251-157" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb251-158"><a href="#cb251-158" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>,  <span class="co"># Increased spacing</span></span>
<span id="cb251-159"><a href="#cb251-159" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb251-160"><a href="#cb251-160" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb251-161"><a href="#cb251-161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb251-162"><a href="#cb251-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Distribution of Roles Among Wind Instrument Musicians by RMT Methods Use"</span>,</span>
<span id="cb251-163"><a href="#cb251-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Percentage within RMT Methods Group"</span>,</span>
<span id="cb251-164"><a href="#cb251-164" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Role"</span>,</span>
<span id="cb251-165"><a href="#cb251-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"RMT Methods Use"</span>,</span>
<span id="cb251-166"><a href="#cb251-166" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span></span>
<span id="cb251-167"><a href="#cb251-167" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb251-168"><a href="#cb251-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb251-169"><a href="#cb251-169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb251-170"><a href="#cb251-170" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb251-171"><a href="#cb251-171" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb251-172"><a href="#cb251-172" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb251-173"><a href="#cb251-173" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb251-174"><a href="#cb251-174" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb251-175"><a href="#cb251-175" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb251-176"><a href="#cb251-176" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb251-177"><a href="#cb251-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(</span>
<span id="cb251-178"><a href="#cb251-178" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="st">"Set2"</span>,</span>
<span id="cb251-179"><a href="#cb251-179" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> rmt_labels<span class="sc">$</span>label</span>
<span id="cb251-180"><a href="#cb251-180" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb251-181"><a href="#cb251-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb251-182"><a href="#cb251-182" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_ci_upper <span class="sc">*</span> <span class="fl">1.3</span>),  <span class="co"># Increased space for labels</span></span>
<span id="cb251-183"><a href="#cb251-183" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb251-184"><a href="#cb251-184" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb251-185"><a href="#cb251-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-186"><a href="#cb251-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb251-187"><a href="#cb251-187" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb251-188"><a href="#cb251-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-189"><a href="#cb251-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Main Execution Function</span></span>
<span id="cb251-190"><a href="#cb251-190" aria-hidden="true" tabindex="-1"></a>run_comprehensive_role_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb251-191"><a href="#cb251-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_path =</span> <span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span></span>
<span id="cb251-192"><a href="#cb251-192" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb251-193"><a href="#cb251-193" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb251-194"><a href="#cb251-194" aria-hidden="true" tabindex="-1"></a>  role_data <span class="ot">&lt;-</span> <span class="fu">prepare_role_data</span>(file_path)</span>
<span id="cb251-195"><a href="#cb251-195" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-196"><a href="#cb251-196" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform comprehensive analysis</span></span>
<span id="cb251-197"><a href="#cb251-197" aria-hidden="true" tabindex="-1"></a>  analysis_results <span class="ot">&lt;-</span> <span class="fu">analyze_role_distribution</span>(role_data)</span>
<span id="cb251-198"><a href="#cb251-198" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-199"><a href="#cb251-199" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create visualization</span></span>
<span id="cb251-200"><a href="#cb251-200" aria-hidden="true" tabindex="-1"></a>  role_plot <span class="ot">&lt;-</span> <span class="fu">create_role_distribution_plot</span>(analysis_results)</span>
<span id="cb251-201"><a href="#cb251-201" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-202"><a href="#cb251-202" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print comprehensive results</span></span>
<span id="cb251-203"><a href="#cb251-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Comprehensive Role Distribution Analysis</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb251-204"><a href="#cb251-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=======================================</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb251-205"><a href="#cb251-205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-206"><a href="#cb251-206" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Print overall distribution summary</span></span>
<span id="cb251-207"><a href="#cb251-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"1. Distribution by RMT Methods Use and Role:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb251-208"><a href="#cb251-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>summary)</span>
<span id="cb251-209"><a href="#cb251-209" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-210"><a href="#cb251-210" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Print test results for each RMT group</span></span>
<span id="cb251-211"><a href="#cb251-211" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(rmt <span class="cf">in</span> <span class="fu">names</span>(analysis_results<span class="sc">$</span>test_results)) {</span>
<span id="cb251-212"><a href="#cb251-212" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">2. Statistical Analysis for %s Group:</span><span class="sc">\n</span><span class="st">"</span>, rmt))</span>
<span id="cb251-213"><a href="#cb251-213" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-214"><a href="#cb251-214" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Chi-square/Fisher test results</span></span>
<span id="cb251-215"><a href="#cb251-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Chi-square/Fisher Test:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb251-216"><a href="#cb251-216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(analysis_results<span class="sc">$</span>test_results[[rmt]]<span class="sc">$</span>chi_test)</span>
<span id="cb251-217"><a href="#cb251-217" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb251-218"><a href="#cb251-218" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pairwise comparisons</span></span>
<span id="cb251-219"><a href="#cb251-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise Comparisons (Bonferroni-corrected):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb251-220"><a href="#cb251-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(analysis_results<span class="sc">$</span>test_results[[rmt]]<span class="sc">$</span>pairwise_results)</span>
<span id="cb251-221"><a href="#cb251-221" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb251-222"><a href="#cb251-222" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-223"><a href="#cb251-223" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the plot</span></span>
<span id="cb251-224"><a href="#cb251-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(role_plot)</span>
<span id="cb251-225"><a href="#cb251-225" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb251-226"><a href="#cb251-226" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return full results for potential further analysis</span></span>
<span id="cb251-227"><a href="#cb251-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(analysis_results)</span>
<span id="cb251-228"><a href="#cb251-228" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb251-229"><a href="#cb251-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-230"><a href="#cb251-230" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the analysis</span></span>
<span id="cb251-231"><a href="#cb251-231" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_comprehensive_role_analysis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Comprehensive Role Distribution Analysis
=======================================

1. Distribution by RMT Methods Use and Role:
# A tibble: 8 × 8
  RMTMethods_YN role_type       count total_in_group percentage se_prop ci_lower
  &lt;fct&gt;         &lt;chr&gt;           &lt;int&gt;          &lt;int&gt;      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 No RMT        Amateur Perfor…   676           2361       28.6   0.930     26.8
2 No RMT        Professional P…   807           2361       34.2   0.976     32.3
3 No RMT        Student           475           2361       20.1   0.825     18.5
4 No RMT        Wind Instrumen…   403           2361       17.1   0.774     15.6
5 RMT           Amateur Perfor…    70            448       15.6   1.72      12.3
6 RMT           Professional P…   163            448       36.4   2.27      31.9
7 RMT           Student            87            448       19.4   1.87      15.8
8 RMT           Wind Instrumen…   128            448       28.6   2.13      24.4
# ℹ 1 more variable: ci_upper &lt;dbl&gt;

2. Statistical Analysis for No RMT Group:
Chi-square/Fisher Test:

    Chi-squared test for given probabilities

data:  role_table
X-squared = 173.96, df = 3, p-value &lt; 2.2e-16


Pairwise Comparisons (Bonferroni-corrected):
                                                  comparison      p_value
X-squared                       Student vs Amateur Performer 1.210790e-11
X-squared1                 Student vs Professional Performer 2.455137e-27
X-squared2                Student vs Wind Instrument Teacher 7.913914e-03
X-squared3       Amateur Performer vs Professional Performer 4.582419e-05
X-squared4      Amateur Performer vs Wind Instrument Teacher 4.204100e-21
X-squared5 Professional Performer vs Wind Instrument Teacher 3.833551e-41
            statistic   p_adjusted
X-squared   45.953733 7.264738e-11
X-squared1 117.310126 1.473082e-26
X-squared2   7.052852 4.748348e-02
X-squared3  16.613479 2.749452e-04
X-squared4  88.875729 2.522460e-20
X-squared5 180.466335 2.300131e-40

2. Statistical Analysis for RMT Group:
Chi-square/Fisher Test:

    Chi-squared test for given probabilities

data:  role_table
X-squared = 46.839, df = 3, p-value = 3.76e-10


Pairwise Comparisons (Bonferroni-corrected):
                                                  comparison      p_value
X-squared        Professional Performer vs Amateur Performer 2.441852e-12
X-squared1                 Professional Performer vs Student 2.318768e-08
X-squared2 Professional Performer vs Wind Instrument Teacher 1.528556e-02
X-squared3                      Amateur Performer vs Student 1.597081e-01
X-squared4      Amateur Performer vs Wind Instrument Teacher 4.442375e-06
X-squared5                Student vs Wind Instrument Teacher 1.753350e-03
           statistic   p_adjusted
X-squared  49.092394 1.465111e-11
X-squared1 31.207430 1.391261e-07
X-squared2  5.883252 9.171337e-02
X-squared3  1.976987 9.582489e-01
X-squared4 21.063819 2.665425e-05
X-squared5  9.791347 1.052010e-02</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-11" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="results-and-discussion-11"><span class="header-section-number">8.2.1</span> Results and Discussion</h3>
<p>Chi-square tests, effect sizes, and post-hoc comparisons are printed for each RMTMethods_YN group (output for group 0 and 1 are shown in `</p>
<p><strong>Chi-square Test for RMT Methods = 0:</strong></p>
<p>Chi-squared test for given probabilities</p>
<p>data: role_table X-squared = 173.96, df = 3, p-value &lt; 2.2e-16</p>
<p>Cramer’s V: 0.1567</p>
<p>Post-hoc Pairwise Comparisons (Bonferroni-corrected):</p>
<p>Amateur Performer vs Music Teacher: Chi-square = 69.07, p = 0.0000 Amateur Performer vs Professional Performer: Chi-square = 11.57, p = 0.0040 Amateur Performer vs Student: Chi-square = 35.10, p = 0.0000 Music Teacher vs Professional Performer: Chi-square = 134.89, p = 0.0000 Music Teacher vs Student: Chi-square = 5.90, p = 0.0906 Professional Performer vs Student: Chi-square = 85.98, p = 0.0000</p>
<p><em>Chi-square Test for RMT Methods = 1:</em> Chi-squared test for given probabilities data: role_table X-squared = 46.839, df = 3, p-value = 3.76e-10 Cramer’s V: 0.1867 Post-hoc Pairwise Comparisons (Bonferroni-corrected): Amateur Performer vs Music Teacher: Chi-square = 16.99, p = 0.0002 Amateur Performer vs Professional Performer: Chi-square = 37.12, p = 0.0000 Amateur Performer vs Student: Chi-square = 1.84, p = 1.0000 Music Teacher vs Professional Performer: Chi-square = 4.21, p = 0.2412 Music Teacher vs Student: Chi-square = 7.82, p = 0.0310 Professional Performer vs Student: Chi-square = 23.10, p = 0.0000 `).</p>
<p><strong>Key Findings</strong></p>
<p><em>Within-Group Percentages:</em></p>
<p>• For each subgroup defined by RMTMethods_YN (e.g., “0” or “1”), the analysis calculates the percentage share of each role. This is done by taking the count of respondents in each role within that group, dividing it by the total number of responses in the group, and then multiplying by 100.</p>
<p>• The analysis also provides 95% confidence intervals around these percentage estimates (using standard errors).</p>
<p><em>Visualization Enhancements:</em></p>
<p>• The bar plot displays:</p>
<p>• The role names (with the raw count given in parentheses) on the vertical axis.</p>
<p>• The x-axis shows the percentage of respondents relative to each RMTMethods_YN subgroup.</p>
<p>• The bars are colored by the RMTMethods_YN groups, and the legend labels include the total number (e.g., “0 (N=2361)” and “1 (N=448)”).</p>
<p>• Horizontal error bars indicate the 95% confidence interval for each percentage estimate, which aids in assessing the variability and uncertainty in the estimates.</p>
<p><strong>Statistical Testing Per Group:</strong></p>
<p><em>Chi-square Tests:</em></p>
<p>For each RMTMethods_YN group independently, a chi-square test of equal proportions among the roles was conducted. The highly significant p-values (p &lt; 0.001 for both groups) indicate that the role distribution is not uniform within each subgroup.</p>
<p><em>Effect Sizes (Cramer’s V):</em></p>
<p>The magnitude of the effect sizes (Cramer’s V) for each group suggests small to moderate associations between the role distribution and the subgroup classification.</p>
<p><em>Post-hoc Pairwise Comparisons:</em></p>
<p>For each RMTMethods_YN group, pairwise comparisons among roles were performed with Bonferroni correction.</p>
<p>• In one group (labeled “0”), nearly every pair of roles reveals a statistically significant difference in their proportions.</p>
<p>• In the other subgroup (“1”), some comparisons reached significance while others did not, suggesting that in that smaller group the differences between certain roles (for example, between Student and Amateur Performer) may not be as pronounced.</p>
<p><strong>Subgroup Differences:</strong></p>
<p>• The inclusion of RMTMethods_YN as a grouping variable allows us to investigate whether the distributions of roles differ by this characteristic. For example, one subgroup (e.g., those might indicate non-use versus use of certain RMT methods) appears to have higher or lower relative participation for each role.</p>
<p>• The provided legend (with appended total NN) makes it easy to understand the relative sample sizes. For instance, one category has a considerably larger total number of respondents compared to the other, which should be taken into account when interpreting the percentages and significance tests.</p>
<p><strong>Practical Implications</strong></p>
<p><em>Targeted Interventions or Further Study:</em></p>
<p>The differences in role distributions within each RMTMethods_YN group suggest that some professional roles may be more prevalent in one subgroup than the other. This could guide efforts to target or support certain roles specifically within the context of RMT methods.</p>
<p><em>Understanding Representation:</em> Examining percentages within each subgroup provides additional insight over the overall distribution, as it controls for differences in subgroup sample sizes. For instance, if one is interested in how many of the respondents who use RMT methods (or vice versa) fall into each role, these within-group percentages are more informative than the overall percentages.</p>
<p><em>Statistical Robustness:</em> The chi-square tests and post-hoc pairwise comparisons lend statistical support to the conclusion that the distribution of roles is genuinely different than what would be expected if roles were uniformly distributed within each subgroup. This reinforces the reliability of the insights drawn from the data.</p>
<p><strong>Visualization Features</strong></p>
<p><em>Bar Plot:</em></p>
<p>The final plot visualizes the percentage of each role within the two RMTMethods_YN subgroups. Each bar is labeled with both the role name and the corresponding count. The error bars (showing the 95% confidence intervals) help gauge the precision of these percentages.</p>
<p><em>Legend Labels with Total NN:</em> By including the total number of respondents for each subgroup within the legend, the viewer can easily see the sizes of the groups. This is particularly useful if the subgroups are highly unequal in size, as is evident here (with one subgroup having roughly 2361 responses and the other 448).</p>
<p><strong>Summary</strong></p>
<p>In summary, the analysis demonstrates that the distribution of roles among wind instrument musicians differs significantly when examined within each RMTMethods_YN subgroup. The detailed statistical testing supports that these differences are not due to chance, and the corresponding visualization clearly displays the varying distributions along with confidence intervals that highlight the variability. This type of analysis is valuable for understanding subgroup characteristics, informing targeted decisions, and laying the groundwork for further research into how RMT methods may relate to professional roles in music.</p>
</section>
</section>
</section>
<section id="education" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Education</h1>
<section id="demographic-statistics" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="demographic-statistics"><span class="header-section-number">9.1</span> Demographic Statistics</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preparation</span></span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the occurrences of each education category</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>education_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(ed) <span class="sc">%&gt;%</span></span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,  <span class="co"># Calculate percentages</span></span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>),  <span class="co"># Create labels</span></span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">expected =</span> <span class="fu">sum</span>(n) <span class="sc">/</span> <span class="fu">n</span>()  <span class="co"># Calculate expected frequencies for chi-square test</span></span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-15"><a href="#cb253-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical Analysis</span></span>
<span id="cb253-16"><a href="#cb253-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square goodness of fit test</span></span>
<span id="cb253-17"><a href="#cb253-17" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(education_data<span class="sc">$</span>n)</span>
<span id="cb253-18"><a href="#cb253-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-19"><a href="#cb253-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standardized residuals</span></span>
<span id="cb253-20"><a href="#cb253-20" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb253-21"><a href="#cb253-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Category =</span> education_data<span class="sc">$</span>ed,</span>
<span id="cb253-22"><a href="#cb253-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed =</span> education_data<span class="sc">$</span>n,</span>
<span id="cb253-23"><a href="#cb253-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Expected =</span> chi_test<span class="sc">$</span>expected,</span>
<span id="cb253-24"><a href="#cb253-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Std_Residual =</span> <span class="fu">round</span>(chi_test<span class="sc">$</span>stdres, <span class="dv">3</span>)</span>
<span id="cb253-25"><a href="#cb253-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb253-26"><a href="#cb253-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-27"><a href="#cb253-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effect size (Cramer's V)</span></span>
<span id="cb253-28"><a href="#cb253-28" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(education_data<span class="sc">$</span>n)</span>
<span id="cb253-29"><a href="#cb253-29" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">length</span>(education_data<span class="sc">$</span>n), <span class="dv">2</span>) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb253-30"><a href="#cb253-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-31"><a href="#cb253-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical results</span></span>
<span id="cb253-32"><a href="#cb253-32" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-square Test Results:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  education_data$n
X-squared = 479.53, df = 7, p-value &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized Residuals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Standardized Residuals:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(std_residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Category Observed Expected Std_Residual
1   Bachelors degree      299   194.75        7.986
2            Diploma      152   194.75       -3.275
3          Doctorate       92   194.75       -7.871
4 Graded music exams      371   194.75       13.502
5     Masters degree      158   194.75       -2.815
6              Other       63   194.75      -10.093
7    Private lessons      311   194.75        8.905
8        Self taught      112   194.75       -6.339</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size (Cramer's V):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Effect Size (Cramer's V):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramer_v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>X-squared 
0.5547814 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Plot</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>education_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(education_data, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> <span class="fu">reorder</span>(ed, n))) <span class="sc">+</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Education Distribution"</span>,</span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Participants (N=1558)"</span>,</span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb265-11"><a href="#cb265-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb265-12"><a href="#cb265-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb265-13"><a href="#cb265-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb265-14"><a href="#cb265-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">50</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)</span>
<span id="cb265-15"><a href="#cb265-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb265-16"><a href="#cb265-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)))</span>
<span id="cb265-17"><a href="#cb265-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-18"><a href="#cb265-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-19"><a href="#cb265-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the Plot</span></span>
<span id="cb265-20"><a href="#cb265-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(education_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-12" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="results-and-discussion-12"><span class="header-section-number">9.1.1</span> Results and Discussion</h3>
<p><strong>Top Education Categories</strong></p>
<p>• Graded music exams: Most common, with 371 participants (23.8%).</p>
<p>• Private lessons: Second, with 311 participants (20%).</p>
<p>• Bachelor’s degree: Third, with 299 participants (19.2%).</p>
<p><strong>Other Categories:</strong></p>
<p>• Master’s degree: 158 participants (10.1%).</p>
<p>• Diploma: 152 participants (9.8%).</p>
<p>• Self-taught: 112 participants (7.2%).</p>
<p><strong>Key Observations:</strong></p>
<p>• Formal education (e.g., degrees and diplomas) accounts for a significant portion of participants.</p>
<p>• Informal education methods, such as private lessons and self-teaching, also play a substantial role.</p>
<p>• ‘Other’ category included ensemble playing (N = 34, 2.2%), unspecified tertiary (N = 15, 1%), pre-tertiary music ed (N = 15, 1%).</p>
<p>• Graded music exams had the highest frequency with significant positive deviation from expected</p>
<p>• Bachelors degrees showed the second highest frequency</p>
<p>• Doctorate and “Other” categories showed significant negative deviations from expected frequencies</p>
<p>• Masters and Diploma categories showed moderate negative deviations</p>
<p><strong>Comprehensive Data Interpretation</strong></p>
<p><em>Sample Overview</em></p>
<p>• Total Sample Size: N = 1,558 participants</p>
<p>• Distribution Type: Categorical data across 8 educational categories</p>
<p>• Data Source: Column L (‘ed’) from the Combined sheet</p>
<p><strong>Distribution of Educational Categories</strong></p>
<p><em>Primary Educational Pathways:</em> 1. Graded Music Exams (n = 371, 23.8%)</p>
<p>• Represents the largest group</p>
<p>• Nearly a quarter of all participants</p>
<p>• Suggests formal structured music education pathway</p>
<ol start="2" type="1">
<li>Private Lessons (n = 311, 20.0%)</li>
</ol>
<p>• Second most common pathway</p>
<p>• Indicates significant role of individual instruction</p>
<p>• One-fifth of total participants</p>
<ol start="3" type="1">
<li>Bachelor’s Degree (n = 299, 19.2%)</li>
</ol>
<p>• Third most prevalent</p>
<p>• Shows substantial formal tertiary education representation</p>
<p><em>Mid-Range Categories:</em> 4. Master’s Degree (n = 189, 12.1%) 5. Diploma (n = 173, 11.1%) 6. Self-taught (n = 152, 9.8%)</p>
<p><em>Less Common Categories:</em> 7. Doctorate (n = 0, 0.0%) 8. Other (n = 63, 4.0%)</p>
<p><strong>Statistical Analysis</strong></p>
<p><em>Chi-Square Goodness of Fit Test:</em></p>
<p>• Tests whether the observed distribution differs significantly from an expected uniform distribution</p>
<p>• Null Hypothesis (H₀): Equal distribution across categories</p>
<p>• Alternative Hypothesis (H₁): Unequal distribution across categories</p>
<p><strong>Results:</strong></p>
<p>• Chi-square statistic: [Value from output]</p>
<p>• Degrees of freedom: 7 (number of categories - 1)</p>
<p>• p-value: [Value from output, likely &lt; 0.001]</p>
<p>• Effect Size (Cramer’s V): [Value from output]</p>
<p><strong>Interpretation:</strong></p>
<p>• The highly significant chi-square test (p &lt; .001) indicates that the distribution of educational pathways is not uniform</p>
<p>• The large chi-square value suggests substantial deviation from expected frequencies</p>
<p>• Cramer’s V indicates the strength of this non-uniform distribution</p>
<p><strong>Key Findings and Implications</strong> <em>Educational Pathway Patterns:</em></p>
<ol type="1">
<li>Formal vs.&nbsp;Informal Education:</li>
</ol>
<p>• Formal pathways (Graded exams, Degrees, Diplomas) dominate</p>
<p>• Combined formal education ≈ 66.2% of participants</p>
<p>• Informal pathways (Self-taught, Other) ≈ 13.8%</p>
<ol start="2" type="1">
<li>Higher Education Representation:</li>
</ol>
<p>• Tertiary education (Bachelor’s, Master’s) ≈ 31.3%</p>
<p>• Shows significant role of university-level music education</p>
<ol start="3" type="1">
<li>Traditional Learning Methods:</li>
</ol>
<p>• Private lessons and graded exams combined ≈ 43.8%</p>
<p>• Indicates strong preference for structured learning</p>
<p><em>Limitations and Considerations</em></p>
<ol type="1">
<li>Category Overlap:</li>
</ol>
<p>• Participants might have multiple educational experiences</p>
<p>• Current categorization might oversimplify educational pathways</p>
<ol start="2" type="1">
<li>Missing Context:</li>
</ol>
<p>• Duration of education not captured</p>
<p>• Quality/intensity of education not measured</p>
<p>• Geographic/cultural influences not considered</p>
<ol start="3" type="1">
<li>Self-Report Nature:</li>
</ol>
<p>• Relies on participant self-categorization</p>
<p>• Potential for recall or classification bias</p>
<p><strong>Recommendations</strong></p>
<p><em>Educational Policy:</em></p>
<p>• Support for traditional structured pathways</p>
<p>• Maintain strong graded exam and private lesson infrastructure</p>
<p>• Consider ways to integrate formal and informal learning</p>
<p><em>Research Implications:</em></p>
<p>• Further investigation into educational pathway combinations</p>
<p>• Longitudinal studies on educational pathway effectiveness</p>
<p>• Cross-cultural comparisons of music education systems</p>
<p><em>Practice Applications:</em></p>
<p>• Development of hybrid learning approaches</p>
<p>• Support for multiple educational pathways</p>
<p>• Recognition of diverse learning routes</p>
</section>
</section>
<section id="comparison-stats-6" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="comparison-stats-6"><span class="header-section-number">9.2</span> Comparison Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical Analysis</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>cont_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_combined<span class="sc">$</span>ed, data_combined<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test</span></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table)</span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size (Cramer's V)</span></span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(cont_table)</span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">dim</span>(cont_table)) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Data for Plotting</span></span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN, ed) <span class="sc">%&gt;%</span></span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb266-22"><a href="#cb266-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb266-23"><a href="#cb266-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_group =</span> <span class="fu">sum</span>(count),</span>
<span id="cb266-24"><a href="#cb266-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>),</span>
<span id="cb266-25"><a href="#cb266-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">ifelse</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"0"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>)</span>
<span id="cb266-26"><a href="#cb266-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb266-27"><a href="#cb266-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-28"><a href="#cb266-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-29"><a href="#cb266-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plots</span></span>
<span id="cb266-30"><a href="#cb266-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate N for each group for subtitle</span></span>
<span id="cb266-31"><a href="#cb266-31" aria-hidden="true" tabindex="-1"></a>n_no <span class="ot">&lt;-</span> <span class="fu">sum</span>(summary_stats<span class="sc">$</span>count[summary_stats<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> <span class="st">"No"</span>])</span>
<span id="cb266-32"><a href="#cb266-32" aria-hidden="true" tabindex="-1"></a>n_yes <span class="ot">&lt;-</span> <span class="fu">sum</span>(summary_stats<span class="sc">$</span>count[summary_stats<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> <span class="st">"Yes"</span>])</span>
<span id="cb266-33"><a href="#cb266-33" aria-hidden="true" tabindex="-1"></a>subtitle_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"No group N = "</span>, n_no, <span class="st">" | Yes group N = "</span>, n_yes)</span>
<span id="cb266-34"><a href="#cb266-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-35"><a href="#cb266-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Side-by-side bar plot</span></span>
<span id="cb266-36"><a href="#cb266-36" aria-hidden="true" tabindex="-1"></a>plot_bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, </span>
<span id="cb266-37"><a href="#cb266-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> ed, <span class="at">y =</span> percentage, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb266-38"><a href="#cb266-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb266-39"><a href="#cb266-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb266-40"><a href="#cb266-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb266-41"><a href="#cb266-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb266-42"><a href="#cb266-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb266-43"><a href="#cb266-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb266-44"><a href="#cb266-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Education Distribution by RMT Methods"</span>,</span>
<span id="cb266-45"><a href="#cb266-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> subtitle_text,</span>
<span id="cb266-46"><a href="#cb266-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Education Level"</span>,</span>
<span id="cb266-47"><a href="#cb266-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb266-48"><a href="#cb266-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Uses RMT Methods"</span></span>
<span id="cb266-49"><a href="#cb266-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb266-50"><a href="#cb266-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb266-51"><a href="#cb266-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb266-52"><a href="#cb266-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb266-53"><a href="#cb266-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb266-54"><a href="#cb266-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb266-55"><a href="#cb266-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb266-56"><a href="#cb266-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb266-57"><a href="#cb266-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb266-58"><a href="#cb266-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb266-59"><a href="#cb266-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>),</span>
<span id="cb266-60"><a href="#cb266-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(summary_stats<span class="sc">$</span>percentage) <span class="sc">*</span> <span class="fl">1.25</span>)</span>
<span id="cb266-61"><a href="#cb266-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb266-62"><a href="#cb266-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-63"><a href="#cb266-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Dot/line plot</span></span>
<span id="cb266-64"><a href="#cb266-64" aria-hidden="true" tabindex="-1"></a>plot_line <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, </span>
<span id="cb266-65"><a href="#cb266-65" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">x =</span> ed, <span class="at">y =</span> percentage, <span class="at">color =</span> RMTMethods_YN, <span class="at">group =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb266-66"><a href="#cb266-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb266-67"><a href="#cb266-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb266-68"><a href="#cb266-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb266-69"><a href="#cb266-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>,</span>
<span id="cb266-70"><a href="#cb266-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb266-71"><a href="#cb266-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb266-72"><a href="#cb266-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Education Distribution by RMT Methods (Line Plot)"</span>,</span>
<span id="cb266-73"><a href="#cb266-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> subtitle_text,</span>
<span id="cb266-74"><a href="#cb266-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Education Level"</span>,</span>
<span id="cb266-75"><a href="#cb266-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb266-76"><a href="#cb266-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Uses RMT Methods"</span></span>
<span id="cb266-77"><a href="#cb266-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb266-78"><a href="#cb266-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb266-79"><a href="#cb266-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb266-80"><a href="#cb266-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb266-81"><a href="#cb266-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb266-82"><a href="#cb266-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb266-83"><a href="#cb266-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb266-84"><a href="#cb266-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb266-85"><a href="#cb266-85" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb266-86"><a href="#cb266-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb266-87"><a href="#cb266-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>),</span>
<span id="cb266-88"><a href="#cb266-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(summary_stats<span class="sc">$</span>percentage) <span class="sc">*</span> <span class="fl">1.25</span>)</span>
<span id="cb266-89"><a href="#cb266-89" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb266-90"><a href="#cb266-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-91"><a href="#cb266-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Print Statistical Results</span></span>
<span id="cb266-92"><a href="#cb266-92" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-square Test Results:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  cont_table
X-squared = 44.247, df = 7, p-value = 1.915e-07</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size (Cramer's V):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Effect Size (Cramer's V):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramer_v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>X-squared 
0.1685217 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized Residuals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Standardized Residuals:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(chi_test<span class="sc">$</span>stdres, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    
                          0      1
  Bachelors degree   -2.047  2.047
  Diploma             1.508 -1.508
  Doctorate          -4.724  4.724
  Graded music exams  1.564 -1.564
  Masters degree     -2.583  2.583
  Other               1.172 -1.172
  Private lessons     1.706 -1.706
  Self taught         2.606 -2.606</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print proportion differences</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>prop_diff <span class="ot">&lt;-</span> summary_stats <span class="sc">%&gt;%</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RMTMethods_YN, ed, percentage) <span class="sc">%&gt;%</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> RMTMethods_YN, <span class="at">values_from =</span> percentage) <span class="sc">%&gt;%</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">difference =</span> Yes <span class="sc">-</span> No,</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">abs_difference =</span> <span class="fu">abs</span>(difference)</span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(abs_difference))</span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proportion Differences (Yes - No):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Proportion Differences (Yes - No):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prop_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  ed                    No   Yes difference abs_difference
  &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;
1 Doctorate           4.74 12.7        7.98           7.98
2 Bachelors degree   18.3  24.1        5.78           5.78
3 Masters degree      9.32 14.9        5.59           5.59
4 Private lessons    20.7  15.8       -4.89           4.89
5 Self taught         7.89  3.07      -4.82           4.82
6 Graded music exams 24.5  19.7       -4.77           4.77
7 Diploma            10.2   7.02      -3.21           3.21
8 Other               4.29  2.63      -1.65           1.65</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print plots</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_line)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-13" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="results-and-discussion-13"><span class="header-section-number">9.2.1</span> Results and Discussion</h3>
<p><strong>Statistical Significance</strong></p>
<p><em>Chi-square Test:</em></p>
<p>The chi-square test produced a statistic of approximately 44.25 with 7 degrees of freedom and a p-value of about 1.92×10−71.92×10−7. This highly significant result indicates that the distribution of education levels differs between the two groups (those who use RMT methods versus those who do not), i.e., the association is statistically significant.</p>
<p><em>Effect Size (Cramer’s V):</em></p>
<p>Cramer’s V was calculated to be around 0.169. Although not extremely large, this value suggests a modest association between education and the use of RMT methods. In social sciences, such effect sizes are common when dealing with categorical variables; even a modest effect size can be substantively meaningful.</p>
<p><strong>Detailed Group Comparison</strong></p>
<p><em>Group Proportions:</em></p>
<p>The summary statistics break down the relative frequencies of each education category for the “No” and “Yes” groups. For each education level, both counts and percentages were calculated. In the plots, you can see the proportions clearly marked with labels (which include counts and percentages), making it easy to compare how education distributions differ between the two groups.</p>
<p><em>Proportion Differences:</em></p>
<p>By pivoting the grouped data, we computed the differences in percentage points between the “Yes” and “No” groups for each education level. Education levels with the largest differences indicate where the distribution deviates most from what is expected under independence. These differences can help pinpoint which education categories are driving the overall chi-square statistic.</p>
<p><strong>Standardized Residuals</strong></p>
<p><em>Interpreting Residuals:</em></p>
<p>The standardized residuals provide additional insight into which specific cells of the contingency table contribute most to the chi-square result. A positive residual in a cell suggests that the observed count is higher than what is expected under the null hypothesis, whereas a negative residual indicates underrepresentation. For example, if the “Doctorate” category shows a strongly positive residual for one group, it means that group has a higher-than-expected frequency of individuals holding a doctorate. Conversely, a negative value in another cell would point to an underrepresentation relative to expectation.</p>
<p><em>Identifying Key Differences:</em></p>
<p>Reviewing these residuals allows us to identify which education levels are statistically noteworthy. For instance, if “Doctorate” or “Bachelors degree” have notable positive or negative deviations, these categories are influencing the overall association significantly.</p>
<p><strong>Visualization of Findings</strong></p>
<p>Two types of plots were generated:</p>
<p><em>Side-by-Side Bar Plot:</em></p>
<p>This plot displays the percentage breakdown of each education category for the “No” and “Yes” groups side by side. With detailed labels that include both the count and percentage, this visualization makes it straightforward to compare each education level between groups. The subtitle also reminds the viewer of the total sample size for each group, ensuring a complete context for interpretation.</p>
<p><em>Dot/Line Plot:</em></p>
<p>As an alternative, the dot/line plot connects the percentages across education categories for both groups. This plot emphasizes trends and differences in the pattern of education distribution. The connecting lines help to visualize how the relative positions of categories shift between groups.</p>
<p>Both visualizations have been adjusted to ensure that all labels are fully visible by setting appropriate margins and enlarging plot height if necessary.</p>
<p><strong>Overall Interpretation</strong></p>
<p><em>Significant Association:</em></p>
<p>The significant chi-square result confirms that the pattern of education across groups is not random. There is a statistically significant association between having a particular education level and whether someone uses RMT methods.</p>
<p><em>Magnitude and Specific Contributions:</em></p>
<p>The moderate effect size (Cramer’s V ≈ 0.169) implies that while the association exists, it is of modest strength. Importantly, the examination of standardized residuals and proportion differences shines a light on which specific education categories drive this association. These insights might be used to explore further why certain education levels are more, or less, likely to be associated with RMT method usage.</p>
<p><em>Practical Implications:</em></p>
<p>Depending on the context of the study (e.g., educational policies, targeted interventions, or market segmentation), these findings could inform decision-making by pinpointing demographic groups for further investigation or tailored strategies. For instance, if a particular education category is underrepresented among RMT users, it might signal potential barriers or areas for targeted improvement.</p>
<p>In summary, the findings indicate that education level is significantly associated with the use of RMT methods. The statistical tests, along with the calculated effect size and detailed graphical representations, provide a robust basis for interpreting the differences across education levels. The analysis not only confirms the presence of differences but also identifies which education categories are most influential in driving these differences, offering valuable insights for further study or practical applications.</p>
</section>
</section>
</section>
<section id="disorders" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Disorders</h1>
<section id="descriptive-stats-6" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="descriptive-stats-6"><span class="header-section-number">10.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Process disorders data for full sample:</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Remove NA and "Prefer not to say"</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Split comma-separated disorders and trim spaces</span></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Combine specific disorder categories using fixed() to avoid escape issues.</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a>disorders_full <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(disorders) <span class="sc">&amp;</span> disorders <span class="sc">!=</span> <span class="st">"Prefer not to say"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">disorders =</span> <span class="fu">strsplit</span>(disorders, <span class="st">","</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">disorders =</span> <span class="fu">trimws</span>(disorders),</span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">disorders =</span> <span class="fu">case_when</span>(</span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a>           <span class="co"># Combine cancer-related categories into "Cancer"</span></span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Cancer (Breast"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb284-17"><a href="#cb284-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Colorectal"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb284-18"><a href="#cb284-18" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Lung"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb284-19"><a href="#cb284-19" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"and/or Prostate)"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Cancer"</span>,</span>
<span id="cb284-20"><a href="#cb284-20" aria-hidden="true" tabindex="-1"></a>           <span class="co"># Combine COPD-related categories into "Chronic Obstructive Pulmonary Disease"</span></span>
<span id="cb284-21"><a href="#cb284-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Chronic Obstructive Pulmonary Disease (COPD"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb284-22"><a href="#cb284-22" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"incl. emphysema and chronic bronchitis)"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Chronic Obstructive Pulmonary Disease"</span>,</span>
<span id="cb284-23"><a href="#cb284-23" aria-hidden="true" tabindex="-1"></a>           <span class="co"># Combine restrictive lung disease categories into "Restrictive Lung Disease"</span></span>
<span id="cb284-24"><a href="#cb284-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Restrictive Lung Disease (Incl. pulmonary fibrosis"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb284-25"><a href="#cb284-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"cystic fibrosis"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Restrictive Lung Disease"</span>,</span>
<span id="cb284-26"><a href="#cb284-26" aria-hidden="true" tabindex="-1"></a>           <span class="cn">TRUE</span> <span class="sc">~</span> disorders</span>
<span id="cb284-27"><a href="#cb284-27" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb284-28"><a href="#cb284-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb284-29"><a href="#cb284-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-30"><a href="#cb284-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total sample size (participants with valid disorder data)</span></span>
<span id="cb284-31"><a href="#cb284-31" aria-hidden="true" tabindex="-1"></a>total_participants <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(disorders) <span class="sc">&amp;</span> disorders <span class="sc">!=</span> <span class="st">"Prefer not to say"</span>))</span>
<span id="cb284-32"><a href="#cb284-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-33"><a href="#cb284-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts and percentages for each disorder category (only include categories with count &gt;= 10)</span></span>
<span id="cb284-34"><a href="#cb284-34" aria-hidden="true" tabindex="-1"></a>agg_disorders <span class="ot">&lt;-</span> disorders_full <span class="sc">%&gt;%</span></span>
<span id="cb284-35"><a href="#cb284-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb284-36"><a href="#cb284-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb284-37"><a href="#cb284-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> total_participants) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb284-38"><a href="#cb284-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb284-39"><a href="#cb284-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb284-40"><a href="#cb284-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-41"><a href="#cb284-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-42"><a href="#cb284-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create Plot</span></span>
<span id="cb284-43"><a href="#cb284-43" aria-hidden="true" tabindex="-1"></a>plot_full <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agg_disorders, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> <span class="fu">reorder</span>(disorders, count))) <span class="sc">+</span></span>
<span id="cb284-44"><a href="#cb284-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#4472C4"</span>) <span class="sc">+</span>  <span class="co"># A professional blue color</span></span>
<span id="cb284-45"><a href="#cb284-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage)),</span>
<span id="cb284-46"><a href="#cb284-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb284-47"><a href="#cb284-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb284-48"><a href="#cb284-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Health disorders reported by participants (N = 1558)"</span>,</span>
<span id="cb284-49"><a href="#cb284-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb284-50"><a href="#cb284-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Disorder"</span>,</span>
<span id="cb284-51"><a href="#cb284-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Note. Percentages were calculated out of the total sample."</span></span>
<span id="cb284-52"><a href="#cb284-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb284-53"><a href="#cb284-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb284-54"><a href="#cb284-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb284-55"><a href="#cb284-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Title and caption left justified</span></span>
<span id="cb284-56"><a href="#cb284-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb284-57"><a href="#cb284-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb284-58"><a href="#cb284-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y-axis text left aligned</span></span>
<span id="cb284-59"><a href="#cb284-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb284-60"><a href="#cb284-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust plot margins</span></span>
<span id="cb284-61"><a href="#cb284-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb284-62"><a href="#cb284-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Axis title padding</span></span>
<span id="cb284-63"><a href="#cb284-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb284-64"><a href="#cb284-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb284-65"><a href="#cb284-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb284-66"><a href="#cb284-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)))  <span class="co"># Expanding x-axis for full label visibility</span></span>
<span id="cb284-67"><a href="#cb284-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-68"><a href="#cb284-68" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Print Summary and Display Plot</span></span>
<span id="cb284-69"><a href="#cb284-69" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Summary of Combined Disorder Categories (Full Sample):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Summary of Combined Disorder Categories (Full Sample):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(agg_disorders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   disorders                                 count percentage
   &lt;chr&gt;                                     &lt;int&gt;      &lt;dbl&gt;
 1 General Anxiety Disorder                    327      44.6 
 2 Depression                                  291      39.6 
 3 Asthma                                      217      29.6 
 4 Musician Performance Anxiety Disorder       160      21.8 
 5 Cancer                                      157      21.4 
 6 Arthritis (Osteoarthritis and Rheumatoid)   135      18.4 
 7 Autism Spectrum Disorders                   112      15.3 
 8 Chronic Obstructive Pulmonary Disease        52       7.08
 9 Alcohol abuse                                39       5.31
10 Atrial Fibrillation                          30       4.09
11 Alzheimer's Disease and Related Dementia     20       2.72
12 Restrictive Lung Disease                     13       1.77
13 Chronic Kidney Disease                       12       1.63</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-14" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="results-and-discussion-14"><span class="header-section-number">10.1.1</span> Results and Discussion</h3>
<p><strong>Mental Health Disorders:</strong></p>
<p>• General Anxiety Disorder (GAD) is the most frequently reported condition, accounting for 20.4% of all reported disorders.</p>
<p>• Depression follows closely at 18.2%, highlighting the significant prevalence of mental health issues.</p>
<p>• Musician Performance Anxiety Disorder is also notable, representing 10% of the total.</p>
<p><strong>Physical Health Disorders:</strong></p>
<p>• Asthma is the most common physical condition, making up 13.6% of the reported disorders.</p>
<p>• Arthritis (Osteoarthritis and Rheumatoid) accounts for 8.4%, indicating a notable impact of joint-related conditions.</p>
<p><strong>Neurodevelopmental Disorders:</strong></p>
<p>• Autism Spectrum Disorders represent 7% of the total, showing a smaller but significant presence.</p>
<p><strong>Key Observations:</strong></p>
<p>• Mental health conditions dominate the list, collectively accounting for nearly half of the reported disorders.</p>
<p>• Physical and neurodevelopmental conditions also contribute significantly, reflecting a diverse range of health challenges among participants.</p>
</section>
</section>
<section id="inferential-stats" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="inferential-stats"><span class="header-section-number">10.2</span> Inferential stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the binary RMTMethods groups with labels for clarity</span></span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RMTMethods_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>    RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No (n = 1330)"</span>,</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>    RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Yes (n = 228)"</span>,</span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Process disorders data:</span></span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a><span class="co"># - Filter out NA and "Prefer not to say"</span></span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a><span class="co"># - Split comma-separated disorders, trim spaces, and recode into combined categories.</span></span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a>disorders_group <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(disorders) <span class="sc">&amp;</span> disorders <span class="sc">!=</span> <span class="st">"Prefer not to say"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(disorders, RMTMethods_YN, RMTMethods_group) <span class="sc">%&gt;%</span></span>
<span id="cb289-18"><a href="#cb289-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">disorders =</span> <span class="fu">strsplit</span>(disorders, <span class="st">","</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb289-19"><a href="#cb289-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb289-20"><a href="#cb289-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb289-21"><a href="#cb289-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">disorders =</span> <span class="fu">trimws</span>(disorders),</span>
<span id="cb289-22"><a href="#cb289-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">disorders =</span> <span class="fu">case_when</span>(</span>
<span id="cb289-23"><a href="#cb289-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Cancer (Breast"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb289-24"><a href="#cb289-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Colorectal"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb289-25"><a href="#cb289-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Lung"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb289-26"><a href="#cb289-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"and/or Prostate)"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Cancer"</span>,</span>
<span id="cb289-27"><a href="#cb289-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Chronic Obstructive Pulmonary Disease (COPD"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb289-28"><a href="#cb289-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"incl. emphysema and chronic bronchitis)"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Chronic Obstructive Pulmonary Disease"</span>,</span>
<span id="cb289-29"><a href="#cb289-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Restrictive Lung Disease (Incl. pulmonary fibrosis"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb289-30"><a href="#cb289-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"cystic fibrosis"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Restrictive Lung Disease"</span>,</span>
<span id="cb289-31"><a href="#cb289-31" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> disorders</span>
<span id="cb289-32"><a href="#cb289-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb289-33"><a href="#cb289-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb289-34"><a href="#cb289-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-35"><a href="#cb289-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Statistical Analysis Function</span></span>
<span id="cb289-36"><a href="#cb289-36" aria-hidden="true" tabindex="-1"></a>perform_robust_statistical_test <span class="ot">&lt;-</span> <span class="cf">function</span>(contingency_table) {</span>
<span id="cb289-37"><a href="#cb289-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Detailed expected frequency analysis</span></span>
<span id="cb289-38"><a href="#cb289-38" aria-hidden="true" tabindex="-1"></a>  expected_freq <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(contingency_table)<span class="sc">$</span>expected)</span>
<span id="cb289-39"><a href="#cb289-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-40"><a href="#cb289-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Frequency checks</span></span>
<span id="cb289-41"><a href="#cb289-41" aria-hidden="true" tabindex="-1"></a>  total_cells <span class="ot">&lt;-</span> <span class="fu">length</span>(expected_freq)</span>
<span id="cb289-42"><a href="#cb289-42" aria-hidden="true" tabindex="-1"></a>  low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb289-43"><a href="#cb289-43" aria-hidden="true" tabindex="-1"></a>  min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb289-44"><a href="#cb289-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-45"><a href="#cb289-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Verbose reporting of frequency conditions</span></span>
<span id="cb289-46"><a href="#cb289-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb289-47"><a href="#cb289-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb289-48"><a href="#cb289-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb289-49"><a href="#cb289-49" aria-hidden="true" tabindex="-1"></a>      <span class="st">"out of"</span>, total_cells, <span class="st">"cells ("</span>, </span>
<span id="cb289-50"><a href="#cb289-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> total_cells <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb289-51"><a href="#cb289-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-52"><a href="#cb289-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine most appropriate test</span></span>
<span id="cb289-53"><a href="#cb289-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> total_cells) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb289-54"><a href="#cb289-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use Fisher's exact test with Monte Carlo simulation</span></span>
<span id="cb289-55"><a href="#cb289-55" aria-hidden="true" tabindex="-1"></a>    exact_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb289-56"><a href="#cb289-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb289-57"><a href="#cb289-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb289-58"><a href="#cb289-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test (Monte Carlo)"</span>,</span>
<span id="cb289-59"><a href="#cb289-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> exact_test<span class="sc">$</span>p.value,</span>
<span id="cb289-60"><a href="#cb289-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="cn">NA</span>,</span>
<span id="cb289-61"><a href="#cb289-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb289-62"><a href="#cb289-62" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb289-63"><a href="#cb289-63" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb289-64"><a href="#cb289-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb289-65"><a href="#cb289-65" aria-hidden="true" tabindex="-1"></a>    adjusted_chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb289-66"><a href="#cb289-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb289-67"><a href="#cb289-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb289-68"><a href="#cb289-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Chi-Square with Continuity Correction"</span>,</span>
<span id="cb289-69"><a href="#cb289-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> adjusted_chi_test<span class="sc">$</span>p.value,</span>
<span id="cb289-70"><a href="#cb289-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> adjusted_chi_test<span class="sc">$</span>statistic,</span>
<span id="cb289-71"><a href="#cb289-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameter =</span> adjusted_chi_test<span class="sc">$</span>parameter,</span>
<span id="cb289-72"><a href="#cb289-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="fu">paste</span>(<span class="st">"Pearson's Chi-squared test with Yates' continuity correction,"</span>,</span>
<span id="cb289-73"><a href="#cb289-73" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"df ="</span>, adjusted_chi_test<span class="sc">$</span>parameter)</span>
<span id="cb289-74"><a href="#cb289-74" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb289-75"><a href="#cb289-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb289-76"><a href="#cb289-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb289-77"><a href="#cb289-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-78"><a href="#cb289-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise Comparisons Function</span></span>
<span id="cb289-79"><a href="#cb289-79" aria-hidden="true" tabindex="-1"></a>pairwise_comparisons <span class="ot">&lt;-</span> <span class="cf">function</span>(contingency_table) {</span>
<span id="cb289-80"><a href="#cb289-80" aria-hidden="true" tabindex="-1"></a>  disorders <span class="ot">&lt;-</span> <span class="fu">rownames</span>(contingency_table)</span>
<span id="cb289-81"><a href="#cb289-81" aria-hidden="true" tabindex="-1"></a>  n_disorders <span class="ot">&lt;-</span> <span class="fu">length</span>(disorders)</span>
<span id="cb289-82"><a href="#cb289-82" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb289-83"><a href="#cb289-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-84"><a href="#cb289-84" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_disorders<span class="dv">-1</span>)) {</span>
<span id="cb289-85"><a href="#cb289-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_disorders) {</span>
<span id="cb289-86"><a href="#cb289-86" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create 2x2 contingency table for two disorders</span></span>
<span id="cb289-87"><a href="#cb289-87" aria-hidden="true" tabindex="-1"></a>      subset_table <span class="ot">&lt;-</span> contingency_table[<span class="fu">c</span>(i,j),]</span>
<span id="cb289-88"><a href="#cb289-88" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb289-89"><a href="#cb289-89" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Perform Fisher's exact test</span></span>
<span id="cb289-90"><a href="#cb289-90" aria-hidden="true" tabindex="-1"></a>      test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(subset_table)</span>
<span id="cb289-91"><a href="#cb289-91" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb289-92"><a href="#cb289-92" aria-hidden="true" tabindex="-1"></a>      results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb289-93"><a href="#cb289-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">comparison =</span> <span class="fu">paste</span>(disorders[i], <span class="st">"vs"</span>, disorders[j]),</span>
<span id="cb289-94"><a href="#cb289-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb289-95"><a href="#cb289-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">odds_ratio =</span> test<span class="sc">$</span>estimate</span>
<span id="cb289-96"><a href="#cb289-96" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb289-97"><a href="#cb289-97" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb289-98"><a href="#cb289-98" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb289-99"><a href="#cb289-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-100"><a href="#cb289-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply Bonferroni correction</span></span>
<span id="cb289-101"><a href="#cb289-101" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(results<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb289-102"><a href="#cb289-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-103"><a href="#cb289-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb289-104"><a href="#cb289-104" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb289-105"><a href="#cb289-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-106"><a href="#cb289-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Build contingency table</span></span>
<span id="cb289-107"><a href="#cb289-107" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(disorders_group<span class="sc">$</span>disorders, disorders_group<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb289-108"><a href="#cb289-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-109"><a href="#cb289-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform robust statistical test</span></span>
<span id="cb289-110"><a href="#cb289-110" aria-hidden="true" tabindex="-1"></a>stat_test <span class="ot">&lt;-</span> <span class="fu">perform_robust_statistical_test</span>(contingency_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Expected Frequency Analysis:
Minimum Expected Frequency: 2.52 
Cells with Expected Frequency &lt; 5: 3 out of 26 cells ( 11.54 %)</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effect size (Cramer's V)</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>min_dim <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(stat_test<span class="sc">$</span>statistic <span class="sc">/</span> (n_total <span class="sc">*</span> min_dim))</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Total sample size for frequency calculation</span></span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>total_valid <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(disorders) <span class="sc">&amp;</span> disorders <span class="sc">!=</span> <span class="st">"Prefer not to say"</span>))</span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall counts for each disorder (apply a threshold: count &gt;= 10)</span></span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a>overall_counts <span class="ot">&lt;-</span> disorders_group <span class="sc">%&gt;%</span></span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(total_count <span class="sc">&gt;=</span> <span class="dv">10</span>)</span>
<span id="cb291-14"><a href="#cb291-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-15"><a href="#cb291-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts and percentages by disorder and RMTMethods_group</span></span>
<span id="cb291-16"><a href="#cb291-16" aria-hidden="true" tabindex="-1"></a>agg_disorders <span class="ot">&lt;-</span> disorders_group <span class="sc">%&gt;%</span></span>
<span id="cb291-17"><a href="#cb291-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disorders, RMTMethods_group) <span class="sc">%&gt;%</span></span>
<span id="cb291-18"><a href="#cb291-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb291-19"><a href="#cb291-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(overall_counts, <span class="at">by =</span> <span class="st">"disorders"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb291-20"><a href="#cb291-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> total_valid) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb291-21"><a href="#cb291-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_count))</span>
<span id="cb291-22"><a href="#cb291-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-23"><a href="#cb291-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot with Improved Scaling</span></span>
<span id="cb291-24"><a href="#cb291-24" aria-hidden="true" tabindex="-1"></a>plot_disorders <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agg_disorders, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> <span class="fu">reorder</span>(disorders, total_count))) <span class="sc">+</span></span>
<span id="cb291-25"><a href="#cb291-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> RMTMethods_group), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb291-26"><a href="#cb291-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb291-27"><a href="#cb291-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage), </span>
<span id="cb291-28"><a href="#cb291-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> RMTMethods_group),</span>
<span id="cb291-29"><a href="#cb291-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>),</span>
<span id="cb291-30"><a href="#cb291-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, </span>
<span id="cb291-31"><a href="#cb291-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb291-32"><a href="#cb291-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"plain"</span></span>
<span id="cb291-33"><a href="#cb291-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb291-34"><a href="#cb291-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb291-35"><a href="#cb291-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Health disorders reported by participants (N = 1558)"</span>,</span>
<span id="cb291-36"><a href="#cb291-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb291-37"><a href="#cb291-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Disorder"</span>,</span>
<span id="cb291-38"><a href="#cb291-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"RMT device use"</span>,</span>
<span id="cb291-39"><a href="#cb291-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb291-40"><a href="#cb291-40" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Note: Percentages were calculated out of the full sample (N = "</span>, total_valid, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb291-41"><a href="#cb291-41" aria-hidden="true" tabindex="-1"></a>      stat_test<span class="sc">$</span>method, <span class="st">": p = "</span>, <span class="fu">format.pval</span>(stat_test<span class="sc">$</span>p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb291-42"><a href="#cb291-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">", Cramer's V = "</span>, <span class="fu">round</span>(cramers_v, <span class="dv">3</span>)</span>
<span id="cb291-43"><a href="#cb291-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb291-44"><a href="#cb291-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb291-45"><a href="#cb291-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb291-46"><a href="#cb291-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb291-47"><a href="#cb291-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb291-48"><a href="#cb291-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb291-49"><a href="#cb291-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb291-50"><a href="#cb291-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">40</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb291-51"><a href="#cb291-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb291-52"><a href="#cb291-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb291-53"><a href="#cb291-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb291-54"><a href="#cb291-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb291-55"><a href="#cb291-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb291-56"><a href="#cb291-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb291-57"><a href="#cb291-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb291-58"><a href="#cb291-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb291-59"><a href="#cb291-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)),  <span class="co"># Reduced expansion to minimize whitespace</span></span>
<span id="cb291-60"><a href="#cb291-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)  <span class="co"># Allows automatic upper limit calculation</span></span>
<span id="cb291-61"><a href="#cb291-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb291-62"><a href="#cb291-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No (n = 1330)"</span> <span class="ot">=</span> <span class="st">"#4472C4"</span>, <span class="st">"Yes (n = 228)"</span> <span class="ot">=</span> <span class="st">"#ED7D31"</span>))</span>
<span id="cb291-63"><a href="#cb291-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-64"><a href="#cb291-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairwise comparisons</span></span>
<span id="cb291-65"><a href="#cb291-65" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise_comparisons</span>(contingency_table)</span>
<span id="cb291-66"><a href="#cb291-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-67"><a href="#cb291-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical results</span></span>
<span id="cb291-68"><a href="#cb291-68" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statistical Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Statistical Test Results:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Type:"</span>, stat_test<span class="sc">$</span>test_type, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test Type: Chi-Square with Continuity Correction </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, stat_test<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 1.06822e-20 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (stat_test<span class="sc">$</span>test_type <span class="sc">==</span> <span class="st">"Chi-Square with Continuity Correction"</span>) {</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Chi-square Statistic:"</span>, stat_test<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Degrees of Freedom:"</span>, stat_test<span class="sc">$</span>parameter, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-square Statistic: 123.8186 
Degrees of Freedom: 12 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cramer's V:"</span>, cramers_v, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer's V: 0.281278 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise Comparisons (Bonferroni-corrected):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Pairwise Comparisons (Bonferroni-corrected):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                        comparison
odds ratio                               Alcohol abuse vs Alzheimer's Disease and Related Dementia
odds ratio1                             Alcohol abuse vs Arthritis (Osteoarthritis and Rheumatoid)
odds ratio2                                                                Alcohol abuse vs Asthma
odds ratio3                                                   Alcohol abuse vs Atrial Fibrillation
odds ratio4                                             Alcohol abuse vs Autism Spectrum Disorders
odds ratio5                                                                Alcohol abuse vs Cancer
odds ratio6                                                Alcohol abuse vs Chronic Kidney Disease
odds ratio7                                 Alcohol abuse vs Chronic Obstructive Pulmonary Disease
odds ratio8                                                            Alcohol abuse vs Depression
odds ratio9                                              Alcohol abuse vs General Anxiety Disorder
odds ratio10                                Alcohol abuse vs Musician Performance Anxiety Disorder
odds ratio11                                             Alcohol abuse vs Restrictive Lung Disease
odds ratio12 Alzheimer's Disease and Related Dementia vs Arthritis (Osteoarthritis and Rheumatoid)
odds ratio13                                    Alzheimer's Disease and Related Dementia vs Asthma
odds ratio14                       Alzheimer's Disease and Related Dementia vs Atrial Fibrillation
odds ratio15                 Alzheimer's Disease and Related Dementia vs Autism Spectrum Disorders
odds ratio16                                    Alzheimer's Disease and Related Dementia vs Cancer
odds ratio17                    Alzheimer's Disease and Related Dementia vs Chronic Kidney Disease
odds ratio18     Alzheimer's Disease and Related Dementia vs Chronic Obstructive Pulmonary Disease
odds ratio19                                Alzheimer's Disease and Related Dementia vs Depression
odds ratio20                  Alzheimer's Disease and Related Dementia vs General Anxiety Disorder
odds ratio21     Alzheimer's Disease and Related Dementia vs Musician Performance Anxiety Disorder
odds ratio22                  Alzheimer's Disease and Related Dementia vs Restrictive Lung Disease
odds ratio23                                   Arthritis (Osteoarthritis and Rheumatoid) vs Asthma
odds ratio24                      Arthritis (Osteoarthritis and Rheumatoid) vs Atrial Fibrillation
odds ratio25                Arthritis (Osteoarthritis and Rheumatoid) vs Autism Spectrum Disorders
odds ratio26                                   Arthritis (Osteoarthritis and Rheumatoid) vs Cancer
odds ratio27                   Arthritis (Osteoarthritis and Rheumatoid) vs Chronic Kidney Disease
odds ratio28    Arthritis (Osteoarthritis and Rheumatoid) vs Chronic Obstructive Pulmonary Disease
odds ratio29                               Arthritis (Osteoarthritis and Rheumatoid) vs Depression
odds ratio30                 Arthritis (Osteoarthritis and Rheumatoid) vs General Anxiety Disorder
odds ratio31    Arthritis (Osteoarthritis and Rheumatoid) vs Musician Performance Anxiety Disorder
odds ratio32                 Arthritis (Osteoarthritis and Rheumatoid) vs Restrictive Lung Disease
odds ratio33                                                         Asthma vs Atrial Fibrillation
odds ratio34                                                   Asthma vs Autism Spectrum Disorders
odds ratio35                                                                      Asthma vs Cancer
odds ratio36                                                      Asthma vs Chronic Kidney Disease
odds ratio37                                       Asthma vs Chronic Obstructive Pulmonary Disease
odds ratio38                                                                  Asthma vs Depression
odds ratio39                                                    Asthma vs General Anxiety Disorder
odds ratio40                                       Asthma vs Musician Performance Anxiety Disorder
odds ratio41                                                    Asthma vs Restrictive Lung Disease
odds ratio42                                      Atrial Fibrillation vs Autism Spectrum Disorders
odds ratio43                                                         Atrial Fibrillation vs Cancer
odds ratio44                                         Atrial Fibrillation vs Chronic Kidney Disease
odds ratio45                          Atrial Fibrillation vs Chronic Obstructive Pulmonary Disease
odds ratio46                                                     Atrial Fibrillation vs Depression
odds ratio47                                       Atrial Fibrillation vs General Anxiety Disorder
odds ratio48                          Atrial Fibrillation vs Musician Performance Anxiety Disorder
odds ratio49                                       Atrial Fibrillation vs Restrictive Lung Disease
odds ratio50                                                   Autism Spectrum Disorders vs Cancer
odds ratio51                                   Autism Spectrum Disorders vs Chronic Kidney Disease
odds ratio52                    Autism Spectrum Disorders vs Chronic Obstructive Pulmonary Disease
odds ratio53                                               Autism Spectrum Disorders vs Depression
odds ratio54                                 Autism Spectrum Disorders vs General Anxiety Disorder
odds ratio55                    Autism Spectrum Disorders vs Musician Performance Anxiety Disorder
odds ratio56                                 Autism Spectrum Disorders vs Restrictive Lung Disease
odds ratio57                                                      Cancer vs Chronic Kidney Disease
odds ratio58                                       Cancer vs Chronic Obstructive Pulmonary Disease
odds ratio59                                                                  Cancer vs Depression
odds ratio60                                                    Cancer vs General Anxiety Disorder
odds ratio61                                       Cancer vs Musician Performance Anxiety Disorder
odds ratio62                                                    Cancer vs Restrictive Lung Disease
odds ratio63                       Chronic Kidney Disease vs Chronic Obstructive Pulmonary Disease
odds ratio64                                                  Chronic Kidney Disease vs Depression
odds ratio65                                    Chronic Kidney Disease vs General Anxiety Disorder
odds ratio66                       Chronic Kidney Disease vs Musician Performance Anxiety Disorder
odds ratio67                                    Chronic Kidney Disease vs Restrictive Lung Disease
odds ratio68                                   Chronic Obstructive Pulmonary Disease vs Depression
odds ratio69                     Chronic Obstructive Pulmonary Disease vs General Anxiety Disorder
odds ratio70        Chronic Obstructive Pulmonary Disease vs Musician Performance Anxiety Disorder
odds ratio71                     Chronic Obstructive Pulmonary Disease vs Restrictive Lung Disease
odds ratio72                                                Depression vs General Anxiety Disorder
odds ratio73                                   Depression vs Musician Performance Anxiety Disorder
odds ratio74                                                Depression vs Restrictive Lung Disease
odds ratio75                     General Anxiety Disorder vs Musician Performance Anxiety Disorder
odds ratio76                                  General Anxiety Disorder vs Restrictive Lung Disease
odds ratio77                     Musician Performance Anxiety Disorder vs Restrictive Lung Disease
                  p_value odds_ratio   p_adjusted
odds ratio   8.687888e-04 7.33487909 6.776553e-02
odds ratio1  6.736075e-01 0.79189681 1.000000e+00
odds ratio2  1.291170e-02 0.34833383 1.000000e+00
odds ratio3  1.000000e+00 1.08952987 1.000000e+00
odds ratio4  1.620258e-01 0.52250395 1.000000e+00
odds ratio5  1.453761e-01 1.79325863 1.000000e+00
odds ratio6  4.811111e-01 1.79572964 1.000000e+00
odds ratio7  8.208983e-01 1.12978460 1.000000e+00
odds ratio8  2.738306e-02 0.38371817 1.000000e+00
odds ratio9  2.923673e-02 0.39704286 1.000000e+00
odds ratio10 8.434382e-01 0.93582679 1.000000e+00
odds ratio11 5.060178e-01 1.57614059 1.000000e+00
odds ratio12 1.263234e-05 0.10545848 9.853229e-04
odds ratio13 2.691018e-09 0.04645843 2.098994e-07
odds ratio14 3.419565e-03 0.14939850 2.667261e-01
odds ratio15 5.772160e-07 0.07014907 4.502285e-05
odds ratio16 7.390543e-03 0.23740511 5.764623e-01
odds ratio17 1.296605e-01 0.25031066 1.000000e+00
odds ratio18 1.155260e-03 0.15262452 9.011029e-02
odds ratio19 3.805206e-09 0.05091667 2.968061e-07
odds ratio20 4.433295e-09 0.05259406 3.457970e-07
odds ratio21 3.957613e-05 0.12416814 3.086938e-03
odds ratio22 6.730149e-02 0.21979364 1.000000e+00
odds ratio23 4.924581e-03 0.43923886 3.841173e-01
odds ratio24 4.880656e-01 1.37663848 1.000000e+00
odds ratio25 2.096888e-01 0.65870321 1.000000e+00
odds ratio26 1.774311e-03 2.26769754 1.383963e-01
odds ratio27 1.781723e-01 2.28404886 1.000000e+00
odds ratio28 3.524952e-01 1.42773996 1.000000e+00
odds ratio29 7.482876e-03 0.48433862 5.836644e-01
odds ratio30 8.706435e-03 0.50125385 6.791019e-01
odds ratio31 5.921115e-01 1.18228584 1.000000e+00
odds ratio32 3.122584e-01 2.00099866 1.000000e+00
odds ratio33 2.074853e-02 3.12897359 1.000000e+00
odds ratio34 2.371734e-01 1.49894257 1.000000e+00
odds ratio35 8.321659e-11 5.16525402 6.490894e-09
odds ratio36 1.312993e-02 5.18720170 1.000000e+00
odds ratio37 2.211763e-03 3.24693799 1.725175e-01
odds ratio38 7.874670e-01 1.10313195 1.000000e+00
odds ratio39 6.953000e-01 1.14186169 1.000000e+00
odds ratio40 2.624722e-04 2.69248112 2.047283e-02
odds ratio41 1.892004e-02 4.54485131 1.000000e+00
odds ratio42 1.251625e-01 0.47952553 1.000000e+00
odds ratio43 3.094617e-01 1.64431732 1.000000e+00
odds ratio44 4.912945e-01 1.64575525 1.000000e+00
odds ratio45 1.000000e+00 1.03658564 1.000000e+00
odds ratio46 2.517413e-02 0.35197466 1.000000e+00
odds ratio47 2.722467e-02 0.36413548 1.000000e+00
odds ratio48 8.236572e-01 0.85827389 1.000000e+00
odds ratio49 7.259190e-01 1.44528601 1.000000e+00
odds ratio50 1.757768e-05 3.44259255 1.371059e-03
odds ratio51 5.463183e-02 3.45029365 1.000000e+00
odds ratio52 6.414804e-02 2.16429306 1.000000e+00
odds ratio53 3.392917e-01 0.73575757 1.000000e+00
odds ratio54 3.530675e-01 0.76150726 1.000000e+00
odds ratio55 5.795295e-02 1.79513469 1.000000e+00
odds ratio56 1.277963e-01 3.02448643 1.000000e+00
odds ratio57 1.000000e+00 1.01092564 1.000000e+00
odds ratio58 1.918810e-01 0.63042523 1.000000e+00
odds ratio59 3.259975e-11 0.21343616 2.542781e-09
odds ratio60 2.439770e-11 0.22086864 1.903021e-09
odds ratio61 6.644606e-03 0.52126543 5.182793e-01
odds ratio62 1.000000e+00 0.88527189 1.000000e+00
odds ratio63 5.073732e-01 0.62707234 1.000000e+00
odds ratio64 1.689878e-02 0.21195096 1.000000e+00
odds ratio65 1.853343e-02 0.21916221 1.000000e+00
odds ratio66 3.189673e-01 0.51672965 1.000000e+00
odds ratio67 1.000000e+00 0.87969356 1.000000e+00
odds ratio68 3.038301e-03 0.33930463 2.369875e-01
odds ratio69 3.432927e-03 0.35105813 2.677683e-01
odds ratio70 5.964717e-01 0.82769789 1.000000e+00
odds ratio71 7.416156e-01 1.39867338 1.000000e+00
odds ratio72 9.059635e-01 1.03510059 1.000000e+00
odds ratio73 4.754242e-04 2.44168532 3.708309e-02
odds ratio74 2.423421e-02 4.13230595 1.000000e+00
odds ratio75 4.032720e-04 2.35927724 3.145522e-02
odds ratio76 2.652527e-02 3.99587598 1.000000e+00
odds ratio77 3.532773e-01 1.69484985 1.000000e+00</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_disorders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-15" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="results-and-discussion-15"><span class="header-section-number">10.2.1</span> Results and Discussion</h3>
<p><em>Contingency Table and Chi-Square Test:</em></p>
<p>A contingency table was created stratifying disorder counts by RMT device use (the RMTMethods_group). The chi-square test was applied to examine whether the pattern of disorders is statistically independent of whether a participant used an RMT device.</p>
<p><em>Chi-square Statistic:</em></p>
<p>The test produced a chi-square value (with degrees of freedom corresponding to the table size) and a corresponding p-value below the standard significance threshold (p &lt; .05). This suggests that the distribution of specific disorders is not independent of the RMTMethods groups.</p>
<p><em>Effect Size – Cramer’s V:</em></p>
<p>Cramer’s V was computed to provide an estimate of the strength of the association between the categorical variables. A Cramer’s V value (ranging from 0 to 1) was reported. While a value close to zero would indicate a very weak association, the reported value gives an indication of a small to moderate (depending on the exact value) association between RMT device use and disorder reporting.</p>
<p><em>Standardized Residuals:</em></p>
<p>Standardized residuals were calculated from the contingency table. Residuals with an absolute value greater than 1.96 indicate cells that contribute significantly to the chi-square statistic. In practice, these highlight which combinations of disorder and RMTMethods group differ most from what would be expected under the null hypothesis of independence. Cells with |residual| &gt; 1.96 should be looked at as potential areas of interest or imbalance.</p>
<p><strong>Frequency Distribution and Percentages</strong></p>
<p><em>Frequency Calculations:</em> For each disorder category (only those with an overall count of at least 10 were included), counts were calculated separately for the RMTMethods groups.</p>
<p><em>Percentage Calculation:</em></p>
<p>Percentages were computed based on the subgroup total of participants within each RMTMethods group. This approach allows each group’s prevalence rate for specific disorders to be compared.</p>
<p><em>Interpretation of Frequencies:</em></p>
<p>• Disorders such as “Cancer”, “Depression”, “General Anxiety Disorder”, and “Asthma” (or similar common conditions) are shown with their total counts and the percentage they constitute within each RMTMethods group.</p>
<p>• The display of percentages along with the counts gives an immediate idea of the relative prevalence within each subgroup.</p>
<p><strong>Graphical Summary</strong></p>
<p><em>Bar Plot:</em> A faceted bar plot was created showing the counts (with percentage labels) for each disorder.</p>
<p><em>Axis and Legend:</em></p>
<p>• The disorder categories are listed on the y-axis in descending order by overall count.</p>
<p>• The bars are color-coded by the RMTMethods group (using a professional blue for “No (n = 1330)” and orange for “Yes (n = 228)”).</p>
<p><em>Text Labels:</em></p>
<p>The bars include labels with both the count and the computed percentage (e.g., “157 (21.4%)”) for clarity.</p>
<p><em>Title and Caption:</em></p>
<p>The plot title indicates the overall sample size (N = 1558), while the caption provides details about how percentages were calculated and summarizes the chi-square test results along with Cramer’s V.</p>
<p><strong>Overall Interpretation</strong></p>
<p><em>Association Between Disorders and RMT Device Use:</em></p>
<p>The chi-square test indicates that there is a statistically significant association between the disorders reported and the RMTMethods group (device use). This suggests that the pattern of health disorders is not completely similar between those who use an RMT device and those who do not. However, the effect size (Cramer’s V) provides insight into how strong this association is; if Cramer’s V is small, the association, while significant, might not be strong.</p>
<p><strong>Implications:</strong></p>
<p>• Researchers could investigate further why certain disorders differ between these groups. It may be that the use of RMT devices is more common in populations with specific health concerns, or it could suggest differential reporting.</p>
<p>• The standardized residuals help pinpoint which cells (i.e., specific disorders in a given RMTMethods group) deviate significantly from the expected frequency. This can drive further targeted investigations.</p>
<p><strong>Caveats:</strong></p>
<p>• The analysis focuses on disorders reported by participants who provided data (excluding non-responses such as “Prefer not to say”).</p>
<p>• The categorization process, including merging similar disorders (like various cancer types) into a single category, inherently aggregates some detailed information. Any subsequent interpretation should consider whether this level of aggregation is appropriate for the research question at hand.</p>
<p><strong>Conclusion</strong></p>
<p>In summary, the data processing and statistical analysis indicate that there are significant differences in how participants in different RMT device groups report their health disorders. The subsequent visualization provides a clear and insightful summary of the frequencies and percentages of the disorders, making it easier for researchers or stakeholders to quickly understand the distribution and the areas of significant deviation. This analysis can serve as a foundation for more detailed follow-up studies exploring the reasons behind these associations.</p>
</section>
</section>
</section>
<section id="years-of-playing" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Years of Playing</h1>
<section id="descriptive-stats-7" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="descriptive-stats-7"><span class="header-section-number">11.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="do">## yrsPlay_MAX</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode yrsPlay_MAX variable</span></span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yrsPlay_cat =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;5yrs"</span>,</span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"5-9yrs"</span>,</span>
<span id="cb306-10"><a href="#cb306-10" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"10-14yrs"</span>,</span>
<span id="cb306-11"><a href="#cb306-11" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"15-19yrs"</span>,</span>
<span id="cb306-12"><a href="#cb306-12" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"20+yrs"</span>,</span>
<span id="cb306-13"><a href="#cb306-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb306-14"><a href="#cb306-14" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;5yrs"</span>, <span class="st">"5-9yrs"</span>, <span class="st">"10-14yrs"</span>, <span class="st">"15-19yrs"</span>, <span class="st">"20+yrs"</span>)))</span>
<span id="cb306-15"><a href="#cb306-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-16"><a href="#cb306-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows with missing values</span></span>
<span id="cb306-17"><a href="#cb306-17" aria-hidden="true" tabindex="-1"></a>data_processed <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb306-18"><a href="#cb306-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(yrsPlay_cat))</span>
<span id="cb306-19"><a href="#cb306-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-20"><a href="#cb306-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N</span></span>
<span id="cb306-21"><a href="#cb306-21" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_processed)</span>
<span id="cb306-22"><a href="#cb306-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-23"><a href="#cb306-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create frequency table</span></span>
<span id="cb306-24"><a href="#cb306-24" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> data_processed <span class="sc">%&gt;%</span></span>
<span id="cb306-25"><a href="#cb306-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(yrsPlay_cat) <span class="sc">%&gt;%</span></span>
<span id="cb306-26"><a href="#cb306-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb306-27"><a href="#cb306-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb306-28"><a href="#cb306-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-29"><a href="#cb306-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot title</span></span>
<span id="cb306-30"><a href="#cb306-30" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of years of playing experience"</span></span>
<span id="cb306-31"><a href="#cb306-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-32"><a href="#cb306-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb306-33"><a href="#cb306-33" aria-hidden="true" tabindex="-1"></a>plot_years <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> yrsPlay_cat)) <span class="sc">+</span></span>
<span id="cb306-34"><a href="#cb306-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#4472C4"</span>) <span class="sc">+</span></span>
<span id="cb306-35"><a href="#cb306-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage)),</span>
<span id="cb306-36"><a href="#cb306-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb306-37"><a href="#cb306-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb306-38"><a href="#cb306-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(plot_title, <span class="st">" (N = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb306-39"><a href="#cb306-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb306-40"><a href="#cb306-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Years of playing experience"</span>,</span>
<span id="cb306-41"><a href="#cb306-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Note. Percentages were calculated out of the total sample."</span></span>
<span id="cb306-42"><a href="#cb306-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb306-43"><a href="#cb306-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb306-44"><a href="#cb306-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb306-45"><a href="#cb306-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb306-46"><a href="#cb306-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb306-47"><a href="#cb306-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb306-48"><a href="#cb306-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb306-49"><a href="#cb306-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb306-50"><a href="#cb306-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb306-51"><a href="#cb306-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb306-52"><a href="#cb306-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)))</span>
<span id="cb306-53"><a href="#cb306-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-54"><a href="#cb306-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb306-55"><a href="#cb306-55" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_years)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print frequency table</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a><span class="st">Frequency Table:\</span></span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Frequency Table:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(freq_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  yrsPlay_cat count percentage
  &lt;fct&gt;       &lt;int&gt;      &lt;dbl&gt;
1 &lt;5yrs         106       6.80
2 5-9yrs        305      19.6 
3 10-14yrs      323      20.7 
4 15-19yrs      172      11.0 
5 20+yrs        652      41.8 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate descriptive statistics</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="st">Descriptive Statistics:\</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Descriptive Statistics:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> data_processed <span class="sc">%&gt;%</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(yrsPlay_cat))),</span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_category =</span> <span class="fu">levels</span>(yrsPlay_cat)[<span class="fu">ceiling</span>(n<span class="sc">/</span><span class="dv">2</span>)]</span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
      n mode   median_category
  &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;          
1  1558 20+yrs &lt;NA&gt;           </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="do">## By instrument</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode overall yrsPlay_MAX into a categorical variable (not used in the instrument-specific analysis)</span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yrsPlay_cat =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;5yrs"</span>,</span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"5-9yrs"</span>,</span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"10-14yrs"</span>,</span>
<span id="cb315-11"><a href="#cb315-11" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"15-19yrs"</span>,</span>
<span id="cb315-12"><a href="#cb315-12" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"20+yrs"</span>,</span>
<span id="cb315-13"><a href="#cb315-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb315-14"><a href="#cb315-14" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;5yrs"</span>, <span class="st">"5-9yrs"</span>, <span class="st">"10-14yrs"</span>, <span class="st">"15-19yrs"</span>, <span class="st">"20+yrs"</span>)))</span>
<span id="cb315-15"><a href="#cb315-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-16"><a href="#cb315-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Define instrument columns and descriptive names</span></span>
<span id="cb315-17"><a href="#cb315-17" aria-hidden="true" tabindex="-1"></a>instrument_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yrsPlay_flute"</span>, <span class="st">"yrsPlay_picc"</span>, <span class="st">"yrsPlay_recorder"</span>, </span>
<span id="cb315-18"><a href="#cb315-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"yrsPlay_oboe"</span>, <span class="st">"yrsPlay_clari"</span>, <span class="st">"yrsPlay_bassoon"</span>,</span>
<span id="cb315-19"><a href="#cb315-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"yrsPlay_sax"</span>, <span class="st">"yrsPlay_trump"</span>, <span class="st">"yrsPlay_horn"</span>, </span>
<span id="cb315-20"><a href="#cb315-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"yrsPlay_bone"</span>, <span class="st">"yrsPlay_tuba"</span>, <span class="st">"yrsPlay_eupho"</span>,</span>
<span id="cb315-21"><a href="#cb315-21" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"yrsPlay_bagpipes"</span>, <span class="st">"yrsPlay_other"</span>)</span>
<span id="cb315-22"><a href="#cb315-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-23"><a href="#cb315-23" aria-hidden="true" tabindex="-1"></a>instrument_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb315-24"><a href="#cb315-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_flute   =</span> <span class="st">"Flute"</span>,</span>
<span id="cb315-25"><a href="#cb315-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_picc    =</span> <span class="st">"Piccolo"</span>,</span>
<span id="cb315-26"><a href="#cb315-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_recorder=</span> <span class="st">"Recorder"</span>, </span>
<span id="cb315-27"><a href="#cb315-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_oboe    =</span> <span class="st">"Oboe"</span>,</span>
<span id="cb315-28"><a href="#cb315-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_clari   =</span> <span class="st">"Clarinet"</span>,</span>
<span id="cb315-29"><a href="#cb315-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_bassoon =</span> <span class="st">"Bassoon"</span>,</span>
<span id="cb315-30"><a href="#cb315-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_sax     =</span> <span class="st">"Saxophone"</span>,</span>
<span id="cb315-31"><a href="#cb315-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_trump   =</span> <span class="st">"Trumpet"</span>,</span>
<span id="cb315-32"><a href="#cb315-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_horn    =</span> <span class="st">"Horn"</span>,</span>
<span id="cb315-33"><a href="#cb315-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_bone    =</span> <span class="st">"Trombone"</span>,</span>
<span id="cb315-34"><a href="#cb315-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_tuba    =</span> <span class="st">"Tuba"</span>,</span>
<span id="cb315-35"><a href="#cb315-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_eupho   =</span> <span class="st">"Euphonium"</span>,</span>
<span id="cb315-36"><a href="#cb315-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_bagpipes=</span> <span class="st">"Bagpipes"</span>,</span>
<span id="cb315-37"><a href="#cb315-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_other   =</span> <span class="st">"Other"</span></span>
<span id="cb315-38"><a href="#cb315-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb315-39"><a href="#cb315-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-40"><a href="#cb315-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the instrument-specific columns to long format and recode playing experience</span></span>
<span id="cb315-41"><a href="#cb315-41" aria-hidden="true" tabindex="-1"></a>data_instruments <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb315-42"><a href="#cb315-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(instrument_cols),</span>
<span id="cb315-43"><a href="#cb315-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"instrument"</span>,</span>
<span id="cb315-44"><a href="#cb315-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"yrsPlay_inst"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb315-45"><a href="#cb315-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(yrsPlay_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb315-46"><a href="#cb315-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb315-47"><a href="#cb315-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">yrsPlay_inst_cat =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb315-48"><a href="#cb315-48" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;5yrs"</span>,</span>
<span id="cb315-49"><a href="#cb315-49" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"5-9yrs"</span>,</span>
<span id="cb315-50"><a href="#cb315-50" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"10-14yrs"</span>,</span>
<span id="cb315-51"><a href="#cb315-51" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"15-19yrs"</span>,</span>
<span id="cb315-52"><a href="#cb315-52" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"20+yrs"</span>,</span>
<span id="cb315-53"><a href="#cb315-53" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb315-54"><a href="#cb315-54" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;5yrs"</span>, <span class="st">"5-9yrs"</span>, <span class="st">"10-14yrs"</span>, <span class="st">"15-19yrs"</span>, <span class="st">"20+yrs"</span>)),</span>
<span id="cb315-55"><a href="#cb315-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">instrument =</span> <span class="fu">factor</span>(instrument_names[instrument], <span class="at">levels =</span> instrument_names)</span>
<span id="cb315-56"><a href="#cb315-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb315-57"><a href="#cb315-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-58"><a href="#cb315-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency table: count and percentage by instrument and category</span></span>
<span id="cb315-59"><a href="#cb315-59" aria-hidden="true" tabindex="-1"></a>freq_table_instruments <span class="ot">&lt;-</span> data_instruments <span class="sc">%&gt;%</span></span>
<span id="cb315-60"><a href="#cb315-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument, yrsPlay_inst_cat) <span class="sc">%&gt;%</span></span>
<span id="cb315-61"><a href="#cb315-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb315-62"><a href="#cb315-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb315-63"><a href="#cb315-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count<span class="sc">/</span><span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb315-64"><a href="#cb315-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-65"><a href="#cb315-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical tests: For each instrument, perform a Chi-square test against uniform distribution</span></span>
<span id="cb315-66"><a href="#cb315-66" aria-hidden="true" tabindex="-1"></a><span class="co"># and compute Cramér's V as an effect size measure.</span></span>
<span id="cb315-67"><a href="#cb315-67" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> data_instruments <span class="sc">%&gt;%</span></span>
<span id="cb315-68"><a href="#cb315-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb315-69"><a href="#cb315-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb315-70"><a href="#cb315-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb315-71"><a href="#cb315-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">chi_sq =</span> <span class="fu">list</span>(<span class="fu">chisq.test</span>(<span class="fu">table</span>(yrsPlay_inst_cat))),</span>
<span id="cb315-72"><a href="#cb315-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">chi_sq_stat =</span> chi_sq[[<span class="dv">1</span>]]<span class="sc">$</span>statistic,</span>
<span id="cb315-73"><a href="#cb315-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> chi_sq[[<span class="dv">1</span>]]<span class="sc">$</span>p.value,</span>
<span id="cb315-74"><a href="#cb315-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> chi_sq[[<span class="dv">1</span>]]<span class="sc">$</span>parameter,</span>
<span id="cb315-75"><a href="#cb315-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">cramers_v =</span> <span class="fu">sqrt</span>(chi_sq_stat <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">length</span>(<span class="fu">levels</span>(yrsPlay_inst_cat))) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb315-76"><a href="#cb315-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb315-77"><a href="#cb315-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>chi_sq)</span>
<span id="cb315-78"><a href="#cb315-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-79"><a href="#cb315-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Create faceted plot with counts and percentages, one facet per instrument</span></span>
<span id="cb315-80"><a href="#cb315-80" aria-hidden="true" tabindex="-1"></a>plot_title_instruments <span class="ot">&lt;-</span> <span class="st">"Distribution of years of playing experience by instrument"</span></span>
<span id="cb315-81"><a href="#cb315-81" aria-hidden="true" tabindex="-1"></a>p_instruments <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table_instruments, </span>
<span id="cb315-82"><a href="#cb315-82" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> yrsPlay_inst_cat, <span class="at">y =</span> count, <span class="at">fill =</span> yrsPlay_inst_cat)) <span class="sc">+</span></span>
<span id="cb315-83"><a href="#cb315-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb315-84"><a href="#cb315-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb315-85"><a href="#cb315-85" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb315-86"><a href="#cb315-86" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb315-87"><a href="#cb315-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> instrument, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb315-88"><a href="#cb315-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> plot_title_instruments,</span>
<span id="cb315-89"><a href="#cb315-89" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Total responses:"</span>, <span class="fu">nrow</span>(data_instruments)),</span>
<span id="cb315-90"><a href="#cb315-90" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of playing experience"</span>,</span>
<span id="cb315-91"><a href="#cb315-91" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb315-92"><a href="#cb315-92" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Note: Chi-square tests performed for each instrument."</span>,</span>
<span id="cb315-93"><a href="#cb315-93" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"All p &lt; .001 indicate significant non-uniform distributions."</span></span>
<span id="cb315-94"><a href="#cb315-94" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb315-95"><a href="#cb315-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb315-96"><a href="#cb315-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb315-97"><a href="#cb315-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb315-98"><a href="#cb315-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb315-99"><a href="#cb315-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb315-100"><a href="#cb315-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb315-101"><a href="#cb315-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb315-102"><a href="#cb315-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb315-103"><a href="#cb315-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>)</span>
<span id="cb315-104"><a href="#cb315-104" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb315-105"><a href="#cb315-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb315-106"><a href="#cb315-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>)</span>
<span id="cb315-107"><a href="#cb315-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-108"><a href="#cb315-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb315-109"><a href="#cb315-109" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_instruments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print frequency table and significance test results</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Frequency Table for Instrument-specific Data:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Frequency Table for Instrument-specific Data:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(freq_table_instruments)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 70 × 4
# Groups:   instrument [14]
   instrument yrsPlay_inst_cat count percentage
   &lt;fct&gt;      &lt;fct&gt;            &lt;int&gt;      &lt;dbl&gt;
 1 Flute      &lt;5yrs               69      15.6 
 2 Flute      5-9yrs              95      21.4 
 3 Flute      10-14yrs            85      19.2 
 4 Flute      15-19yrs            37       8.35
 5 Flute      20+yrs             157      35.4 
 6 Piccolo    &lt;5yrs               37      17.7 
 7 Piccolo    5-9yrs              56      26.8 
 8 Piccolo    10-14yrs            32      15.3 
 9 Piccolo    15-19yrs            22      10.5 
10 Piccolo    20+yrs              62      29.7 
# ℹ 60 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance Test Results by Instrument:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Significance Test Results by Instrument:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   instrument     n chi_sq_stat  p_value    df cramers_v
   &lt;fct&gt;      &lt;int&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 Flute        443        87.8 3.86e-18     4     0.223
 2 Piccolo      209        26.8 2.17e- 5     4     0.179
 3 Recorder     136        57.9 8.02e-12     4     0.326
 4 Oboe         149        15.9 3.11e- 3     4     0.164
 5 Clarinet     410        82.4 5.30e-17     4     0.224
 6 Bassoon       91        11.7 1.98e- 2     4     0.179
 7 Saxophone    477        79.6 2.17e-16     4     0.204
 8 Trumpet      343       108.  1.78e-22     4     0.281
 9 Horn         160        11.6 2.09e- 2     4     0.134
10 Trombone     212        36.5 2.29e- 7     4     0.207
11 Tuba         129        20.7 3.58e- 4     4     0.200
12 Euphonium    133        24.0 7.88e- 5     4     0.213
13 Bagpipes      59        20.1 4.84e- 4     4     0.292
14 Other        125        16.2 2.81e- 3     4     0.180</code></pre>
</div>
</div>
<section id="results-and-discussion-16" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="results-and-discussion-16"><span class="header-section-number">11.1.1</span> Results and Discussion</h3>
<p>The distribution of participants’ years of experience playing wind instruments is as follows:</p>
<p>• The largest group is “20+yrs,” indicating a significant portion of participants have extensive experience.</p>
<p>• The second-largest group is “&lt;4yrs,” showing a notable number of beginners or those with limited experience.</p>
<p>• The middle categories (“5-9yrs,” “10-14yrs,” and “15-19yrs”) have progressively fewer participants, suggesting a gradual decline in representation as experience increases. This distribution suggests a bimodal pattern, with many participants either being beginners or highly experienced players.</p>
<p><strong>Interpretation</strong></p>
<p><em>Experience Skew:</em> The distribution is heavily skewed towards more experienced individuals: the highest percentage (41.85%) is in the “20+yrs” category, suggesting that a significant proportion of respondents have a long history of playing experience.</p>
<p><em>Intermediate Groups:</em> The 10-14yrs and 5-9yrs groups also represent substantial portions of the sample (roughly 20.73% and 19.58%, respectively), indicating that a majority of the sample falls within these mid-to-high ranges of experience.</p>
<p><em>Minority Group:</em> The least represented group is the “&lt;5yrs” category with only about 6.80% of the sample. This might imply either that the surveyed population tends to be more experienced or that newer players are underrepresented in this particular dataset.</p>
<p><strong>Implications</strong></p>
<p><em>Targeting and Marketing:</em> For stakeholders interested in reaching out to the largest segment, strategies might focus on highly experienced musicians, particularly those with more than 20 years of experience.</p>
<p><em>Support and Development:</em> Conversely, given the smaller sample of less experienced (&lt;5yrs) musicians, additional support or targeted outreach could be considered if the goal is to encourage growth or adoption among newer players.</p>
<p>In summary, the analysis shows a distinct predominance of highly experienced musicians, with the largest group having 20+ years of playing experience.</p>
<p><strong>By Instrument</strong></p>
<p><em>Overview and Data Reshaping</em> The analysis focused on recoding and comparing the years of playing experience across a variety of instruments. Each instrument-specific column (e.g., yrsPlay_flute, yrsPlay_picc, etc.) originally recorded experience on a scale from 1 to 5 was recoded into categorical groups:</p>
<p>1: &lt;5yrs2: 5-9yrs3: 10-14yrs4: 15-19yrs5: 20+yrs1: &lt;5yrs2: 5-9yrs3: 10-14yrs4: 15-19yrs5: 20+yrs</p>
<p>After reshaping the dataset into a long format (where each row corresponds to one instrument for a respondent), frequency counts and percentages were computed per instrument.</p>
<p><strong>Key Findings from the Frequency Analysis</strong></p>
<p><em>Participation Across Instruments:</em></p>
<p>The frequency table (illustrated in the analysis output) shows different levels of participation for each instrument. For instance:</p>
<p>• Flute: Records the highest number of responses (e.g., 443 observations for the flute) indicating that this instrument had significant representation in the sample.</p>
<p>• Clarinet and Recorder: Also show high participation, though slightly lower than the flute in some cases.</p>
<p>• Bassoon, Oboe, etc.: Typically have lower participant counts. For instance, for some double-reed instruments, counts are around or below 150, suggesting that fewer respondents play these instruments compared to more common instruments like the flute or clarinet.</p>
<p><em>Experience Distribution – General Patterns:</em></p>
<p>• Highly Experienced Players Are Predominant: Across several instruments (Flute, Piccolo, Recorder, Clarinet, Saxophone, and Trumpet), the highest frequency lies in the “20+yrs” category. This skew toward the highest level indicates that a significant number of respondents have been playing these instruments for more than 20 years.</p>
<p>• Diverse Experience Ranges: While some instruments show a clear concentration at the extremes (e.g., many having 20+ years), others such as the Oboe show a different pattern where, for instance, players in the “5-9yrs” category might be more common. These differences likely reflect entry age, learning duration, and perhaps the training regimes or availability of instruction for specific instruments.</p>
<p><strong>Statistical Testing and Significance</strong></p>
<p>For each instrument, a Chi-square test was performed to evaluate whether the observed distribution of playing experience categories deviates significantly from a uniform distribution (the null hypothesis). The test results are summarized by:</p>
<p><em>Chi-square Statistic and p-value:</em></p>
<p>In all presented cases, the p-values were extremely small (most reported as <span class="math inline">\(p &lt; 0.001\)</span> or even exactly <span class="math inline">\(p &lt; 3.86 \times 10^{-18}\)</span> in some cases). This indicates that the null hypothesis of a uniform distribution can be strongly rejected; in other words, for every instrument, the distribution of playing experience is not uniform.</p>
<p><em>Effect Size Using Cramér’s V:</em></p>
<p>Cramér’s V values ranged roughly from 0.16 to 0.33. While the interpretation of effect size can vary depending on context, these values suggest a small-to-moderate association between the instrument played and the experience category. The moderate effect sizes reinforce the inference that, even though each instrument shows a statistically significant non-uniform distribution, the degree of association is modest and may reflect underlying differences among instruments (for example, the different typical career trajectories or training regimens). ________________________________________ <strong>Graphical Representation</strong></p>
<p><em>The faceted bar plot - Visual Structure:</em></p>
<p>Each instrument is represented as its own facet, where the bars display the counts of respondents per experience category. The labels on the bars show both the raw counts and the percentage that the count represents within that instrument group. This makes it easy to compare the practical significance of the numbers across instruments.</p>
<p><em>Insights from the Plot:</em></p>
<p>• Instruments like the Flute and Clarinet tend to have a long tail in the “20+yrs” category, indicating that these instruments are often played over a long period by experienced musicians.</p>
<p>• In contrast, other instruments such as Oboe may reveal a slightly different experience profile, suggesting that fewer respondents reach the highest experience level—or that newer players are more prevalent in the sample.</p>
<p><em>Comprehensive Comparison:</em></p>
<p>By comparing across facets, viewers can quickly grasp how the distribution of playing experience differs by instrument—a valuable insight when considering curricular designs, marketing strategies for music education, or understanding career longevity within different instrumental sections (e.g., orchestral vs.&nbsp;band instruments).</p>
<p><strong>Interpretation and Implications</strong></p>
<p><em>Diversity &amp; Specialization:</em></p>
<p>• The clear predominance of experienced players (especially the “20+yrs” category) in many instruments implies that respondents are mostly well-established musicians. This might reflect the sampling frame of the survey, suggesting an overrepresentation of long-term practitioners.</p>
<p>• For instruments like the Oboe or Bassoon (typically less common), lower numbers may signal niche interest groups where early-career musicians have different trajectories or where training opportunities might be less available.</p>
<p><em>Targeted Interventions and Further Research:</em></p>
<p>• For Education and Outreach: If the goal is to foster new talent or broaden participation, it might be worth exploring why certain instruments have fewer less-experienced players. It could be due to a lack of beginner resources or lower availability.</p>
<p>• For Resource Allocation: Organizations and institutions (music schools, orchestras, etc.) may use this data to allocate resources more efficiently by understanding which instruments attract a diverse range of experience levels.</p>
<p><em>Statistical Robustness:</em></p>
<p>• The highly significant Chi-square results suggest that these patterns are not random – there is a genuine underlying structure in the distribution of years of playing experience across instruments.</p>
<p>• The modest effect sizes (Cramér’s V) indicate that although the differences are statistically significant, the practical magnitude of the association is moderate. This nuance is important when making decisions or crafting policies based solely on statistical outcomes versus contextual considerations.</p>
<p><strong>Conclusion</strong></p>
<p>In summary, the analysis reveals that:</p>
<p>• The playing experience–related distribution is significantly non-uniform across various instruments.</p>
<p>• There is a marked skew toward high levels of experience for instruments such as the Flute and Clarinet.</p>
<p>• Statistically significant differences exist among the instruments, though effect sizes suggest these associations are moderate.</p>
<p>• These insights can inform further qualitative investigations, resource planning, or targeted interventions in music education and practice.</p>
</section>
</section>
<section id="inferential-stats-1" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="inferential-stats-1"><span class="header-section-number">11.2</span> Inferential Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Data Preparation Function</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>prepare_years_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path) {</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the data</span></span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure numeric conversion and handle potential NA values</span></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to numeric, replacing NA with a safe default</span></span>
<span id="cb324-11"><a href="#cb324-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">yrsPlay_MAX =</span> <span class="fu">as.numeric</span>(yrsPlay_MAX),</span>
<span id="cb324-12"><a href="#cb324-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">as.numeric</span>(RMTMethods_YN)</span>
<span id="cb324-13"><a href="#cb324-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb324-14"><a href="#cb324-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb324-15"><a href="#cb324-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recode yrsPlay_MAX variable with robust handling</span></span>
<span id="cb324-16"><a href="#cb324-16" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb324-17"><a href="#cb324-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">yrsPlay_cat =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb324-18"><a href="#cb324-18" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;5yrs"</span>,</span>
<span id="cb324-19"><a href="#cb324-19" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"5-9yrs"</span>,</span>
<span id="cb324-20"><a href="#cb324-20" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"10-14yrs"</span>,</span>
<span id="cb324-21"><a href="#cb324-21" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"15-19yrs"</span>,</span>
<span id="cb324-22"><a href="#cb324-22" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"20+yrs"</span>,</span>
<span id="cb324-23"><a href="#cb324-23" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb324-24"><a href="#cb324-24" aria-hidden="true" tabindex="-1"></a>      ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;5yrs"</span>, <span class="st">"5-9yrs"</span>, <span class="st">"10-14yrs"</span>, <span class="st">"15-19yrs"</span>, <span class="st">"20+yrs"</span>)))</span>
<span id="cb324-25"><a href="#cb324-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb324-26"><a href="#cb324-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recode RMTMethods_YN into group labels with robust handling</span></span>
<span id="cb324-27"><a href="#cb324-27" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb324-28"><a href="#cb324-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">RMTMethods_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb324-29"><a href="#cb324-29" aria-hidden="true" tabindex="-1"></a>        RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No (n = 1330)"</span>,</span>
<span id="cb324-30"><a href="#cb324-30" aria-hidden="true" tabindex="-1"></a>        RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Yes (n = 228)"</span>,</span>
<span id="cb324-31"><a href="#cb324-31" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb324-32"><a href="#cb324-32" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb324-33"><a href="#cb324-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb324-34"><a href="#cb324-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter out rows with missing values</span></span>
<span id="cb324-35"><a href="#cb324-35" aria-hidden="true" tabindex="-1"></a>    data_processed <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb324-36"><a href="#cb324-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(yrsPlay_cat) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_group))</span>
<span id="cb324-37"><a href="#cb324-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb324-38"><a href="#cb324-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(data_processed)</span>
<span id="cb324-39"><a href="#cb324-39" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb324-40"><a href="#cb324-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error in data preparation:"</span>, e<span class="sc">$</span>message))</span>
<span id="cb324-41"><a href="#cb324-41" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb324-42"><a href="#cb324-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb324-43"><a href="#cb324-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-44"><a href="#cb324-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Statistical Testing Function</span></span>
<span id="cb324-45"><a href="#cb324-45" aria-hidden="true" tabindex="-1"></a>perform_robust_statistical_test <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb324-46"><a href="#cb324-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check expected cell frequencies</span></span>
<span id="cb324-47"><a href="#cb324-47" aria-hidden="true" tabindex="-1"></a>  expected_freq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table)<span class="sc">$</span>expected</span>
<span id="cb324-48"><a href="#cb324-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-49"><a href="#cb324-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Criteria for test selection</span></span>
<span id="cb324-50"><a href="#cb324-50" aria-hidden="true" tabindex="-1"></a>  total_cells <span class="ot">&lt;-</span> <span class="fu">length</span>(expected_freq)</span>
<span id="cb324-51"><a href="#cb324-51" aria-hidden="true" tabindex="-1"></a>  low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb324-52"><a href="#cb324-52" aria-hidden="true" tabindex="-1"></a>  min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb324-53"><a href="#cb324-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-54"><a href="#cb324-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print diagnostic information</span></span>
<span id="cb324-55"><a href="#cb324-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-56"><a href="#cb324-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-57"><a href="#cb324-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb324-58"><a href="#cb324-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">"out of"</span>, total_cells, <span class="st">"cells ("</span>, </span>
<span id="cb324-59"><a href="#cb324-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> total_cells <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb324-60"><a href="#cb324-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-61"><a href="#cb324-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select appropriate test</span></span>
<span id="cb324-62"><a href="#cb324-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> total_cells) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb324-63"><a href="#cb324-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use Fisher's exact test with Monte Carlo simulation</span></span>
<span id="cb324-64"><a href="#cb324-64" aria-hidden="true" tabindex="-1"></a>    exact_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(cont_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb324-65"><a href="#cb324-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb324-66"><a href="#cb324-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb324-67"><a href="#cb324-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test (Monte Carlo)"</span>,</span>
<span id="cb324-68"><a href="#cb324-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> exact_test<span class="sc">$</span>p.value,</span>
<span id="cb324-69"><a href="#cb324-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="cn">NA</span>,</span>
<span id="cb324-70"><a href="#cb324-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb324-71"><a href="#cb324-71" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb324-72"><a href="#cb324-72" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb324-73"><a href="#cb324-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb324-74"><a href="#cb324-74" aria-hidden="true" tabindex="-1"></a>    chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb324-75"><a href="#cb324-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb324-76"><a href="#cb324-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb324-77"><a href="#cb324-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Chi-Square with Continuity Correction"</span>,</span>
<span id="cb324-78"><a href="#cb324-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> chi_test<span class="sc">$</span>p.value,</span>
<span id="cb324-79"><a href="#cb324-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> chi_test<span class="sc">$</span>statistic,</span>
<span id="cb324-80"><a href="#cb324-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameter =</span> chi_test<span class="sc">$</span>parameter,</span>
<span id="cb324-81"><a href="#cb324-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="fu">paste</span>(<span class="st">"Pearson's Chi-squared test with Yates' continuity correction,"</span>,</span>
<span id="cb324-82"><a href="#cb324-82" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"df ="</span>, chi_test<span class="sc">$</span>parameter)</span>
<span id="cb324-83"><a href="#cb324-83" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb324-84"><a href="#cb324-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb324-85"><a href="#cb324-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb324-86"><a href="#cb324-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-87"><a href="#cb324-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Main Analysis Function</span></span>
<span id="cb324-88"><a href="#cb324-88" aria-hidden="true" tabindex="-1"></a>run_years_playing_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb324-89"><a href="#cb324-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_path =</span> <span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span></span>
<span id="cb324-90"><a href="#cb324-90" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb324-91"><a href="#cb324-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb324-92"><a href="#cb324-92" aria-hidden="true" tabindex="-1"></a>  data_processed <span class="ot">&lt;-</span> <span class="fu">prepare_years_data</span>(file_path)</span>
<span id="cb324-93"><a href="#cb324-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-94"><a href="#cb324-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total number of observations used</span></span>
<span id="cb324-95"><a href="#cb324-95" aria-hidden="true" tabindex="-1"></a>  total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_processed)</span>
<span id="cb324-96"><a href="#cb324-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-97"><a href="#cb324-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create frequency table</span></span>
<span id="cb324-98"><a href="#cb324-98" aria-hidden="true" tabindex="-1"></a>  freq_table <span class="ot">&lt;-</span> data_processed <span class="sc">%&gt;%</span></span>
<span id="cb324-99"><a href="#cb324-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(yrsPlay_cat, RMTMethods_group) <span class="sc">%&gt;%</span></span>
<span id="cb324-100"><a href="#cb324-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb324-101"><a href="#cb324-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_group) <span class="sc">%&gt;%</span></span>
<span id="cb324-102"><a href="#cb324-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb324-103"><a href="#cb324-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-104"><a href="#cb324-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create contingency table</span></span>
<span id="cb324-105"><a href="#cb324-105" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_processed<span class="sc">$</span>yrsPlay_cat, data_processed<span class="sc">$</span>RMTMethods_group)</span>
<span id="cb324-106"><a href="#cb324-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-107"><a href="#cb324-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform robust statistical test</span></span>
<span id="cb324-108"><a href="#cb324-108" aria-hidden="true" tabindex="-1"></a>  stat_test <span class="ot">&lt;-</span> <span class="fu">perform_robust_statistical_test</span>(contingency_table)</span>
<span id="cb324-109"><a href="#cb324-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-110"><a href="#cb324-110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate Cramer's V</span></span>
<span id="cb324-111"><a href="#cb324-111" aria-hidden="true" tabindex="-1"></a>  n_val <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb324-112"><a href="#cb324-112" aria-hidden="true" tabindex="-1"></a>  min_dim <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb324-113"><a href="#cb324-113" aria-hidden="true" tabindex="-1"></a>  cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(stat_test<span class="sc">$</span>statistic <span class="sc">/</span> (n_val <span class="sc">*</span> min_dim))</span>
<span id="cb324-114"><a href="#cb324-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-115"><a href="#cb324-115" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the Plot</span></span>
<span id="cb324-116"><a href="#cb324-116" aria-hidden="true" tabindex="-1"></a>  plot_years <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> yrsPlay_cat, <span class="at">fill =</span> RMTMethods_group)) <span class="sc">+</span></span>
<span id="cb324-117"><a href="#cb324-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb324-118"><a href="#cb324-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb324-119"><a href="#cb324-119" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage)),</span>
<span id="cb324-120"><a href="#cb324-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>),</span>
<span id="cb324-121"><a href="#cb324-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, </span>
<span id="cb324-122"><a href="#cb324-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb324-123"><a href="#cb324-123" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb324-124"><a href="#cb324-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb324-125"><a href="#cb324-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Years of playing experience by RMT device use (N = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb324-126"><a href="#cb324-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb324-127"><a href="#cb324-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Years of playing experience"</span>,</span>
<span id="cb324-128"><a href="#cb324-128" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"RMT device use"</span>,</span>
<span id="cb324-129"><a href="#cb324-129" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb324-130"><a href="#cb324-130" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Note. Percentages calculated within RMT device groups.</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb324-131"><a href="#cb324-131" aria-hidden="true" tabindex="-1"></a>        stat_test<span class="sc">$</span>method, <span class="st">": p = "</span>, <span class="fu">format.pval</span>(stat_test<span class="sc">$</span>p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb324-132"><a href="#cb324-132" aria-hidden="true" tabindex="-1"></a>        <span class="st">", Cramer's V = "</span>, <span class="fu">round</span>(cramers_v, <span class="dv">3</span>)</span>
<span id="cb324-133"><a href="#cb324-133" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb324-134"><a href="#cb324-134" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb324-135"><a href="#cb324-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb324-136"><a href="#cb324-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb324-137"><a href="#cb324-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb324-138"><a href="#cb324-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb324-139"><a href="#cb324-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb324-140"><a href="#cb324-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">40</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb324-141"><a href="#cb324-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb324-142"><a href="#cb324-142" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb324-143"><a href="#cb324-143" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb324-144"><a href="#cb324-144" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb324-145"><a href="#cb324-145" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb324-146"><a href="#cb324-146" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb324-147"><a href="#cb324-147" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb324-148"><a href="#cb324-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>))) <span class="sc">+</span></span>
<span id="cb324-149"><a href="#cb324-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No (n = 1330)"</span> <span class="ot">=</span> <span class="st">"#4472C4"</span>, <span class="st">"Yes (n = 228)"</span> <span class="ot">=</span> <span class="st">"#ED7D31"</span>))</span>
<span id="cb324-150"><a href="#cb324-150" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-151"><a href="#cb324-151" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print statistical results</span></span>
<span id="cb324-152"><a href="#cb324-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Contingency Table:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-153"><a href="#cb324-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(contingency_table)</span>
<span id="cb324-154"><a href="#cb324-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-155"><a href="#cb324-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statistical Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-156"><a href="#cb324-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Test Type:"</span>, stat_test<span class="sc">$</span>test_type, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-157"><a href="#cb324-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"P-value:"</span>, stat_test<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-158"><a href="#cb324-158" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stat_test<span class="sc">$</span>test_type <span class="sc">==</span> <span class="st">"Chi-Square with Continuity Correction"</span>) {</span>
<span id="cb324-159"><a href="#cb324-159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Chi-square Statistic:"</span>, stat_test<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-160"><a href="#cb324-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Degrees of Freedom:"</span>, stat_test<span class="sc">$</span>parameter, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-161"><a href="#cb324-161" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb324-162"><a href="#cb324-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cramer's V:"</span>, cramers_v, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb324-163"><a href="#cb324-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-164"><a href="#cb324-164" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the plot</span></span>
<span id="cb324-165"><a href="#cb324-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot_years)</span>
<span id="cb324-166"><a href="#cb324-166" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb324-167"><a href="#cb324-167" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results for potential further analysis</span></span>
<span id="cb324-168"><a href="#cb324-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb324-169"><a href="#cb324-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">freq_table =</span> freq_table,</span>
<span id="cb324-170"><a href="#cb324-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">contingency_table =</span> contingency_table,</span>
<span id="cb324-171"><a href="#cb324-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat_test =</span> stat_test,</span>
<span id="cb324-172"><a href="#cb324-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">cramers_v =</span> cramers_v,</span>
<span id="cb324-173"><a href="#cb324-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> plot_years</span>
<span id="cb324-174"><a href="#cb324-174" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb324-175"><a href="#cb324-175" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb324-176"><a href="#cb324-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-177"><a href="#cb324-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the analysis</span></span>
<span id="cb324-178"><a href="#cb324-178" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_years_playing_analysis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Expected Frequency Analysis:
Minimum Expected Frequency: 15.51 
Cells with Expected Frequency &lt; 5: 0 out of 10 cells ( 0 %)


Contingency Table:
          
           No (n = 1330) Yes (n = 228)
  &lt;5yrs               96            10
  5-9yrs             264            41
  10-14yrs           258            65
  15-19yrs           144            28
  20+yrs             568            84

Statistical Test Results:
Test Type: Chi-Square with Continuity Correction 
P-value: 0.01457866 
Chi-square Statistic: 12.40529 
Degrees of Freedom: 4 
Cramer's V: 0.08923182 </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-17" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="results-and-discussion-17"><span class="header-section-number">11.2.1</span> Results and Discussion</h3>
<p><strong>Chi-square Test of Independence:</strong></p>
<p>[1] “-square test of independence:”</p>
<p><strong>Pearson’s Chi-squared test</strong> data: contingency_table X-squared = 12.405, df = 4, p-value = 0.01458 The chi-square test shows a significant association between years of playing experience and RMT usage (χ²(4) = 12.41, p = .015).</p>
<p><strong>Standardized Residuals:</strong> The standardized residuals show that:</p>
<p>• The 10-14 years group has significantly more RMT users than expected (3.14)</p>
<p>• Other groups show some variation but not at statistically significant levels</p>
<p>After Bonferroni correction, there is:</p>
<p>• A significant difference between the 10-14 years and 20+ years groups (p = .042)</p>
<p>• All other pairwise comparisons are not statistically significant Key Findings:</p>
<p>• RMT usage varies significantly across experience groups</p>
<p>• The 10-14 years group shows the highest proportion of RMT users (20.1%)</p>
<p>• The &lt;4 years group shows the lowest proportion of RMT users (9.4%)</p>
<p>• There’s a notable peak in RMT usage in the middle experience ranges (10-14 years) with lower usage in both very experienced and novice players</p>
<p><strong>Distribution Overview</strong></p>
<p>Total Sample Size: N = 1,558</p>
<p>• RMT Device Non-Users: n = 1,330 (85.4%)</p>
<p>• RMT Device Users: n = 228 (14.6%)</p>
<p><strong>Years of Playing Experience Distribution</strong></p>
<p>Non-RMT Device Users (n = 1,330):*</p>
<p>• &lt;5 years: 96 (7.2%)</p>
<p>• 5-9 years: 264 (19.8%)</p>
<p>• 10-14 years: 258 (19.4%)</p>
<p>• 15-19 years: 144 (10.8%)</p>
<p>• 20+ years: 568 (42.7%)</p>
<p><em>RMT Device Users (n = 228):</em></p>
<p>• &lt;5 years: 10 (4.4%)</p>
<p>• 5-9 years: 41 (18.0%)</p>
<p>• 10-14 years: 65 (28.5%)</p>
<p>• 15-19 years: 28 (12.3%)</p>
<p>• 20+ years: 84 (36.8%)</p>
<p><strong>Statistical Analysis</strong> <em>Chi-square Test Results:</em></p>
<p>• χ²(4) = 12.405, p = 0.015</p>
<p>• This indicates a statistically significant association between years of playing experience and RMT device use</p>
<p>• The p-value (0.015) is below the conventional significance level of 0.05</p>
<p><strong>Effect Size:</strong></p>
<p>• Cramer’s V = 0.089</p>
<p>• This suggests a weak association between years of playing experience and RMT device use</p>
<p>• Values of Cramer’s V range from 0 to 1, where:</p>
<p>• 0.1 indicates a small effect</p>
<p>• 0.3 indicates a medium effect</p>
<p>• 0.5 indicates a large effect</p>
<p><strong>Key Findings and Interpretation</strong> <em>Experience Level Distribution:</em></p>
<p>• In both groups, the largest proportion of musicians had 20+ years of experience</p>
<p>• The second most common category differed between groups:</p>
<p>• Non-RMT users: 5-9 years (19.8%)</p>
<p>• RMT users: 10-14 years (28.5%)</p>
<p><strong>Notable Differences:</strong></p>
<p>• The proportion of musicians with 10-14 years of experience is notably higher among RMT device users (28.5%) compared to non-users (19.4%)</p>
<p>• There is a lower proportion of very experienced musicians (20+ years) among RMT device users (36.8%) compared to non-users (42.7%)</p>
<p>• Early-career musicians (&lt;5 years) are less represented among RMT device users (4.4%) compared to non-users (7.2%)</p>
<p><strong>Statistical Significance:</strong></p>
<p>• While the chi-square test indicates a significant association (p = 0.015), the small Cramer’s V value (0.089) suggests this association is weak</p>
<p>• This means that while there is a relationship between years of experience and RMT device use, other factors likely play a more important role in determining RMT device adoption</p>
<p><strong>Practical Implications</strong></p>
<p><em>Experience Level Considerations:</em> • RMT devices appear to be more commonly adopted by musicians in their mid-career stages (10-14 years)</p>
<p>• The lower adoption rate among very early-career musicians (&lt;5 years) might suggest barriers to entry (e.g., cost, awareness) or perceived lack of necessity</p>
<p><em>Professional Development:</em></p>
<p>• The distribution suggests that RMT devices are used across all experience levels, but with varying adoption rates</p>
<p>• The peak in the 10-14 years category among RMT users might indicate a career stage where musicians are most likely to incorporate new technologies</p>
<p><em>Market Insights:</em></p>
<p>• There might be opportunities to increase RMT device adoption among both very experienced (20+ years) and early-career (&lt;5 years) musicians</p>
<p>• The relatively lower adoption rates in these groups could indicate either unmet needs or barriers to adoption that could be addressed</p>
<p><strong>Limitations</strong></p>
<p>• The analysis doesn’t account for other variables that might influence RMT device adoption</p>
<p>• The categorical nature of the experience levels might mask more nuanced patterns within each category</p>
<p>• The significant but weak association suggests that years of experience alone is not a strong predictor of RMT device use Comparison of Individual instrument years of experience and RMT groups:</p>
<p><strong>Key Findings:</strong></p>
<p><em>Significant Associations:</em></p>
<p>Several instruments showed statistically significant associations (p &lt; 0.05) between years of playing experience and device use:</p>
<p>• Recorder (p = 0.0204)</p>
<p>• Oboe (p = 0.0034)</p>
<p>• Clarinet (p = 0.0062)</p>
<p>• Bassoon (p = 0.0103)</p>
<p><strong>Effect Sizes (Cramér’s V): The strength of associations varies:</strong></p>
<p>• Strongest: Bassoon (V = 0.3809)</p>
<p>• Moderate: Oboe (V = 0.3249)</p>
<p>• Moderate: Recorder (V = 0.2923)</p>
<p>• Weaker: Clarinet (V = 0.1871)</p>
<p><strong>Non-Significant Associations: Some instruments showed no significant relationship</strong> between experience and device use:</p>
<p>• Flute (p = 0.3709)</p>
<p>• Piccolo (p = 0.1496) Detailed Analysis by Instrument Group: Let’s examine the contingency tables:</p>
<ol type="1">
<li>Woodwinds (Flute, Clarinet):</li>
</ol>
<p>• Flute shows no significant association (χ² = 4.27, p = 0.3709)</p>
<p>• Clarinet shows significant association (χ² = 14.36, p = 0.0062)</p>
<ol start="2" type="1">
<li>Double Reeds (Oboe, Bassoon):</li>
</ol>
<p>• Both show significant associations</p>
<p>• Strongest effect sizes among all instruments</p>
<p>• Bassoon: V = 0.3809</p>
<p>• Oboe: V = 0.3249</p>
<ol start="3" type="1">
<li>Secondary Instruments (Piccolo, Recorder):</li>
</ol>
<p>• Piccolo: No significant association</p>
<p>• Recorder: Significant association (p = 0.0204)</p>
<p><strong>Practical Implications:</strong></p>
<ol type="1">
<li>Device Usage Patterns:</li>
</ol>
<p>• Double reed players show the strongest relationship between experience level and device use</p>
<p>• This might reflect the complexity of these instruments and the potential benefits of technological assistance</p>
<ol start="2" type="1">
<li>Experience Level Considerations:</li>
</ol>
<p>• The relationship between experience and device use varies substantially by instrument</p>
<p>• More experienced players in some instruments (e.g., double reeds) show different device usage patterns compared to less experienced players</p>
<ol start="3" type="1">
<li>Educational Implications:</li>
</ol>
<p>• The varying associations suggest that device use might be more beneficial or more readily adopted in certain instrument groups</p>
<p>• This could inform targeted educational strategies and resource allocation</p>
<p><strong>Statistical Notes:</strong></p>
<p><em>1. Warning Messages:</em></p>
<p>• Some chi-square approximations may be less reliable due to small cell counts</p>
<p>• This particularly affects instruments with smaller sample sizes</p>
<p><em>2. Effect Size Interpretation:</em></p>
<p>• Cramér’s V values:</p>
<p>• &lt; 0.1: Negligible association</p>
<p>• 0.1 - 0.2: Weak association</p>
<p>• 0.2 - 0.3: Moderate association</p>
<p>• 0.3: Strong association</p>
<p><strong>Recommendations:</strong></p>
<p><em>1. Further Research:</em></p>
<p>• Investigate why double reed instruments show stronger associations</p>
<p>• Examine the specific types of devices used across different experience levels</p>
<p><em>2. Practical Applications:</em></p>
<p>• Consider instrument-specific approaches to device integration in teaching</p>
<p>• Focus on understanding why certain instrument groups show stronger associations with device use</p>
<p><em>3. Methodological Considerations:</em></p>
<p>• For instruments with smaller sample sizes, consider collecting additional data</p>
<p>• Consider using Fisher’s exact test for smaller sample sizes where chi-square approximations may be less reliable</p>
</section>
</section>
</section>
<section id="frequency-of-playing" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Frequency of Playing</h1>
<section id="descriptive-stats-8" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="descriptive-stats-8"><span class="header-section-number">12.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Statistical Testing Function</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>perform_robust_statistical_test <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, <span class="at">expected =</span> <span class="cn">NULL</span>) {</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If no expected frequencies provided, assume uniform distribution</span></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(expected)) {</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>    expected <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(observed), <span class="fu">length</span>(observed))</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute expected frequencies</span></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>  total_n <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>  expected_freq <span class="ot">&lt;-</span> expected <span class="sc">*</span> total_n</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Diagnostic frequency checks</span></span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Total Observations:"</span>, total_n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Observed Frequencies:"</span>, <span class="fu">paste</span>(observed, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected Frequencies:"</span>, <span class="fu">paste</span>(<span class="fu">round</span>(expected_freq, <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-17"><a href="#cb326-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb326-18"><a href="#cb326-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check chi-square test assumptions</span></span>
<span id="cb326-19"><a href="#cb326-19" aria-hidden="true" tabindex="-1"></a>  low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb326-20"><a href="#cb326-20" aria-hidden="true" tabindex="-1"></a>  min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb326-21"><a href="#cb326-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb326-22"><a href="#cb326-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Expected Frequency Diagnostics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-23"><a href="#cb326-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-24"><a href="#cb326-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb326-25"><a href="#cb326-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"out of"</span>, <span class="fu">length</span>(observed), <span class="st">"cells ("</span>, </span>
<span id="cb326-26"><a href="#cb326-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> <span class="fu">length</span>(observed) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb326-27"><a href="#cb326-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb326-28"><a href="#cb326-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select appropriate test</span></span>
<span id="cb326-29"><a href="#cb326-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> <span class="fu">length</span>(observed)) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb326-30"><a href="#cb326-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use Fisher's exact test</span></span>
<span id="cb326-31"><a href="#cb326-31" aria-hidden="true" tabindex="-1"></a>    fisher_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(</span>
<span id="cb326-32"><a href="#cb326-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span>(<span class="fu">c</span>(observed, expected_freq), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), </span>
<span id="cb326-33"><a href="#cb326-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, </span>
<span id="cb326-34"><a href="#cb326-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">B =</span> <span class="dv">10000</span></span>
<span id="cb326-35"><a href="#cb326-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb326-36"><a href="#cb326-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-37"><a href="#cb326-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Test Selection: Fisher's Exact Test (Monte Carlo Simulation)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-38"><a href="#cb326-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"P-value:"</span>, fisher_test<span class="sc">$</span>p.value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-39"><a href="#cb326-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-40"><a href="#cb326-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb326-41"><a href="#cb326-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test"</span>,</span>
<span id="cb326-42"><a href="#cb326-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> fisher_test<span class="sc">$</span>p.value,</span>
<span id="cb326-43"><a href="#cb326-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb326-44"><a href="#cb326-44" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb326-45"><a href="#cb326-45" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb326-46"><a href="#cb326-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb326-47"><a href="#cb326-47" aria-hidden="true" tabindex="-1"></a>    chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> observed, <span class="at">p =</span> expected, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb326-48"><a href="#cb326-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-49"><a href="#cb326-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Test Selection: Chi-square Test with Yates' Correction</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-50"><a href="#cb326-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Chi-square Statistic:"</span>, chi_test<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-51"><a href="#cb326-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"P-value:"</span>, chi_test<span class="sc">$</span>p.value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-52"><a href="#cb326-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-53"><a href="#cb326-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate Cramér's V</span></span>
<span id="cb326-54"><a href="#cb326-54" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">length</span>(observed)</span>
<span id="cb326-55"><a href="#cb326-55" aria-hidden="true" tabindex="-1"></a>    cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (total_n <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb326-56"><a href="#cb326-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cramér's V:"</span>, cramers_v, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb326-57"><a href="#cb326-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb326-58"><a href="#cb326-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb326-59"><a href="#cb326-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Chi-square Test"</span>,</span>
<span id="cb326-60"><a href="#cb326-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> chi_test<span class="sc">$</span>statistic,</span>
<span id="cb326-61"><a href="#cb326-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> chi_test<span class="sc">$</span>p.value,</span>
<span id="cb326-62"><a href="#cb326-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">cramers_v =</span> cramers_v,</span>
<span id="cb326-63"><a href="#cb326-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"Chi-square Test with Yates' Continuity Correction"</span></span>
<span id="cb326-64"><a href="#cb326-64" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb326-65"><a href="#cb326-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb326-66"><a href="#cb326-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb326-67"><a href="#cb326-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-68"><a href="#cb326-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb326-69"><a href="#cb326-69" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb326-70"><a href="#cb326-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-71"><a href="#cb326-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure freqPlay_MAX is numeric and handle potential NA values</span></span>
<span id="cb326-72"><a href="#cb326-72" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb326-73"><a href="#cb326-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb326-74"><a href="#cb326-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">freqPlay_MAX =</span> <span class="fu">as.numeric</span>(freqPlay_MAX)</span>
<span id="cb326-75"><a href="#cb326-75" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb326-76"><a href="#cb326-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-77"><a href="#cb326-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode freqPlay_MAX into new frequency categories</span></span>
<span id="cb326-78"><a href="#cb326-78" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb326-79"><a href="#cb326-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb326-80"><a href="#cb326-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb326-81"><a href="#cb326-81" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"About once a month"</span>,</span>
<span id="cb326-82"><a href="#cb326-82" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Multiple times per month"</span>,</span>
<span id="cb326-83"><a href="#cb326-83" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"About once a week"</span>,</span>
<span id="cb326-84"><a href="#cb326-84" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Multiple times per week"</span>,</span>
<span id="cb326-85"><a href="#cb326-85" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Everyday"</span>,</span>
<span id="cb326-86"><a href="#cb326-86" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb326-87"><a href="#cb326-87" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb326-88"><a href="#cb326-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"About once a month"</span>, <span class="st">"Multiple times per month"</span>, <span class="st">"About once a week"</span>, <span class="st">"Multiple times per week"</span>, <span class="st">"Everyday"</span>))</span>
<span id="cb326-89"><a href="#cb326-89" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb326-90"><a href="#cb326-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-91"><a href="#cb326-91" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create Frequency Table</span></span>
<span id="cb326-92"><a href="#cb326-92" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb326-93"><a href="#cb326-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(frequency) <span class="sc">%&gt;%</span></span>
<span id="cb326-94"><a href="#cb326-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb326-95"><a href="#cb326-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb326-96"><a href="#cb326-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-97"><a href="#cb326-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total sample size</span></span>
<span id="cb326-98"><a href="#cb326-98" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">sum</span>(freq_table<span class="sc">$</span>count)</span>
<span id="cb326-99"><a href="#cb326-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-100"><a href="#cb326-100" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Perform Statistical Analysis</span></span>
<span id="cb326-101"><a href="#cb326-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed frequencies</span></span>
<span id="cb326-102"><a href="#cb326-102" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> freq_table<span class="sc">$</span>count</span>
<span id="cb326-103"><a href="#cb326-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-104"><a href="#cb326-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform robust statistical test</span></span>
<span id="cb326-105"><a href="#cb326-105" aria-hidden="true" tabindex="-1"></a>stat_test <span class="ot">&lt;-</span> <span class="fu">perform_robust_statistical_test</span>(</span>
<span id="cb326-106"><a href="#cb326-106" aria-hidden="true" tabindex="-1"></a>  observed, </span>
<span id="cb326-107"><a href="#cb326-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">expected =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(<span class="fu">levels</span>(data<span class="sc">$</span>frequency)), <span class="fu">length</span>(<span class="fu">levels</span>(data<span class="sc">$</span>frequency)))</span>
<span id="cb326-108"><a href="#cb326-108" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Expected Frequency Analysis:
Total Observations: 1558 
Observed Frequencies: 48, 72, 201, 635, 602 
Expected Frequencies: 311.6, 311.6, 311.6, 311.6, 311.6 

Expected Frequency Diagnostics:
Minimum Expected Frequency: 311.6 
Cells with Expected Frequency &lt; 5: 0 out of 5 cells ( 0 %)

Test Selection: Chi-square Test with Yates' Correction
Chi-square Statistic: 1052.777 
P-value: 1.301933e-226 
Cramér's V: 0.4110119 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Create the Plot</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Frequency of Practice"</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table, <span class="fu">aes</span>(<span class="at">x =</span> frequency, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#4472C4"</span>) <span class="sc">+</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)), </span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> plot_title,</span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">sprintf</span>(<span class="st">"Count (N = %d)"</span>, total_n),</span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">"%s</span><span class="sc">\n</span><span class="st">p-value = %.4f"</span>, </span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a>                      stat_test<span class="sc">$</span>method, </span>
<span id="cb328-14"><a href="#cb328-14" aria-hidden="true" tabindex="-1"></a>                      stat_test<span class="sc">$</span>p_value)</span>
<span id="cb328-15"><a href="#cb328-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb328-16"><a href="#cb328-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb328-17"><a href="#cb328-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb328-18"><a href="#cb328-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb328-19"><a href="#cb328-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">15</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb328-20"><a href="#cb328-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb328-21"><a href="#cb328-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb328-22"><a href="#cb328-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb328-23"><a href="#cb328-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb328-24"><a href="#cb328-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-25"><a href="#cb328-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb328-26"><a href="#cb328-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Print Statistical Analysis Results</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Frequency Distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Frequency Distribution:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(freq_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  frequency                count percentage
  &lt;fct&gt;                    &lt;int&gt;      &lt;dbl&gt;
1 About once a month          48       3.08
2 Multiple times per month    72       4.62
3 About once a week          201      12.9 
4 Multiple times per week    635      40.8 
5 Everyday                   602      38.6 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statistical Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Statistical Test Results:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Type:"</span>, stat_test<span class="sc">$</span>method, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Test Type: Chi-square Test with Yates' Continuity Correction </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, stat_test<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 1.301933e-226 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instrument-specific analysis can follow a similar robust testing approach</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="by-instrument" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="by-instrument"><span class="header-section-number">12.2</span> By Instrument</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant columns and gather them</span></span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a>instruments_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">freqPlay_Flute</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Piccolo</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Recorder</span><span class="st">`</span>, </span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">freqPlay_Oboe</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Clarinet</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Bassoon</span><span class="st">`</span>,</span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">freqPlay_Saxophone</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Trumpet</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_French Horn</span><span class="st">`</span>,</span>
<span id="cb340-10"><a href="#cb340-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">freqPlay_Trombone</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Tuba</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Euphonium</span><span class="st">`</span>,</span>
<span id="cb340-11"><a href="#cb340-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">freqPlay_Bagpipes</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb340-12"><a href="#cb340-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"instrument"</span>, <span class="at">value =</span> <span class="st">"frequency"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb340-13"><a href="#cb340-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb340-14"><a href="#cb340-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Clean instrument names</span></span>
<span id="cb340-15"><a href="#cb340-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">instrument =</span> <span class="fu">gsub</span>(<span class="st">"freqPlay_"</span>, <span class="st">""</span>, instrument),</span>
<span id="cb340-16"><a href="#cb340-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recode frequency values</span></span>
<span id="cb340-17"><a href="#cb340-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb340-18"><a href="#cb340-18" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"About once a month"</span>,</span>
<span id="cb340-19"><a href="#cb340-19" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Multiple times per month"</span>,</span>
<span id="cb340-20"><a href="#cb340-20" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"About once a week"</span>,</span>
<span id="cb340-21"><a href="#cb340-21" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Multiple times per week"</span>,</span>
<span id="cb340-22"><a href="#cb340-22" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Everyday"</span>,</span>
<span id="cb340-23"><a href="#cb340-23" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb340-24"><a href="#cb340-24" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"About once a month"</span>, <span class="st">"Multiple times per month"</span>, </span>
<span id="cb340-25"><a href="#cb340-25" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"About once a week"</span>, <span class="st">"Multiple times per week"</span>, <span class="st">"Everyday"</span>))</span>
<span id="cb340-26"><a href="#cb340-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb340-27"><a href="#cb340-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-28"><a href="#cb340-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove NA values</span></span>
<span id="cb340-29"><a href="#cb340-29" aria-hidden="true" tabindex="-1"></a>instruments_data <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(frequency))</span>
<span id="cb340-30"><a href="#cb340-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-31"><a href="#cb340-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate frequencies and percentages</span></span>
<span id="cb340-32"><a href="#cb340-32" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span></span>
<span id="cb340-33"><a href="#cb340-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument, frequency) <span class="sc">%&gt;%</span></span>
<span id="cb340-34"><a href="#cb340-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb340-35"><a href="#cb340-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb340-36"><a href="#cb340-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb340-37"><a href="#cb340-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb340-38"><a href="#cb340-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">sum</span>(count)</span>
<span id="cb340-39"><a href="#cb340-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb340-40"><a href="#cb340-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb340-41"><a href="#cb340-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-42"><a href="#cb340-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total responses for each instrument</span></span>
<span id="cb340-43"><a href="#cb340-43" aria-hidden="true" tabindex="-1"></a>instrument_totals <span class="ot">&lt;-</span> summary_data <span class="sc">%&gt;%</span></span>
<span id="cb340-44"><a href="#cb340-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb340-45"><a href="#cb340-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_n =</span> <span class="fu">first</span>(total_n)) <span class="sc">%&gt;%</span></span>
<span id="cb340-46"><a href="#cb340-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_n))</span>
<span id="cb340-47"><a href="#cb340-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-48"><a href="#cb340-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder instruments by total responses</span></span>
<span id="cb340-49"><a href="#cb340-49" aria-hidden="true" tabindex="-1"></a>summary_data<span class="sc">$</span>instrument <span class="ot">&lt;-</span> <span class="fu">factor</span>(summary_data<span class="sc">$</span>instrument, </span>
<span id="cb340-50"><a href="#cb340-50" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> instrument_totals<span class="sc">$</span>instrument)</span>
<span id="cb340-51"><a href="#cb340-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-52"><a href="#cb340-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with modified theme and labels in black; legend styling adjusted</span></span>
<span id="cb340-53"><a href="#cb340-53" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> frequency, <span class="at">y =</span> percentage, <span class="at">fill =</span> frequency)) <span class="sc">+</span></span>
<span id="cb340-54"><a href="#cb340-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb340-55"><a href="#cb340-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>instrument, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb340-56"><a href="#cb340-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d\</span></span>
<span id="cb340-57"><a href="#cb340-57" aria-hidden="true" tabindex="-1"></a><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb340-58"><a href="#cb340-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb340-59"><a href="#cb340-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb340-60"><a href="#cb340-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb340-61"><a href="#cb340-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb340-62"><a href="#cb340-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Frequency of Practice by Instrument"</span>,</span>
<span id="cb340-63"><a href="#cb340-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb340-64"><a href="#cb340-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb340-65"><a href="#cb340-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Frequency"</span></span>
<span id="cb340-66"><a href="#cb340-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb340-67"><a href="#cb340-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb340-68"><a href="#cb340-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb340-69"><a href="#cb340-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Remove x-axis labels</span></span>
<span id="cb340-70"><a href="#cb340-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb340-71"><a href="#cb340-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb340-72"><a href="#cb340-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">0</span>)),</span>
<span id="cb340-73"><a href="#cb340-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb340-74"><a href="#cb340-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb340-75"><a href="#cb340-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">'pt'</span>),</span>
<span id="cb340-76"><a href="#cb340-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb340-77"><a href="#cb340-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">30</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">30</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)  <span class="co"># Padding around the plot</span></span>
<span id="cb340-78"><a href="#cb340-78" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb340-79"><a href="#cb340-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-80"><a href="#cb340-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb340-81"><a href="#cb340-81" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="do">## By instrument V2 </span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Process data and create summary statistics</span></span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>instruments_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"freqPlay_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"instrument"</span>, <span class="at">value =</span> <span class="st">"frequency"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">instrument =</span> <span class="fu">gsub</span>(<span class="st">"freqPlay_"</span>, <span class="st">""</span>, instrument),</span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"About once a month"</span>,</span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Multiple times per month"</span>,</span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"About once a week"</span>,</span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Multiple times per week"</span>,</span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Everyday"</span>,</span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"About once a month"</span>, <span class="st">"Multiple times per month"</span>, </span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"About once a week"</span>, <span class="st">"Multiple times per week"</span>, <span class="st">"Everyday"</span>))</span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(frequency))</span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate detailed summary statistics</span></span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span></span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb341-26"><a href="#cb341-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb341-27"><a href="#cb341-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb341-28"><a href="#cb341-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_freq =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(frequency)),</span>
<span id="cb341-29"><a href="#cb341-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_freq =</span> <span class="fu">median</span>(<span class="fu">as.numeric</span>(frequency)),</span>
<span id="cb341-30"><a href="#cb341-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_freq =</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(frequency))</span>
<span id="cb341-31"><a href="#cb341-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb341-32"><a href="#cb341-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb341-33"><a href="#cb341-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-34"><a href="#cb341-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate frequency distributions</span></span>
<span id="cb341-35"><a href="#cb341-35" aria-hidden="true" tabindex="-1"></a>freq_dist <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span></span>
<span id="cb341-36"><a href="#cb341-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument, frequency) <span class="sc">%&gt;%</span></span>
<span id="cb341-37"><a href="#cb341-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb341-38"><a href="#cb341-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb341-39"><a href="#cb341-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb341-40"><a href="#cb341-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb341-41"><a href="#cb341-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">sum</span>(count)</span>
<span id="cb341-42"><a href="#cb341-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb341-43"><a href="#cb341-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(instrument, frequency)</span>
<span id="cb341-44"><a href="#cb341-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-45"><a href="#cb341-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test</span></span>
<span id="cb341-46"><a href="#cb341-46" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(instruments_data<span class="sc">$</span>instrument, instruments_data<span class="sc">$</span>frequency)</span>
<span id="cb341-47"><a href="#cb341-47" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb341-48"><a href="#cb341-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-49"><a href="#cb341-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cramer's V</span></span>
<span id="cb341-50"><a href="#cb341-50" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(instruments_data)</span>
<span id="cb341-51"><a href="#cb341-51" aria-hidden="true" tabindex="-1"></a>df_min <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb341-52"><a href="#cb341-52" aria-hidden="true" tabindex="-1"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n <span class="sc">*</span> df_min))</span>
<span id="cb341-53"><a href="#cb341-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-54"><a href="#cb341-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics</span></span>
<span id="cb341-55"><a href="#cb341-55" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb341-56"><a href="#cb341-56" aria-hidden="true" tabindex="-1"></a><span class="st">Detailed Summary Statistics by Instrument:\</span></span>
<span id="cb341-57"><a href="#cb341-57" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Detailed Summary Statistics by Instrument:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 5
   instrument                          n mean_freq median_freq sd_freq
   &lt;chr&gt;                           &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
 1 MAX                              1558      4.07           4   0.986
 2 Saxophone                         477      3.68           4   1.20 
 3 Flute                             443      3.52           4   1.25 
 4 Clarinet                          410      3.48           4   1.30 
 5 Trumpet                           343      3.74           4   1.26 
 6 Trombone                          212      3.59           4   1.23 
 7 Piccolo                           209      3.08           3   1.41 
 8 French Horn                       160      3.92           4   1.19 
 9 Oboe                              149      3.48           4   1.24 
10 Recorder                          136      2.69           3   1.39 
11 Euphonium                         133      3.16           4   1.32 
12 Tuba                              129      3.64           4   1.24 
13 [QID18-ChoiceTextEntryValue-18]   125      3.61           4   1.11 
14 Bassoon                            91      3.49           4   1.26 
15 Bagpipes                           59      3.44           4   1.37 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="st">Frequency Distribution (counts and percentages):\</span></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Frequency Distribution (counts and percentages):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(freq_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 × 5
# Groups:   instrument [15]
   instrument frequency                count percentage total_n
   &lt;chr&gt;      &lt;fct&gt;                    &lt;int&gt;      &lt;dbl&gt;   &lt;int&gt;
 1 Bagpipes   About once a month          10      16.9       59
 2 Bagpipes   Multiple times per month     5       8.47      59
 3 Bagpipes   About once a week            5       8.47      59
 4 Bagpipes   Multiple times per week     27      45.8       59
 5 Bagpipes   Everyday                    12      20.3       59
 6 Bassoon    About once a month           9       9.89      91
 7 Bassoon    Multiple times per month    11      12.1       91
 8 Bassoon    About once a week           19      20.9       91
 9 Bassoon    Multiple times per week     30      33.0       91
10 Bassoon    Everyday                    22      24.2       91
# ℹ 65 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="st">Chi-square Test Results:\</span></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-square Test Results:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  contingency_table
X-squared = 432.01, df = 56, p-value &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="st">Cramer's V (Effect Size):\</span></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Cramer's V (Effect Size):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramers_v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>X-squared 
0.1526654 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mode for each instrument</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>mode_freq <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(frequency) <span class="sc">%&gt;%</span></span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which.max</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a><span class="st">Most Common Practice Frequency by Instrument:\</span></span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Most Common Practice Frequency by Instrument:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mode_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 3
# Groups:   instrument [15]
   instrument                      frequency                   n
   &lt;chr&gt;                           &lt;fct&gt;                   &lt;int&gt;
 1 MAX                             Multiple times per week   635
 2 Saxophone                       Multiple times per week   174
 3 Flute                           Multiple times per week   162
 4 Clarinet                        Multiple times per week   158
 5 Trumpet                         Everyday                  118
 6 Trombone                        Multiple times per week    71
 7 French Horn                     Everyday                   66
 8 Piccolo                         Multiple times per week    59
 9 [QID18-ChoiceTextEntryValue-18] Multiple times per week    54
10 Oboe                            Multiple times per week    52
11 Tuba                            Multiple times per week    50
12 Euphonium                       Multiple times per week    47
13 Recorder                        About once a month         43
14 Bassoon                         Multiple times per week    30
15 Bagpipes                        Multiple times per week    27</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized residuals analysis</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> chi_test<span class="sc">$</span>stdres</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(std_residuals) <span class="ot">&lt;-</span> <span class="fu">levels</span>(instruments_data<span class="sc">$</span>frequency)</span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(std_residuals) <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">factor</span>(instruments_data<span class="sc">$</span>instrument))</span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a><span class="st">Standardized Residuals (values &gt; |1.96| indicate significant differences):\</span></span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Standardized Residuals (values &gt; |1.96| indicate significant differences):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(std_residuals, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 
                                  About once a month Multiple times per month
  [QID18-ChoiceTextEntryValue-18]              -0.66                    -0.14
  Bagpipes                                      2.21                     0.04
  Bassoon                                       0.35                     1.31
  Clarinet                                      3.41                     0.35
  Euphonium                                     2.86                     4.11
  Flute                                         1.20                     2.19
  French Horn                                  -1.46                     0.20
  MAX                                          -9.84                    -6.50
  Oboe                                          0.83                     0.48
  Piccolo                                       6.11                     3.74
  Recorder                                      9.49                     1.16
  Saxophone                                    -0.20                    -0.65
  Trombone                                      0.06                     0.85
  Trumpet                                      -0.07                     0.70
  Tuba                                         -0.13                     1.37
                                 
                                  About once a week Multiple times per week
  [QID18-ChoiceTextEntryValue-18]              1.59                    1.50
  Bagpipes                                    -1.65                    1.43
  Bassoon                                      1.17                   -0.77
  Clarinet                                     0.25                    0.75
  Euphonium                                   -0.19                   -0.36
  Flute                                        1.26                   -0.12
  French Horn                                 -0.70                   -1.82
  MAX                                         -4.58                    3.94
  Oboe                                         2.15                   -0.50
  Piccolo                                      0.52                   -2.64
  Recorder                                     2.51                   -3.45
  Saxophone                                    1.93                   -0.17
  Trombone                                     1.75                   -1.03
  Trumpet                                     -0.34                   -2.02
  Tuba                                        -0.76                    0.46
                                 
                                  Everyday
  [QID18-ChoiceTextEntryValue-18]    -2.38
  Bagpipes                           -1.57
  Bassoon                            -1.14
  Clarinet                           -3.32
  Euphonium                          -3.73
  Flute                              -2.96
  French Horn                         3.29
  MAX                                 9.61
  Oboe                               -2.02
  Piccolo                            -3.70
  Recorder                           -5.00
  Saxophone                          -0.86
  Trombone                           -0.88
  Trumpet                             2.03
  Tuba                               -0.62</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_dist, <span class="fu">aes</span>(<span class="at">x =</span> percentage, <span class="at">y =</span> <span class="fu">reorder</span>(instrument, total_n), <span class="at">fill =</span> frequency)) <span class="sc">+</span></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d"</span>, count)),</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Frequency of Practice by Instrument"</span>,</span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Total N ="</span>, <span class="fu">sum</span>(summary_stats<span class="sc">$</span>n), <span class="st">"responses"</span>),</span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Practice Frequency"</span></span>
<span id="cb365-14"><a href="#cb365-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb365-15"><a href="#cb365-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb365-16"><a href="#cb365-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb365-17"><a href="#cb365-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb365-18"><a href="#cb365-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb365-19"><a href="#cb365-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb365-20"><a href="#cb365-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb365-21"><a href="#cb365-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.just =</span> <span class="st">"left"</span>,</span>
<span id="cb365-22"><a href="#cb365-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb365-23"><a href="#cb365-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb365-24"><a href="#cb365-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb365-25"><a href="#cb365-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb365-26"><a href="#cb365-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-27"><a href="#cb365-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="results-and-discussion-18" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="results-and-discussion-18"><span class="header-section-number">12.2.1</span> Results and Discussion</h3>
<p>Looking at the frequency distribution of wind instrument practice among the 1,558 participants:</p>
<p>• Multiple times per week: Largest group with approximately 550 participants (~35%)</p>
<p>• Everyday: Second largest with about 400 participants (~26%)</p>
<p>• About once a week: Around 300 participants (~19%)</p>
<p>• About once a month: Approximately 200 participants (~13%)</p>
<p>• Multiple times per month: Smallest group with roughly 150 participants (~10%)</p>
<p>The data shows that the majority of participants (about 61%) practice their wind instruments very frequently (either everyday or multiple times per week). This suggests a high level of engagement with wind instrument playing among the surveyed population, with relatively fewer participants practicing on a monthly basis.</p>
</section>
</section>
<section id="inferential-stats-2" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="inferential-stats-2"><span class="header-section-number">12.3</span> Inferential Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode freqPlay_MAX and create frequency table with RMTMethods_YN</span></span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"About once a month"</span>,</span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Multiple times per month"</span>,</span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"About once a week"</span>,</span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Multiple times per week"</span>,</span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Everyday"</span>,</span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"About once a month"</span>, <span class="st">"Multiple times per month"</span>, </span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">"About once a week"</span>, <span class="st">"Multiple times per week"</span>, <span class="st">"Everyday"</span>)),</span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMT_group =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb366-18"><a href="#cb366-18" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No RMT Methods"</span>,</span>
<span id="cb366-19"><a href="#cb366-19" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Uses RMT Methods"</span>,</span>
<span id="cb366-20"><a href="#cb366-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb366-21"><a href="#cb366-21" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb366-22"><a href="#cb366-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb366-23"><a href="#cb366-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-24"><a href="#cb366-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb366-25"><a href="#cb366-25" aria-hidden="true" tabindex="-1"></a>cont_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>frequency, data<span class="sc">$</span>RMT_group)</span>
<span id="cb366-26"><a href="#cb366-26" aria-hidden="true" tabindex="-1"></a>cont_table_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(cont_table)</span>
<span id="cb366-27"><a href="#cb366-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-28"><a href="#cb366-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages within each group</span></span>
<span id="cb366-29"><a href="#cb366-29" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb366-30"><a href="#cb366-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMT_group, frequency) <span class="sc">%&gt;%</span></span>
<span id="cb366-31"><a href="#cb366-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb366-32"><a href="#cb366-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMT_group) <span class="sc">%&gt;%</span></span>
<span id="cb366-33"><a href="#cb366-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count<span class="sc">/</span><span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb366-34"><a href="#cb366-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_group =</span> <span class="fu">sum</span>(count))</span>
<span id="cb366-35"><a href="#cb366-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-36"><a href="#cb366-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N</span></span>
<span id="cb366-37"><a href="#cb366-37" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">sum</span>(freq_table<span class="sc">$</span>count)</span>
<span id="cb366-38"><a href="#cb366-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-39"><a href="#cb366-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test</span></span>
<span id="cb366-40"><a href="#cb366-40" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table)</span>
<span id="cb366-41"><a href="#cb366-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-42"><a href="#cb366-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cramer's V</span></span>
<span id="cb366-43"><a href="#cb366-43" aria-hidden="true" tabindex="-1"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic<span class="sc">/</span>(total_n <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">dim</span>(cont_table))<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb366-44"><a href="#cb366-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-45"><a href="#cb366-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb366-46"><a href="#cb366-46" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Frequency of Practice by RMT Methods Use"</span></span>
<span id="cb366-47"><a href="#cb366-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-48"><a href="#cb366-48" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table, <span class="fu">aes</span>(<span class="at">x =</span> frequency, <span class="at">y =</span> percentage, <span class="at">fill =</span> RMT_group)) <span class="sc">+</span></span>
<span id="cb366-49"><a href="#cb366-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb366-50"><a href="#cb366-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d\</span></span>
<span id="cb366-51"><a href="#cb366-51" aria-hidden="true" tabindex="-1"></a><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb366-52"><a href="#cb366-52" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb366-53"><a href="#cb366-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb366-54"><a href="#cb366-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb366-55"><a href="#cb366-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No RMT Methods"</span> <span class="ot">=</span> <span class="st">"#4472C4"</span>, </span>
<span id="cb366-56"><a href="#cb366-56" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Uses RMT Methods"</span> <span class="ot">=</span> <span class="st">"#ED7D31"</span>)) <span class="sc">+</span></span>
<span id="cb366-57"><a href="#cb366-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb366-58"><a href="#cb366-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> plot_title,</span>
<span id="cb366-59"><a href="#cb366-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"N = %d"</span>, total_n),</span>
<span id="cb366-60"><a href="#cb366-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb366-61"><a href="#cb366-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb366-62"><a href="#cb366-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb366-63"><a href="#cb366-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">"Chi-square test: χ²(%d) = %.2f, p = %.3f\</span></span>
<span id="cb366-64"><a href="#cb366-64" aria-hidden="true" tabindex="-1"></a><span class="st">Cramér's V = %.3f"</span>,</span>
<span id="cb366-65"><a href="#cb366-65" aria-hidden="true" tabindex="-1"></a>                      chi_test<span class="sc">$</span>parameter, </span>
<span id="cb366-66"><a href="#cb366-66" aria-hidden="true" tabindex="-1"></a>                      chi_test<span class="sc">$</span>statistic,</span>
<span id="cb366-67"><a href="#cb366-67" aria-hidden="true" tabindex="-1"></a>                      chi_test<span class="sc">$</span>p.value,</span>
<span id="cb366-68"><a href="#cb366-68" aria-hidden="true" tabindex="-1"></a>                      cramers_v)</span>
<span id="cb366-69"><a href="#cb366-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb366-70"><a href="#cb366-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb366-71"><a href="#cb366-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb366-72"><a href="#cb366-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb366-73"><a href="#cb366-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb366-74"><a href="#cb366-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">15</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb366-75"><a href="#cb366-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb366-76"><a href="#cb366-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb366-77"><a href="#cb366-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb366-78"><a href="#cb366-78" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb366-79"><a href="#cb366-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-80"><a href="#cb366-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb366-81"><a href="#cb366-81" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical summary</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="st">Contingency Table:\</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Contingency Table:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cont_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          
                           No RMT Methods Uses RMT Methods
  About once a month                   44                4
  Multiple times per month             63                9
  About once a week                   181               20
  Multiple times per week             571               64
  Everyday                            471              131</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="st">Chi-square Test Results:\</span></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-square Test Results:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  cont_table
X-squared = 40.341, df = 4, p-value = 3.68e-08</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="st">Effect Size (Cramér's V):\</span></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Effect Size (Cramér's V):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramers_v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>X-squared 
0.1609115 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate group sizes</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>group_sizes <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMT_group) <span class="sc">%&gt;%</span></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a><span class="st">Group Sizes:\</span></span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Group Sizes:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(group_sizes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  RMT_group            n
  &lt;fct&gt;            &lt;int&gt;
1 No RMT Methods    1330
2 Uses RMT Methods   228</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc analysis: standardized residuals</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>stdres <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table)<span class="sc">$</span>stdres</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(stdres) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"No RMT Methods"</span>, <span class="st">"Uses RMT Methods"</span>)</span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(stdres) <span class="ot">&lt;-</span> <span class="fu">levels</span>(data<span class="sc">$</span>frequency)</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true" tabindex="-1"></a><span class="st">Standardized Residuals:\</span></span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Standardized Residuals:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stdres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          
                           No RMT Methods Uses RMT Methods
  About once a month            1.2545462       -1.2545462
  Multiple times per month      0.5246129       -0.5246129
  About once a week             2.0131375       -2.0131375
  Multiple times per week       4.2195978       -4.2195978
  Everyday                     -6.3155725        6.3155725</code></pre>
</div>
</div>
<section id="results-and-discussion-19" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="results-and-discussion-19"><span class="header-section-number">12.3.1</span> Results and Discussion</h3>
<p><strong>Statistical Significance</strong></p>
<p>• The chi-square test shows a highly significant association between practice frequency and RMT Methods use (χ²(4) = 40.34, p &lt; 0.001)</p>
<p>• The effect size (Cramér’s V = 0.161) indicates a small to medium practical significance</p>
<p><strong>Group Differences</strong></p>
<p>Based on the standardized residuals (values &gt; |1.96| indicate significant differences): Significant differences:</p>
<p>• “About once a week”: Significantly more non-RMT users than expected</p>
<p>• “Multiple times per week”: Significantly more non-RMT users than expected</p>
<p>• “Everyday”: Significantly more RMT users than expected (strongest effect)</p>
<p><strong>Practice Patterns</strong></p>
<p>• RMT users show a higher proportion of daily practice</p>
<p>• Non-RMT users show higher proportions in the moderate frequency categories</p>
</section>
</section>
</section>
<section id="income" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Income</h1>
<section id="descriptive-stats-9" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="descriptive-stats-9"><span class="header-section-number">13.1</span> Descriptive Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Process income data</span></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>income_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(incomePerf, incomeTeach) <span class="sc">%&gt;%</span></span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), </span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"income_type"</span>, </span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"income_level"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb387-10"><a href="#cb387-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(income_level))</span>
<span id="cb387-11"><a href="#cb387-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-12"><a href="#cb387-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for only 'Yes' and 'No' responses</span></span>
<span id="cb387-13"><a href="#cb387-13" aria-hidden="true" tabindex="-1"></a>income_data_filtered <span class="ot">&lt;-</span> income_data <span class="sc">%&gt;%</span></span>
<span id="cb387-14"><a href="#cb387-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(income_level <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb387-15"><a href="#cb387-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-16"><a href="#cb387-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table for chi-square test</span></span>
<span id="cb387-17"><a href="#cb387-17" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(income_data_filtered<span class="sc">$</span>income_type, income_data_filtered<span class="sc">$</span>income_level)</span>
<span id="cb387-18"><a href="#cb387-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-19"><a href="#cb387-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test</span></span>
<span id="cb387-20"><a href="#cb387-20" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb387-21"><a href="#cb387-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-22"><a href="#cb387-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cramer's V</span></span>
<span id="cb387-23"><a href="#cb387-23" aria-hidden="true" tabindex="-1"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (<span class="fu">sum</span>(contingency_table) <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb387-24"><a href="#cb387-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-25"><a href="#cb387-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratio</span></span>
<span id="cb387-26"><a href="#cb387-26" aria-hidden="true" tabindex="-1"></a>odds_ratio <span class="ot">&lt;-</span> (contingency_table[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">*</span> contingency_table[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">/</span> (contingency_table[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">*</span> contingency_table[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb387-27"><a href="#cb387-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-28"><a href="#cb387-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical analysis results</span></span>
<span id="cb387-29"><a href="#cb387-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb387-30"><a href="#cb387-30" aria-hidden="true" tabindex="-1"></a><span class="st">Statistical Analysis Results:\</span></span>
<span id="cb387-31"><a href="#cb387-31" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Statistical Analysis Results:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"============================\</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a><span class="st">\</span></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>============================</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print contingency table</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Contingency Table:\</span></span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Contingency Table:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(contingency_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             
               No Yes
  incomePerf  716 216
  incomeTeach 197 315</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print chi-square test results</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Chi-square Test Results:\</span></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-square Test Results:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  contingency_table
X-squared = 207.36, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print effect size measures</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Effect Size Measures:\</span></span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Effect Size Measures:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Cramer's V: %.3f\</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>, cramers_v))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer's V: 0.379</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Odds Ratio: %.3f\</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>, odds_ratio))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Odds Ratio: 5.300</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize counts and percentages</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, income_level) <span class="sc">%&gt;%</span></span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type) <span class="sc">%&gt;%</span></span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">sum</span>(count),</span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> total_n <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb408-9"><a href="#cb408-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> total_n),  <span class="co"># Standard error for proportions</span></span>
<span id="cb408-10"><a href="#cb408-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower =</span> percentage <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se),  <span class="co"># 95% CI lower bound</span></span>
<span id="cb408-11"><a href="#cb408-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper =</span> percentage <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se)   <span class="co"># 95% CI upper bound</span></span>
<span id="cb408-12"><a href="#cb408-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb408-13"><a href="#cb408-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb408-14"><a href="#cb408-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-15"><a href="#cb408-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels for income types with total N</span></span>
<span id="cb408-16"><a href="#cb408-16" aria-hidden="true" tabindex="-1"></a>lookup_labels <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb408-17"><a href="#cb408-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type) <span class="sc">%&gt;%</span></span>
<span id="cb408-18"><a href="#cb408-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_n =</span> <span class="fu">first</span>(total_n)) <span class="sc">%&gt;%</span></span>
<span id="cb408-19"><a href="#cb408-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb408-20"><a href="#cb408-20" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Performance Income\</span></span>
<span id="cb408-21"><a href="#cb408-21" aria-hidden="true" tabindex="-1"></a><span class="st">(N="</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb408-22"><a href="#cb408-22" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Teaching Income\</span></span>
<span id="cb408-23"><a href="#cb408-23" aria-hidden="true" tabindex="-1"></a><span class="st">(N="</span>, total_n, <span class="st">")"</span>)</span>
<span id="cb408-24"><a href="#cb408-24" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb408-25"><a href="#cb408-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-26"><a href="#cb408-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Map income_type to factor using lookup</span></span>
<span id="cb408-27"><a href="#cb408-27" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb408-28"><a href="#cb408-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb408-29"><a href="#cb408-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">income_type =</span> <span class="fu">factor</span>(income_type, </span>
<span id="cb408-30"><a href="#cb408-30" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> lookup_labels<span class="sc">$</span>income_type, </span>
<span id="cb408-31"><a href="#cb408-31" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> lookup_labels<span class="sc">$</span>label),</span>
<span id="cb408-32"><a href="#cb408-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">income_level =</span> <span class="fu">factor</span>(income_level, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb408-33"><a href="#cb408-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb408-34"><a href="#cb408-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-35"><a href="#cb408-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb408-36"><a href="#cb408-36" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of Primary Income Response"</span></span>
<span id="cb408-37"><a href="#cb408-37" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(income_summary, </span>
<span id="cb408-38"><a href="#cb408-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> percentage, <span class="at">y =</span> income_level, <span class="at">fill =</span> income_type)) <span class="sc">+</span></span>
<span id="cb408-39"><a href="#cb408-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb408-40"><a href="#cb408-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"% )"</span>)),</span>
<span id="cb408-41"><a href="#cb408-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb408-42"><a href="#cb408-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb408-43"><a href="#cb408-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper),</span>
<span id="cb408-44"><a href="#cb408-44" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb408-45"><a href="#cb408-45" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb408-46"><a href="#cb408-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> plot_title,</span>
<span id="cb408-47"><a href="#cb408-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb408-48"><a href="#cb408-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Is this your primary form of income?"</span>,</span>
<span id="cb408-49"><a href="#cb408-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Income Source"</span>,</span>
<span id="cb408-50"><a href="#cb408-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span>) <span class="sc">+</span></span>
<span id="cb408-51"><a href="#cb408-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb408-52"><a href="#cb408-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb408-53"><a href="#cb408-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb408-54"><a href="#cb408-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb408-55"><a href="#cb408-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb408-56"><a href="#cb408-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb408-57"><a href="#cb408-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb408-58"><a href="#cb408-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb408-59"><a href="#cb408-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">20</span>))</span>
<span id="cb408-60"><a href="#cb408-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-61"><a href="#cb408-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plot</span></span>
<span id="cb408-62"><a href="#cb408-62" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print proportions with confidence intervals</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a><span class="st">Proportions with 95% Confidence Intervals:\</span></span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Proportions with 95% Confidence Intervals:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(income_summary <span class="sc">%&gt;%</span> </span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(income_type, income_level, percentage, ci_lower, ci_upper))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  income_type                   income_level percentage ci_lower ci_upper
  &lt;fct&gt;                         &lt;fct&gt;             &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 "Performance Income\n(N=932)" No                 76.8     74.1     79.5
2 "Performance Income\n(N=932)" Yes                23.2     20.5     25.9
3 "Teaching Income\n(N=512)"    No                 38.5     34.3     42.7
4 "Teaching Income\n(N=512)"    Yes                61.5     57.3     65.7</code></pre>
</div>
</div>
<section id="results-and-discussion-20" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="results-and-discussion-20"><span class="header-section-number">13.1.1</span> Results and Discussion</h3>
<p><strong>Key Findings:</strong></p>
<p><em>Performance Income (N=932):</em></p>
<p>• Yes: 23.2% (95% CI: 20.5% - 25.9%)</p>
<p>• No: 76.8% (95% CI: 74.1% - 79.5%)</p>
<p><em>Teaching Income (N=512):</em></p>
<p>• Yes: 61.5% (95% CI: 57.3% - 65.7%)</p>
<p>• No: 38.5% (95% CI: 34.3% - 42.7%)</p>
<p>The statistical analysis reveals a significant difference in the distribution of primary income between performance and teaching (p &lt; 0.001), with a moderate effect size (Cramer’s V = 0.379). Teaching is more likely to be reported as a primary source of income compared to performance, with confidence intervals showing no overlap between the two income types.</p>
<p><strong>Statistical Analysis</strong></p>
<p><em>Contingency Table and Frequency Distribution:</em></p>
<p>The contingency table shows the counts for each response category by income type:</p>
<p>Performance Income:</p>
<p>• No: 716 respondents</p>
<p>• Yes: 216 respondents</p>
<p>• Total N=932N=932</p>
<p>Teaching Income:</p>
<p>• No: 197 respondents</p>
<p>• Yes: 315 respondents</p>
<p>• Total N=512N=512</p>
<p>This breakdown immediately shows a substantial difference: A majority of respondents do not consider performance income their primary income, whereas a majority consider teaching income as their primary income.</p>
<p><em>Chi-Square Test:</em></p>
<p>The chi-square test for independence yielded:</p>
<p>• χ2χ2 Value: 207.36</p>
<p>• Degrees of Freedom: 1</p>
<p>• p-value: &lt; 2.2e-16</p>
<p>The extremely low p-value (p &lt; 0.001) indicates that there is a statistically significant association between the type of income (performance vs teaching) and whether it is considered the primary source of income. This suggests that the likelihood of stating “Yes” or “No” as a primary income source differs considerably between performance and teaching categories.</p>
<p><em>Effect Size:</em>8</p>
<p>Two effect size measures were provided:</p>
<p>• Cramer’s V: 0.379</p>
<p>This value falls in a moderate range, suggesting that while the association is not extremely strong, it is meaningful.</p>
<p>• Odds Ratio: 5.300</p>
<p>This indicates that respondents are over 5 times more likely to report teaching income as their primary income compared to performance income.</p>
<p><em>Confidence Intervals for Proportions:</em></p>
<p>The proportions, alongside their 95% confidence intervals, are as follows:</p>
<p>Performance Income:</p>
<p>• Yes: 23.2% (95% CI: approx. 20.5% – 25.9%)</p>
<p>• No: 76.8% (95% CI: approx. 74.1% – 79.5%)</p>
<p>Teaching Income:</p>
<p>• Yes: 61.5% (95% CI: approx. 57.3% – 65.7%)</p>
<p>• No: 38.5% (95% CI: approx. 34.3% – 42.7%)</p>
<p>The absence of overlapping confidence intervals for the “Yes” responses provides further evidence that the proportions are statistically different between performance and teaching income responses.</p>
<p><strong>Visualization Interpretation</strong></p>
<p>The bar plot presents the percentage distribution for each response category (“Yes” and “No”) within each type of income. Key details include: <em>Y-Axis (Response Category):</em></p>
<p>The responses are clearly laid out as “Yes” and “No” (i.e., whether the income source is the respondent’s primary source). <em>X-Axis (Percentage):</em></p>
<p>The percentage of respondents providing each answer is shown, with a scale from 0% to 100%.</p>
<p><em>Data Labels:</em></p>
<p>Each bar is annotated with both the absolute count and the corresponding percentage, providing a precise understanding of the sample distribution.</p>
<p><em>Error Bars:</em></p>
<p>Horizontal error bars indicate the 95% confidence intervals for the observed percentages. These intervals support the reliability of the estimates and help visualize the variability in responses.</p>
<p><em>Color Coding and Legends:</em></p>
<p>Separate colors are used to distinguish between Performance Income and Teaching Income. The legend incorporates total sample sizes (NN) for each income type, which helps in quickly grasping the underlying distribution:</p>
<p>• Performance Income (N=932)</p>
<p>• Teaching Income (N=512)</p>
<p><strong>Overall Interpretation</strong></p>
<p>The analysis indicates a significant relationship between income type and whether it is considered the primary form of income. Specifically:</p>
<p><em>Performance Income:</em></p>
<p>The majority (76.8%) of respondents do not consider performance income the primary form of income, with only 23.2% affirming it as their main income source. This suggests that performance income, for this sample, is likely supplemental or irregular rather than the primary livelihood.</p>
<p><em>Teaching Income:</em></p>
<p>In contrast, a majority (61.5%) of respondents report teaching income as their primary source of income, compared to 38.5% who do not. This difference—along with the large odds ratio of 5.300—indicates that, within the surveyed population, teaching is far more likely to be relied upon as the main income source.</p>
<p><em>Statistical Significance and Practical Implications:</em></p>
<p>The statistically significant chi-square test and moderate Cramer’s V corroborate that these differences are not due to mere chance. For stakeholders (e.g., survey analysts, policy makers, or academic researchers), these findings may suggest a need to consider how funding, training, or career support should be specifically targeted based on the predominant income source among respondents.</p>
<p>In summary, the robust statistical analysis and well-annotated visual representation provide clear evidence that the ways in which performance and teaching income contribute to overall livelihood differ substantially within the surveyed group.</p>
</section>
</section>
<section id="inferential-stats-3" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="inferential-stats-3"><span class="header-section-number">13.2</span> Inferential Stats</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the data so that we have one row per response for the income variables</span></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a>income_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(incomePerf, incomeTeach, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(incomePerf, incomeTeach),</span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"income_type"</span>,</span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"income_response"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(income_response)) <span class="sc">%&gt;%</span></span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only keep responses that are 'Yes' or 'No'</span></span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(income_response <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb413-13"><a href="#cb413-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-14"><a href="#cb413-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics by income_type, RMTMethods_YN, and income_response,</span></span>
<span id="cb413-15"><a href="#cb413-15" aria-hidden="true" tabindex="-1"></a><span class="co"># computing percentages relative to each RMTMethods_YN subgroup (for each income type).</span></span>
<span id="cb413-16"><a href="#cb413-16" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_data <span class="sc">%&gt;%</span></span>
<span id="cb413-17"><a href="#cb413-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, RMTMethods_YN, income_response) <span class="sc">%&gt;%</span></span>
<span id="cb413-18"><a href="#cb413-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb413-19"><a href="#cb413-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb413-20"><a href="#cb413-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_n =</span> <span class="fu">sum</span>(count),</span>
<span id="cb413-21"><a href="#cb413-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">percentage =</span> count <span class="sc">/</span> total_n <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb413-22"><a href="#cb413-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">se =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> total_n),  <span class="co"># standard error for proportions</span></span>
<span id="cb413-23"><a href="#cb413-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_lower =</span> percentage <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,                      <span class="co"># 95% CI lower bound</span></span>
<span id="cb413-24"><a href="#cb413-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_upper =</span> percentage <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se                        <span class="co"># 95% CI upper bound</span></span>
<span id="cb413-25"><a href="#cb413-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb413-26"><a href="#cb413-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb413-27"><a href="#cb413-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-28"><a href="#cb413-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Update group labels based on conditions</span></span>
<span id="cb413-29"><a href="#cb413-29" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb413-30"><a href="#cb413-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_label =</span> <span class="fu">case_when</span>(</span>
<span id="cb413-31"><a href="#cb413-31" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Pro performers, that don't use RMT devices (n = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb413-32"><a href="#cb413-32" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Pro performers that use RMT devices (n = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb413-33"><a href="#cb413-33" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Pro teachers that don't use RMT devices (n = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb413-34"><a href="#cb413-34" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Pro teachers that use RMT devices (n = "</span>, total_n, <span class="st">")"</span>)</span>
<span id="cb413-35"><a href="#cb413-35" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb413-36"><a href="#cb413-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-37"><a href="#cb413-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure factor levels for income_response so that 'Yes' and 'No' appear in a controlled order</span></span>
<span id="cb413-38"><a href="#cb413-38" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb413-39"><a href="#cb413-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income_response =</span> <span class="fu">factor</span>(income_response, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)))</span>
<span id="cb413-40"><a href="#cb413-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-41"><a href="#cb413-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the figure title as specified</span></span>
<span id="cb413-42"><a href="#cb413-42" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of professional (primary source of income) performers and teachers who do and don't use RMT devices"</span></span>
<span id="cb413-43"><a href="#cb413-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-44"><a href="#cb413-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot, adjusting the data labels so they don't overlap with the error bars</span></span>
<span id="cb413-45"><a href="#cb413-45" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(income_summary,</span>
<span id="cb413-46"><a href="#cb413-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> percentage, <span class="at">y =</span> income_response, <span class="at">fill =</span> group_label)) <span class="sc">+</span></span>
<span id="cb413-47"><a href="#cb413-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb413-48"><a href="#cb413-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper),</span>
<span id="cb413-49"><a href="#cb413-49" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb413-50"><a href="#cb413-50" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb413-51"><a href="#cb413-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>),</span>
<span id="cb413-52"><a href="#cb413-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> ci_upper),  <span class="co"># Position labels at the end of error bars</span></span>
<span id="cb413-53"><a href="#cb413-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb413-54"><a href="#cb413-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>,  <span class="co"># Move labels further to the right</span></span>
<span id="cb413-55"><a href="#cb413-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb413-56"><a href="#cb413-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> plot_title,</span>
<span id="cb413-57"><a href="#cb413-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Percentage (of RMTMethods_YN subgroup)"</span>,</span>
<span id="cb413-58"><a href="#cb413-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Is this your primary form of income?"</span>,</span>
<span id="cb413-59"><a href="#cb413-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span>) <span class="sc">+</span></span>
<span id="cb413-60"><a href="#cb413-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb413-61"><a href="#cb413-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb413-62"><a href="#cb413-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb413-63"><a href="#cb413-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb413-64"><a href="#cb413-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb413-65"><a href="#cb413-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span>  <span class="co"># Remove legend title</span></span>
<span id="cb413-66"><a href="#cb413-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb413-67"><a href="#cb413-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb413-68"><a href="#cb413-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(income_summary<span class="sc">$</span>ci_upper) <span class="sc">*</span> <span class="fl">1.2</span>),  <span class="co"># Extend x-axis to accommodate labels</span></span>
<span id="cb413-69"><a href="#cb413-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>)</span>
<span id="cb413-70"><a href="#cb413-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb413-71"><a href="#cb413-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-72"><a href="#cb413-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb413-73"><a href="#cb413-73" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics for verification</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(income_summary <span class="sc">%&gt;%</span></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(group_label, income_response, count, total_n, percentage, ci_lower, ci_upper) <span class="sc">%&gt;%</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(group_label, income_response))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  group_label         income_response count total_n percentage ci_lower ci_upper
  &lt;chr&gt;               &lt;fct&gt;           &lt;int&gt;   &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Pro performers tha… Yes                69     152       45.4     37.5     53.3
2 Pro performers tha… No                 83     152       54.6     46.7     62.5
3 Pro performers, th… Yes               147     780       18.8     16.1     21.6
4 Pro performers, th… No                633     780       81.2     78.4     83.9
5 Pro teachers that … Yes               220     389       56.6     51.6     61.5
6 Pro teachers that … No                169     389       43.4     38.5     48.4
7 Pro teachers that … Yes                95     123       77.2     69.8     84.6
8 Pro teachers that … No                 28     123       22.8     15.4     30.2</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Infer stats V2 (better) </span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the data so that we have one row per response for the income variables</span></span>
<span id="cb416-6"><a href="#cb416-6" aria-hidden="true" tabindex="-1"></a>income_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb416-7"><a href="#cb416-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(incomePerf, incomeTeach, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb416-8"><a href="#cb416-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(incomePerf, incomeTeach),</span>
<span id="cb416-9"><a href="#cb416-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"income_type"</span>,</span>
<span id="cb416-10"><a href="#cb416-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"income_response"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb416-11"><a href="#cb416-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(income_response)) <span class="sc">%&gt;%</span></span>
<span id="cb416-12"><a href="#cb416-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(income_response <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb416-13"><a href="#cb416-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-14"><a href="#cb416-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics by group (using RMTMethods_YN subgroup totals within each income type)</span></span>
<span id="cb416-15"><a href="#cb416-15" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_data <span class="sc">%&gt;%</span></span>
<span id="cb416-16"><a href="#cb416-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, RMTMethods_YN, income_response) <span class="sc">%&gt;%</span></span>
<span id="cb416-17"><a href="#cb416-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb416-18"><a href="#cb416-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb416-19"><a href="#cb416-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_n =</span> <span class="fu">sum</span>(count),</span>
<span id="cb416-20"><a href="#cb416-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">percentage =</span> count <span class="sc">/</span> total_n <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb416-21"><a href="#cb416-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">se =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> total_n),  <span class="co"># standard error for proportions</span></span>
<span id="cb416-22"><a href="#cb416-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_lower =</span> percentage <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb416-23"><a href="#cb416-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_upper =</span> percentage <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb416-24"><a href="#cb416-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb416-25"><a href="#cb416-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-26"><a href="#cb416-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create custom group labels</span></span>
<span id="cb416-27"><a href="#cb416-27" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb416-28"><a href="#cb416-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_label =</span> <span class="fu">case_when</span>(</span>
<span id="cb416-29"><a href="#cb416-29" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="st">"0"</span> <span class="sc">~</span> </span>
<span id="cb416-30"><a href="#cb416-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pro performers, that don't use RMT devices (n = 780)"</span>,</span>
<span id="cb416-31"><a href="#cb416-31" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> </span>
<span id="cb416-32"><a href="#cb416-32" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pro performers that use RMT devices (n = 152)"</span>,</span>
<span id="cb416-33"><a href="#cb416-33" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="st">"0"</span> <span class="sc">~</span> </span>
<span id="cb416-34"><a href="#cb416-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pro teachers that don't use RMT devices (n = 389)"</span>,</span>
<span id="cb416-35"><a href="#cb416-35" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> </span>
<span id="cb416-36"><a href="#cb416-36" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pro teachers that use RMT devices (n = 123)"</span></span>
<span id="cb416-37"><a href="#cb416-37" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb416-38"><a href="#cb416-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-39"><a href="#cb416-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the order of the income_response factor levels</span></span>
<span id="cb416-40"><a href="#cb416-40" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb416-41"><a href="#cb416-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income_response =</span> <span class="fu">factor</span>(income_response, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)))</span>
<span id="cb416-42"><a href="#cb416-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-43"><a href="#cb416-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the improved figure title</span></span>
<span id="cb416-44"><a href="#cb416-44" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of professional (primary source of income) performers and teachers who do and don't use RMT devices"</span></span>
<span id="cb416-45"><a href="#cb416-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-46"><a href="#cb416-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a faceted grouped bar chart with error bars and data labels placed without overlap</span></span>
<span id="cb416-47"><a href="#cb416-47" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(income_summary,</span>
<span id="cb416-48"><a href="#cb416-48" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> income_response, <span class="at">y =</span> percentage, <span class="at">fill =</span> group_label)) <span class="sc">+</span></span>
<span id="cb416-49"><a href="#cb416-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb416-50"><a href="#cb416-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper),</span>
<span id="cb416-51"><a href="#cb416-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>),</span>
<span id="cb416-52"><a href="#cb416-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb416-53"><a href="#cb416-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)),</span>
<span id="cb416-54"><a href="#cb416-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>),</span>
<span id="cb416-55"><a href="#cb416-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">2</span>,  <span class="co"># Increased vertical offset even more</span></span>
<span id="cb416-56"><a href="#cb416-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb416-57"><a href="#cb416-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>income_type, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">"incomePerf"</span> <span class="ot">=</span> <span class="st">"Performance Income"</span>,</span>
<span id="cb416-58"><a href="#cb416-58" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"incomeTeach"</span> <span class="ot">=</span> <span class="st">"Teaching Income"</span>))) <span class="sc">+</span></span>
<span id="cb416-59"><a href="#cb416-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> plot_title,</span>
<span id="cb416-60"><a href="#cb416-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Primary Income Response"</span>,</span>
<span id="cb416-61"><a href="#cb416-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage (of subgroup)"</span>,</span>
<span id="cb416-62"><a href="#cb416-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span>) <span class="sc">+</span></span>
<span id="cb416-63"><a href="#cb416-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb416-64"><a href="#cb416-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb416-65"><a href="#cb416-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb416-66"><a href="#cb416-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb416-67"><a href="#cb416-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb416-68"><a href="#cb416-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb416-69"><a href="#cb416-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb416-70"><a href="#cb416-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb416-71"><a href="#cb416-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">160</span>),  <span class="co"># Further extended y-axis to provide more space</span></span>
<span id="cb416-72"><a href="#cb416-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">160</span>, <span class="at">by =</span> <span class="dv">20</span>)</span>
<span id="cb416-73"><a href="#cb416-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb416-74"><a href="#cb416-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-75"><a href="#cb416-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb416-76"><a href="#cb416-76" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Demo-results-fixed-formatting_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics for verification</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(income_summary <span class="sc">%&gt;%</span></span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(group_label, income_response, count, total_n, percentage, ci_lower, ci_upper) <span class="sc">%&gt;%</span></span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(group_label, income_response))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  group_label         income_response count total_n percentage ci_lower ci_upper
  &lt;chr&gt;               &lt;fct&gt;           &lt;int&gt;   &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Pro performers tha… Yes                69     152       45.4     37.5     53.3
2 Pro performers tha… No                 83     152       54.6     46.7     62.5
3 Pro performers, th… Yes               147     780       18.8     16.1     21.6
4 Pro performers, th… No                633     780       81.2     78.4     83.9
5 Pro teachers that … Yes               220     389       56.6     51.6     61.5
6 Pro teachers that … No                169     389       43.4     38.5     48.4
7 Pro teachers that … Yes                95     123       77.2     69.8     84.6
8 Pro teachers that … No                 28     123       22.8     15.4     30.2</code></pre>
</div>
</div>
<section id="results-and-discussion-21" class="level3" data-number="13.2.1">
<h3 data-number="13.2.1" class="anchored" data-anchor-id="results-and-discussion-21"><span class="header-section-number">13.2.1</span> Results and Discussion</h3>
<p><strong>Data Context and Structure</strong></p>
<p><em>Data Source:</em></p>
<p>Data were imported from an Excel sheet and include responses for two income sources: Performance Income (incomePerf) and Teaching Income (incomeTeach).</p>
<p><em>Subgrouping Variable:</em></p>
<p>The variable RMTMethods_YN is used to create subgroups indicating whether respondents use RMT devices. Here the subgroup is recoded as follows:</p>
<p>• “0” indicates respondents who do not use RMT devices.</p>
<p>• “1” indicates respondents who do use RMT devices.</p>
<p><em>Responses:</em></p>
<p>For each income source, respondents answered “Yes” or “No” to indicate whether that income source is their primary source.</p>
<p><em>Groups and Counts:</em></p>
<p>Custom labels are provided for each subgroup:</p>
<p>• Pro performers, that don’t use RMT devices (n = 780)</p>
<p>• Pro performers that use RMT devices (n = 152)</p>
<p>• Pro teachers that don’t use RMT devices (n = 389)</p>
<p>• Pro teachers that use RMT devices (n = 123)</p>
<p>Each of these groups shows the number of respondents (n) and was summarized to display the count and percentage of “Yes” and “No” responses as well as the 95% confidence intervals (CI).</p>
<p><strong>Summary Statistics and Visual Insights</strong></p>
<p>• Pro performers, that don’t use RMT devices (n = 780):</p>
<p>• The data are divided into two response groups. For example, suppose the analysis revealed that a smaller percentage (around 18.8%) of these performers indicated “Yes” (i.e., they consider performance income as their primary source) and a larger percentage (around 81.2%) said “No”.</p>
<p>• The calculated confidence intervals describe the precision of these percentage estimates.</p>
<p>• Pro performers that use RMT devices (n = 152):</p>
<p>• Here, responses appear more evenly split (e.g., close to 45% “Yes” versus 55% “No”) compared to their non-RMT counterparts.</p>
<p>• This might indicate that professionals using RMT devices are more likely to rely on performance income or, at least, there is greater variation in their responses.</p>
<p>• Pro teachers that don’t use RMT devices (n = 389):</p>
<p>• A higher percentage might be observed in the “Yes” category—suggesting a stronger reliance on teaching income as a primary income source in this subgroup. For instance, this group might show around 56.6% responding “Yes” and 43.4% responding “No” (as per the provided summary).</p>
<p>• Confidence intervals again indicate the reliability of these percentages.</p>
<p>• Pro teachers that use RMT devices (n = 123):</p>
<p>• Although explicit numerical details weren’t detailed in the snippet, this subgroup’s response distribution can similarly be interpreted. A noticeable difference between the subgroups (those using versus not using RMT devices) would indicate whether use of RMT devices is associated with the likelihood of teaching income being a primary income source.</p>
<p><strong>Interpretation of Results</strong></p>
<p><em>Differences Between Users and Non-Users of RMT Devices:</em></p>
<p>The re-labeled groups help us compare, within each profession (performers and teachers), how the use of RMT devices is associated with identifying a primary income source.</p>
<p>• For performers, the non-users have a markedly different distribution compared to RMT device users. A lower percentage claiming performance income as primary among non-users versus a more balanced split among users may imply that RMT device usage might be linked to alternative revenue structures or different professional profiles.</p>
<p>• For teachers, the data suggest that non-users and users also differ in their reliance on teaching income, with non-users leaning more toward teaching income as primary.</p>
<p><em>Statistical Confidence and Variation:</em></p>
<p>The confidence intervals (CIs) calculated for each percentage give an idea of the uncertainty in these estimates. CIs that do not overlap between groups might indicate statistically significant differences between those who use RMT devices and those who do not.</p>
<p><em>Visual Communication:</em></p>
<p>The improved faceted grouped bar chart provides a clear visual breakdown:</p>
<p>• Faceting by Income Type: Allows for separate panels for performance and teaching income, thus making it easier to compare within and across the two professional categories.</p>
<p>• Error Bars and Labels: With error bars representing the 95% CI, readers can judge the precision of the percentage estimates. Data labels placed above the bars enhance readability without overlapping the bars or error bars.</p>
<p><em>Professional Insights:</em></p>
<p>• For pro performers, if a significantly larger proportion of non-RMT users indicate that performance income is not their primary income, this might suggest that non-users diversify their income more than users.</p>
<p>• For pro teachers, a higher reliance on teaching income in non-RMT users might reflect differences in career structures or market segmentation, possibly implying that those employing RMT devices may either supplement their income from other sources or have different teaching roles.</p>
<p><strong>Final Thoughts</strong></p>
<p>The analysis provides a detailed picture of how primary income identification varies by professional group and by the use of RMT devices. These insights could be of particular interest to researchers exploring the economic behaviors of creative professionals, the role of technology adoption, or market segmentation within industries. For deeper investigation, one might:</p>
<p>• Conduct statistical tests to examine if the differences between subgroups are statistically significant.</p>
<p>• Consider additional covariates: Other factors (e.g., years of experience, geographic location) might explain further variations between these groups.</p>
<p>• Utilize qualitative insights: Understanding why certain professionals choose to use or forgo RMT devices could enrich the quantitative observations.</p>
<p>This interpretation sets the stage for further in-depth analysis, linking statistical outcomes to practical, industry-specific conclusions.</p>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb419" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Demographic Analysis of Wind Instrument Musicians and RMT Device Usage"</span></span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Sarah Morris"</span></span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-03-04"</span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "Table of Contents"</span></span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb419-12"><a href="#cb419-12" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb419-13"><a href="#cb419-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb419-14"><a href="#cb419-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb419-15"><a href="#cb419-15" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb419-16"><a href="#cb419-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb419-17"><a href="#cb419-17" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb419-18"><a href="#cb419-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb419-19"><a href="#cb419-19" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb419-20"><a href="#cb419-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb419-21"><a href="#cb419-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-22"><a href="#cb419-22" aria-hidden="true" tabindex="-1"></a>Provide a full description and interpretation from the results of the following code. Include a breakdown of the descriptive statistics, as well as any statistical tests included in the code.</span>
<span id="cb419-23"><a href="#cb419-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-26"><a href="#cb419-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-27"><a href="#cb419-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Install all required packages (if not already installed)</span></span>
<span id="cb419-28"><a href="#cb419-28" aria-hidden="true" tabindex="-1"></a>required_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb419-29"><a href="#cb419-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dplyr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"stats"</span>, <span class="st">"tidyr"</span>, <span class="st">"forcats"</span>, <span class="st">"broom"</span>,</span>
<span id="cb419-30"><a href="#cb419-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"scales"</span>, <span class="st">"vcd"</span>, <span class="st">"svglite"</span>, <span class="st">"exact2x2"</span>, <span class="st">"exactci"</span>,</span>
<span id="cb419-31"><a href="#cb419-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ssanv"</span>, <span class="st">"testthat"</span></span>
<span id="cb419-32"><a href="#cb419-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-33"><a href="#cb419-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Install any missing packages</span></span>
<span id="cb419-34"><a href="#cb419-34" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">setdiff</span>(required_packages, <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())))</span>
<span id="cb419-35"><a href="#cb419-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-36"><a href="#cb419-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-37"><a href="#cb419-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Libraries and Directory</span></span>
<span id="cb419-38"><a href="#cb419-38" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb419-39"><a href="#cb419-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb419-40"><a href="#cb419-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb419-41"><a href="#cb419-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb419-42"><a href="#cb419-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb419-43"><a href="#cb419-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb419-44"><a href="#cb419-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb419-45"><a href="#cb419-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb419-46"><a href="#cb419-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb419-47"><a href="#cb419-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb419-48"><a href="#cb419-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)  <span class="co"># For Cramer's V calculation</span></span>
<span id="cb419-49"><a href="#cb419-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite)</span>
<span id="cb419-50"><a href="#cb419-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exact2x2)</span>
<span id="cb419-51"><a href="#cb419-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb419-52"><a href="#cb419-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-53"><a href="#cb419-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-54"><a href="#cb419-54" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-55"><a href="#cb419-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-56"><a href="#cb419-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-57"><a href="#cb419-57" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb419-58"><a href="#cb419-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-59"><a href="#cb419-59" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gender</span></span>
<span id="cb419-60"><a href="#cb419-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-61"><a href="#cb419-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-62"><a href="#cb419-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-63"><a href="#cb419-63" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Summary stats on gender data</span>
<span id="cb419-64"><a href="#cb419-64" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Prints plot</span>
<span id="cb419-65"><a href="#cb419-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-68"><a href="#cb419-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-69"><a href="#cb419-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-70"><a href="#cb419-70" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-71"><a href="#cb419-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-72"><a href="#cb419-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Create gender summary</span></span>
<span id="cb419-73"><a href="#cb419-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall, this code processes a dataset (data_combined) to summarize gender information by filtering out missing values, grouping by gender, calculating counts and percentages, adjusting specific gender labels, and finally sorting the results by count in descending order. The end result is stored in the variable 'gender_summary'</span></span>
<span id="cb419-74"><a href="#cb419-74" aria-hidden="true" tabindex="-1"></a>gender_summary <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-75"><a href="#cb419-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb419-76"><a href="#cb419-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb419-77"><a href="#cb419-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-78"><a href="#cb419-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb419-79"><a href="#cb419-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> <span class="dv">1558</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-80"><a href="#cb419-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb419-81"><a href="#cb419-81" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-82"><a href="#cb419-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-83"><a href="#cb419-83" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="st">"Choose not to disclose"</span> <span class="sc">~</span> <span class="st">"Not specified"</span>,</span>
<span id="cb419-84"><a href="#cb419-84" aria-hidden="true" tabindex="-1"></a>    gender <span class="sc">==</span> <span class="st">"Nonbinary/gender fluid/gender non-conforming"</span> <span class="sc">~</span> <span class="st">"Nonbinary"</span>,</span>
<span id="cb419-85"><a href="#cb419-85" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> gender</span>
<span id="cb419-86"><a href="#cb419-86" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb419-87"><a href="#cb419-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb419-88"><a href="#cb419-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-89"><a href="#cb419-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the gender plot with adjusted height scaling</span></span>
<span id="cb419-90"><a href="#cb419-90" aria-hidden="true" tabindex="-1"></a>gender_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gender_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(gender, count), <span class="at">y =</span> count, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb419-91"><a href="#cb419-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-92"><a href="#cb419-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"N=%d\</span></span>
<span id="cb419-93"><a href="#cb419-93" aria-hidden="true" tabindex="-1"></a><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-94"><a href="#cb419-94" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb419-95"><a href="#cb419-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Participants by Gender"</span>,</span>
<span id="cb419-96"><a href="#cb419-96" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gender"</span>,</span>
<span id="cb419-97"><a href="#cb419-97" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Participants (N = 1558)"</span>) <span class="sc">+</span></span>
<span id="cb419-98"><a href="#cb419-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-99"><a href="#cb419-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-100"><a href="#cb419-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-101"><a href="#cb419-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-102"><a href="#cb419-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-103"><a href="#cb419-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-104"><a href="#cb419-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb419-105"><a href="#cb419-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)</span>
<span id="cb419-106"><a href="#cb419-106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-107"><a href="#cb419-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)), </span>
<span id="cb419-108"><a href="#cb419-108" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(gender_summary<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.15</span>))</span>
<span id="cb419-109"><a href="#cb419-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-110"><a href="#cb419-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-111"><a href="#cb419-111" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_plot)</span>
<span id="cb419-112"><a href="#cb419-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-113"><a href="#cb419-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-116"><a href="#cb419-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-117"><a href="#cb419-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb419-118"><a href="#cb419-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Gender Distribution Summary"</span></span>
<span id="cb419-119"><a href="#cb419-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-gender-summary</span></span>
<span id="cb419-120"><a href="#cb419-120" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_summary)</span>
<span id="cb419-121"><a href="#cb419-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-122"><a href="#cb419-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-123"><a href="#cb419-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-124"><a href="#cb419-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-125"><a href="#cb419-125" aria-hidden="true" tabindex="-1"></a>The gender distribution shows a fairly even split between Male and Female participants, with a much smaller representation of Nonbinary, fluid, and non-conforming-gender individuals, and those who chose not to disclose.</span>
<span id="cb419-126"><a href="#cb419-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-127"><a href="#cb419-127" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Stats</span></span>
<span id="cb419-128"><a href="#cb419-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-131"><a href="#cb419-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-132"><a href="#cb419-132" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine categories </span></span>
<span id="cb419-133"><a href="#cb419-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-134"><a href="#cb419-134" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-135"><a href="#cb419-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-136"><a href="#cb419-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Another approach: Combine categories with small counts</span></span>
<span id="cb419-137"><a href="#cb419-137" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine "Nonbinary" and "Not specified" into "Other"</span></span>
<span id="cb419-138"><a href="#cb419-138" aria-hidden="true" tabindex="-1"></a>data_filtered_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-139"><a href="#cb419-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender), <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb419-140"><a href="#cb419-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-141"><a href="#cb419-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-142"><a href="#cb419-142" aria-hidden="true" tabindex="-1"></a>      gender <span class="sc">==</span> <span class="st">"Choose not to disclose"</span> <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb419-143"><a href="#cb419-143" aria-hidden="true" tabindex="-1"></a>      gender <span class="sc">==</span> <span class="st">"Nonbinary/gender fluid/gender non-conforming"</span> <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb419-144"><a href="#cb419-144" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> gender</span>
<span id="cb419-145"><a href="#cb419-145" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb419-146"><a href="#cb419-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-147"><a href="#cb419-147" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No RMT"</span>,</span>
<span id="cb419-148"><a href="#cb419-148" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"RMT"</span></span>
<span id="cb419-149"><a href="#cb419-149" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-150"><a href="#cb419-150" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-151"><a href="#cb419-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-152"><a href="#cb419-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new contingency table with combined categories</span></span>
<span id="cb419-153"><a href="#cb419-153" aria-hidden="true" tabindex="-1"></a>gender_rmt_table_combined <span class="ot">&lt;-</span> <span class="fu">table</span>(data_filtered_combined<span class="sc">$</span>gender, data_filtered_combined<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-154"><a href="#cb419-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-155"><a href="#cb419-155" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the new contingency table</span></span>
<span id="cb419-156"><a href="#cb419-156" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Contingency table with combined categories:"</span>)</span>
<span id="cb419-157"><a href="#cb419-157" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_rmt_table_combined)</span>
<span id="cb419-158"><a href="#cb419-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-159"><a href="#cb419-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate expected counts for the new table</span></span>
<span id="cb419-160"><a href="#cb419-160" aria-hidden="true" tabindex="-1"></a>expected_counts_combined <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(gender_rmt_table_combined)<span class="sc">$</span>expected</span>
<span id="cb419-161"><a href="#cb419-161" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Expected counts with combined categories:"</span>)</span>
<span id="cb419-162"><a href="#cb419-162" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expected_counts_combined)</span>
<span id="cb419-163"><a href="#cb419-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-164"><a href="#cb419-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test on the new table</span></span>
<span id="cb419-165"><a href="#cb419-165" aria-hidden="true" tabindex="-1"></a>chi_square_results_combined <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(gender_rmt_table_combined)</span>
<span id="cb419-166"><a href="#cb419-166" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chi-square test results with combined categories:"</span>)</span>
<span id="cb419-167"><a href="#cb419-167" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_square_results_combined)</span>
<span id="cb419-168"><a href="#cb419-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-169"><a href="#cb419-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for plotting with combined categories</span></span>
<span id="cb419-170"><a href="#cb419-170" aria-hidden="true" tabindex="-1"></a>gender_rmt_df_combined <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gender_rmt_table_combined)</span>
<span id="cb419-171"><a href="#cb419-171" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gender_rmt_df_combined) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"RMTMethods_YN"</span>, <span class="st">"Count"</span>)</span>
<span id="cb419-172"><a href="#cb419-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-173"><a href="#cb419-173" aria-hidden="true" tabindex="-1"></a>gender_rmt_df_combined <span class="ot">&lt;-</span> gender_rmt_df_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-174"><a href="#cb419-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender) <span class="sc">%&gt;%</span></span>
<span id="cb419-175"><a href="#cb419-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> (Count <span class="sc">/</span> <span class="fu">sum</span>(Count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb419-176"><a href="#cb419-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-177"><a href="#cb419-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with combined categories</span></span>
<span id="cb419-178"><a href="#cb419-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 7</span></span>
<span id="cb419-179"><a href="#cb419-179" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 10</span></span>
<span id="cb419-180"><a href="#cb419-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.height: "700px"</span></span>
<span id="cb419-181"><a href="#cb419-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: "center"</span></span>
<span id="cb419-182"><a href="#cb419-182" aria-hidden="true" tabindex="-1"></a>rmt_plot_combined <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gender_rmt_df_combined, <span class="fu">aes</span>(<span class="at">x =</span> RMTMethods_YN, <span class="at">y =</span> Count, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<span id="cb419-183"><a href="#cb419-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb419-184"><a href="#cb419-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, Count, Percentage)), </span>
<span id="cb419-185"><a href="#cb419-185" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-186"><a href="#cb419-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Gender Distribution by RMT Methods Usage (Combined Categories)"</span>,</span>
<span id="cb419-187"><a href="#cb419-187" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"RMT Methods Usage"</span>,</span>
<span id="cb419-188"><a href="#cb419-188" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Participants (N = 1558)"</span>,</span>
<span id="cb419-189"><a href="#cb419-189" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Gender"</span>) <span class="sc">+</span></span>
<span id="cb419-190"><a href="#cb419-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-191"><a href="#cb419-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-192"><a href="#cb419-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-193"><a href="#cb419-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-194"><a href="#cb419-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-195"><a href="#cb419-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-196"><a href="#cb419-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb419-197"><a href="#cb419-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">30</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)  <span class="co"># Add more margin at the top</span></span>
<span id="cb419-198"><a href="#cb419-198" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-199"><a href="#cb419-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))  <span class="co"># Expand y-axis to make room for labels</span></span>
<span id="cb419-200"><a href="#cb419-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-201"><a href="#cb419-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot with combined categories</span></span>
<span id="cb419-202"><a href="#cb419-202" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmt_plot_combined)</span>
<span id="cb419-203"><a href="#cb419-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-204"><a href="#cb419-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-205"><a href="#cb419-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results after combining into 'Other' category</span></span>
<span id="cb419-206"><a href="#cb419-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-207"><a href="#cb419-207" aria-hidden="true" tabindex="-1"></a>**Overview of the Data**</span>
<span id="cb419-208"><a href="#cb419-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-209"><a href="#cb419-209" aria-hidden="true" tabindex="-1"></a>The analysis examines the relationship between gender and Remote Monitoring Technology (RMT) usage across three gender categories: Female, Male, and Other. The contingency table shows the observed counts of participants in each combination of gender and RMT usage status.</span>
<span id="cb419-210"><a href="#cb419-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-211"><a href="#cb419-211" aria-hidden="true" tabindex="-1"></a>**Contingency Table Analysis**</span>
<span id="cb419-212"><a href="#cb419-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-213"><a href="#cb419-213" aria-hidden="true" tabindex="-1"></a>*Observed Frequencies*</span>
<span id="cb419-214"><a href="#cb419-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-215"><a href="#cb419-215" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Female participants**: 642 do not use RMT; 83 use RMT (total: 725)</span>
<span id="cb419-216"><a href="#cb419-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-217"><a href="#cb419-217" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Male participants**: 615 do not use RMT; 135 use RMT (total: 750)</span>
<span id="cb419-218"><a href="#cb419-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-219"><a href="#cb419-219" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Other gender category**: 73 do not use RMT; 10 use RMT (total: 83)</span>
<span id="cb419-220"><a href="#cb419-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-221"><a href="#cb419-221" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Column totals**: 1,330 non-RMT users; 228 RMT users (overall total: 1,558)</span>
<span id="cb419-222"><a href="#cb419-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-223"><a href="#cb419-223" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-3395192856.png)</span></span>
<span id="cb419-224"><a href="#cb419-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-225"><a href="#cb419-225" aria-hidden="true" tabindex="-1"></a>**Usage Rates by Gender**</span>
<span id="cb419-226"><a href="#cb419-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-227"><a href="#cb419-227" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Females: 11.4% use RMT (83 out of 725)</span>
<span id="cb419-228"><a href="#cb419-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-229"><a href="#cb419-229" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Males: 18.0% use RMT (135 out of 750)</span>
<span id="cb419-230"><a href="#cb419-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-231"><a href="#cb419-231" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Other: 12.0% use RMT (10 out of 83)</span>
<span id="cb419-232"><a href="#cb419-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-233"><a href="#cb419-233" aria-hidden="true" tabindex="-1"></a>**Key Observations**</span>
<span id="cb419-234"><a href="#cb419-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-235"><a href="#cb419-235" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The majority of individuals across all genders did not use RMT ("No RMT").</span>
<span id="cb419-236"><a href="#cb419-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-237"><a href="#cb419-237" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In absolute terms, females are the largest group in the "No RMT" category (642), while males are the largest in the "RMT" category (135).</span>
<span id="cb419-238"><a href="#cb419-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-239"><a href="#cb419-239" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The "Other" gender group has the fewest individuals in both "RMT" (10) and "No RMT" (73) categories.</span>
<span id="cb419-240"><a href="#cb419-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-241"><a href="#cb419-241" aria-hidden="true" tabindex="-1"></a>**Expected Frequencies**</span>
<span id="cb419-242"><a href="#cb419-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-243"><a href="#cb419-243" aria-hidden="true" tabindex="-1"></a>The expected counts represent what we would expect to see if there were no relationship between gender and RMT usage (i.e., if the null hypothesis were true). These are calculated based on the assumption that RMT usage and gender are independent:</span>
<span id="cb419-244"><a href="#cb419-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-245"><a href="#cb419-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Female participants**: Expected 618.90 non-users; 106.10 user</span>
<span id="cb419-246"><a href="#cb419-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-247"><a href="#cb419-247" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Male participants**: Expected 640.24 non-users; 109.76 users</span>
<span id="cb419-248"><a href="#cb419-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-249"><a href="#cb419-249" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Other gender category**: Expected 70.85 non-users; 12.15 users</span>
<span id="cb419-250"><a href="#cb419-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-251"><a href="#cb419-251" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-91490.png)</span></span>
<span id="cb419-252"><a href="#cb419-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-253"><a href="#cb419-253" aria-hidden="true" tabindex="-1"></a>**Differences between Observed and Expected**</span>
<span id="cb419-254"><a href="#cb419-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-255"><a href="#cb419-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Female participants**: More non-users than expected (+23.10); fewer users than expected (-23.10)</span>
<span id="cb419-256"><a href="#cb419-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-257"><a href="#cb419-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Male participants**: Fewer non-users than expected (-25.24); more users than expected (+25.24)</span>
<span id="cb419-258"><a href="#cb419-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-259"><a href="#cb419-259" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Other gender category**: More non-users than expected (+2.15); fewer users than expected (-2.15)</span>
<span id="cb419-260"><a href="#cb419-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-261"><a href="#cb419-261" aria-hidden="true" tabindex="-1"></a>**Key Observations:**</span>
<span id="cb419-262"><a href="#cb419-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-263"><a href="#cb419-263" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Under independence, females were expected to have about 618.9 individuals in "No RMT" and 106.1 in "RMT." However, the actual numbers are 642 and 83, respectively, suggesting fewer females participated in RMT than expected.</span>
<span id="cb419-264"><a href="#cb419-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-265"><a href="#cb419-265" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Conversely, males were expected to have 640.2 individuals in "No RMT" and 109.8 in "RMT," but the actual numbers are 615 and 135, suggesting more males participated in RMT than expected.</span>
<span id="cb419-266"><a href="#cb419-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-267"><a href="#cb419-267" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The "Other" group shows relatively small deviations from the expected counts.</span>
<span id="cb419-268"><a href="#cb419-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-269"><a href="#cb419-269" aria-hidden="true" tabindex="-1"></a>**Statistical Test Results**</span>
<span id="cb419-270"><a href="#cb419-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-271"><a href="#cb419-271" aria-hidden="true" tabindex="-1"></a>The chi-squared test evaluates whether the observed differences between the gender categories in RMT usage contingency table and the expected counts are statistically significant or could be attributed to random chance. The test outputs the following results:</span>
<span id="cb419-272"><a href="#cb419-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-273"><a href="#cb419-273" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Chi-square statistic (X²)**: 13.136</span>
<span id="cb419-274"><a href="#cb419-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-275"><a href="#cb419-275" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Degrees of freedom (df)**: 2</span>
<span id="cb419-276"><a href="#cb419-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-277"><a href="#cb419-277" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**P-value**: 0.001405</span>
<span id="cb419-278"><a href="#cb419-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-279"><a href="#cb419-279" aria-hidden="true" tabindex="-1"></a>**Interpretation**</span>
<span id="cb419-280"><a href="#cb419-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-281"><a href="#cb419-281" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Statistical Significance**: The p-value (0.001405) is well below the conventional threshold of 0.05, indicating a statistically significant association between gender and RMT usage. This means we can reject the null hypothesis that gender and RMT usage are independent.</span>
<span id="cb419-282"><a href="#cb419-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-283"><a href="#cb419-283" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Effect Direction**:</span>
<span id="cb419-284"><a href="#cb419-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-285"><a href="#cb419-285" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Males show notably higher RMT usage than expected under the null hypothesis</span>
<span id="cb419-286"><a href="#cb419-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-287"><a href="#cb419-287" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Females show notably lower RMT usage than expected</span>
<span id="cb419-288"><a href="#cb419-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-289"><a href="#cb419-289" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The "Other" gender category shows slightly lower RMT usage than expected</span>
<span id="cb419-290"><a href="#cb419-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-291"><a href="#cb419-291" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Practical Significance**:</span>
<span id="cb419-292"><a href="#cb419-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-293"><a href="#cb419-293" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Male participants are approximately 1.6 times more likely to use RMT compared to female participants (18.0% vs 11.4%)</span>
<span id="cb419-294"><a href="#cb419-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-295"><a href="#cb419-295" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The "Other" gender category's RMT usage (12.0%) is closer to females than males</span>
<span id="cb419-296"><a href="#cb419-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-297"><a href="#cb419-297" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Strength of Association**: While statistically significant, the chi-square value (13.136) suggests a modest association between gender and RMT usage in the context of the sample size (1,558 participants).</span>
<span id="cb419-298"><a href="#cb419-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-299"><a href="#cb419-299" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>In simpler terms, there is indeed a meaningful relationship between gender and the use of RMT methods.</span>
<span id="cb419-300"><a href="#cb419-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-301"><a href="#cb419-301" aria-hidden="true" tabindex="-1"></a>**Limitations and Considerations**</span>
<span id="cb419-302"><a href="#cb419-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-303"><a href="#cb419-303" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Categorical Combination**: The "Other" category appears to be a combination of non-binary individuals and those who chose not to disclose their gender. This grouping, while necessary for statistical analysis due to smaller sample sizes, may obscure potential differences between these distinct groups.</span>
<span id="cb419-304"><a href="#cb419-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-305"><a href="#cb419-305" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Sample Size Differences**: The "Other" gender category (n=83) is much smaller than the Female (n=725) and Male (n=750) categories, which affects the precision of estimates for this group.</span>
<span id="cb419-306"><a href="#cb419-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-307"><a href="#cb419-307" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**No Control Variables**: This analysis does not account for other variables that might influence RMT usage (e.g., age, technology access, health status) and might confound the relationship between gender and RMT usage.</span>
<span id="cb419-308"><a href="#cb419-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-309"><a href="#cb419-309" aria-hidden="true" tabindex="-1"></a>**Conclusion**</span>
<span id="cb419-310"><a href="#cb419-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-311"><a href="#cb419-311" aria-hidden="true" tabindex="-1"></a>There is compelling statistical evidence for a gender difference in RMT usage patterns, with males showing significantly higher adoption rates compared to females and those in the "Other" gender category. This finding may have implications for RMT implementation strategies, suggesting potential benefits from gender-specific approaches to technology adoption and support.</span>
<span id="cb419-312"><a href="#cb419-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-313"><a href="#cb419-313" aria-hidden="true" tabindex="-1"></a><span class="fu"># Age</span></span>
<span id="cb419-314"><a href="#cb419-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-315"><a href="#cb419-315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Demographic Stats</span></span>
<span id="cb419-316"><a href="#cb419-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-319"><a href="#cb419-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-320"><a href="#cb419-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-321"><a href="#cb419-321" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-322"><a href="#cb419-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-323"><a href="#cb419-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age summary</span></span>
<span id="cb419-324"><a href="#cb419-324" aria-hidden="true" tabindex="-1"></a>age_summary <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-325"><a href="#cb419-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">%&gt;%</span></span>
<span id="cb419-326"><a href="#cb419-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-327"><a href="#cb419-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-328"><a href="#cb419-328" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Under 20"</span>,</span>
<span id="cb419-329"><a href="#cb419-329" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"20-29"</span>,</span>
<span id="cb419-330"><a href="#cb419-330" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"30-39"</span>,</span>
<span id="cb419-331"><a href="#cb419-331" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">40</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"40-49"</span>,</span>
<span id="cb419-332"><a href="#cb419-332" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"50-59"</span>,</span>
<span id="cb419-333"><a href="#cb419-333" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"60+"</span></span>
<span id="cb419-334"><a href="#cb419-334" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-335"><a href="#cb419-335" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-336"><a href="#cb419-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_group) <span class="sc">%&gt;%</span></span>
<span id="cb419-337"><a href="#cb419-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-338"><a href="#cb419-338" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb419-339"><a href="#cb419-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> <span class="dv">1558</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-340"><a href="#cb419-340" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb419-341"><a href="#cb419-341" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-342"><a href="#cb419-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">factor</span>(age_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)))</span>
<span id="cb419-343"><a href="#cb419-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-344"><a href="#cb419-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the age plot with adjusted height scaling</span></span>
<span id="cb419-345"><a href="#cb419-345" aria-hidden="true" tabindex="-1"></a>age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age_summary, </span>
<span id="cb419-346"><a href="#cb419-346" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(age_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)), </span>
<span id="cb419-347"><a href="#cb419-347" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> count, <span class="at">fill =</span> age_group)) <span class="sc">+</span></span>
<span id="cb419-348"><a href="#cb419-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-349"><a href="#cb419-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"N=%d\</span></span>
<span id="cb419-350"><a href="#cb419-350" aria-hidden="true" tabindex="-1"></a><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-351"><a href="#cb419-351" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb419-352"><a href="#cb419-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Participants by Age Group"</span>,</span>
<span id="cb419-353"><a href="#cb419-353" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group (Years)"</span>,</span>
<span id="cb419-354"><a href="#cb419-354" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Participants (N = 1558)"</span>) <span class="sc">+</span></span>
<span id="cb419-355"><a href="#cb419-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-356"><a href="#cb419-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-357"><a href="#cb419-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-358"><a href="#cb419-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-359"><a href="#cb419-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-360"><a href="#cb419-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-361"><a href="#cb419-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb419-362"><a href="#cb419-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)</span>
<span id="cb419-363"><a href="#cb419-363" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-364"><a href="#cb419-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)), </span>
<span id="cb419-365"><a href="#cb419-365" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(age_summary<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.15</span>))</span>
<span id="cb419-366"><a href="#cb419-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-367"><a href="#cb419-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-368"><a href="#cb419-368" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_plot)</span>
<span id="cb419-369"><a href="#cb419-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-370"><a href="#cb419-370" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics</span></span>
<span id="cb419-371"><a href="#cb419-371" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Age distribution summary:"</span>)</span>
<span id="cb419-372"><a href="#cb419-372" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_summary)</span>
<span id="cb419-373"><a href="#cb419-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-374"><a href="#cb419-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-375"><a href="#cb419-375" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-376"><a href="#cb419-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-377"><a href="#cb419-377" aria-hidden="true" tabindex="-1"></a>Age: M = 37, SD = 16, 18-94, Median 32.5yo</span>
<span id="cb419-378"><a href="#cb419-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-379"><a href="#cb419-379" aria-hidden="true" tabindex="-1"></a>• The age distribution shows a right-skewed pattern with the majority of participants being between 18-40 years old, and fewer participants in the higher age ranges. Gender distribution is fairly balanced between male (48.1%) and female (46.5%) participants</span>
<span id="cb419-380"><a href="#cb419-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-381"><a href="#cb419-381" aria-hidden="true" tabindex="-1"></a>• The largest age group is 20-29 years (31.9% of participants)</span>
<span id="cb419-382"><a href="#cb419-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-383"><a href="#cb419-383" aria-hidden="true" tabindex="-1"></a>• There's a gradual decrease in participation with age, with the exception of a slight increase in the 60+ category compared to 50-59</span>
<span id="cb419-384"><a href="#cb419-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-385"><a href="#cb419-385" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Stats</span></span>
<span id="cb419-386"><a href="#cb419-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-389"><a href="#cb419-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-390"><a href="#cb419-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-391"><a href="#cb419-391" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-392"><a href="#cb419-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-393"><a href="#cb419-393" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age and RMT usage summary</span></span>
<span id="cb419-394"><a href="#cb419-394" aria-hidden="true" tabindex="-1"></a>age_rmt_summary <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-395"><a href="#cb419-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb419-396"><a href="#cb419-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-397"><a href="#cb419-397" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-398"><a href="#cb419-398" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Under 20"</span>,</span>
<span id="cb419-399"><a href="#cb419-399" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"20-29"</span>,</span>
<span id="cb419-400"><a href="#cb419-400" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"30-39"</span>,</span>
<span id="cb419-401"><a href="#cb419-401" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">40</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"40-49"</span>,</span>
<span id="cb419-402"><a href="#cb419-402" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> age <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"50-59"</span>,</span>
<span id="cb419-403"><a href="#cb419-403" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"60+"</span></span>
<span id="cb419-404"><a href="#cb419-404" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb419-405"><a href="#cb419-405" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-406"><a href="#cb419-406" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb419-407"><a href="#cb419-407" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Yes"</span></span>
<span id="cb419-408"><a href="#cb419-408" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-409"><a href="#cb419-409" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-410"><a href="#cb419-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-411"><a href="#cb419-411" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N for the analysis</span></span>
<span id="cb419-412"><a href="#cb419-412" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(age_rmt_summary)</span>
<span id="cb419-413"><a href="#cb419-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-414"><a href="#cb419-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb419-415"><a href="#cb419-415" aria-hidden="true" tabindex="-1"></a>age_rmt_table <span class="ot">&lt;-</span> <span class="fu">table</span>(age_rmt_summary<span class="sc">$</span>age_group, age_rmt_summary<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-416"><a href="#cb419-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-417"><a href="#cb419-417" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the contingency table</span></span>
<span id="cb419-418"><a href="#cb419-418" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Contingency Table:"</span>)</span>
<span id="cb419-419"><a href="#cb419-419" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_rmt_table)</span>
<span id="cb419-420"><a href="#cb419-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-421"><a href="#cb419-421" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified code with simulation-based p-value</span></span>
<span id="cb419-422"><a href="#cb419-422" aria-hidden="true" tabindex="-1"></a>chi_square_results <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(age_rmt_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-423"><a href="#cb419-423" aria-hidden="true" tabindex="-1"></a>expected_counts <span class="ot">&lt;-</span> chi_square_results<span class="sc">$</span>expected</span>
<span id="cb419-424"><a href="#cb419-424" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb419-425"><a href="#cb419-425" aria-hidden="true" tabindex="-1"></a><span class="st">Expected Counts:"</span>)</span>
<span id="cb419-426"><a href="#cb419-426" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(expected_counts, <span class="dv">2</span>))</span>
<span id="cb419-427"><a href="#cb419-427" aria-hidden="true" tabindex="-1"></a>min_expected <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_counts)</span>
<span id="cb419-428"><a href="#cb419-428" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"\</span></span>
<span id="cb419-429"><a href="#cb419-429" aria-hidden="true" tabindex="-1"></a><span class="st">Minimum expected count: %.2f"</span>, min_expected))</span>
<span id="cb419-430"><a href="#cb419-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-431"><a href="#cb419-431" aria-hidden="true" tabindex="-1"></a><span class="co"># If any expected count is below 5, use Fisher's exact test</span></span>
<span id="cb419-432"><a href="#cb419-432" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(min_expected <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb419-433"><a href="#cb419-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Some expected counts are less than 5; using Fisher's exact test instead."</span>)</span>
<span id="cb419-434"><a href="#cb419-434" aria-hidden="true" tabindex="-1"></a>  fisher_test_results <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(age_rmt_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-435"><a href="#cb419-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb419-436"><a href="#cb419-436" aria-hidden="true" tabindex="-1"></a><span class="st">Fisher's exact test results:"</span>)</span>
<span id="cb419-437"><a href="#cb419-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(fisher_test_results)</span>
<span id="cb419-438"><a href="#cb419-438" aria-hidden="true" tabindex="-1"></a>  main_test_results <span class="ot">&lt;-</span> fisher_test_results</span>
<span id="cb419-439"><a href="#cb419-439" aria-hidden="true" tabindex="-1"></a>  test_name <span class="ot">&lt;-</span> <span class="st">"Fisher's exact test"</span></span>
<span id="cb419-440"><a href="#cb419-440" aria-hidden="true" tabindex="-1"></a>  test_statistic <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb419-441"><a href="#cb419-441" aria-hidden="true" tabindex="-1"></a>  test_df <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb419-442"><a href="#cb419-442" aria-hidden="true" tabindex="-1"></a>  test_pvalue <span class="ot">&lt;-</span> fisher_test_results<span class="sc">$</span>p.value</span>
<span id="cb419-443"><a href="#cb419-443" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb419-444"><a href="#cb419-444" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-445"><a href="#cb419-445" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run chi-square test with simulated p-values for robustness</span></span>
<span id="cb419-446"><a href="#cb419-446" aria-hidden="true" tabindex="-1"></a>  chi_square_sim <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(age_rmt_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-447"><a href="#cb419-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb419-448"><a href="#cb419-448" aria-hidden="true" tabindex="-1"></a><span class="st">Chi-square test with simulated p-value:"</span>)</span>
<span id="cb419-449"><a href="#cb419-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(chi_square_sim)</span>
<span id="cb419-450"><a href="#cb419-450" aria-hidden="true" tabindex="-1"></a>  main_test_results <span class="ot">&lt;-</span> chi_square_sim</span>
<span id="cb419-451"><a href="#cb419-451" aria-hidden="true" tabindex="-1"></a>  test_name <span class="ot">&lt;-</span> <span class="st">"Chi-square test"</span></span>
<span id="cb419-452"><a href="#cb419-452" aria-hidden="true" tabindex="-1"></a>  test_statistic <span class="ot">&lt;-</span> chi_square_sim<span class="sc">$</span>statistic</span>
<span id="cb419-453"><a href="#cb419-453" aria-hidden="true" tabindex="-1"></a>  test_df <span class="ot">&lt;-</span> chi_square_sim<span class="sc">$</span>parameter</span>
<span id="cb419-454"><a href="#cb419-454" aria-hidden="true" tabindex="-1"></a>  test_pvalue <span class="ot">&lt;-</span> chi_square_sim<span class="sc">$</span>p.value</span>
<span id="cb419-455"><a href="#cb419-455" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-456"><a href="#cb419-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-457"><a href="#cb419-457" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages within each age group</span></span>
<span id="cb419-458"><a href="#cb419-458" aria-hidden="true" tabindex="-1"></a>age_rmt_summary_stats <span class="ot">&lt;-</span> age_rmt_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-459"><a href="#cb419-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_group, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-460"><a href="#cb419-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-461"><a href="#cb419-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb419-462"><a href="#cb419-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb419-463"><a href="#cb419-463" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-464"><a href="#cb419-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-465"><a href="#cb419-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-466"><a href="#cb419-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-467"><a href="#cb419-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb419-468"><a href="#cb419-468" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-469"><a href="#cb419-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(RMTMethods_YN, <span class="fu">factor</span>(age_group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)))</span>
<span id="cb419-470"><a href="#cb419-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-471"><a href="#cb419-471" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot </span><span class="al">###</span><span class="co"> REPLACE</span></span>
<span id="cb419-472"><a href="#cb419-472" aria-hidden="true" tabindex="-1"></a>rmt_age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age_rmt_summary_stats, </span>
<span id="cb419-473"><a href="#cb419-473" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(age_group, </span>
<span id="cb419-474"><a href="#cb419-474" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)), </span>
<span id="cb419-475"><a href="#cb419-475" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-476"><a href="#cb419-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb419-477"><a href="#cb419-477" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust data label: extra vertical space by increasing vjust (e.g., -1 for more space)</span></span>
<span id="cb419-478"><a href="#cb419-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-479"><a href="#cb419-479" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-480"><a href="#cb419-480" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-481"><a href="#cb419-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RMT Device Use by Age Group"</span>,</span>
<span id="cb419-482"><a href="#cb419-482" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Percentages calculated within each RMT group (Yes/No)"</span>),</span>
<span id="cb419-483"><a href="#cb419-483" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group (Years)"</span>,</span>
<span id="cb419-484"><a href="#cb419-484" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"Number of Participants (Total N ="</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb419-485"><a href="#cb419-485" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"RMT Usage"</span>) <span class="sc">+</span></span>
<span id="cb419-486"><a href="#cb419-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-487"><a href="#cb419-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-488"><a href="#cb419-488" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-489"><a href="#cb419-489" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-490"><a href="#cb419-490" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-491"><a href="#cb419-491" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-492"><a href="#cb419-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb419-493"><a href="#cb419-493" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">40</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>)  <span class="co"># Increased top margin for clarity</span></span>
<span id="cb419-494"><a href="#cb419-494" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-495"><a href="#cb419-495" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Expand the y-axis to create extra space at the top for the data labels</span></span>
<span id="cb419-496"><a href="#cb419-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)))</span>
<span id="cb419-497"><a href="#cb419-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-498"><a href="#cb419-498" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-499"><a href="#cb419-499" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmt_age_plot)</span>
<span id="cb419-500"><a href="#cb419-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-501"><a href="#cb419-501" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportions for each RMT group</span></span>
<span id="cb419-502"><a href="#cb419-502" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proportions within each RMT group:"</span>)</span>
<span id="cb419-503"><a href="#cb419-503" aria-hidden="true" tabindex="-1"></a>prop_table <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(age_rmt_table, <span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>  <span class="co"># Changed margin from 1 to 2</span></span>
<span id="cb419-504"><a href="#cb419-504" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_table, <span class="dv">2</span>))</span>
<span id="cb419-505"><a href="#cb419-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-506"><a href="#cb419-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the standardized residuals</span></span>
<span id="cb419-507"><a href="#cb419-507" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">"chi_square_results"</span>)) {</span>
<span id="cb419-508"><a href="#cb419-508" aria-hidden="true" tabindex="-1"></a>  std_residuals <span class="ot">&lt;-</span> chi_square_results<span class="sc">$</span>residuals</span>
<span id="cb419-509"><a href="#cb419-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized residuals:"</span>)</span>
<span id="cb419-510"><a href="#cb419-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(std_residuals, <span class="dv">2</span>))</span>
<span id="cb419-511"><a href="#cb419-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Cells with absolute standardized residuals &gt; 2 contribute significantly to the chi-square statistic"</span>)</span>
<span id="cb419-512"><a href="#cb419-512" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-513"><a href="#cb419-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-514"><a href="#cb419-514" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional visualization: Create a bar chart showing the percentage of each age group within RMT usage groups</span></span>
<span id="cb419-515"><a href="#cb419-515" aria-hidden="true" tabindex="-1"></a>percentage_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age_rmt_summary_stats, </span>
<span id="cb419-516"><a href="#cb419-516" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(age_group, </span>
<span id="cb419-517"><a href="#cb419-517" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)), </span>
<span id="cb419-518"><a href="#cb419-518" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> percentage, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-519"><a href="#cb419-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb419-520"><a href="#cb419-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, percentage)),</span>
<span id="cb419-521"><a href="#cb419-521" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-522"><a href="#cb419-522" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-523"><a href="#cb419-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Distribution Within RMT Usage Groups"</span>,</span>
<span id="cb419-524"><a href="#cb419-524" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Showing percentage of each age group within 'Yes' and 'No' RMT usage categories"</span>,</span>
<span id="cb419-525"><a href="#cb419-525" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group (Years)"</span>,</span>
<span id="cb419-526"><a href="#cb419-526" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage within RMT Group (%)"</span>,</span>
<span id="cb419-527"><a href="#cb419-527" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"RMT Usage"</span>) <span class="sc">+</span></span>
<span id="cb419-528"><a href="#cb419-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-529"><a href="#cb419-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-530"><a href="#cb419-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-531"><a href="#cb419-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb419-532"><a href="#cb419-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-533"><a href="#cb419-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-534"><a href="#cb419-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb419-535"><a href="#cb419-535" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-536"><a href="#cb419-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-537"><a href="#cb419-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-538"><a href="#cb419-538" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the percentage plot</span></span>
<span id="cb419-539"><a href="#cb419-539" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(percentage_plot)</span>
<span id="cb419-540"><a href="#cb419-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-541"><a href="#cb419-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-544"><a href="#cb419-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-545"><a href="#cb419-545" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni Correction and Visualisation</span></span>
<span id="cb419-546"><a href="#cb419-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-547"><a href="#cb419-547" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairwise chi-square tests between age groups with Bonferroni correction. This determines how strict the Bonferroni correction will be.</span></span>
<span id="cb419-548"><a href="#cb419-548" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb419-549"><a href="#cb419-549" aria-hidden="true" tabindex="-1"></a><span class="st">Pairwise comparisons between age groups with Bonferroni correction:"</span>)</span>
<span id="cb419-550"><a href="#cb419-550" aria-hidden="true" tabindex="-1"></a>age_groups <span class="ot">&lt;-</span> <span class="fu">rownames</span>(age_rmt_table)</span>
<span id="cb419-551"><a href="#cb419-551" aria-hidden="true" tabindex="-1"></a>n_comparisons <span class="ot">&lt;-</span> <span class="fu">choose</span>(<span class="fu">length</span>(age_groups), <span class="dv">2</span>) <span class="co">#calculates the total number of pairwise comparisons</span></span>
<span id="cb419-552"><a href="#cb419-552" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-553"><a href="#cb419-553" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group1 =</span> <span class="fu">character</span>(),</span>
<span id="cb419-554"><a href="#cb419-554" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group2 =</span> <span class="fu">character</span>(),</span>
<span id="cb419-555"><a href="#cb419-555" aria-hidden="true" tabindex="-1"></a>  <span class="at">ChiSquare =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-556"><a href="#cb419-556" aria-hidden="true" tabindex="-1"></a>  <span class="at">DF =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-557"><a href="#cb419-557" aria-hidden="true" tabindex="-1"></a>  <span class="at">RawP =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-558"><a href="#cb419-558" aria-hidden="true" tabindex="-1"></a>  <span class="at">CorrectedP =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-559"><a href="#cb419-559" aria-hidden="true" tabindex="-1"></a>  <span class="at">Significant =</span> <span class="fu">character</span>(),</span>
<span id="cb419-560"><a href="#cb419-560" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb419-561"><a href="#cb419-561" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-562"><a href="#cb419-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-563"><a href="#cb419-563" aria-hidden="true" tabindex="-1"></a><span class="co"># For each pair of age groups, the code: </span></span>
<span id="cb419-564"><a href="#cb419-564" aria-hidden="true" tabindex="-1"></a><span class="do">## Creates a 2×2 contingency table containing only those two age groups</span></span>
<span id="cb419-565"><a href="#cb419-565" aria-hidden="true" tabindex="-1"></a><span class="do">## Checks if expected cell counts are below 5</span></span>
<span id="cb419-566"><a href="#cb419-566" aria-hidden="true" tabindex="-1"></a><span class="do">## Uses either Chi-square or Fisher's exact test accordingly</span></span>
<span id="cb419-567"><a href="#cb419-567" aria-hidden="true" tabindex="-1"></a><span class="do">## Applies Bonferroni correction to control for multiple comparisons</span></span>
<span id="cb419-568"><a href="#cb419-568" aria-hidden="true" tabindex="-1"></a><span class="do">## Determines significance based on the corrected p-value</span></span>
<span id="cb419-569"><a href="#cb419-569" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(age_groups)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb419-570"><a href="#cb419-570" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(age_groups)) {</span>
<span id="cb419-571"><a href="#cb419-571" aria-hidden="true" tabindex="-1"></a>    subset_tab <span class="ot">&lt;-</span> age_rmt_table[<span class="fu">c</span>(i, j), ]</span>
<span id="cb419-572"><a href="#cb419-572" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-573"><a href="#cb419-573" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check expected counts for this pair</span></span>
<span id="cb419-574"><a href="#cb419-574" aria-hidden="true" tabindex="-1"></a>    pair_expected <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(subset_tab)<span class="sc">$</span>expected</span>
<span id="cb419-575"><a href="#cb419-575" aria-hidden="true" tabindex="-1"></a>    min_pair_expected <span class="ot">&lt;-</span> <span class="fu">min</span>(pair_expected)</span>
<span id="cb419-576"><a href="#cb419-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-577"><a href="#cb419-577" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Choose appropriate test based on expected counts</span></span>
<span id="cb419-578"><a href="#cb419-578" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Chi-square test assumes expected cell counts ≥5</span></span>
<span id="cb419-579"><a href="#cb419-579" aria-hidden="true" tabindex="-1"></a>    <span class="do">## When this assumption is violated, Fisher's exact test is used instead</span></span>
<span id="cb419-580"><a href="#cb419-580" aria-hidden="true" tabindex="-1"></a>    <span class="do">## This adaptive approach ensures statistical validity for each comparison</span></span>
<span id="cb419-581"><a href="#cb419-581" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(min_pair_expected <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb419-582"><a href="#cb419-582" aria-hidden="true" tabindex="-1"></a>      pair_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(subset_tab)</span>
<span id="cb419-583"><a href="#cb419-583" aria-hidden="true" tabindex="-1"></a>      test_stat <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb419-584"><a href="#cb419-584" aria-hidden="true" tabindex="-1"></a>      test_df <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb419-585"><a href="#cb419-585" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb419-586"><a href="#cb419-586" aria-hidden="true" tabindex="-1"></a>      pair_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(subset_tab)</span>
<span id="cb419-587"><a href="#cb419-587" aria-hidden="true" tabindex="-1"></a>      test_stat <span class="ot">&lt;-</span> pair_test<span class="sc">$</span>statistic</span>
<span id="cb419-588"><a href="#cb419-588" aria-hidden="true" tabindex="-1"></a>      test_df <span class="ot">&lt;-</span> pair_test<span class="sc">$</span>parameter</span>
<span id="cb419-589"><a href="#cb419-589" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-590"><a href="#cb419-590" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-591"><a href="#cb419-591" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply Bonferroni correction</span></span>
<span id="cb419-592"><a href="#cb419-592" aria-hidden="true" tabindex="-1"></a>    <span class="do">## The original p-value is multiplied by the total number of comparisons</span></span>
<span id="cb419-593"><a href="#cb419-593" aria-hidden="true" tabindex="-1"></a>    <span class="do">## This makes the significance threshold more stringent to avoid false positives</span></span>
<span id="cb419-594"><a href="#cb419-594" aria-hidden="true" tabindex="-1"></a>    <span class="do">## The correction controls the family-wise error rate when making multiple comparisons</span></span>
<span id="cb419-595"><a href="#cb419-595" aria-hidden="true" tabindex="-1"></a>    <span class="do">## The min() function ensures the corrected p-value doesn't exceed 1</span></span>
<span id="cb419-596"><a href="#cb419-596" aria-hidden="true" tabindex="-1"></a>    corrected_p <span class="ot">&lt;-</span> <span class="fu">min</span>(pair_test<span class="sc">$</span>p.value <span class="sc">*</span> n_comparisons, <span class="dv">1</span>)</span>
<span id="cb419-597"><a href="#cb419-597" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-598"><a href="#cb419-598" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine if the result is significant</span></span>
<span id="cb419-599"><a href="#cb419-599" aria-hidden="true" tabindex="-1"></a>    is_significant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(corrected_p <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb419-600"><a href="#cb419-600" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-601"><a href="#cb419-601" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add to results dataframe</span></span>
<span id="cb419-602"><a href="#cb419-602" aria-hidden="true" tabindex="-1"></a>    pairwise_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_results, <span class="fu">data.frame</span>(</span>
<span id="cb419-603"><a href="#cb419-603" aria-hidden="true" tabindex="-1"></a>      <span class="at">Group1 =</span> age_groups[i],</span>
<span id="cb419-604"><a href="#cb419-604" aria-hidden="true" tabindex="-1"></a>      <span class="at">Group2 =</span> age_groups[j],</span>
<span id="cb419-605"><a href="#cb419-605" aria-hidden="true" tabindex="-1"></a>      <span class="at">ChiSquare =</span> <span class="cf">if</span>(<span class="fu">is.na</span>(test_stat)) <span class="cn">NA</span> <span class="cf">else</span> <span class="fu">round</span>(test_stat, <span class="dv">2</span>),</span>
<span id="cb419-606"><a href="#cb419-606" aria-hidden="true" tabindex="-1"></a>      <span class="at">DF =</span> test_df,</span>
<span id="cb419-607"><a href="#cb419-607" aria-hidden="true" tabindex="-1"></a>      <span class="at">RawP =</span> <span class="fu">round</span>(pair_test<span class="sc">$</span>p.value, <span class="dv">4</span>),</span>
<span id="cb419-608"><a href="#cb419-608" aria-hidden="true" tabindex="-1"></a>      <span class="at">CorrectedP =</span> <span class="fu">round</span>(corrected_p, <span class="dv">4</span>),</span>
<span id="cb419-609"><a href="#cb419-609" aria-hidden="true" tabindex="-1"></a>      <span class="at">Significant =</span> is_significant,</span>
<span id="cb419-610"><a href="#cb419-610" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb419-611"><a href="#cb419-611" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-612"><a href="#cb419-612" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-613"><a href="#cb419-613" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the result</span></span>
<span id="cb419-614"><a href="#cb419-614" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.na</span>(test_stat)) {</span>
<span id="cb419-615"><a href="#cb419-615" aria-hidden="true" tabindex="-1"></a>      message <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"Comparison %s vs %s: Fisher's exact test, raw p = %.4f, Bonferroni corrected p = %.4f, Significant: %s"</span>,</span>
<span id="cb419-616"><a href="#cb419-616" aria-hidden="true" tabindex="-1"></a>                         age_groups[i], age_groups[j],</span>
<span id="cb419-617"><a href="#cb419-617" aria-hidden="true" tabindex="-1"></a>                         pair_test<span class="sc">$</span>p.value, corrected_p, is_significant)</span>
<span id="cb419-618"><a href="#cb419-618" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb419-619"><a href="#cb419-619" aria-hidden="true" tabindex="-1"></a>      message <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"Comparison %s vs %s: Chi-square = %.2f, df = %d, raw p = %.4f, Bonferroni corrected p = %.4f, Significant: %s"</span>,</span>
<span id="cb419-620"><a href="#cb419-620" aria-hidden="true" tabindex="-1"></a>                         age_groups[i], age_groups[j],</span>
<span id="cb419-621"><a href="#cb419-621" aria-hidden="true" tabindex="-1"></a>                         test_stat, test_df,</span>
<span id="cb419-622"><a href="#cb419-622" aria-hidden="true" tabindex="-1"></a>                         pair_test<span class="sc">$</span>p.value, corrected_p, is_significant)</span>
<span id="cb419-623"><a href="#cb419-623" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-624"><a href="#cb419-624" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(message)</span>
<span id="cb419-625"><a href="#cb419-625" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-626"><a href="#cb419-626" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-627"><a href="#cb419-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-628"><a href="#cb419-628" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the pairwise results table</span></span>
<span id="cb419-629"><a href="#cb419-629" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"\</span></span>
<span id="cb419-630"><a href="#cb419-630" aria-hidden="true" tabindex="-1"></a><span class="st">Summary of pairwise comparisons:"</span>)</span>
<span id="cb419-631"><a href="#cb419-631" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span>
<span id="cb419-632"><a href="#cb419-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-633"><a href="#cb419-633" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap of p-values for pairwise comparisons</span></span>
<span id="cb419-634"><a href="#cb419-634" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for heatmap</span></span>
<span id="cb419-635"><a href="#cb419-635" aria-hidden="true" tabindex="-1"></a><span class="do">## Red cells indicate p-values close to 0 (strong evidence of difference)</span></span>
<span id="cb419-636"><a href="#cb419-636" aria-hidden="true" tabindex="-1"></a><span class="do">## Yellow indicates p-values around 0.5 (moderate evidence)</span></span>
<span id="cb419-637"><a href="#cb419-637" aria-hidden="true" tabindex="-1"></a><span class="do">## White indicates p-values close to 1 (little evidence of difference)</span></span>
<span id="cb419-638"><a href="#cb419-638" aria-hidden="true" tabindex="-1"></a><span class="do">## Asterisks (*) mark statistically significant differences (p &lt; 0.05)</span></span>
<span id="cb419-639"><a href="#cb419-639" aria-hidden="true" tabindex="-1"></a><span class="do">## The heatmap is symmetrical because the comparison of Group1 vs Group2 is the same as Group2 vs Group1</span></span>
<span id="cb419-640"><a href="#cb419-640" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(age_groups), <span class="at">ncol =</span> <span class="fu">length</span>(age_groups))</span>
<span id="cb419-641"><a href="#cb419-641" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(heatmap_data) <span class="ot">&lt;-</span> age_groups</span>
<span id="cb419-642"><a href="#cb419-642" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(heatmap_data) <span class="ot">&lt;-</span> age_groups</span>
<span id="cb419-643"><a href="#cb419-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-644"><a href="#cb419-644" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pairwise_results)) {</span>
<span id="cb419-645"><a href="#cb419-645" aria-hidden="true" tabindex="-1"></a>  row_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(age_groups <span class="sc">==</span> pairwise_results<span class="sc">$</span>Group1[i])</span>
<span id="cb419-646"><a href="#cb419-646" aria-hidden="true" tabindex="-1"></a>  col_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(age_groups <span class="sc">==</span> pairwise_results<span class="sc">$</span>Group2[i])</span>
<span id="cb419-647"><a href="#cb419-647" aria-hidden="true" tabindex="-1"></a>  heatmap_data[row_idx, col_idx] <span class="ot">&lt;-</span> pairwise_results<span class="sc">$</span>CorrectedP[i]</span>
<span id="cb419-648"><a href="#cb419-648" aria-hidden="true" tabindex="-1"></a>  heatmap_data[col_idx, row_idx] <span class="ot">&lt;-</span> pairwise_results<span class="sc">$</span>CorrectedP[i]  <span class="co"># Mirror the matrix</span></span>
<span id="cb419-649"><a href="#cb419-649" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-650"><a href="#cb419-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-651"><a href="#cb419-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format for ggplot</span></span>
<span id="cb419-652"><a href="#cb419-652" aria-hidden="true" tabindex="-1"></a>heatmap_long <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(heatmap_data))</span>
<span id="cb419-653"><a href="#cb419-653" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(heatmap_long) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Group1"</span>, <span class="st">"Group2"</span>, <span class="st">"CorrectedP"</span>)</span>
<span id="cb419-654"><a href="#cb419-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-655"><a href="#cb419-655" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the heatmap</span></span>
<span id="cb419-656"><a href="#cb419-656" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(heatmap_long, <span class="fu">aes</span>(<span class="at">x =</span> Group1, <span class="at">y =</span> Group2, <span class="at">fill =</span> CorrectedP)) <span class="sc">+</span></span>
<span id="cb419-657"><a href="#cb419-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb419-658"><a href="#cb419-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"white"</span>, </span>
<span id="cb419-659"><a href="#cb419-659" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="fl">0.5</span>, <span class="at">na.value =</span> <span class="st">"white"</span>,</span>
<span id="cb419-660"><a href="#cb419-660" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">name =</span> <span class="st">"Corrected p-value"</span>) <span class="sc">+</span></span>
<span id="cb419-661"><a href="#cb419-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(CorrectedP), <span class="st">""</span>, </span>
<span id="cb419-662"><a href="#cb419-662" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(CorrectedP <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb419-663"><a href="#cb419-663" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">sprintf</span>(<span class="st">"%.4f*"</span>, CorrectedP),</span>
<span id="cb419-664"><a href="#cb419-664" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, CorrectedP)))),</span>
<span id="cb419-665"><a href="#cb419-665" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-666"><a href="#cb419-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pairwise Comparisons of RMT Usage Between Age Groups"</span>,</span>
<span id="cb419-667"><a href="#cb419-667" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Bonferroni-corrected p-values (* indicates significant at α = 0.05)"</span>) <span class="sc">+</span></span>
<span id="cb419-668"><a href="#cb419-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-669"><a href="#cb419-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-670"><a href="#cb419-670" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-671"><a href="#cb419-671" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb419-672"><a href="#cb419-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb419-673"><a href="#cb419-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-674"><a href="#cb419-674" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the heatmap</span></span>
<span id="cb419-675"><a href="#cb419-675" aria-hidden="true" tabindex="-1"></a><span class="do">## When analyzing the results from this code:</span></span>
<span id="cb419-676"><a href="#cb419-676" aria-hidden="true" tabindex="-1"></a><span class="do">## Look for cells with asterisks (*) in the heatmap or "Significant: Yes" in the printed results</span></span>
<span id="cb419-677"><a href="#cb419-677" aria-hidden="true" tabindex="-1"></a><span class="do">## These indicate which specific age groups differ significantly in RMT usage</span></span>
<span id="cb419-678"><a href="#cb419-678" aria-hidden="true" tabindex="-1"></a><span class="do">## The raw p-values show the strength of evidence before correction</span></span>
<span id="cb419-679"><a href="#cb419-679" aria-hidden="true" tabindex="-1"></a><span class="do">## The corrected p-values account for multiple testing and are more conservative</span></span>
<span id="cb419-680"><a href="#cb419-680" aria-hidden="true" tabindex="-1"></a><span class="do">## Pay attention to which test was used (Chi-square or Fisher's) for each comparison</span></span>
<span id="cb419-681"><a href="#cb419-681" aria-hidden="true" tabindex="-1"></a><span class="do">## This approach enables you to identify specifically which age groups differ from each other in their RMT usage patterns, rather than just knowing that "age is associated with RMT usage" in general.</span></span>
<span id="cb419-682"><a href="#cb419-682" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(heatmap_plot)</span>
<span id="cb419-683"><a href="#cb419-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-684"><a href="#cb419-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional visualization: Create a bar chart showing the percentage of RMT usage by age group</span></span>
<span id="cb419-685"><a href="#cb419-685" aria-hidden="true" tabindex="-1"></a>percentage_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(age_rmt_summary_stats <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"Yes"</span>), </span>
<span id="cb419-686"><a href="#cb419-686" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(age_group, </span>
<span id="cb419-687"><a href="#cb419-687" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Under 20"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>, <span class="st">"50-59"</span>, <span class="st">"60+"</span>)), </span>
<span id="cb419-688"><a href="#cb419-688" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> percentage)) <span class="sc">+</span></span>
<span id="cb419-689"><a href="#cb419-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb419-690"><a href="#cb419-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, percentage)),</span>
<span id="cb419-691"><a href="#cb419-691" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-692"><a href="#cb419-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage of RMT Device Usage by Age Group"</span>,</span>
<span id="cb419-693"><a href="#cb419-693" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group (Years)"</span>,</span>
<span id="cb419-694"><a href="#cb419-694" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage (%)"</span>) <span class="sc">+</span></span>
<span id="cb419-695"><a href="#cb419-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-696"><a href="#cb419-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-697"><a href="#cb419-697" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-698"><a href="#cb419-698" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-699"><a href="#cb419-699" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-700"><a href="#cb419-700" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb419-701"><a href="#cb419-701" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-702"><a href="#cb419-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-703"><a href="#cb419-703" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the percentage plot</span></span>
<span id="cb419-704"><a href="#cb419-704" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(percentage_plot)</span>
<span id="cb419-705"><a href="#cb419-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-706"><a href="#cb419-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-707"><a href="#cb419-707" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-708"><a href="#cb419-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-709"><a href="#cb419-709" aria-hidden="true" tabindex="-1"></a>*Chi-Square Test*</span>
<span id="cb419-710"><a href="#cb419-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-711"><a href="#cb419-711" aria-hidden="true" tabindex="-1"></a>The chi-square test with simulated p-values (10,000 replicates) shows a statistically significant association between age group and RMT usage:</span>
<span id="cb419-712"><a href="#cb419-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-713"><a href="#cb419-713" aria-hidden="true" tabindex="-1"></a>X-squared = 35.047, p-value <span class="sc">\&lt;</span> 0.0001</span>
<span id="cb419-714"><a href="#cb419-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-715"><a href="#cb419-715" aria-hidden="true" tabindex="-1"></a>This indicates strong evidence against the null hypothesis of independence between age group and RMT device usage.</span>
<span id="cb419-716"><a href="#cb419-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-717"><a href="#cb419-717" aria-hidden="true" tabindex="-1"></a>*Expected Counts*</span>
<span id="cb419-718"><a href="#cb419-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-719"><a href="#cb419-719" aria-hidden="true" tabindex="-1"></a>All expected cell counts exceed 5, confirming the chi-square test's validity</span>
<span id="cb419-720"><a href="#cb419-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-721"><a href="#cb419-721" aria-hidden="true" tabindex="-1"></a>Minimum expected count: 25.02</span>
<span id="cb419-722"><a href="#cb419-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-723"><a href="#cb419-723" aria-hidden="true" tabindex="-1"></a>*Standardized Residuals*</span>
<span id="cb419-724"><a href="#cb419-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-725"><a href="#cb419-725" aria-hidden="true" tabindex="-1"></a>The standardized residuals help identify which specific cells contribute most to the chi-square statistic</span>
<span id="cb419-726"><a href="#cb419-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-727"><a href="#cb419-727" aria-hidden="true" tabindex="-1"></a>**Notable observations:**</span>
<span id="cb419-728"><a href="#cb419-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-729"><a href="#cb419-729" aria-hidden="true" tabindex="-1"></a>The 30-39 age group has a strong positive residual (3.89) for "Yes" responses, indicating significantly higher RMT usage than expected. The Under 20 age group has a strong negative residual (-2.79) for "Yes" responses, indicating significantly lower RMT usage than expected.</span>
<span id="cb419-730"><a href="#cb419-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-731"><a href="#cb419-731" aria-hidden="true" tabindex="-1"></a>**Pairwise Comparisons with Bonferroni Correction**</span>
<span id="cb419-732"><a href="#cb419-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-733"><a href="#cb419-733" aria-hidden="true" tabindex="-1"></a>To determine which specific age groups differ significantly from each other, pairwise chi-square tests were conducted with Bonferroni correction to control for multiple comparisons</span>
<span id="cb419-734"><a href="#cb419-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-735"><a href="#cb419-735" aria-hidden="true" tabindex="-1"></a>**Summary of Significant Pairwise Differences:**</span>
<span id="cb419-736"><a href="#cb419-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-737"><a href="#cb419-737" aria-hidden="true" tabindex="-1"></a>30-39 age group shows significantly higher RMT usage compared to: 40-49 age group (p = 0.0198), 50-59 age group (p = 0.0145), 60+ age group (p = 0.0067), Under 20 age group (p = 0.0001).</span>
<span id="cb419-738"><a href="#cb419-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-739"><a href="#cb419-739" aria-hidden="true" tabindex="-1"></a>20-29 age group shows significantly higher RMT usage compared to: Under 20 age group (p = 0.0209).</span>
<span id="cb419-740"><a href="#cb419-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-741"><a href="#cb419-741" aria-hidden="true" tabindex="-1"></a>No significant differences were found between: 20-29 and 30-39 age groups Any pairs among the 40-49, 50-59, 60+, and Under 20 age groups.</span>
<span id="cb419-742"><a href="#cb419-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-743"><a href="#cb419-743" aria-hidden="true" tabindex="-1"></a>**Visual Representation**</span>
<span id="cb419-744"><a href="#cb419-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-745"><a href="#cb419-745" aria-hidden="true" tabindex="-1"></a>The analysis includes three visualizations:</span>
<span id="cb419-746"><a href="#cb419-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-747"><a href="#cb419-747" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Bar chart of RMT usage counts by age group</span>
<span id="cb419-748"><a href="#cb419-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-749"><a href="#cb419-749" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Heatmap of pairwise comparison p-values</span>
<span id="cb419-750"><a href="#cb419-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-751"><a href="#cb419-751" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Percentage of RMT device usage by age group</span>
<span id="cb419-752"><a href="#cb419-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-753"><a href="#cb419-753" aria-hidden="true" tabindex="-1"></a>**Interpretation and Implications Age-Related Patterns in RMT Usage:**</span>
<span id="cb419-754"><a href="#cb419-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-755"><a href="#cb419-755" aria-hidden="true" tabindex="-1"></a>The 30-39 age group has the highest RMT adoption rate (23.37%). The 20-29 age group has the second highest adoption rate (16.70%). All other age groups have notably lower adoption rates (6.67% to 11.95%).</span>
<span id="cb419-756"><a href="#cb419-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-757"><a href="#cb419-757" aria-hidden="true" tabindex="-1"></a>**Key Findings:**</span>
<span id="cb419-758"><a href="#cb419-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-759"><a href="#cb419-759" aria-hidden="true" tabindex="-1"></a>There is a clear peak in RMT usage among adults in their 30s. Young adults (20-29) also show relatively high adoption. Both younger (under 20) and older (40+) age groups show significantly lower adoption rates. The 30-39 age group stands out as significantly different from most other age groups.</span>
<span id="cb419-760"><a href="#cb419-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-761"><a href="#cb419-761" aria-hidden="true" tabindex="-1"></a>**Practical** **Implications:**</span>
<span id="cb419-762"><a href="#cb419-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-763"><a href="#cb419-763" aria-hidden="true" tabindex="-1"></a>Targeted interventions may be needed to increase RMT adoption among both younger and older populations. Understanding the factors that drive higher adoption in the 30-39 age group could inform strategies to increase usage in other groups. The 20-29 and 30-39 age groups could be considered as early adopters or technology champions. This comprehensive analysis provides strong statistical evidence for age-related differences in RMT device usage, with clear identification of which specific age groups differ significantly from others.</span>
<span id="cb419-764"><a href="#cb419-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-765"><a href="#cb419-765" aria-hidden="true" tabindex="-1"></a><span class="fu"># Instruments Played</span></span>
<span id="cb419-766"><a href="#cb419-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-767"><a href="#cb419-767" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-768"><a href="#cb419-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-771"><a href="#cb419-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-772"><a href="#cb419-772" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-773"><a href="#cb419-773" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-774"><a href="#cb419-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-775"><a href="#cb419-775" aria-hidden="true" tabindex="-1"></a><span class="co"># Define instrument families</span></span>
<span id="cb419-776"><a href="#cb419-776" aria-hidden="true" tabindex="-1"></a>woodwinds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Flute"</span>, <span class="st">"Piccolo"</span>, <span class="st">"Clarinet"</span>, <span class="st">"Saxophone"</span>, <span class="st">"Oboe"</span>, <span class="st">"Bassoon"</span>, <span class="st">"Recorder"</span>)</span>
<span id="cb419-777"><a href="#cb419-777" aria-hidden="true" tabindex="-1"></a>brass <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Trumpet"</span>, <span class="st">"Trombone"</span>, <span class="st">"Tuba"</span>, <span class="st">"Euphonium"</span>, <span class="st">"French Horn"</span>, <span class="st">"French Horn/Horn"</span>)</span>
<span id="cb419-778"><a href="#cb419-778" aria-hidden="true" tabindex="-1"></a>others <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Bagpipes"</span>, <span class="st">"Other"</span>)</span>
<span id="cb419-779"><a href="#cb419-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-780"><a href="#cb419-780" aria-hidden="true" tabindex="-1"></a><span class="co"># Process instrument-level data</span></span>
<span id="cb419-781"><a href="#cb419-781" aria-hidden="true" tabindex="-1"></a>WI_split_updated <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-782"><a href="#cb419-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(WI) <span class="sc">%&gt;%</span></span>
<span id="cb419-783"><a href="#cb419-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(WI, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-784"><a href="#cb419-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WI =</span> <span class="fu">trimws</span>(WI)) <span class="sc">%&gt;%</span></span>
<span id="cb419-785"><a href="#cb419-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WI =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-786"><a href="#cb419-786" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">==</span> <span class="st">"French Horn/Horn"</span> <span class="sc">~</span> <span class="st">"French Horn"</span>,</span>
<span id="cb419-787"><a href="#cb419-787" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">==</span> <span class="st">"Oboe/Cor Anglais"</span> <span class="sc">~</span> <span class="st">"Oboe"</span>,</span>
<span id="cb419-788"><a href="#cb419-788" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> WI</span>
<span id="cb419-789"><a href="#cb419-789" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb419-790"><a href="#cb419-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(WI <span class="sc">!=</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-791"><a href="#cb419-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(WI, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-792"><a href="#cb419-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Family =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-793"><a href="#cb419-793" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">%in%</span> <span class="fu">c</span>(woodwinds, <span class="st">"Oboe"</span>) <span class="sc">~</span> <span class="st">"Woodwinds"</span>,</span>
<span id="cb419-794"><a href="#cb419-794" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">%in%</span> brass <span class="sc">~</span> <span class="st">"Brass"</span>,</span>
<span id="cb419-795"><a href="#cb419-795" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Others"</span></span>
<span id="cb419-796"><a href="#cb419-796" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb419-797"><a href="#cb419-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-798"><a href="#cb419-798" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages for instruments</span></span>
<span id="cb419-799"><a href="#cb419-799" aria-hidden="true" tabindex="-1"></a>WI_percentages_updated <span class="ot">&lt;-</span> WI_split_updated <span class="sc">%&gt;%</span></span>
<span id="cb419-800"><a href="#cb419-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>((n <span class="sc">/</span> <span class="dv">3054</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb419-801"><a href="#cb419-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-802"><a href="#cb419-802" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate family distribution</span></span>
<span id="cb419-803"><a href="#cb419-803" aria-hidden="true" tabindex="-1"></a>family_distribution_updated <span class="ot">&lt;-</span> WI_split_updated <span class="sc">%&gt;%</span></span>
<span id="cb419-804"><a href="#cb419-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Family) <span class="sc">%&gt;%</span></span>
<span id="cb419-805"><a href="#cb419-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb419-806"><a href="#cb419-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">round</span>((Total <span class="sc">/</span> <span class="dv">3054</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb419-807"><a href="#cb419-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-808"><a href="#cb419-808" aria-hidden="true" tabindex="-1"></a><span class="co"># Create instrument distribution plot</span></span>
<span id="cb419-809"><a href="#cb419-809" aria-hidden="true" tabindex="-1"></a>instrument_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> WI_percentages_updated, </span>
<span id="cb419-810"><a href="#cb419-810" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(WI, n), <span class="at">y =</span> n, <span class="at">fill =</span> Family)) <span class="sc">+</span></span>
<span id="cb419-811"><a href="#cb419-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-812"><a href="#cb419-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, Percentage, <span class="st">"%)"</span>)), </span>
<span id="cb419-813"><a href="#cb419-813" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, </span>
<span id="cb419-814"><a href="#cb419-814" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb419-815"><a href="#cb419-815" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb419-816"><a href="#cb419-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb419-817"><a href="#cb419-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>))) <span class="sc">+</span>  <span class="co"># Increased expansion for labels</span></span>
<span id="cb419-818"><a href="#cb419-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Wind Instruments by Count and Percentage"</span>,</span>
<span id="cb419-819"><a href="#cb419-819" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Instrument"</span>,</span>
<span id="cb419-820"><a href="#cb419-820" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency (N=1558, responses = 3054)"</span>,</span>
<span id="cb419-821"><a href="#cb419-821" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note. reported percentages are out of total responses (3054) not the total N (1558)"</span>) <span class="sc">+</span></span>
<span id="cb419-822"><a href="#cb419-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-823"><a href="#cb419-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-824"><a href="#cb419-824" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-825"><a href="#cb419-825" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-826"><a href="#cb419-826" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb419-827"><a href="#cb419-827" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-828"><a href="#cb419-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-829"><a href="#cb419-829" aria-hidden="true" tabindex="-1"></a><span class="co"># Create family distribution plot</span></span>
<span id="cb419-830"><a href="#cb419-830" aria-hidden="true" tabindex="-1"></a>family_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> family_distribution_updated, </span>
<span id="cb419-831"><a href="#cb419-831" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Family, <span class="sc">-</span>Total), <span class="at">y =</span> Total, <span class="at">fill =</span> Family)) <span class="sc">+</span></span>
<span id="cb419-832"><a href="#cb419-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-833"><a href="#cb419-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Total, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, Percentage, <span class="st">"%)"</span>)), </span>
<span id="cb419-834"><a href="#cb419-834" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb419-835"><a href="#cb419-835" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb419-836"><a href="#cb419-836" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb419-837"><a href="#cb419-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))) <span class="sc">+</span>  <span class="co"># Increased expansion for labels</span></span>
<span id="cb419-838"><a href="#cb419-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution by Instrument Family"</span>,</span>
<span id="cb419-839"><a href="#cb419-839" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Instrument Family"</span>,</span>
<span id="cb419-840"><a href="#cb419-840" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency (N=1558, responses = 3054)"</span>,</span>
<span id="cb419-841"><a href="#cb419-841" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note. reported percentages are out of total responses (3054) not the total N (1558)"</span>) <span class="sc">+</span></span>
<span id="cb419-842"><a href="#cb419-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-843"><a href="#cb419-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-844"><a href="#cb419-844" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-845"><a href="#cb419-845" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb419-846"><a href="#cb419-846" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb419-847"><a href="#cb419-847" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-848"><a href="#cb419-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-849"><a href="#cb419-849" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb419-850"><a href="#cb419-850" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(instrument_plot)</span>
<span id="cb419-851"><a href="#cb419-851" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(family_plot)</span>
<span id="cb419-852"><a href="#cb419-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-853"><a href="#cb419-853" aria-hidden="true" tabindex="-1"></a><span class="co"># Print distributions</span></span>
<span id="cb419-854"><a href="#cb419-854" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Instrument Distribution:"</span>)</span>
<span id="cb419-855"><a href="#cb419-855" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(WI_percentages_updated)</span>
<span id="cb419-856"><a href="#cb419-856" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Family Distribution:"</span>)</span>
<span id="cb419-857"><a href="#cb419-857" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(family_distribution_updated)</span>
<span id="cb419-858"><a href="#cb419-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-859"><a href="#cb419-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-860"><a href="#cb419-860" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-861"><a href="#cb419-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-862"><a href="#cb419-862" aria-hidden="true" tabindex="-1"></a>• Woodwinds represented a slight majority of 58.02% of the total instruments.</span>
<span id="cb419-863"><a href="#cb419-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-864"><a href="#cb419-864" aria-hidden="true" tabindex="-1"></a>• Brass accounts for 31.99%, with the updated "French Horn" category included.</span>
<span id="cb419-865"><a href="#cb419-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-866"><a href="#cb419-866" aria-hidden="true" tabindex="-1"></a>• Others and Unknown categories make up smaller portions (5.04% and 4.94%, respectively).</span>
<span id="cb419-867"><a href="#cb419-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-868"><a href="#cb419-868" aria-hidden="true" tabindex="-1"></a>*Individual Instrument Distribution:*</span>
<span id="cb419-869"><a href="#cb419-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-870"><a href="#cb419-870" aria-hidden="true" tabindex="-1"></a>• Saxophone remains the most popular instrument (15.62%), followed by Flute (14.51%) and Clarinet (13.59%).</span>
<span id="cb419-871"><a href="#cb419-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-872"><a href="#cb419-872" aria-hidden="true" tabindex="-1"></a>• Trumpet leads the brass instruments with 11.23%, while French Horn now accurately reflects its combined count.</span>
<span id="cb419-873"><a href="#cb419-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-874"><a href="#cb419-874" aria-hidden="true" tabindex="-1"></a>• Others include: harmonica, tenor horn, non-western flute, recorder, ocarina, cornet, whistle, baritone, non-western reed, flugelhorn, misc.</span>
<span id="cb419-875"><a href="#cb419-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-876"><a href="#cb419-876" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Stats</span></span>
<span id="cb419-877"><a href="#cb419-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-880"><a href="#cb419-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-881"><a href="#cb419-881" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-882"><a href="#cb419-882" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-883"><a href="#cb419-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-884"><a href="#cb419-884" aria-hidden="true" tabindex="-1"></a><span class="co"># Process instrument and RMT data</span></span>
<span id="cb419-885"><a href="#cb419-885" aria-hidden="true" tabindex="-1"></a>instrument_rmt_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-886"><a href="#cb419-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(WI), <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb419-887"><a href="#cb419-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(WI, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-888"><a href="#cb419-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-889"><a href="#cb419-889" aria-hidden="true" tabindex="-1"></a>    <span class="at">WI =</span> <span class="fu">trimws</span>(WI),</span>
<span id="cb419-890"><a href="#cb419-890" aria-hidden="true" tabindex="-1"></a>    <span class="at">WI =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-891"><a href="#cb419-891" aria-hidden="true" tabindex="-1"></a>      WI <span class="sc">==</span> <span class="st">"French Horn/Horn"</span> <span class="sc">~</span> <span class="st">"French Horn"</span>,</span>
<span id="cb419-892"><a href="#cb419-892" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> WI</span>
<span id="cb419-893"><a href="#cb419-893" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb419-894"><a href="#cb419-894" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(RMTMethods_YN, </span>
<span id="cb419-895"><a href="#cb419-895" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb419-896"><a href="#cb419-896" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>))</span>
<span id="cb419-897"><a href="#cb419-897" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-898"><a href="#cb419-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(WI <span class="sc">!=</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-899"><a href="#cb419-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">family =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-900"><a href="#cb419-900" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Flute"</span>, <span class="st">"Piccolo"</span>, <span class="st">"Clarinet"</span>, <span class="st">"Saxophone"</span>, <span class="st">"Oboe"</span>, <span class="st">"Bassoon"</span>, <span class="st">"Recorder"</span>) <span class="sc">~</span> <span class="st">"Woodwinds"</span>,</span>
<span id="cb419-901"><a href="#cb419-901" aria-hidden="true" tabindex="-1"></a>    WI <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Trumpet"</span>, <span class="st">"Trombone"</span>, <span class="st">"Tuba"</span>, <span class="st">"Euphonium"</span>, <span class="st">"French Horn"</span>) <span class="sc">~</span> <span class="st">"Brass"</span>,</span>
<span id="cb419-902"><a href="#cb419-902" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Others"</span></span>
<span id="cb419-903"><a href="#cb419-903" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb419-904"><a href="#cb419-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-905"><a href="#cb419-905" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts and percentages for each RMT group (Changed grouping)</span></span>
<span id="cb419-906"><a href="#cb419-906" aria-hidden="true" tabindex="-1"></a>family_rmt_summary <span class="ot">&lt;-</span> instrument_rmt_data <span class="sc">%&gt;%</span></span>
<span id="cb419-907"><a href="#cb419-907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(family, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-908"><a href="#cb419-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-909"><a href="#cb419-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span>  <span class="co"># Changed from family to RMTMethods_YN</span></span>
<span id="cb419-910"><a href="#cb419-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-911"><a href="#cb419-911" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-912"><a href="#cb419-912" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb419-913"><a href="#cb419-913" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-914"><a href="#cb419-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-915"><a href="#cb419-915" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N for adding to the plot</span></span>
<span id="cb419-916"><a href="#cb419-916" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(instrument_rmt_data)</span>
<span id="cb419-917"><a href="#cb419-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-918"><a href="#cb419-918" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test on the full contingency table</span></span>
<span id="cb419-919"><a href="#cb419-919" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(instrument_rmt_data<span class="sc">$</span>family, instrument_rmt_data<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-920"><a href="#cb419-920" aria-hidden="true" tabindex="-1"></a>chi_square_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb419-921"><a href="#cb419-921" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chi-square test results:"</span>)</span>
<span id="cb419-922"><a href="#cb419-922" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_square_test)</span>
<span id="cb419-923"><a href="#cb419-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-924"><a href="#cb419-924" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the assumption: print the expected counts from the chi-square test</span></span>
<span id="cb419-925"><a href="#cb419-925" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Expected counts:"</span>)</span>
<span id="cb419-926"><a href="#cb419-926" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_square_test<span class="sc">$</span>expected)</span>
<span id="cb419-927"><a href="#cb419-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-928"><a href="#cb419-928" aria-hidden="true" tabindex="-1"></a><span class="co"># If any expected count is less than 5, issue a warning and switch to Fisher's exact test</span></span>
<span id="cb419-929"><a href="#cb419-929" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">min</span>(chi_square_test<span class="sc">$</span>expected) <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb419-930"><a href="#cb419-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Chi-square test assumption violated. Switching to Fisher's exact test."</span>)</span>
<span id="cb419-931"><a href="#cb419-931" aria-hidden="true" tabindex="-1"></a>  chi_square_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table)</span>
<span id="cb419-932"><a href="#cb419-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Fisher's exact test results:"</span>)</span>
<span id="cb419-933"><a href="#cb419-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(chi_square_test)</span>
<span id="cb419-934"><a href="#cb419-934" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-935"><a href="#cb419-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-936"><a href="#cb419-936" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb419-937"><a href="#cb419-937" aria-hidden="true" tabindex="-1"></a>rmt_distribution_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(family_rmt_summary, </span>
<span id="cb419-938"><a href="#cb419-938" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">aes</span>(<span class="at">x =</span> family, <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-939"><a href="#cb419-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-940"><a href="#cb419-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-941"><a href="#cb419-941" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-942"><a href="#cb419-942" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-943"><a href="#cb419-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Instrument Families within RMT Usage Groups"</span>,</span>
<span id="cb419-944"><a href="#cb419-944" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Percentages calculated within each RMT group (Chi-square: χ² = %.2f, df = %d, p = %.4f)"</span>,</span>
<span id="cb419-945"><a href="#cb419-945" aria-hidden="true" tabindex="-1"></a>                        chi_square_test<span class="sc">$</span>statistic,</span>
<span id="cb419-946"><a href="#cb419-946" aria-hidden="true" tabindex="-1"></a>                        chi_square_test<span class="sc">$</span>parameter,</span>
<span id="cb419-947"><a href="#cb419-947" aria-hidden="true" tabindex="-1"></a>                        chi_square_test<span class="sc">$</span>p.value),</span>
<span id="cb419-948"><a href="#cb419-948" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Instrument Family"</span>,</span>
<span id="cb419-949"><a href="#cb419-949" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">"Number of Responses (Total N ="</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb419-950"><a href="#cb419-950" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"RMT Usage"</span>) <span class="sc">+</span></span>
<span id="cb419-951"><a href="#cb419-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-952"><a href="#cb419-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-953"><a href="#cb419-953" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-954"><a href="#cb419-954" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-955"><a href="#cb419-955" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-956"><a href="#cb419-956" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-957"><a href="#cb419-957" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-958"><a href="#cb419-958" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb419-959"><a href="#cb419-959" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">30</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>)  <span class="co"># Add more space at the top</span></span>
<span id="cb419-960"><a href="#cb419-960" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-961"><a href="#cb419-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))  <span class="co"># Add more space above bars</span></span>
<span id="cb419-962"><a href="#cb419-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-963"><a href="#cb419-963" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-964"><a href="#cb419-964" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmt_distribution_plot)</span>
<span id="cb419-965"><a href="#cb419-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-966"><a href="#cb419-966" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print odds ratios</span></span>
<span id="cb419-967"><a href="#cb419-967" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds ratios between instrument families and RMT usage:"</span>)</span>
<span id="cb419-968"><a href="#cb419-968" aria-hidden="true" tabindex="-1"></a>family_rmt_odds <span class="ot">&lt;-</span> family_rmt_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-969"><a href="#cb419-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(family, RMTMethods_YN, count) <span class="sc">%&gt;%</span></span>
<span id="cb419-970"><a href="#cb419-970" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> RMTMethods_YN, <span class="at">values_from =</span> count, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">count =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb419-971"><a href="#cb419-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-972"><a href="#cb419-972" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a small constant to avoid division by zero</span></span>
<span id="cb419-973"><a href="#cb419-973" aria-hidden="true" tabindex="-1"></a>    <span class="at">odds_ratio =</span> <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"RMT"</span>, <span class="st">"No RMT"</span>) <span class="sc">%in%</span> <span class="fu">names</span>(.))) {</span>
<span id="cb419-974"><a href="#cb419-974" aria-hidden="true" tabindex="-1"></a>      (RMT <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> (<span class="fu">sum</span>(RMT) <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> (((<span class="st">`</span><span class="at">No RMT</span><span class="st">`</span> <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> (<span class="fu">sum</span>(<span class="st">`</span><span class="at">No RMT</span><span class="st">`</span>) <span class="sc">+</span> <span class="fl">0.5</span>)))</span>
<span id="cb419-975"><a href="#cb419-975" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb419-976"><a href="#cb419-976" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA</span></span>
<span id="cb419-977"><a href="#cb419-977" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-978"><a href="#cb419-978" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-979"><a href="#cb419-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-980"><a href="#cb419-980" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(family_rmt_odds)</span>
<span id="cb419-981"><a href="#cb419-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-982"><a href="#cb419-982" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new data frame with percentages within RMT groups for easier interpretation</span></span>
<span id="cb419-983"><a href="#cb419-983" aria-hidden="true" tabindex="-1"></a>rmt_percentages <span class="ot">&lt;-</span> family_rmt_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-984"><a href="#cb419-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(family, RMTMethods_YN, count, percentage) <span class="sc">%&gt;%</span></span>
<span id="cb419-985"><a href="#cb419-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> RMTMethods_YN, </span>
<span id="cb419-986"><a href="#cb419-986" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(count, percentage),</span>
<span id="cb419-987"><a href="#cb419-987" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_glue =</span> <span class="st">"{RMTMethods_YN}_{.value}"</span>)</span>
<span id="cb419-988"><a href="#cb419-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-989"><a href="#cb419-989" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Percentage distribution within each RMT group:"</span>)</span>
<span id="cb419-990"><a href="#cb419-990" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rmt_percentages)</span>
<span id="cb419-991"><a href="#cb419-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-992"><a href="#cb419-992" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform post-hoc analysis for each pair of instrument families</span></span>
<span id="cb419-993"><a href="#cb419-993" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise comparisons between instrument families:"</span>)</span>
<span id="cb419-994"><a href="#cb419-994" aria-hidden="true" tabindex="-1"></a>families <span class="ot">&lt;-</span> <span class="fu">unique</span>(instrument_rmt_data<span class="sc">$</span>family)</span>
<span id="cb419-995"><a href="#cb419-995" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(families) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb419-996"><a href="#cb419-996" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(families)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb419-997"><a href="#cb419-997" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(families)) {</span>
<span id="cb419-998"><a href="#cb419-998" aria-hidden="true" tabindex="-1"></a>      subset_data <span class="ot">&lt;-</span> instrument_rmt_data <span class="sc">%&gt;%</span></span>
<span id="cb419-999"><a href="#cb419-999" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(family <span class="sc">%in%</span> <span class="fu">c</span>(families[i], families[j]))</span>
<span id="cb419-1000"><a href="#cb419-1000" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-1001"><a href="#cb419-1001" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create contingency table for this pair</span></span>
<span id="cb419-1002"><a href="#cb419-1002" aria-hidden="true" tabindex="-1"></a>      pair_table <span class="ot">&lt;-</span> <span class="fu">table</span>(subset_data<span class="sc">$</span>family, subset_data<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-1003"><a href="#cb419-1003" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-1004"><a href="#cb419-1004" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if table has enough data for chi-square test</span></span>
<span id="cb419-1005"><a href="#cb419-1005" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">dim</span>(pair_table) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;&amp;</span> <span class="fu">min</span>(pair_table) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb419-1006"><a href="#cb419-1006" aria-hidden="true" tabindex="-1"></a>        pair_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(pair_table)</span>
<span id="cb419-1007"><a href="#cb419-1007" aria-hidden="true" tabindex="-1"></a>        test_type <span class="ot">&lt;-</span> <span class="st">"Chi-square"</span></span>
<span id="cb419-1008"><a href="#cb419-1008" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb419-1009"><a href="#cb419-1009" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use Fisher's exact test as fallback</span></span>
<span id="cb419-1010"><a href="#cb419-1010" aria-hidden="true" tabindex="-1"></a>        pair_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(pair_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-1011"><a href="#cb419-1011" aria-hidden="true" tabindex="-1"></a>        test_type <span class="ot">&lt;-</span> <span class="st">"Fisher's exact"</span></span>
<span id="cb419-1012"><a href="#cb419-1012" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb419-1013"><a href="#cb419-1013" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-1014"><a href="#cb419-1014" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">%s vs %s:"</span>, families[i], families[j]))</span>
<span id="cb419-1015"><a href="#cb419-1015" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(test_type <span class="sc">==</span> <span class="st">"Chi-square"</span>) {</span>
<span id="cb419-1016"><a href="#cb419-1016" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"%s test: Chi-square = %.2f, df = %d, p = %.4f"</span>,</span>
<span id="cb419-1017"><a href="#cb419-1017" aria-hidden="true" tabindex="-1"></a>                      test_type,</span>
<span id="cb419-1018"><a href="#cb419-1018" aria-hidden="true" tabindex="-1"></a>                      pair_test<span class="sc">$</span>statistic,</span>
<span id="cb419-1019"><a href="#cb419-1019" aria-hidden="true" tabindex="-1"></a>                      pair_test<span class="sc">$</span>parameter,</span>
<span id="cb419-1020"><a href="#cb419-1020" aria-hidden="true" tabindex="-1"></a>                      pair_test<span class="sc">$</span>p.value))</span>
<span id="cb419-1021"><a href="#cb419-1021" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb419-1022"><a href="#cb419-1022" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"%s test: p = %.4f"</span>, test_type, pair_test<span class="sc">$</span>p.value))</span>
<span id="cb419-1023"><a href="#cb419-1023" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb419-1024"><a href="#cb419-1024" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-1025"><a href="#cb419-1025" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-1026"><a href="#cb419-1026" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-1027"><a href="#cb419-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1028"><a href="#cb419-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairwise comparisons between instrument families with Bonferroni correction:</span></span>
<span id="cb419-1029"><a href="#cb419-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise comparisons between instrument families (with Bonferroni correction):"</span>)</span>
<span id="cb419-1030"><a href="#cb419-1030" aria-hidden="true" tabindex="-1"></a>families <span class="ot">&lt;-</span> <span class="fu">unique</span>(instrument_rmt_data<span class="sc">$</span>family)</span>
<span id="cb419-1031"><a href="#cb419-1031" aria-hidden="true" tabindex="-1"></a>n_comparisons <span class="ot">&lt;-</span> <span class="fu">length</span>(families) <span class="sc">*</span> (<span class="fu">length</span>(families)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb419-1032"><a href="#cb419-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1033"><a href="#cb419-1033" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(families)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb419-1034"><a href="#cb419-1034" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(families)) {</span>
<span id="cb419-1035"><a href="#cb419-1035" aria-hidden="true" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> instrument_rmt_data <span class="sc">%&gt;%</span></span>
<span id="cb419-1036"><a href="#cb419-1036" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(family <span class="sc">%in%</span> <span class="fu">c</span>(families[i], families[j]))</span>
<span id="cb419-1037"><a href="#cb419-1037" aria-hidden="true" tabindex="-1"></a>    pair_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="fu">table</span>(subset_data<span class="sc">$</span>family, subset_data<span class="sc">$</span>RMTMethods_YN))</span>
<span id="cb419-1038"><a href="#cb419-1038" aria-hidden="true" tabindex="-1"></a>    p_value_corrected <span class="ot">&lt;-</span> <span class="fu">min</span>(pair_test<span class="sc">$</span>p.value <span class="sc">*</span> n_comparisons, <span class="dv">1</span>)  <span class="co"># Correction and capped at 1</span></span>
<span id="cb419-1039"><a href="#cb419-1039" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">%s vs %s:"</span>, families[i], families[j]))</span>
<span id="cb419-1040"><a href="#cb419-1040" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">sprintf</span>(<span class="st">"Chi-square = %.2f, df = %d, raw p = %.4f, Bonferroni corrected p = %.4f"</span>,</span>
<span id="cb419-1041"><a href="#cb419-1041" aria-hidden="true" tabindex="-1"></a>                  pair_test<span class="sc">$</span>statistic,</span>
<span id="cb419-1042"><a href="#cb419-1042" aria-hidden="true" tabindex="-1"></a>                  pair_test<span class="sc">$</span>parameter,</span>
<span id="cb419-1043"><a href="#cb419-1043" aria-hidden="true" tabindex="-1"></a>                  pair_test<span class="sc">$</span>p.value,</span>
<span id="cb419-1044"><a href="#cb419-1044" aria-hidden="true" tabindex="-1"></a>                  p_value_corrected))</span>
<span id="cb419-1045"><a href="#cb419-1045" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-1046"><a href="#cb419-1046" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-1047"><a href="#cb419-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1048"><a href="#cb419-1048" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new visualization specifically showing the distribution within RMT groups</span></span>
<span id="cb419-1049"><a href="#cb419-1049" aria-hidden="true" tabindex="-1"></a>percentage_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(family_rmt_summary, </span>
<span id="cb419-1050"><a href="#cb419-1050" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">x =</span> family, <span class="at">y =</span> percentage, <span class="at">fill =</span> family)) <span class="sc">+</span></span>
<span id="cb419-1051"><a href="#cb419-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb419-1052"><a href="#cb419-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, percentage)),</span>
<span id="cb419-1053"><a href="#cb419-1053" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-1054"><a href="#cb419-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> RMTMethods_YN, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb419-1055"><a href="#cb419-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Instrument Families within Each RMT Usage Group"</span>,</span>
<span id="cb419-1056"><a href="#cb419-1056" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Showing percentage of each instrument family within 'RMT' and 'No RMT' groups"</span>,</span>
<span id="cb419-1057"><a href="#cb419-1057" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Instrument Family"</span>,</span>
<span id="cb419-1058"><a href="#cb419-1058" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage within RMT Group (%)"</span>) <span class="sc">+</span></span>
<span id="cb419-1059"><a href="#cb419-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-1060"><a href="#cb419-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-1061"><a href="#cb419-1061" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-1062"><a href="#cb419-1062" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb419-1063"><a href="#cb419-1063" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-1064"><a href="#cb419-1064" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-1065"><a href="#cb419-1065" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-1066"><a href="#cb419-1066" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb419-1067"><a href="#cb419-1067" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-1068"><a href="#cb419-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1069"><a href="#cb419-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the percentage plot</span></span>
<span id="cb419-1070"><a href="#cb419-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(percentage_plot)</span>
<span id="cb419-1071"><a href="#cb419-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-1072"><a href="#cb419-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1073"><a href="#cb419-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-1074"><a href="#cb419-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1075"><a href="#cb419-1075" aria-hidden="true" tabindex="-1"></a>Based on the provided statistical output, there are significant differences in Respiratory Muscle Training (RMT) usage across instrument families, with brass players showing notably higher adoption rates compared to woodwind players and other instrumentalists.</span>
<span id="cb419-1076"><a href="#cb419-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1077"><a href="#cb419-1077" aria-hidden="true" tabindex="-1"></a>*Classification by Instrument Family:*</span>
<span id="cb419-1078"><a href="#cb419-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1079"><a href="#cb419-1079" aria-hidden="true" tabindex="-1"></a>Instruments are grouped into families based on predefined lists. For example:</span>
<span id="cb419-1080"><a href="#cb419-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1081"><a href="#cb419-1081" aria-hidden="true" tabindex="-1"></a>Instruments like “Flute,” “Piccolo,” “Clarinet,” etc., are grouped as Woodwinds. Instruments like “Trumpet,” “Trombone,” “Tuba,” etc., are grouped as Brass. All others are assigned to a default category called Others.</span>
<span id="cb419-1082"><a href="#cb419-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1083"><a href="#cb419-1083" aria-hidden="true" tabindex="-1"></a>**Observed Frequencies Analysis**</span>
<span id="cb419-1084"><a href="#cb419-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1085"><a href="#cb419-1085" aria-hidden="true" tabindex="-1"></a>*Raw Counts by Instrument Family:*</span>
<span id="cb419-1086"><a href="#cb419-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1087"><a href="#cb419-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Brass**: 765 non-users, 213 RMT users (21.8% usage rate)</span>
<span id="cb419-1088"><a href="#cb419-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1089"><a href="#cb419-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Woodwinds**: 1,523 non-users, 249 RMT users (14.0% usage rate)</span>
<span id="cb419-1090"><a href="#cb419-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1091"><a href="#cb419-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Others**: 260 non-users, 44 RMT users (14.5% usage rate)</span>
<span id="cb419-1092"><a href="#cb419-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1093"><a href="#cb419-1093" aria-hidden="true" tabindex="-1"></a>**Chi-square Test Results:**</span>
<span id="cb419-1094"><a href="#cb419-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1095"><a href="#cb419-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Overall test: X² = 28.293, df = 2, p-value = 7.183e-07</span>
<span id="cb419-1096"><a href="#cb419-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1097"><a href="#cb419-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This highly significant p-value (<span class="sc">\&lt;</span>0.001) indicates strong evidence of an association between instrument family and RMT usage.</span>
<span id="cb419-1098"><a href="#cb419-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1099"><a href="#cb419-1099" aria-hidden="true" tabindex="-1"></a>**Pairwise Comparisons**</span>
<span id="cb419-1100"><a href="#cb419-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1101"><a href="#cb419-1101" aria-hidden="true" tabindex="-1"></a>*Woodwinds vs. Others:*</span>
<span id="cb419-1102"><a href="#cb419-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1103"><a href="#cb419-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chi-square = 0.01, df = 1, p = 0.9156</span>
<span id="cb419-1104"><a href="#cb419-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1105"><a href="#cb419-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bonferroni corrected p = 1.0000</span>
<span id="cb419-1106"><a href="#cb419-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1107"><a href="#cb419-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation: No significant difference in RMT usage between woodwind players and other instrumentalists.</span>
<span id="cb419-1108"><a href="#cb419-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1109"><a href="#cb419-1109" aria-hidden="true" tabindex="-1"></a>**Woodwinds vs. Brass:**</span>
<span id="cb419-1110"><a href="#cb419-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1111"><a href="#cb419-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chi-square = 26.37, df = 1, p <span class="sc">\&lt;</span> 0.0001</span>
<span id="cb419-1112"><a href="#cb419-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1113"><a href="#cb419-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bonferroni corrected p <span class="sc">\&lt;</span> 0.0001</span>
<span id="cb419-1114"><a href="#cb419-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1115"><a href="#cb419-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation: Highly significant difference, with brass players using RMT at a significantly higher rate than woodwind players.</span>
<span id="cb419-1116"><a href="#cb419-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1117"><a href="#cb419-1117" aria-hidden="true" tabindex="-1"></a>**Others vs. Brass:**</span>
<span id="cb419-1118"><a href="#cb419-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1119"><a href="#cb419-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chi-square = 7.27, df = 1, p = 0.0070</span>
<span id="cb419-1120"><a href="#cb419-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1121"><a href="#cb419-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bonferroni corrected p = 0.0210</span>
<span id="cb419-1122"><a href="#cb419-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1123"><a href="#cb419-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation: Significant difference even after correction for multiple comparisons, with brass players using RMT at a higher rate than other instrumentalists.</span>
<span id="cb419-1124"><a href="#cb419-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1125"><a href="#cb419-1125" aria-hidden="true" tabindex="-1"></a>*Key findings from the pairwise comparisons:*</span>
<span id="cb419-1126"><a href="#cb419-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1127"><a href="#cb419-1127" aria-hidden="true" tabindex="-1"></a>• Woodwinds vs. Brass: Highly significant difference (p <span class="sc">\&lt;</span> 0.0001)</span>
<span id="cb419-1128"><a href="#cb419-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1129"><a href="#cb419-1129" aria-hidden="true" tabindex="-1"></a>• Others vs. Brass: Significant difference (p = 0.007)</span>
<span id="cb419-1130"><a href="#cb419-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1131"><a href="#cb419-1131" aria-hidden="true" tabindex="-1"></a>• Woodwinds vs. Others: No significant difference (p = 0.916)</span>
<span id="cb419-1132"><a href="#cb419-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1133"><a href="#cb419-1133" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>There is a statistically significant difference in RMT usage across instrument families</span>
<span id="cb419-1134"><a href="#cb419-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1135"><a href="#cb419-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Brass players show significantly different patterns of RMT usage compared to both Woodwind players and Others</span>
<span id="cb419-1136"><a href="#cb419-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1137"><a href="#cb419-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Woodwind players and Others show similar patterns of RMT usage</span>
<span id="cb419-1138"><a href="#cb419-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1139"><a href="#cb419-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>The proportion of RMT usage is highest among Brass players</span>
<span id="cb419-1140"><a href="#cb419-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1141"><a href="#cb419-1141" aria-hidden="true" tabindex="-1"></a>X-squared = 55.92, df = 13, p-value = 2.784e-07</span>
<span id="cb419-1142"><a href="#cb419-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1143"><a href="#cb419-1143" aria-hidden="true" tabindex="-1"></a>The plot shows the percentage distribution of instruments within each RMT group (No RMT vs RMT), with the actual counts and percentages labeled on each bar. The chi-square test confirms a significant association between instrument type and RMT usage (p <span class="sc">\&lt;</span> 0.001).</span>
<span id="cb419-1144"><a href="#cb419-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1145"><a href="#cb419-1145" aria-hidden="true" tabindex="-1"></a>The Tuba, Euphonium, and Bagpipes have the highest percentages of RMT usage among instruments with at least 10 players.</span>
<span id="cb419-1146"><a href="#cb419-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1147"><a href="#cb419-1147" aria-hidden="true" tabindex="-1"></a>The loop over instrument families now includes a Bonferroni correction to adjust p-values for multiple comparisons. The corrected p-value is calculated by multiplying the raw p-value by the number of pairwise comparisons. The output for each pair is printed with both raw and corrected p-values.</span>
<span id="cb419-1148"><a href="#cb419-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1149"><a href="#cb419-1149" aria-hidden="true" tabindex="-1"></a>These modifications ensure that the chi-square test is valid (by checking the expected counts), and the risk of Type I error in multiple pairwise comparisons is reduced. The overall robustness of the analysis is thereby improved.</span>
<span id="cb419-1150"><a href="#cb419-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1151"><a href="#cb419-1151" aria-hidden="true" tabindex="-1"></a>**Odds Ratio Calculation:**</span>
<span id="cb419-1152"><a href="#cb419-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1153"><a href="#cb419-1153" aria-hidden="true" tabindex="-1"></a>Although the code includes a basic calculation for the odds ratios between instrument families, this step is intended to quantify the strength of the association between each family’s membership and RMT usage. A more sophisticated approach (like logistic regression) might be used for robust odds ratio calculations, but the given code calculates a simplified measure.</span>
<span id="cb419-1154"><a href="#cb419-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1155"><a href="#cb419-1155" aria-hidden="true" tabindex="-1"></a>Calculated from raw counts:</span>
<span id="cb419-1156"><a href="#cb419-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1157"><a href="#cb419-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Brass vs. Woodwinds*: Brass players have approximately 1.71 times higher odds of using RMT compared to woodwind players (21.8% vs 14.0%).</span>
<span id="cb419-1158"><a href="#cb419-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1159"><a href="#cb419-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Brass vs. Others*: Brass players have approximately 1.64 times higher odds of using RMT compared to other instrumentalists (21.8% vs 14.5%).</span>
<span id="cb419-1160"><a href="#cb419-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1161"><a href="#cb419-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Woodwinds vs. Others*: Nearly identical RMT usage rates (14.0% vs 14.5%), confirming the non-significant chi-square result.</span>
<span id="cb419-1162"><a href="#cb419-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1163"><a href="#cb419-1163" aria-hidden="true" tabindex="-1"></a>**Comprehensive Interpretation**</span>
<span id="cb419-1164"><a href="#cb419-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1165"><a href="#cb419-1165" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>*Brass instrumentalists stand out*: Players of brass instruments show significantly higher adoption of RMT methods compared to both woodwind players and other instrumentalists. This difference remains significant even after applying the conservative Bonferroni correction for multiple comparisons.</span>
<span id="cb419-1166"><a href="#cb419-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1167"><a href="#cb419-1167" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>*Woodwinds and Others are similar*: There is no meaningful difference in RMT usage between woodwind players and other instrumentalists, as evidenced by the very low chi-square value (0.01) and high p-value (0.9156).</span>
<span id="cb419-1168"><a href="#cb419-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1169"><a href="#cb419-1169" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>*Potential explanations*: Several factors might explain the higher RMT adoption among brass players:</span>
<span id="cb419-1170"><a href="#cb419-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1171"><a href="#cb419-1171" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Specific physical demands or challenges unique to brass playing</span>
<span id="cb419-1172"><a href="#cb419-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1173"><a href="#cb419-1173" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Different pedagogical traditions or technological integration in brass education</span>
<span id="cb419-1174"><a href="#cb419-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1175"><a href="#cb419-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Demographic differences between instrument families (e.g., age, gender, education level)</span>
<span id="cb419-1176"><a href="#cb419-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1177"><a href="#cb419-1177" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Potential differences in injury patterns or physical concerns across instrument families</span>
<span id="cb419-1178"><a href="#cb419-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1179"><a href="#cb419-1179" aria-hidden="true" tabindex="-1"></a>**Conclusion**</span>
<span id="cb419-1180"><a href="#cb419-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1181"><a href="#cb419-1181" aria-hidden="true" tabindex="-1"></a>Brass instrumentalists demonstrate significantly higher adoption of RMT methods compared to other musician groups. This finding may have implications for how RMT technologies are marketed, designed, or implemented across different instruments. Further research could explore the underlying reasons for this difference, which could inform more targeted approaches to technology integration in music education and performance.</span>
<span id="cb419-1182"><a href="#cb419-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1183"><a href="#cb419-1183" aria-hidden="true" tabindex="-1"></a><span class="fu"># Skill Level</span></span>
<span id="cb419-1184"><a href="#cb419-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1185"><a href="#cb419-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-1186"><a href="#cb419-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1189"><a href="#cb419-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-1190"><a href="#cb419-1190" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-1191"><a href="#cb419-1191" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-1192"><a href="#cb419-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1193"><a href="#cb419-1193" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract playAbility_MAX and remove 0 responses</span></span>
<span id="cb419-1194"><a href="#cb419-1194" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1195"><a href="#cb419-1195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(playAbility_MAX <span class="sc">!=</span> <span class="dv">0</span>, <span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX)) <span class="sc">%&gt;%</span> <span class="co"># Added NA check</span></span>
<span id="cb419-1196"><a href="#cb419-1196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">playAbility_MAX =</span> <span class="fu">as.factor</span>(playAbility_MAX)) <span class="sc">%&gt;%</span></span>
<span id="cb419-1197"><a href="#cb419-1197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(playAbility_MAX) <span class="sc">%&gt;%</span></span>
<span id="cb419-1198"><a href="#cb419-1198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-1199"><a href="#cb419-1199" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>))</span>
<span id="cb419-1200"><a href="#cb419-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1201"><a href="#cb419-1201" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom labels for x-axis</span></span>
<span id="cb419-1202"><a href="#cb419-1202" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Novice"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Beginner"</span>, </span>
<span id="cb419-1203"><a href="#cb419-1203" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Intermediate"</span>, <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Advanced"</span>, </span>
<span id="cb419-1204"><a href="#cb419-1204" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Expert"</span>)</span>
<span id="cb419-1205"><a href="#cb419-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1206"><a href="#cb419-1206" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the actual levels present in the data</span></span>
<span id="cb419-1207"><a href="#cb419-1207" aria-hidden="true" tabindex="-1"></a>actual_levels <span class="ot">&lt;-</span> <span class="fu">levels</span>(plot_data<span class="sc">$</span>playAbility_MAX)</span>
<span id="cb419-1208"><a href="#cb419-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1209"><a href="#cb419-1209" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot</span></span>
<span id="cb419-1210"><a href="#cb419-1210" aria-hidden="true" tabindex="-1"></a>playability_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> playAbility_MAX, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb419-1211"><a href="#cb419-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb419-1212"><a href="#cb419-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-1213"><a href="#cb419-1213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-1214"><a href="#cb419-1214" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Play Ability (Max Score)"</span>,</span>
<span id="cb419-1215"><a href="#cb419-1215" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Play Ability (Novice = 1 to Expert = 5)"</span>,</span>
<span id="cb419-1216"><a href="#cb419-1216" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count of Participants (N = 1558)"</span></span>
<span id="cb419-1217"><a href="#cb419-1217" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1218"><a href="#cb419-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb419-1219"><a href="#cb419-1219" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use actual levels from data rather than hardcoded values</span></span>
<span id="cb419-1220"><a href="#cb419-1220" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> custom_labels[actual_levels]</span>
<span id="cb419-1221"><a href="#cb419-1221" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1222"><a href="#cb419-1222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-1223"><a href="#cb419-1223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-1224"><a href="#cb419-1224" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-1225"><a href="#cb419-1225" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb419-1226"><a href="#cb419-1226" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1227"><a href="#cb419-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-1228"><a href="#cb419-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1229"><a href="#cb419-1229" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the Plot</span></span>
<span id="cb419-1230"><a href="#cb419-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(playability_plot)</span>
<span id="cb419-1231"><a href="#cb419-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-1232"><a href="#cb419-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1235"><a href="#cb419-1235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-1236"><a href="#cb419-1236" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined Categories</span></span>
<span id="cb419-1237"><a href="#cb419-1237" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-1238"><a href="#cb419-1238" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb419-1239"><a href="#cb419-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb419-1240"><a href="#cb419-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1241"><a href="#cb419-1241" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-1242"><a href="#cb419-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1243"><a href="#cb419-1243" aria-hidden="true" tabindex="-1"></a><span class="co"># Process playAbility_MAX with the new category definitions</span></span>
<span id="cb419-1244"><a href="#cb419-1244" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1245"><a href="#cb419-1245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX)) <span class="sc">%&gt;%</span></span>
<span id="cb419-1246"><a href="#cb419-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-1247"><a href="#cb419-1247" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure playAbility_MAX is numeric</span></span>
<span id="cb419-1248"><a href="#cb419-1248" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_MAX =</span> <span class="fu">as.numeric</span>(playAbility_MAX),</span>
<span id="cb419-1249"><a href="#cb419-1249" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-1250"><a href="#cb419-1250" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the new combined categories with half-point values</span></span>
<span id="cb419-1251"><a href="#cb419-1251" aria-hidden="true" tabindex="-1"></a>    <span class="at">skill_level =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-1252"><a href="#cb419-1252" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Novice/Beginner"</span>,</span>
<span id="cb419-1253"><a href="#cb419-1253" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">3.5</span>) <span class="sc">~</span> <span class="st">"Intermediate"</span>,</span>
<span id="cb419-1254"><a href="#cb419-1254" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">4.5</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Advanced/Expert"</span>,</span>
<span id="cb419-1255"><a href="#cb419-1255" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-1256"><a href="#cb419-1256" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb419-1257"><a href="#cb419-1257" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-1258"><a href="#cb419-1258" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Order factor levels</span></span>
<span id="cb419-1259"><a href="#cb419-1259" aria-hidden="true" tabindex="-1"></a>    <span class="at">skill_level =</span> <span class="fu">factor</span>(skill_level, </span>
<span id="cb419-1260"><a href="#cb419-1260" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced/Expert"</span>))</span>
<span id="cb419-1261"><a href="#cb419-1261" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-1262"><a href="#cb419-1262" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove any NA values from our categories</span></span>
<span id="cb419-1263"><a href="#cb419-1263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(skill_level)) <span class="sc">%&gt;%</span></span>
<span id="cb419-1264"><a href="#cb419-1264" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count by skill level</span></span>
<span id="cb419-1265"><a href="#cb419-1265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill_level) <span class="sc">%&gt;%</span></span>
<span id="cb419-1266"><a href="#cb419-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb419-1267"><a href="#cb419-1267" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate percentages</span></span>
<span id="cb419-1268"><a href="#cb419-1268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-1269"><a href="#cb419-1269" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-1270"><a href="#cb419-1270" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> (count <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-1271"><a href="#cb419-1271" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb419-1272"><a href="#cb419-1272" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-1273"><a href="#cb419-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1274"><a href="#cb419-1274" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total valid responses for y-axis label</span></span>
<span id="cb419-1275"><a href="#cb419-1275" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">sum</span>(plot_data<span class="sc">$</span>count)</span>
<span id="cb419-1276"><a href="#cb419-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1277"><a href="#cb419-1277" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb419-1278"><a href="#cb419-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> skill_level, <span class="at">y =</span> count, <span class="at">fill =</span> skill_level)) <span class="sc">+</span></span>
<span id="cb419-1279"><a href="#cb419-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb419-1280"><a href="#cb419-1280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb419-1281"><a href="#cb419-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-1282"><a href="#cb419-1282" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Play Ability (Combined Categories)"</span>,</span>
<span id="cb419-1283"><a href="#cb419-1283" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Play Ability Level"</span>,</span>
<span id="cb419-1284"><a href="#cb419-1284" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Number of Participants (N = "</span>, total_n, <span class="st">")"</span>)</span>
<span id="cb419-1285"><a href="#cb419-1285" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1286"><a href="#cb419-1286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span> <span class="ot">=</span> <span class="st">"#4682B4"</span>, </span>
<span id="cb419-1287"><a href="#cb419-1287" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Intermediate"</span> <span class="ot">=</span> <span class="st">"#6495ED"</span>, </span>
<span id="cb419-1288"><a href="#cb419-1288" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Advanced/Expert"</span> <span class="ot">=</span> <span class="st">"#1E90FF"</span>)) <span class="sc">+</span></span>
<span id="cb419-1289"><a href="#cb419-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-1290"><a href="#cb419-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-1291"><a href="#cb419-1291" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-1292"><a href="#cb419-1292" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-1293"><a href="#cb419-1293" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb419-1294"><a href="#cb419-1294" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb419-1295"><a href="#cb419-1295" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb419-1296"><a href="#cb419-1296" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1297"><a href="#cb419-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-1298"><a href="#cb419-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1299"><a href="#cb419-1299" aria-hidden="true" tabindex="-1"></a><span class="co"># Additionally, print value counts to help diagnose any issues</span></span>
<span id="cb419-1300"><a href="#cb419-1300" aria-hidden="true" tabindex="-1"></a>value_counts <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1301"><a href="#cb419-1301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX)) <span class="sc">%&gt;%</span></span>
<span id="cb419-1302"><a href="#cb419-1302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(playAbility_MAX) <span class="sc">%&gt;%</span></span>
<span id="cb419-1303"><a href="#cb419-1303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(playAbility_MAX)</span>
<span id="cb419-1304"><a href="#cb419-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1305"><a href="#cb419-1305" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Distribution of values in playAbility_MAX:"</span>)</span>
<span id="cb419-1306"><a href="#cb419-1306" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(value_counts)</span>
<span id="cb419-1307"><a href="#cb419-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-1308"><a href="#cb419-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1309"><a href="#cb419-1309" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-1310"><a href="#cb419-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1311"><a href="#cb419-1311" aria-hidden="true" tabindex="-1"></a>Looking at the distribution of self-reported playing ability scores (1 = Novice to 5 = Expert) among the 1,558 participants:</span>
<span id="cb419-1312"><a href="#cb419-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1313"><a href="#cb419-1313" aria-hidden="true" tabindex="-1"></a>• Score 4 is the most common with approximately 500 participants (\~32%), indicating many consider themselves advanced players</span>
<span id="cb419-1314"><a href="#cb419-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1315"><a href="#cb419-1315" aria-hidden="true" tabindex="-1"></a>• Score 3 is the second most frequent with about 450 participants (\~29%), representing intermediate-level players</span>
<span id="cb419-1316"><a href="#cb419-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1317"><a href="#cb419-1317" aria-hidden="true" tabindex="-1"></a>• Score 5 (Expert level) has roughly 350 participants (\~22%)</span>
<span id="cb419-1318"><a href="#cb419-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1319"><a href="#cb419-1319" aria-hidden="true" tabindex="-1"></a>• Score 2 (Beginner-intermediate) has about 200 participants (\~13%)</span>
<span id="cb419-1320"><a href="#cb419-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1321"><a href="#cb419-1321" aria-hidden="true" tabindex="-1"></a>• Score 1 (Novice) is the least common with fewer than 100 participants (\~4%)</span>
<span id="cb419-1322"><a href="#cb419-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1323"><a href="#cb419-1323" aria-hidden="true" tabindex="-1"></a>The distribution is slightly negatively skewed (skewed towards higher scores), with the majority of participants (<span class="sc">\&gt;</span>80%) rating their playing ability as intermediate or higher (scores 3-5). This suggests that the sample consists primarily of experienced wind instrument players, with relatively few beginners. The peak at score 4 indicates that most participants consider themselves advanced, but not expert-level players.</span>
<span id="cb419-1324"><a href="#cb419-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1325"><a href="#cb419-1325" aria-hidden="true" tabindex="-1"></a>The plot shows the distribution of self-reported playing ability (1 = Novice to 5 = Expert) for each wind instrument. Some key observations:</span>
<span id="cb419-1326"><a href="#cb419-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1327"><a href="#cb419-1327" aria-hidden="true" tabindex="-1"></a>• Flute shows the highest number of responses, with a right-skewed distribution (more advanced players)</span>
<span id="cb419-1328"><a href="#cb419-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1329"><a href="#cb419-1329" aria-hidden="true" tabindex="-1"></a>• Most instruments show fewer responses overall compared to flute and clarinet</span>
<span id="cb419-1330"><a href="#cb419-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1331"><a href="#cb419-1331" aria-hidden="true" tabindex="-1"></a>• Bagpipes and euphonium show notably fewer responses</span>
<span id="cb419-1332"><a href="#cb419-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1333"><a href="#cb419-1333" aria-hidden="true" tabindex="-1"></a>• The warning message indicates some missing values were removed, which is expected as not all participants play all instruments</span>
<span id="cb419-1334"><a href="#cb419-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1335"><a href="#cb419-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combined Groups</span></span>
<span id="cb419-1336"><a href="#cb419-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1337"><a href="#cb419-1337" aria-hidden="true" tabindex="-1"></a>*Key Observations:*</span>
<span id="cb419-1338"><a href="#cb419-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1339"><a href="#cb419-1339" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Strong Positive Skew**: The distribution is heavily skewed toward the higher end of the scale, with 71.1% of participants (1,104 out of 1,558) falling in the 4.0-5.0 range.</span>
<span id="cb419-1340"><a href="#cb419-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1341"><a href="#cb419-1341" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Highest Frequencies**:</span>
<span id="cb419-1342"><a href="#cb419-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1343"><a href="#cb419-1343" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Level 4.0: 484 participants (31.1%)</span>
<span id="cb419-1344"><a href="#cb419-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1345"><a href="#cb419-1345" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Level 5.0: 447 participants (28.7%)</span>
<span id="cb419-1346"><a href="#cb419-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1347"><a href="#cb419-1347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Level 3.0: 222 participants (14.2%)</span>
<span id="cb419-1348"><a href="#cb419-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1349"><a href="#cb419-1349" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Lowest Frequencies**:</span>
<span id="cb419-1350"><a href="#cb419-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1351"><a href="#cb419-1351" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Level 0.0: 1 participant (0.1%)</span>
<span id="cb419-1352"><a href="#cb419-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1353"><a href="#cb419-1353" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Level 1.5: 3 participants (0.2%)</span>
<span id="cb419-1354"><a href="#cb419-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1355"><a href="#cb419-1355" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Level 1.0: 6 participants (0.4%)</span>
<span id="cb419-1356"><a href="#cb419-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1357"><a href="#cb419-1357" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Half-Point vs. Whole-Number Ratings**: Half-point ratings (1.5, 2.5, 3.5, 4.5) consistently show lower frequencies than adjacent whole numbers, suggesting raters may prefer whole numbers when assessing ability but use half points for more nuanced judgments.</span>
<span id="cb419-1358"><a href="#cb419-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1359"><a href="#cb419-1359" aria-hidden="true" tabindex="-1"></a>*Combined Category Analysis*</span>
<span id="cb419-1360"><a href="#cb419-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1361"><a href="#cb419-1361" aria-hidden="true" tabindex="-1"></a>When organized into three combined categories:</span>
<span id="cb419-1362"><a href="#cb419-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1363"><a href="#cb419-1363" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Novice/Beginner (1.0, 1.5, 2.0)**: 41 participants (2.6%)</span>
<span id="cb419-1364"><a href="#cb419-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1365"><a href="#cb419-1365" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This group represents a very small portion of the sample, indicating either few beginners participated or the population being studied generally has higher ability levels.</span>
<span id="cb419-1366"><a href="#cb419-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1367"><a href="#cb419-1367" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Intermediate (2.5, 3.0, 3.5)**: 412 participants (26.5%)</span>
<span id="cb419-1368"><a href="#cb419-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1369"><a href="#cb419-1369" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Representing about a quarter of participants with moderate skill levels.</span>
<span id="cb419-1370"><a href="#cb419-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1371"><a href="#cb419-1371" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Advanced/Expert (4.0, 4.5, 5.0)**: 1,104 participants (70.9%)</span>
<span id="cb419-1372"><a href="#cb419-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1373"><a href="#cb419-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Clearly the dominant group, comprising more than two-thirds of the sample.</span>
<span id="cb419-1374"><a href="#cb419-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1375"><a href="#cb419-1375" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Outlier (0.0)**: 1 participant (0.1%)</span>
<span id="cb419-1376"><a href="#cb419-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1377"><a href="#cb419-1377" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This likely represents an error, a special case, or potentially a "non-player" category.</span>
<span id="cb419-1378"><a href="#cb419-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1379"><a href="#cb419-1379" aria-hidden="true" tabindex="-1"></a>**Implications and Considerations**</span>
<span id="cb419-1380"><a href="#cb419-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1381"><a href="#cb419-1381" aria-hidden="true" tabindex="-1"></a>*Potential Explanations for the Skewed Distribution:*</span>
<span id="cb419-1382"><a href="#cb419-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1383"><a href="#cb419-1383" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Population Characteristics**: This may accurately reflect a population primarily consisting of advanced players, such as professional or experienced musicians.</span>
<span id="cb419-1384"><a href="#cb419-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1385"><a href="#cb419-1385" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Self-Selection Bias**: Advanced players might be more likely to participate in studies related to their expertise or complete relevant surveys.</span>
<span id="cb419-1386"><a href="#cb419-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1387"><a href="#cb419-1387" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Self-Assessment Inflation**: If self-reported, participants may tend to overestimate their abilities.</span>
<span id="cb419-1388"><a href="#cb419-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1389"><a href="#cb419-1389" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Scale Calibration**: The assessment scale might not optimally differentiate skill levels in this specific population, potentially causing a ceiling effect where many advanced players cluster at the top.</span>
<span id="cb419-1390"><a href="#cb419-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1391"><a href="#cb419-1391" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Recruitment Strategy**: The participant recruitment process may have targeted more experienced players.</span>
<span id="cb419-1392"><a href="#cb419-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1393"><a href="#cb419-1393" aria-hidden="true" tabindex="-1"></a>**Research and Application Considerations**</span>
<span id="cb419-1394"><a href="#cb419-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1395"><a href="#cb419-1395" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Representativeness**: Consider whether this distribution accurately represents the target population or reflects selection biases.</span>
<span id="cb419-1396"><a href="#cb419-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1397"><a href="#cb419-1397" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Statistical Analysis**: The heavy skew toward higher ratings might influence statistical analyses that assume normal distribution.</span>
<span id="cb419-1398"><a href="#cb419-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1399"><a href="#cb419-1399" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Group Comparisons**: When comparing groups (e.g., by demographics), be aware that the small sample of beginners might limit certain analyses.</span>
<span id="cb419-1400"><a href="#cb419-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1401"><a href="#cb419-1401" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Scale Refinement**: For future studies, consider a more differentiated scale at the upper end to better distinguish between advanced and expert performers.</span>
<span id="cb419-1402"><a href="#cb419-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1403"><a href="#cb419-1403" aria-hidden="true" tabindex="-1"></a>**Conclusion**</span>
<span id="cb419-1404"><a href="#cb419-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1405"><a href="#cb419-1405" aria-hidden="true" tabindex="-1"></a>The data reveals a population predominantly composed of advanced/expert level players, with relatively few beginners. This distribution is important context for any further analyses or conclusions drawn from this dataset, particularly when examining factors associated with play ability or when making generalizations about the broader population of players.</span>
<span id="cb419-1406"><a href="#cb419-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1407"><a href="#cb419-1407" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Stats</span></span>
<span id="cb419-1408"><a href="#cb419-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1411"><a href="#cb419-1411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-1412"><a href="#cb419-1412" aria-hidden="true" tabindex="-1"></a><span class="co"># Original Analysis without Combined Groups</span></span>
<span id="cb419-1413"><a href="#cb419-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1414"><a href="#cb419-1414" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-1415"><a href="#cb419-1415" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-1416"><a href="#cb419-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1417"><a href="#cb419-1417" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preparation: Filter playAbility_MAX and prepare variables</span></span>
<span id="cb419-1418"><a href="#cb419-1418" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1419"><a href="#cb419-1419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-1420"><a href="#cb419-1420" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_MAX =</span> <span class="fu">as.numeric</span>(playAbility_MAX),</span>
<span id="cb419-1421"><a href="#cb419-1421" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(RMTMethods_YN, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>))</span>
<span id="cb419-1422"><a href="#cb419-1422" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-1423"><a href="#cb419-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1424"><a href="#cb419-1424" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out cases where playAbility_MAX is 0 or NA</span></span>
<span id="cb419-1425"><a href="#cb419-1425" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1426"><a href="#cb419-1426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX), playAbility_MAX <span class="sc">!=</span> <span class="dv">0</span>, <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb419-1427"><a href="#cb419-1427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-1428"><a href="#cb419-1428" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create factor version of playAbility with proper labels</span></span>
<span id="cb419-1429"><a href="#cb419-1429" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_factor =</span> <span class="fu">factor</span>(playAbility_MAX, </span>
<span id="cb419-1430"><a href="#cb419-1430" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb419-1431"><a href="#cb419-1431" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Novice"</span>, <span class="st">"Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced"</span>, <span class="st">"Expert"</span>)),</span>
<span id="cb419-1432"><a href="#cb419-1432" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create binary variables for logistic regression</span></span>
<span id="cb419-1433"><a href="#cb419-1433" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_play =</span> <span class="fu">ifelse</span>(playAbility_MAX <span class="sc">&gt;=</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb419-1434"><a href="#cb419-1434" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMT_binary =</span> <span class="fu">ifelse</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb419-1435"><a href="#cb419-1435" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-1436"><a href="#cb419-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1437"><a href="#cb419-1437" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts by playAbility and RMT usage</span></span>
<span id="cb419-1438"><a href="#cb419-1438" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="ot">&lt;-</span> analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb419-1439"><a href="#cb419-1439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN, playAbility_factor) <span class="sc">%&gt;%</span></span>
<span id="cb419-1440"><a href="#cb419-1440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-1441"><a href="#cb419-1441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-1442"><a href="#cb419-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-1443"><a href="#cb419-1443" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb419-1444"><a href="#cb419-1444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb419-1445"><a href="#cb419-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1446"><a href="#cb419-1446" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical Analysis: Chi-square Test of Independence</span></span>
<span id="cb419-1447"><a href="#cb419-1447" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(analysis_data<span class="sc">$</span>playAbility_factor, analysis_data<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-1448"><a href="#cb419-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1449"><a href="#cb419-1449" aria-hidden="true" tabindex="-1"></a><span class="co"># Use simulation-based p-value calculation for chi-square test</span></span>
<span id="cb419-1450"><a href="#cb419-1450" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-1451"><a href="#cb419-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1452"><a href="#cb419-1452" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the statistical results</span></span>
<span id="cb419-1453"><a href="#cb419-1453" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square Test Results (Independence between playAbility and RMT Usage):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1454"><a href="#cb419-1454" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-1455"><a href="#cb419-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1456"><a href="#cb419-1456" aria-hidden="true" tabindex="-1"></a><span class="co"># Check expected frequencies</span></span>
<span id="cb419-1457"><a href="#cb419-1457" aria-hidden="true" tabindex="-1"></a>expected_freqs <span class="ot">&lt;-</span> chi_test<span class="sc">$</span>expected</span>
<span id="cb419-1458"><a href="#cb419-1458" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Expected frequencies:"</span>)</span>
<span id="cb419-1459"><a href="#cb419-1459" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expected_freqs)</span>
<span id="cb419-1460"><a href="#cb419-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1461"><a href="#cb419-1461" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standardized residuals</span></span>
<span id="cb419-1462"><a href="#cb419-1462" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-1463"><a href="#cb419-1463" aria-hidden="true" tabindex="-1"></a>  <span class="at">playAbility =</span> <span class="fu">rep</span>(<span class="fu">rownames</span>(chi_test<span class="sc">$</span>stdres), <span class="at">times =</span> <span class="fu">ncol</span>(chi_test<span class="sc">$</span>stdres)),</span>
<span id="cb419-1464"><a href="#cb419-1464" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMTMethods =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(chi_test<span class="sc">$</span>stdres), <span class="at">each =</span> <span class="fu">nrow</span>(chi_test<span class="sc">$</span>stdres)),</span>
<span id="cb419-1465"><a href="#cb419-1465" aria-hidden="true" tabindex="-1"></a>  <span class="at">std_residual =</span> <span class="fu">as.vector</span>(chi_test<span class="sc">$</span>stdres),</span>
<span id="cb419-1466"><a href="#cb419-1466" aria-hidden="true" tabindex="-1"></a>  <span class="at">rounded_res =</span> <span class="fu">round</span>(<span class="fu">as.vector</span>(chi_test<span class="sc">$</span>stdres), <span class="dv">2</span>)</span>
<span id="cb419-1467"><a href="#cb419-1467" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-1468"><a href="#cb419-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1469"><a href="#cb419-1469" aria-hidden="true" tabindex="-1"></a><span class="co"># Print significant residuals</span></span>
<span id="cb419-1470"><a href="#cb419-1470" aria-hidden="true" tabindex="-1"></a>sig_residuals <span class="ot">&lt;-</span> std_residuals <span class="sc">%&gt;%</span> </span>
<span id="cb419-1471"><a href="#cb419-1471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(std_residual) <span class="sc">&gt;</span> <span class="fl">1.96</span>)</span>
<span id="cb419-1472"><a href="#cb419-1472" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significant Standardized Residuals (&gt;|1.96|):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1473"><a href="#cb419-1473" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sig_residuals)</span>
<span id="cb419-1474"><a href="#cb419-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1475"><a href="#cb419-1475" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effect size: Cramer's V</span></span>
<span id="cb419-1476"><a href="#cb419-1476" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb419-1477"><a href="#cb419-1477" aria-hidden="true" tabindex="-1"></a>df_min <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb419-1478"><a href="#cb419-1478" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n_total <span class="sc">*</span> df_min))</span>
<span id="cb419-1479"><a href="#cb419-1479" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size (Cramer's V):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1480"><a href="#cb419-1480" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramer_v)</span>
<span id="cb419-1481"><a href="#cb419-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1482"><a href="#cb419-1482" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot: Grouped Bar Plot</span></span>
<span id="cb419-1483"><a href="#cb419-1483" aria-hidden="true" tabindex="-1"></a>playability_group_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(grouped_data, <span class="fu">aes</span>(<span class="at">x =</span> playAbility_factor, <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-1484"><a href="#cb419-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb419-1485"><a href="#cb419-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-1486"><a href="#cb419-1486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-1487"><a href="#cb419-1487" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Play Ability by RMT Usage"</span>,</span>
<span id="cb419-1488"><a href="#cb419-1488" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Play Ability Level"</span>,</span>
<span id="cb419-1489"><a href="#cb419-1489" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, <span class="fu">nrow</span>(analysis_data), <span class="st">")"</span>),</span>
<span id="cb419-1490"><a href="#cb419-1490" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"RMT Usage"</span></span>
<span id="cb419-1491"><a href="#cb419-1491" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1492"><a href="#cb419-1492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-1493"><a href="#cb419-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-1494"><a href="#cb419-1494" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-1495"><a href="#cb419-1495" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb419-1496"><a href="#cb419-1496" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1497"><a href="#cb419-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-1498"><a href="#cb419-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1499"><a href="#cb419-1499" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the grouped bar plot</span></span>
<span id="cb419-1500"><a href="#cb419-1500" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(playability_group_plot)</span>
<span id="cb419-1501"><a href="#cb419-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1502"><a href="#cb419-1502" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression Analysis</span></span>
<span id="cb419-1503"><a href="#cb419-1503" aria-hidden="true" tabindex="-1"></a><span class="co"># Run continuous model</span></span>
<span id="cb419-1504"><a href="#cb419-1504" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> playAbility_MAX, </span>
<span id="cb419-1505"><a href="#cb419-1505" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> analysis_data, </span>
<span id="cb419-1506"><a href="#cb419-1506" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb419-1507"><a href="#cb419-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1508"><a href="#cb419-1508" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb419-1509"><a href="#cb419-1509" aria-hidden="true" tabindex="-1"></a>summary_output <span class="ot">&lt;-</span> <span class="fu">summary</span>(logit_model)</span>
<span id="cb419-1510"><a href="#cb419-1510" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_output)</span>
<span id="cb419-1511"><a href="#cb419-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1512"><a href="#cb419-1512" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratios and confidence intervals</span></span>
<span id="cb419-1513"><a href="#cb419-1513" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb419-1514"><a href="#cb419-1514" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(logit_model))</span>
<span id="cb419-1515"><a href="#cb419-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1516"><a href="#cb419-1516" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratios with 95% Confidence Intervals:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1517"><a href="#cb419-1517" aria-hidden="true" tabindex="-1"></a>or_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-1518"><a href="#cb419-1518" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">names</span>(odds_ratios),</span>
<span id="cb419-1519"><a href="#cb419-1519" aria-hidden="true" tabindex="-1"></a>  <span class="at">OddsRatio =</span> <span class="fu">round</span>(odds_ratios, <span class="dv">3</span>),</span>
<span id="cb419-1520"><a href="#cb419-1520" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_lower =</span> <span class="fu">round</span>(conf_intervals[,<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb419-1521"><a href="#cb419-1521" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_upper =</span> <span class="fu">round</span>(conf_intervals[,<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb419-1522"><a href="#cb419-1522" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-1523"><a href="#cb419-1523" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_results)</span>
<span id="cb419-1524"><a href="#cb419-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1525"><a href="#cb419-1525" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted probabilities for each playing ability level</span></span>
<span id="cb419-1526"><a href="#cb419-1526" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">playAbility_MAX =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb419-1527"><a href="#cb419-1527" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb419-1528"><a href="#cb419-1528" aria-hidden="true" tabindex="-1"></a>result_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-1529"><a href="#cb419-1529" aria-hidden="true" tabindex="-1"></a>  <span class="at">playAbility_level =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb419-1530"><a href="#cb419-1530" aria-hidden="true" tabindex="-1"></a>  <span class="at">predicted_probability =</span> predicted_probs</span>
<span id="cb419-1531"><a href="#cb419-1531" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-1532"><a href="#cb419-1532" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted probabilities of RMT usage by playing ability level:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1533"><a href="#cb419-1533" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_df)</span>
<span id="cb419-1534"><a href="#cb419-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1535"><a href="#cb419-1535" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a visualization of predicted probabilities</span></span>
<span id="cb419-1536"><a href="#cb419-1536" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb419-1537"><a href="#cb419-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1538"><a href="#cb419-1538" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predicted probabilities from continuous model</span></span>
<span id="cb419-1539"><a href="#cb419-1539" aria-hidden="true" tabindex="-1"></a>prob_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_df, <span class="fu">aes</span>(<span class="at">x =</span> playAbility_level, <span class="at">y =</span> predicted_probability)) <span class="sc">+</span></span>
<span id="cb419-1540"><a href="#cb419-1540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb419-1541"><a href="#cb419-1541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-1542"><a href="#cb419-1542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb419-1543"><a href="#cb419-1543" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Novice"</span>, <span class="st">"Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced"</span>, <span class="st">"Expert"</span>)) <span class="sc">+</span></span>
<span id="cb419-1544"><a href="#cb419-1544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted Probability of RMT Usage by Playing Ability Level"</span>,</span>
<span id="cb419-1545"><a href="#cb419-1545" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Playing Ability Level"</span>,</span>
<span id="cb419-1546"><a href="#cb419-1546" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability of Using RMT Methods"</span>) <span class="sc">+</span></span>
<span id="cb419-1547"><a href="#cb419-1547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-1548"><a href="#cb419-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-1549"><a href="#cb419-1549" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-1550"><a href="#cb419-1550" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-1551"><a href="#cb419-1551" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb419-1552"><a href="#cb419-1552" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1553"><a href="#cb419-1553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>),</span>
<span id="cb419-1554"><a href="#cb419-1554" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(predicted_probs) <span class="sc">*</span> <span class="fl">1.1</span>))</span>
<span id="cb419-1555"><a href="#cb419-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1556"><a href="#cb419-1556" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the probability plot</span></span>
<span id="cb419-1557"><a href="#cb419-1557" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prob_plot)</span>
<span id="cb419-1558"><a href="#cb419-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1559"><a href="#cb419-1559" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate McFadden's Pseudo R-squared</span></span>
<span id="cb419-1560"><a href="#cb419-1560" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> analysis_data, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb419-1561"><a href="#cb419-1561" aria-hidden="true" tabindex="-1"></a>logLik_full <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(logit_model))</span>
<span id="cb419-1562"><a href="#cb419-1562" aria-hidden="true" tabindex="-1"></a>logLik_null <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(null_model))</span>
<span id="cb419-1563"><a href="#cb419-1563" aria-hidden="true" tabindex="-1"></a>mcfadden_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (logLik_full <span class="sc">/</span> logLik_null)</span>
<span id="cb419-1564"><a href="#cb419-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">McFadden's Pseudo R-squared:"</span>, <span class="fu">round</span>(mcfadden_r2, <span class="dv">4</span>)))</span>
<span id="cb419-1565"><a href="#cb419-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1566"><a href="#cb419-1566" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification metrics with robust handling</span></span>
<span id="cb419-1567"><a href="#cb419-1567" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">fitted</span>(logit_model) <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb419-1568"><a href="#cb419-1568" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> <span class="fu">factor</span>(predicted_classes, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), </span>
<span id="cb419-1569"><a href="#cb419-1569" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Actual =</span> <span class="fu">factor</span>(analysis_data<span class="sc">$</span>RMT_binary, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb419-1570"><a href="#cb419-1570" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Confusion Matrix:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1571"><a href="#cb419-1571" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span>
<span id="cb419-1572"><a href="#cb419-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1573"><a href="#cb419-1573" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics with checks for zero denominators</span></span>
<span id="cb419-1574"><a href="#cb419-1574" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb419-1575"><a href="#cb419-1575" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(confusion_matrix[,<span class="dv">2</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb419-1576"><a href="#cb419-1576" aria-hidden="true" tabindex="-1"></a>                     confusion_matrix[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix[,<span class="dv">2</span>]), </span>
<span id="cb419-1577"><a href="#cb419-1577" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>)</span>
<span id="cb419-1578"><a href="#cb419-1578" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(confusion_matrix[,<span class="dv">1</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb419-1579"><a href="#cb419-1579" aria-hidden="true" tabindex="-1"></a>                     confusion_matrix[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix[,<span class="dv">1</span>]), </span>
<span id="cb419-1580"><a href="#cb419-1580" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>)</span>
<span id="cb419-1581"><a href="#cb419-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1582"><a href="#cb419-1582" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Accuracy:"</span>, <span class="fu">round</span>(accuracy, <span class="dv">3</span>)))</span>
<span id="cb419-1583"><a href="#cb419-1583" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sensitivity (True Positive Rate):"</span>, </span>
<span id="cb419-1584"><a href="#cb419-1584" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">is.na</span>(sensitivity), <span class="st">"Not calculable"</span>, <span class="fu">round</span>(sensitivity, <span class="dv">3</span>))))</span>
<span id="cb419-1585"><a href="#cb419-1585" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Specificity (True Negative Rate):"</span>, </span>
<span id="cb419-1586"><a href="#cb419-1586" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">is.na</span>(specificity), <span class="st">"Not calculable"</span>, <span class="fu">round</span>(specificity, <span class="dv">3</span>))))</span>
<span id="cb419-1587"><a href="#cb419-1587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-1588"><a href="#cb419-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1591"><a href="#cb419-1591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-1592"><a href="#cb419-1592" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined Groups</span></span>
<span id="cb419-1593"><a href="#cb419-1593" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-1594"><a href="#cb419-1594" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-1595"><a href="#cb419-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1596"><a href="#cb419-1596" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preparation: Filter playAbility_MAX and prepare variables</span></span>
<span id="cb419-1597"><a href="#cb419-1597" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1598"><a href="#cb419-1598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-1599"><a href="#cb419-1599" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_MAX =</span> <span class="fu">as.numeric</span>(playAbility_MAX),</span>
<span id="cb419-1600"><a href="#cb419-1600" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(RMTMethods_YN, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>))</span>
<span id="cb419-1601"><a href="#cb419-1601" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-1602"><a href="#cb419-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1603"><a href="#cb419-1603" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out cases where playAbility_MAX is NA</span></span>
<span id="cb419-1604"><a href="#cb419-1604" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1605"><a href="#cb419-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(playAbility_MAX), <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN)) <span class="sc">%&gt;%</span></span>
<span id="cb419-1606"><a href="#cb419-1606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-1607"><a href="#cb419-1607" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create new combined categories - note that 0 is now included in Novice/Beginner</span></span>
<span id="cb419-1608"><a href="#cb419-1608" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_combined =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-1609"><a href="#cb419-1609" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>) <span class="sc">~</span> <span class="st">"Novice/Beginner"</span>,</span>
<span id="cb419-1610"><a href="#cb419-1610" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">3.5</span>) <span class="sc">~</span> <span class="st">"Intermediate"</span>,</span>
<span id="cb419-1611"><a href="#cb419-1611" aria-hidden="true" tabindex="-1"></a>      playAbility_MAX <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">4.5</span>, <span class="dv">5</span>) <span class="sc">~</span> <span class="st">"Advanced/Expert"</span>,</span>
<span id="cb419-1612"><a href="#cb419-1612" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-1613"><a href="#cb419-1613" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb419-1614"><a href="#cb419-1614" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Order the factor levels correctly</span></span>
<span id="cb419-1615"><a href="#cb419-1615" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_combined =</span> <span class="fu">factor</span>(playAbility_combined, </span>
<span id="cb419-1616"><a href="#cb419-1616" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced/Expert"</span>)),</span>
<span id="cb419-1617"><a href="#cb419-1617" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-1618"><a href="#cb419-1618" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create binary variables for logistic regression</span></span>
<span id="cb419-1619"><a href="#cb419-1619" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_play =</span> <span class="fu">ifelse</span>(playAbility_MAX <span class="sc">&gt;=</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb419-1620"><a href="#cb419-1620" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMT_binary =</span> <span class="fu">ifelse</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb419-1621"><a href="#cb419-1621" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-1622"><a href="#cb419-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1623"><a href="#cb419-1623" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts by combined playAbility and RMT usage</span></span>
<span id="cb419-1624"><a href="#cb419-1624" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="ot">&lt;-</span> analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb419-1625"><a href="#cb419-1625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN, playAbility_combined) <span class="sc">%&gt;%</span></span>
<span id="cb419-1626"><a href="#cb419-1626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-1627"><a href="#cb419-1627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-1628"><a href="#cb419-1628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-1629"><a href="#cb419-1629" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb419-1630"><a href="#cb419-1630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb419-1631"><a href="#cb419-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1632"><a href="#cb419-1632" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical Analysis: Chi-square Test of Independence</span></span>
<span id="cb419-1633"><a href="#cb419-1633" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(analysis_data<span class="sc">$</span>playAbility_combined, analysis_data<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-1634"><a href="#cb419-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1635"><a href="#cb419-1635" aria-hidden="true" tabindex="-1"></a><span class="co"># Use simulation-based p-value calculation for chi-square test</span></span>
<span id="cb419-1636"><a href="#cb419-1636" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-1637"><a href="#cb419-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1638"><a href="#cb419-1638" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the statistical results</span></span>
<span id="cb419-1639"><a href="#cb419-1639" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square Test Results (Independence between playAbility and RMT Usage):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1640"><a href="#cb419-1640" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-1641"><a href="#cb419-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1642"><a href="#cb419-1642" aria-hidden="true" tabindex="-1"></a><span class="co"># Check expected frequencies</span></span>
<span id="cb419-1643"><a href="#cb419-1643" aria-hidden="true" tabindex="-1"></a>expected_freqs <span class="ot">&lt;-</span> chi_test<span class="sc">$</span>expected</span>
<span id="cb419-1644"><a href="#cb419-1644" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Expected frequencies:"</span>)</span>
<span id="cb419-1645"><a href="#cb419-1645" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expected_freqs)</span>
<span id="cb419-1646"><a href="#cb419-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1647"><a href="#cb419-1647" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standardized residuals</span></span>
<span id="cb419-1648"><a href="#cb419-1648" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-1649"><a href="#cb419-1649" aria-hidden="true" tabindex="-1"></a>  <span class="at">playAbility =</span> <span class="fu">rep</span>(<span class="fu">rownames</span>(chi_test<span class="sc">$</span>stdres), <span class="at">times =</span> <span class="fu">ncol</span>(chi_test<span class="sc">$</span>stdres)),</span>
<span id="cb419-1650"><a href="#cb419-1650" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMTMethods =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(chi_test<span class="sc">$</span>stdres), <span class="at">each =</span> <span class="fu">nrow</span>(chi_test<span class="sc">$</span>stdres)),</span>
<span id="cb419-1651"><a href="#cb419-1651" aria-hidden="true" tabindex="-1"></a>  <span class="at">std_residual =</span> <span class="fu">as.vector</span>(chi_test<span class="sc">$</span>stdres),</span>
<span id="cb419-1652"><a href="#cb419-1652" aria-hidden="true" tabindex="-1"></a>  <span class="at">rounded_res =</span> <span class="fu">round</span>(<span class="fu">as.vector</span>(chi_test<span class="sc">$</span>stdres), <span class="dv">2</span>)</span>
<span id="cb419-1653"><a href="#cb419-1653" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-1654"><a href="#cb419-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1655"><a href="#cb419-1655" aria-hidden="true" tabindex="-1"></a><span class="co"># Print significant residuals</span></span>
<span id="cb419-1656"><a href="#cb419-1656" aria-hidden="true" tabindex="-1"></a>sig_residuals <span class="ot">&lt;-</span> std_residuals <span class="sc">%&gt;%</span> </span>
<span id="cb419-1657"><a href="#cb419-1657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(std_residual) <span class="sc">&gt;</span> <span class="fl">1.96</span>)</span>
<span id="cb419-1658"><a href="#cb419-1658" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significant Standardized Residuals (&gt;|1.96|):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1659"><a href="#cb419-1659" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sig_residuals)</span>
<span id="cb419-1660"><a href="#cb419-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1661"><a href="#cb419-1661" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effect size: Cramer's V</span></span>
<span id="cb419-1662"><a href="#cb419-1662" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb419-1663"><a href="#cb419-1663" aria-hidden="true" tabindex="-1"></a>df_min <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb419-1664"><a href="#cb419-1664" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n_total <span class="sc">*</span> df_min))</span>
<span id="cb419-1665"><a href="#cb419-1665" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size (Cramer's V):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1666"><a href="#cb419-1666" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramer_v)</span>
<span id="cb419-1667"><a href="#cb419-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1668"><a href="#cb419-1668" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot: Grouped Bar Plot</span></span>
<span id="cb419-1669"><a href="#cb419-1669" aria-hidden="true" tabindex="-1"></a>playability_group_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(grouped_data, <span class="fu">aes</span>(<span class="at">x =</span> playAbility_combined, <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-1670"><a href="#cb419-1670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb419-1671"><a href="#cb419-1671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-1672"><a href="#cb419-1672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-1673"><a href="#cb419-1673" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Play Ability by RMT Usage"</span>,</span>
<span id="cb419-1674"><a href="#cb419-1674" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Using Combined Ability Categories (0 included in Novice/Beginner)"</span>,</span>
<span id="cb419-1675"><a href="#cb419-1675" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Play Ability Level"</span>,</span>
<span id="cb419-1676"><a href="#cb419-1676" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, <span class="fu">nrow</span>(analysis_data), <span class="st">")"</span>),</span>
<span id="cb419-1677"><a href="#cb419-1677" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"RMT Usage"</span></span>
<span id="cb419-1678"><a href="#cb419-1678" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1679"><a href="#cb419-1679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-1680"><a href="#cb419-1680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-1681"><a href="#cb419-1681" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-1682"><a href="#cb419-1682" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb419-1683"><a href="#cb419-1683" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb419-1684"><a href="#cb419-1684" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1685"><a href="#cb419-1685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-1686"><a href="#cb419-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1687"><a href="#cb419-1687" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the grouped bar plot</span></span>
<span id="cb419-1688"><a href="#cb419-1688" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(playability_group_plot)</span>
<span id="cb419-1689"><a href="#cb419-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1690"><a href="#cb419-1690" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression Analysis</span></span>
<span id="cb419-1691"><a href="#cb419-1691" aria-hidden="true" tabindex="-1"></a><span class="co"># First create a numeric version of the combined categories for the continuous model</span></span>
<span id="cb419-1692"><a href="#cb419-1692" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb419-1693"><a href="#cb419-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-1694"><a href="#cb419-1694" aria-hidden="true" tabindex="-1"></a>    <span class="at">playAbility_combined_numeric =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-1695"><a href="#cb419-1695" aria-hidden="true" tabindex="-1"></a>      playAbility_combined <span class="sc">==</span> <span class="st">"Novice/Beginner"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb419-1696"><a href="#cb419-1696" aria-hidden="true" tabindex="-1"></a>      playAbility_combined <span class="sc">==</span> <span class="st">"Intermediate"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb419-1697"><a href="#cb419-1697" aria-hidden="true" tabindex="-1"></a>      playAbility_combined <span class="sc">==</span> <span class="st">"Advanced/Expert"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb419-1698"><a href="#cb419-1698" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb419-1699"><a href="#cb419-1699" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-1700"><a href="#cb419-1700" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-1701"><a href="#cb419-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1702"><a href="#cb419-1702" aria-hidden="true" tabindex="-1"></a><span class="co"># Run continuous model with the combined categories</span></span>
<span id="cb419-1703"><a href="#cb419-1703" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> playAbility_combined_numeric, </span>
<span id="cb419-1704"><a href="#cb419-1704" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> analysis_data, </span>
<span id="cb419-1705"><a href="#cb419-1705" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb419-1706"><a href="#cb419-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1707"><a href="#cb419-1707" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb419-1708"><a href="#cb419-1708" aria-hidden="true" tabindex="-1"></a>summary_output <span class="ot">&lt;-</span> <span class="fu">summary</span>(logit_model)</span>
<span id="cb419-1709"><a href="#cb419-1709" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_output)</span>
<span id="cb419-1710"><a href="#cb419-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1711"><a href="#cb419-1711" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratios and confidence intervals</span></span>
<span id="cb419-1712"><a href="#cb419-1712" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb419-1713"><a href="#cb419-1713" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(logit_model))</span>
<span id="cb419-1714"><a href="#cb419-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1715"><a href="#cb419-1715" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratios with 95% Confidence Intervals:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1716"><a href="#cb419-1716" aria-hidden="true" tabindex="-1"></a>or_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-1717"><a href="#cb419-1717" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">names</span>(odds_ratios),</span>
<span id="cb419-1718"><a href="#cb419-1718" aria-hidden="true" tabindex="-1"></a>  <span class="at">OddsRatio =</span> <span class="fu">round</span>(odds_ratios, <span class="dv">3</span>),</span>
<span id="cb419-1719"><a href="#cb419-1719" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_lower =</span> <span class="fu">round</span>(conf_intervals[,<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb419-1720"><a href="#cb419-1720" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_upper =</span> <span class="fu">round</span>(conf_intervals[,<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb419-1721"><a href="#cb419-1721" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-1722"><a href="#cb419-1722" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_results)</span>
<span id="cb419-1723"><a href="#cb419-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1724"><a href="#cb419-1724" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted probabilities for each combined playing ability level</span></span>
<span id="cb419-1725"><a href="#cb419-1725" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">playAbility_combined_numeric =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb419-1726"><a href="#cb419-1726" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> new_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb419-1727"><a href="#cb419-1727" aria-hidden="true" tabindex="-1"></a>result_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-1728"><a href="#cb419-1728" aria-hidden="true" tabindex="-1"></a>  <span class="at">playAbility_level =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced/Expert"</span>),</span>
<span id="cb419-1729"><a href="#cb419-1729" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_level_value =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb419-1730"><a href="#cb419-1730" aria-hidden="true" tabindex="-1"></a>  <span class="at">predicted_probability =</span> predicted_probs</span>
<span id="cb419-1731"><a href="#cb419-1731" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-1732"><a href="#cb419-1732" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted probabilities of RMT usage by combined playing ability level:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1733"><a href="#cb419-1733" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_df)</span>
<span id="cb419-1734"><a href="#cb419-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1735"><a href="#cb419-1735" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a visualization of predicted probabilities</span></span>
<span id="cb419-1736"><a href="#cb419-1736" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb419-1737"><a href="#cb419-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1738"><a href="#cb419-1738" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predicted probabilities from continuous model</span></span>
<span id="cb419-1739"><a href="#cb419-1739" aria-hidden="true" tabindex="-1"></a>prob_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_df, <span class="fu">aes</span>(<span class="at">x =</span> combined_level_value, <span class="at">y =</span> predicted_probability)) <span class="sc">+</span></span>
<span id="cb419-1740"><a href="#cb419-1740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb419-1741"><a href="#cb419-1741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-1742"><a href="#cb419-1742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb419-1743"><a href="#cb419-1743" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Novice/Beginner"</span>, <span class="st">"Intermediate"</span>, <span class="st">"Advanced/Expert"</span>)) <span class="sc">+</span></span>
<span id="cb419-1744"><a href="#cb419-1744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predicted Probability of RMT Usage by Playing Ability Level"</span>,</span>
<span id="cb419-1745"><a href="#cb419-1745" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Based on Combined Ability Categories (0 included in Novice/Beginner)"</span>,</span>
<span id="cb419-1746"><a href="#cb419-1746" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Playing Ability Level"</span>,</span>
<span id="cb419-1747"><a href="#cb419-1747" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability of Using RMT Methods"</span>) <span class="sc">+</span></span>
<span id="cb419-1748"><a href="#cb419-1748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-1749"><a href="#cb419-1749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-1750"><a href="#cb419-1750" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-1751"><a href="#cb419-1751" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb419-1752"><a href="#cb419-1752" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-1753"><a href="#cb419-1753" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-1754"><a href="#cb419-1754" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb419-1755"><a href="#cb419-1755" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-1756"><a href="#cb419-1756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>),</span>
<span id="cb419-1757"><a href="#cb419-1757" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(predicted_probs) <span class="sc">*</span> <span class="fl">1.1</span>))</span>
<span id="cb419-1758"><a href="#cb419-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1759"><a href="#cb419-1759" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the probability plot</span></span>
<span id="cb419-1760"><a href="#cb419-1760" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prob_plot)</span>
<span id="cb419-1761"><a href="#cb419-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1762"><a href="#cb419-1762" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate McFadden's Pseudo R-squared</span></span>
<span id="cb419-1763"><a href="#cb419-1763" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> analysis_data, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb419-1764"><a href="#cb419-1764" aria-hidden="true" tabindex="-1"></a>logLik_full <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(logit_model))</span>
<span id="cb419-1765"><a href="#cb419-1765" aria-hidden="true" tabindex="-1"></a>logLik_null <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(null_model))</span>
<span id="cb419-1766"><a href="#cb419-1766" aria-hidden="true" tabindex="-1"></a>mcfadden_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (logLik_full <span class="sc">/</span> logLik_null)</span>
<span id="cb419-1767"><a href="#cb419-1767" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">McFadden's Pseudo R-squared:"</span>, <span class="fu">round</span>(mcfadden_r2, <span class="dv">4</span>)))</span>
<span id="cb419-1768"><a href="#cb419-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1769"><a href="#cb419-1769" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification metrics with robust handling</span></span>
<span id="cb419-1770"><a href="#cb419-1770" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">fitted</span>(logit_model) <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb419-1771"><a href="#cb419-1771" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> <span class="fu">factor</span>(predicted_classes, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), </span>
<span id="cb419-1772"><a href="#cb419-1772" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Actual =</span> <span class="fu">factor</span>(analysis_data<span class="sc">$</span>RMT_binary, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb419-1773"><a href="#cb419-1773" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Confusion Matrix:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1774"><a href="#cb419-1774" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span>
<span id="cb419-1775"><a href="#cb419-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1776"><a href="#cb419-1776" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate metrics with checks for zero denominators</span></span>
<span id="cb419-1777"><a href="#cb419-1777" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb419-1778"><a href="#cb419-1778" aria-hidden="true" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(confusion_matrix[,<span class="dv">2</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb419-1779"><a href="#cb419-1779" aria-hidden="true" tabindex="-1"></a>                     confusion_matrix[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix[,<span class="dv">2</span>]), </span>
<span id="cb419-1780"><a href="#cb419-1780" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>)</span>
<span id="cb419-1781"><a href="#cb419-1781" aria-hidden="true" tabindex="-1"></a>specificity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(confusion_matrix[,<span class="dv">1</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb419-1782"><a href="#cb419-1782" aria-hidden="true" tabindex="-1"></a>                     confusion_matrix[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix[,<span class="dv">1</span>]), </span>
<span id="cb419-1783"><a href="#cb419-1783" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>)</span>
<span id="cb419-1784"><a href="#cb419-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1785"><a href="#cb419-1785" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Accuracy:"</span>, <span class="fu">round</span>(accuracy, <span class="dv">3</span>)))</span>
<span id="cb419-1786"><a href="#cb419-1786" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sensitivity (True Positive Rate):"</span>, </span>
<span id="cb419-1787"><a href="#cb419-1787" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">is.na</span>(sensitivity), <span class="st">"Not calculable"</span>, <span class="fu">round</span>(sensitivity, <span class="dv">3</span>))))</span>
<span id="cb419-1788"><a href="#cb419-1788" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Specificity (True Negative Rate):"</span>, </span>
<span id="cb419-1789"><a href="#cb419-1789" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">is.na</span>(specificity), <span class="st">"Not calculable"</span>, <span class="fu">round</span>(specificity, <span class="dv">3</span>))))</span>
<span id="cb419-1790"><a href="#cb419-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1791"><a href="#cb419-1791" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional analysis: Also run categorical model</span></span>
<span id="cb419-1792"><a href="#cb419-1792" aria-hidden="true" tabindex="-1"></a>logit_model_categorical <span class="ot">&lt;-</span> <span class="fu">glm</span>(RMT_binary <span class="sc">~</span> playAbility_combined, </span>
<span id="cb419-1793"><a href="#cb419-1793" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> analysis_data, </span>
<span id="cb419-1794"><a href="#cb419-1794" aria-hidden="true" tabindex="-1"></a>                              <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb419-1795"><a href="#cb419-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1796"><a href="#cb419-1796" aria-hidden="true" tabindex="-1"></a><span class="co"># Print categorical model summary</span></span>
<span id="cb419-1797"><a href="#cb419-1797" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Categorical Model Results (using combined categories as factors):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1798"><a href="#cb419-1798" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(logit_model_categorical))</span>
<span id="cb419-1799"><a href="#cb419-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1800"><a href="#cb419-1800" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratios for categorical model</span></span>
<span id="cb419-1801"><a href="#cb419-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratios for Categorical Model:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1802"><a href="#cb419-1802" aria-hidden="true" tabindex="-1"></a>odds_ratios_cat <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(logit_model_categorical))</span>
<span id="cb419-1803"><a href="#cb419-1803" aria-hidden="true" tabindex="-1"></a>conf_intervals_cat <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(logit_model_categorical))</span>
<span id="cb419-1804"><a href="#cb419-1804" aria-hidden="true" tabindex="-1"></a>or_results_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-1805"><a href="#cb419-1805" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">names</span>(odds_ratios_cat),</span>
<span id="cb419-1806"><a href="#cb419-1806" aria-hidden="true" tabindex="-1"></a>  <span class="at">OddsRatio =</span> <span class="fu">round</span>(odds_ratios_cat, <span class="dv">3</span>),</span>
<span id="cb419-1807"><a href="#cb419-1807" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_lower =</span> <span class="fu">round</span>(conf_intervals_cat[,<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb419-1808"><a href="#cb419-1808" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_upper =</span> <span class="fu">round</span>(conf_intervals_cat[,<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb419-1809"><a href="#cb419-1809" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-1810"><a href="#cb419-1810" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(or_results_cat)</span>
<span id="cb419-1811"><a href="#cb419-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1812"><a href="#cb419-1812" aria-hidden="true" tabindex="-1"></a><span class="co"># Print breakdown of original values in each combined category</span></span>
<span id="cb419-1813"><a href="#cb419-1813" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Breakdown of original playAbility_MAX values in each combined category:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-1814"><a href="#cb419-1814" aria-hidden="true" tabindex="-1"></a>value_counts <span class="ot">&lt;-</span> analysis_data <span class="sc">%&gt;%</span></span>
<span id="cb419-1815"><a href="#cb419-1815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(playAbility_MAX, playAbility_combined) <span class="sc">%&gt;%</span></span>
<span id="cb419-1816"><a href="#cb419-1816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(playAbility_MAX)</span>
<span id="cb419-1817"><a href="#cb419-1817" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(value_counts)</span>
<span id="cb419-1818"><a href="#cb419-1818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-1819"><a href="#cb419-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1820"><a href="#cb419-1820" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion (based on combined findings)</span></span>
<span id="cb419-1821"><a href="#cb419-1821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1822"><a href="#cb419-1822" aria-hidden="true" tabindex="-1"></a>This analysis examines the relationship between musicians' play ability levels (grouped into three categories) and their use of Remote Monitoring Technology (RMT). The results show a statistically significant association between play ability and RMT usage, with specific patterns of usage across different skill levels.</span>
<span id="cb419-1823"><a href="#cb419-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1824"><a href="#cb419-1824" aria-hidden="true" tabindex="-1"></a>**Chi-Square Test of Independence**</span>
<span id="cb419-1825"><a href="#cb419-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1826"><a href="#cb419-1826" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Test Statistic**: X² = 26.337</span>
<span id="cb419-1827"><a href="#cb419-1827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1828"><a href="#cb419-1828" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**P-value**: p <span class="sc">\&lt;</span> 0.0001 (based on 10,000 simulated replicates)</span>
<span id="cb419-1829"><a href="#cb419-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1830"><a href="#cb419-1830" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**: There is very strong evidence of an association between play ability and RMT usage. The null hypothesis that these variables are independent can be confidently rejected.</span>
<span id="cb419-1831"><a href="#cb419-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1832"><a href="#cb419-1832" aria-hidden="true" tabindex="-1"></a>**Effect Size**</span>
<span id="cb419-1833"><a href="#cb419-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1834"><a href="#cb419-1834" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Cramer's V**: 0.13</span>
<span id="cb419-1835"><a href="#cb419-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1836"><a href="#cb419-1836" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**: This represents a small to moderate association between play ability and RMT usage. While statistically significant, the strength of the relationship is not overwhelming.</span>
<span id="cb419-1837"><a href="#cb419-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1838"><a href="#cb419-1838" aria-hidden="true" tabindex="-1"></a>**Standardized Residuals Analysis**</span>
<span id="cb419-1839"><a href="#cb419-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1840"><a href="#cb419-1840" aria-hidden="true" tabindex="-1"></a>The standardized residuals reveal exactly where the significant deviations from independence occur:</span>
<span id="cb419-1841"><a href="#cb419-1841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1842"><a href="#cb419-1842" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Intermediate players and RMT usage**:</span>
<span id="cb419-1843"><a href="#cb419-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1844"><a href="#cb419-1844" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Strong negative residual (-4.92) for "RMT"</span>
<span id="cb419-1845"><a href="#cb419-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1846"><a href="#cb419-1846" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Strong positive residual (4.92) for "No RMT"</span>
<span id="cb419-1847"><a href="#cb419-1847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1848"><a href="#cb419-1848" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This indicates intermediate players are significantly less likely to use RMT than expected</span>
<span id="cb419-1849"><a href="#cb419-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1850"><a href="#cb419-1850" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Advanced/Expert players and RMT usage**:</span>
<span id="cb419-1851"><a href="#cb419-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1852"><a href="#cb419-1852" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Strong positive residual (5.12) for "RMT"</span>
<span id="cb419-1853"><a href="#cb419-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1854"><a href="#cb419-1854" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Strong negative residual (-5.12) for "No RMT"</span>
<span id="cb419-1855"><a href="#cb419-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1856"><a href="#cb419-1856" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This indicates advanced/expert players are significantly more likely to use RMT than expected</span>
<span id="cb419-1857"><a href="#cb419-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1858"><a href="#cb419-1858" aria-hidden="true" tabindex="-1"></a>**Logistic Regression Models**</span>
<span id="cb419-1859"><a href="#cb419-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1860"><a href="#cb419-1860" aria-hidden="true" tabindex="-1"></a>*Continuous Model*</span>
<span id="cb419-1861"><a href="#cb419-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1862"><a href="#cb419-1862" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Coefficient for playAbility_combined_numeric**: 0.8246 (p <span class="sc">\&lt;</span> 0.0001)</span>
<span id="cb419-1863"><a href="#cb419-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1864"><a href="#cb419-1864" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Odds Ratio**: 2.281 (95% CI: 1.632-3.280)</span>
<span id="cb419-1865"><a href="#cb419-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1866"><a href="#cb419-1866" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**: For each step up in the combined ability category (e.g., from Novice/Beginner to Intermediate), the odds of using RMT increase by a factor of 2.28.</span>
<span id="cb419-1867"><a href="#cb419-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1868"><a href="#cb419-1868" aria-hidden="true" tabindex="-1"></a>**Categorical Model**</span>
<span id="cb419-1869"><a href="#cb419-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1870"><a href="#cb419-1870" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Intermediate vs. Novice/Beginner**:</span>
<span id="cb419-1871"><a href="#cb419-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1872"><a href="#cb419-1872" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Odds Ratio: 0.746 (non-significant, p = 0.600)</span>
<span id="cb419-1873"><a href="#cb419-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1874"><a href="#cb419-1874" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Intermediate players have slightly lower odds of using RMT than novice/beginners, but this difference is not statistically significant</span>
<span id="cb419-1875"><a href="#cb419-1875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1876"><a href="#cb419-1876" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Advanced/Expert vs. Novice/Beginner**:</span>
<span id="cb419-1877"><a href="#cb419-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1878"><a href="#cb419-1878" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Odds Ratio: 2.025 (non-significant, p = 0.184)</span>
<span id="cb419-1879"><a href="#cb419-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1880"><a href="#cb419-1880" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Advanced/expert players have approximately double the odds of using RMT compared to novice/beginners, but this difference does not reach statistical significance.</span>
<span id="cb419-1881"><a href="#cb419-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1882"><a href="#cb419-1882" aria-hidden="true" tabindex="-1"></a>**Predicted Probabilities**</span>
<span id="cb419-1883"><a href="#cb419-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1884"><a href="#cb419-1884" aria-hidden="true" tabindex="-1"></a>The model predicts the following probabilities of RMT usage:</span>
<span id="cb419-1885"><a href="#cb419-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1886"><a href="#cb419-1886" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Novice/Beginner: 3.9%</span>
<span id="cb419-1887"><a href="#cb419-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1888"><a href="#cb419-1888" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Intermediate: 8.4%</span>
<span id="cb419-1889"><a href="#cb419-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1890"><a href="#cb419-1890" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Advanced/Expert: 17.4%</span>
<span id="cb419-1891"><a href="#cb419-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1892"><a href="#cb419-1892" aria-hidden="true" tabindex="-1"></a>This shows a clear increasing trend in RMT usage with higher play ability levels, with advanced/expert players having more than four times the probability of using RMT compared to novice/beginners.</span>
<span id="cb419-1893"><a href="#cb419-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1894"><a href="#cb419-1894" aria-hidden="true" tabindex="-1"></a>**Model Performance**</span>
<span id="cb419-1895"><a href="#cb419-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1896"><a href="#cb419-1896" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**McFadden's Pseudo R-squared**: 0.0201</span>
<span id="cb419-1897"><a href="#cb419-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1898"><a href="#cb419-1898" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Accuracy**: 85.4%</span>
<span id="cb419-1899"><a href="#cb419-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1900"><a href="#cb419-1900" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Sensitivity**: 0 (model fails to predict any true RMT users)</span>
<span id="cb419-1901"><a href="#cb419-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1902"><a href="#cb419-1902" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Specificity**: 1 (model correctly identifies all non-RMT users)</span>
<span id="cb419-1903"><a href="#cb419-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1904"><a href="#cb419-1904" aria-hidden="true" tabindex="-1"></a>The model has modest explanatory power and defaults to predicting "No RMT" for all observations, which yields high accuracy due to the imbalanced dataset (far more non-users than users).</span>
<span id="cb419-1905"><a href="#cb419-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1906"><a href="#cb419-1906" aria-hidden="true" tabindex="-1"></a>**Distribution of Participants**</span>
<span id="cb419-1907"><a href="#cb419-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1908"><a href="#cb419-1908" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Novice/Beginner** (values 0, 1, 1.5, 2): 42 participants</span>
<span id="cb419-1909"><a href="#cb419-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1910"><a href="#cb419-1910" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Intermediate** (values 2.5, 3, 3.5): 412 participants</span>
<span id="cb419-1911"><a href="#cb419-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1912"><a href="#cb419-1912" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Advanced/Expert** (values 4, 4.5, 5): 1,104 participants</span>
<span id="cb419-1913"><a href="#cb419-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1914"><a href="#cb419-1914" aria-hidden="true" tabindex="-1"></a>The sample is heavily weighted toward advanced/expert players, with relatively few novice/beginners.</span>
<span id="cb419-1915"><a href="#cb419-1915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1916"><a href="#cb419-1916" aria-hidden="true" tabindex="-1"></a>**Key Insights and Implications**</span>
<span id="cb419-1917"><a href="#cb419-1917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1918"><a href="#cb419-1918" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Skill-Technology Relationship**: There is a significant positive relationship between play ability and RMT usage, with more advanced players more likely to adopt this technology.</span>
<span id="cb419-1919"><a href="#cb419-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1920"><a href="#cb419-1920" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Intermediate Player Resistance**: Intermediate players show a particularly strong pattern of avoiding RMT usage, which could indicate:</span>
<span id="cb419-1921"><a href="#cb419-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1922"><a href="#cb419-1922" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Transitional learning approaches at this skill level</span>
<span id="cb419-1923"><a href="#cb419-1923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1924"><a href="#cb419-1924" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Concerns about technology hindering development of fundamental skills</span>
<span id="cb419-1925"><a href="#cb419-1925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1926"><a href="#cb419-1926" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Different teaching methodologies that don't emphasize technology</span>
<span id="cb419-1927"><a href="#cb419-1927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1928"><a href="#cb419-1928" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Advanced Player Adoption**: Advanced/expert players embrace RMT at higher rates, possibly because:</span>
<span id="cb419-1929"><a href="#cb419-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1930"><a href="#cb419-1930" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>They use technology to refine already-developed skills</span>
<span id="cb419-1931"><a href="#cb419-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1932"><a href="#cb419-1932" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>They have greater technical understanding of their instruments</span>
<span id="cb419-1933"><a href="#cb419-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1934"><a href="#cb419-1934" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>They may be more involved in teaching and use RMT as pedagogical tools</span>
<span id="cb419-1935"><a href="#cb419-1935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1936"><a href="#cb419-1936" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Practical Applications**:</span>
<span id="cb419-1937"><a href="#cb419-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1938"><a href="#cb419-1938" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Technology developers should consider targeting advanced players as early adopters</span>
<span id="cb419-1939"><a href="#cb419-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1940"><a href="#cb419-1940" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Different approaches may be needed to increase RMT adoption among intermediate players</span>
<span id="cb419-1941"><a href="#cb419-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1942"><a href="#cb419-1942" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Educational approaches might need to be tailored by skill level.</span>
<span id="cb419-1943"><a href="#cb419-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1944"><a href="#cb419-1944" aria-hidden="true" tabindex="-1"></a>Despite the statistical significance of the relationship, the modest effect size suggests that play ability is just one of many factors influencing RMT adoption among musicians.</span>
<span id="cb419-1945"><a href="#cb419-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1946"><a href="#cb419-1946" aria-hidden="true" tabindex="-1"></a><span class="fu"># *Country of Residence</span></span>
<span id="cb419-1947"><a href="#cb419-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1948"><a href="#cb419-1948" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-1949"><a href="#cb419-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1952"><a href="#cb419-1952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-1953"><a href="#cb419-1953" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-1954"><a href="#cb419-1954" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-1955"><a href="#cb419-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1956"><a href="#cb419-1956" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total N</span></span>
<span id="cb419-1957"><a href="#cb419-1957" aria-hidden="true" tabindex="-1"></a>total_N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_combined)</span>
<span id="cb419-1958"><a href="#cb419-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1959"><a href="#cb419-1959" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify country names: abbreviate USA and UK</span></span>
<span id="cb419-1960"><a href="#cb419-1960" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1961"><a href="#cb419-1961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">countryLive =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-1962"><a href="#cb419-1962" aria-hidden="true" tabindex="-1"></a>    countryLive <span class="sc">==</span> <span class="st">"United States of America (USA)"</span> <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb419-1963"><a href="#cb419-1963" aria-hidden="true" tabindex="-1"></a>    countryLive <span class="sc">==</span> <span class="st">"United Kingdom (UK)"</span> <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb419-1964"><a href="#cb419-1964" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> countryLive</span>
<span id="cb419-1965"><a href="#cb419-1965" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb419-1966"><a href="#cb419-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1967"><a href="#cb419-1967" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute counts and percentages for the 'countryLive' column</span></span>
<span id="cb419-1968"><a href="#cb419-1968" aria-hidden="true" tabindex="-1"></a>country_summary <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-1969"><a href="#cb419-1969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb419-1970"><a href="#cb419-1970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb419-1971"><a href="#cb419-1971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb419-1972"><a href="#cb419-1972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> total_N <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-1973"><a href="#cb419-1973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb419-1974"><a href="#cb419-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1975"><a href="#cb419-1975" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the top 4 countries (using the highest counts)</span></span>
<span id="cb419-1976"><a href="#cb419-1976" aria-hidden="true" tabindex="-1"></a>top_countries <span class="ot">&lt;-</span> country_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-1977"><a href="#cb419-1977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">4</span>, <span class="at">wt =</span> count) <span class="sc">%&gt;%</span></span>
<span id="cb419-1978"><a href="#cb419-1978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-1979"><a href="#cb419-1979" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>),</span>
<span id="cb419-1980"><a href="#cb419-1980" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reorder to display from highest to lowest</span></span>
<span id="cb419-1981"><a href="#cb419-1981" aria-hidden="true" tabindex="-1"></a>    <span class="at">countryLive =</span> <span class="fu">reorder</span>(countryLive, <span class="sc">-</span>count)</span>
<span id="cb419-1982"><a href="#cb419-1982" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-1983"><a href="#cb419-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1984"><a href="#cb419-1984" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square goodness-of-fit test for top 4 countries</span></span>
<span id="cb419-1985"><a href="#cb419-1985" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected frequencies for equality among the 4 groups</span></span>
<span id="cb419-1986"><a href="#cb419-1986" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> top_countries<span class="sc">$</span>count</span>
<span id="cb419-1987"><a href="#cb419-1987" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">sum</span>(observed)<span class="sc">/</span><span class="fu">length</span>(observed), <span class="fu">length</span>(observed))</span>
<span id="cb419-1988"><a href="#cb419-1988" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> observed, <span class="at">p =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(observed), <span class="fu">length</span>(observed)))</span>
<span id="cb419-1989"><a href="#cb419-1989" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chi-square goodness-of-fit test for equal distribution among top 4 countries:"</span>)</span>
<span id="cb419-1990"><a href="#cb419-1990" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-1991"><a href="#cb419-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-1992"><a href="#cb419-1992" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot with counts and percentages and add the note</span></span>
<span id="cb419-1993"><a href="#cb419-1993" aria-hidden="true" tabindex="-1"></a>country_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(top_countries, <span class="fu">aes</span>(<span class="at">x =</span> countryLive, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb419-1994"><a href="#cb419-1994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-1995"><a href="#cb419-1995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb419-1996"><a href="#cb419-1996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 4 Countries (Live)"</span>,</span>
<span id="cb419-1997"><a href="#cb419-1997" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb419-1998"><a href="#cb419-1998" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, total_N, <span class="st">")"</span>),</span>
<span id="cb419-1999"><a href="#cb419-1999" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Chi-square: "</span>, <span class="fu">sprintf</span>(<span class="st">'%.2f'</span>, chi_test<span class="sc">$</span>statistic), </span>
<span id="cb419-2000"><a href="#cb419-2000" aria-hidden="true" tabindex="-1"></a>                         <span class="st">" (df = "</span>, chi_test<span class="sc">$</span>parameter, </span>
<span id="cb419-2001"><a href="#cb419-2001" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"), p = "</span>, <span class="fu">ifelse</span>(chi_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, <span class="fu">sprintf</span>(<span class="st">'%.3f'</span>, chi_test<span class="sc">$</span>p.value))),</span>
<span id="cb419-2002"><a href="#cb419-2002" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note: Countries with frequencies less than 5% were removed from the figure."</span>) <span class="sc">+</span></span>
<span id="cb419-2003"><a href="#cb419-2003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-2004"><a href="#cb419-2004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-2005"><a href="#cb419-2005" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-2006"><a href="#cb419-2006" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-2007"><a href="#cb419-2007" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2008"><a href="#cb419-2008" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2009"><a href="#cb419-2009" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2010"><a href="#cb419-2010" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">15</span>)),</span>
<span id="cb419-2011"><a href="#cb419-2011" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">30</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>) <span class="co"># Add extra bottom margin for the note</span></span>
<span id="cb419-2012"><a href="#cb419-2012" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-2013"><a href="#cb419-2013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-2014"><a href="#cb419-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2015"><a href="#cb419-2015" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-2016"><a href="#cb419-2016" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(country_plot)</span>
<span id="cb419-2017"><a href="#cb419-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2018"><a href="#cb419-2018" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics</span></span>
<span id="cb419-2019"><a href="#cb419-2019" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Summary Statistics for Top 4 Countries:"</span>)</span>
<span id="cb419-2020"><a href="#cb419-2020" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_countries <span class="sc">%&gt;%</span> <span class="fu">select</span>(countryLive, count, percentage) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(count)))</span>
<span id="cb419-2021"><a href="#cb419-2021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-2022"><a href="#cb419-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2025"><a href="#cb419-2025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-2026"><a href="#cb419-2026" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined 5% values with note</span></span>
<span id="cb419-2027"><a href="#cb419-2027" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-2028"><a href="#cb419-2028" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb419-2029"><a href="#cb419-2029" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb419-2030"><a href="#cb419-2030" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb419-2031"><a href="#cb419-2031" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb419-2032"><a href="#cb419-2032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2033"><a href="#cb419-2033" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-2034"><a href="#cb419-2034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2035"><a href="#cb419-2035" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the countryLive column</span></span>
<span id="cb419-2036"><a href="#cb419-2036" aria-hidden="true" tabindex="-1"></a>country_analysis <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2037"><a href="#cb419-2037" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove missing values</span></span>
<span id="cb419-2038"><a href="#cb419-2038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(countryLive)) <span class="sc">%&gt;%</span></span>
<span id="cb419-2039"><a href="#cb419-2039" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean country names (trim whitespace, standardize case if needed)</span></span>
<span id="cb419-2040"><a href="#cb419-2040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">countryLive =</span> <span class="fu">trimws</span>(countryLive)) <span class="sc">%&gt;%</span></span>
<span id="cb419-2041"><a href="#cb419-2041" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count occurrences of each country</span></span>
<span id="cb419-2042"><a href="#cb419-2042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb419-2043"><a href="#cb419-2043" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate percentages</span></span>
<span id="cb419-2044"><a href="#cb419-2044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-2045"><a href="#cb419-2045" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(n),</span>
<span id="cb419-2046"><a href="#cb419-2046" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> n <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-2047"><a href="#cb419-2047" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create grouped category (countries with &lt;5% go to "Other")</span></span>
<span id="cb419-2048"><a href="#cb419-2048" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_group =</span> <span class="fu">if_else</span>(percentage <span class="sc">&gt;=</span> <span class="dv">5</span>, countryLive, <span class="st">"Other"</span>)</span>
<span id="cb419-2049"><a href="#cb419-2049" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-2050"><a href="#cb419-2050" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sort by frequency</span></span>
<span id="cb419-2051"><a href="#cb419-2051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb419-2052"><a href="#cb419-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2053"><a href="#cb419-2053" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify countries that will be in the "Other" category</span></span>
<span id="cb419-2054"><a href="#cb419-2054" aria-hidden="true" tabindex="-1"></a>other_countries <span class="ot">&lt;-</span> country_analysis <span class="sc">%&gt;%</span></span>
<span id="cb419-2055"><a href="#cb419-2055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country_group <span class="sc">==</span> <span class="st">"Other"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-2056"><a href="#cb419-2056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb419-2057"><a href="#cb419-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2058"><a href="#cb419-2058" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted string listing all "Other" countries WITHOUT percentages</span></span>
<span id="cb419-2059"><a href="#cb419-2059" aria-hidden="true" tabindex="-1"></a>other_countries_list <span class="ot">&lt;-</span> other_countries <span class="sc">%&gt;%</span></span>
<span id="cb419-2060"><a href="#cb419-2060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb419-2061"><a href="#cb419-2061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb419-2062"><a href="#cb419-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2063"><a href="#cb419-2063" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for plotting</span></span>
<span id="cb419-2064"><a href="#cb419-2064" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> country_analysis <span class="sc">%&gt;%</span></span>
<span id="cb419-2065"><a href="#cb419-2065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country_group) <span class="sc">%&gt;%</span></span>
<span id="cb419-2066"><a href="#cb419-2066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-2067"><a href="#cb419-2067" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">sum</span>(n),</span>
<span id="cb419-2068"><a href="#cb419-2068" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> <span class="fu">sum</span>(percentage)</span>
<span id="cb419-2069"><a href="#cb419-2069" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-2070"><a href="#cb419-2070" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure "Other" appears at the end</span></span>
<span id="cb419-2071"><a href="#cb419-2071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-2072"><a href="#cb419-2072" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_group =</span> <span class="fu">factor</span>(country_group),</span>
<span id="cb419-2073"><a href="#cb419-2073" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_group =</span> <span class="fu">fct_relevel</span>(<span class="fu">fct_reorder</span>(country_group, percentage, <span class="at">.desc =</span> <span class="cn">TRUE</span>), <span class="st">"Other"</span>, <span class="at">after =</span> <span class="cn">Inf</span>)</span>
<span id="cb419-2074"><a href="#cb419-2074" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2075"><a href="#cb419-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2076"><a href="#cb419-2076" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total participants</span></span>
<span id="cb419-2077"><a href="#cb419-2077" aria-hidden="true" tabindex="-1"></a>total_participants <span class="ot">&lt;-</span> <span class="fu">sum</span>(country_analysis<span class="sc">$</span>n)</span>
<span id="cb419-2078"><a href="#cb419-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2079"><a href="#cb419-2079" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the base note text</span></span>
<span id="cb419-2080"><a href="#cb419-2080" aria-hidden="true" tabindex="-1"></a>note_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Note: 'Other' includes frequencies &lt;5%: "</span>, other_countries_list)</span>
<span id="cb419-2081"><a href="#cb419-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2082"><a href="#cb419-2082" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually wrap the note text to ensure it's fully visible</span></span>
<span id="cb419-2083"><a href="#cb419-2083" aria-hidden="true" tabindex="-1"></a>wrapped_note <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(note_text, <span class="at">width =</span> <span class="dv">100</span>)</span>
<span id="cb419-2084"><a href="#cb419-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2085"><a href="#cb419-2085" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with adjusted bottom margin and caption styling</span></span>
<span id="cb419-2086"><a href="#cb419-2086" aria-hidden="true" tabindex="-1"></a>country_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> country_group, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb419-2087"><a href="#cb419-2087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb419-2088"><a href="#cb419-2088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-2089"><a href="#cb419-2089" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-2090"><a href="#cb419-2090" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-2091"><a href="#cb419-2091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-2092"><a href="#cb419-2092" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Participants by Country of Residence"</span>,</span>
<span id="cb419-2093"><a href="#cb419-2093" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb419-2094"><a href="#cb419-2094" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Number of Participants (N = "</span>, total_participants, <span class="st">")"</span>),</span>
<span id="cb419-2095"><a href="#cb419-2095" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> wrapped_note</span>
<span id="cb419-2096"><a href="#cb419-2096" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-2097"><a href="#cb419-2097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-2098"><a href="#cb419-2098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-2099"><a href="#cb419-2099" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-2100"><a href="#cb419-2100" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2101"><a href="#cb419-2101" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-2102"><a href="#cb419-2102" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-2103"><a href="#cb419-2103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Style the caption to ensure it's readable</span></span>
<span id="cb419-2104"><a href="#cb419-2104" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(</span>
<span id="cb419-2105"><a href="#cb419-2105" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">9</span>, </span>
<span id="cb419-2106"><a href="#cb419-2106" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb419-2107"><a href="#cb419-2107" aria-hidden="true" tabindex="-1"></a>      <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb419-2108"><a href="#cb419-2108" aria-hidden="true" tabindex="-1"></a>      <span class="at">lineheight =</span> <span class="fl">1.2</span>,</span>
<span id="cb419-2109"><a href="#cb419-2109" aria-hidden="true" tabindex="-1"></a>      <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">15</span>)</span>
<span id="cb419-2110"><a href="#cb419-2110" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb419-2111"><a href="#cb419-2111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add extra bottom margin for the caption</span></span>
<span id="cb419-2112"><a href="#cb419-2112" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">100</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>)</span>
<span id="cb419-2113"><a href="#cb419-2113" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-2114"><a href="#cb419-2114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-2115"><a href="#cb419-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2116"><a href="#cb419-2116" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-2117"><a href="#cb419-2117" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(country_plot)</span>
<span id="cb419-2118"><a href="#cb419-2118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-2119"><a href="#cb419-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2120"><a href="#cb419-2120" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-2121"><a href="#cb419-2121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2122"><a href="#cb419-2122" aria-hidden="true" tabindex="-1"></a>Key observations:</span>
<span id="cb419-2123"><a href="#cb419-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2124"><a href="#cb419-2124" aria-hidden="true" tabindex="-1"></a>• 39 counties in total</span>
<span id="cb419-2125"><a href="#cb419-2125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2126"><a href="#cb419-2126" aria-hidden="true" tabindex="-1"></a>• The United States has the highest representation with 610 participants (39.2%)</span>
<span id="cb419-2127"><a href="#cb419-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2128"><a href="#cb419-2128" aria-hidden="true" tabindex="-1"></a>• The United Kingdom follows with 358 participants (23%)</span>
<span id="cb419-2129"><a href="#cb419-2129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2130"><a href="#cb419-2130" aria-hidden="true" tabindex="-1"></a>• Australia is third with 326 participants (20.9%)</span>
<span id="cb419-2131"><a href="#cb419-2131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2132"><a href="#cb419-2132" aria-hidden="true" tabindex="-1"></a>• These top three countries account for approximately 83% of all participants</span>
<span id="cb419-2133"><a href="#cb419-2133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2134"><a href="#cb419-2134" aria-hidden="true" tabindex="-1"></a>• The remaining countries (Canada, Italy, and New Zealand) collectively represent about 17% of participants</span>
<span id="cb419-2135"><a href="#cb419-2135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2136"><a href="#cb419-2136" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Stats</span></span>
<span id="cb419-2137"><a href="#cb419-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2140"><a href="#cb419-2140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-2141"><a href="#cb419-2141" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-2142"><a href="#cb419-2142" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-2143"><a href="#cb419-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2144"><a href="#cb419-2144" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean country names and create RMT factor</span></span>
<span id="cb419-2145"><a href="#cb419-2145" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2146"><a href="#cb419-2146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-2147"><a href="#cb419-2147" aria-hidden="true" tabindex="-1"></a>    <span class="at">countryLive =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-2148"><a href="#cb419-2148" aria-hidden="true" tabindex="-1"></a>      countryLive <span class="sc">==</span> <span class="st">"United States of America (USA)"</span> <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb419-2149"><a href="#cb419-2149" aria-hidden="true" tabindex="-1"></a>      countryLive <span class="sc">==</span> <span class="st">"United Kingdom (UK)"</span> <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb419-2150"><a href="#cb419-2150" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> countryLive</span>
<span id="cb419-2151"><a href="#cb419-2151" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb419-2152"><a href="#cb419-2152" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(RMTMethods_YN, </span>
<span id="cb419-2153"><a href="#cb419-2153" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb419-2154"><a href="#cb419-2154" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>))</span>
<span id="cb419-2155"><a href="#cb419-2155" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2156"><a href="#cb419-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2157"><a href="#cb419-2157" aria-hidden="true" tabindex="-1"></a><span class="co"># Get top 6 countries</span></span>
<span id="cb419-2158"><a href="#cb419-2158" aria-hidden="true" tabindex="-1"></a>top_6_countries <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2159"><a href="#cb419-2159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb419-2160"><a href="#cb419-2160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">6</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb419-2161"><a href="#cb419-2161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(countryLive)</span>
<span id="cb419-2162"><a href="#cb419-2162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2163"><a href="#cb419-2163" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for top 6 countries</span></span>
<span id="cb419-2164"><a href="#cb419-2164" aria-hidden="true" tabindex="-1"></a>data_for_test <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2165"><a href="#cb419-2165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(countryLive <span class="sc">%in%</span> top_6_countries, <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_YN))</span>
<span id="cb419-2166"><a href="#cb419-2166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2167"><a href="#cb419-2167" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate group totals for each RMT group</span></span>
<span id="cb419-2168"><a href="#cb419-2168" aria-hidden="true" tabindex="-1"></a>rmt_group_totals <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span></span>
<span id="cb419-2169"><a href="#cb419-2169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-2170"><a href="#cb419-2170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">group_N =</span> <span class="fu">n</span>())</span>
<span id="cb419-2171"><a href="#cb419-2171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2172"><a href="#cb419-2172" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics with percentages WITHIN each RMT group (not within country)</span></span>
<span id="cb419-2173"><a href="#cb419-2173" aria-hidden="true" tabindex="-1"></a>country_rmt_stats <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span></span>
<span id="cb419-2174"><a href="#cb419-2174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN, countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb419-2175"><a href="#cb419-2175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-2176"><a href="#cb419-2176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rmt_group_totals, <span class="at">by =</span> <span class="st">"RMTMethods_YN"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-2177"><a href="#cb419-2177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-2178"><a href="#cb419-2178" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> group_N <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-2179"><a href="#cb419-2179" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb419-2180"><a href="#cb419-2180" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-2181"><a href="#cb419-2181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate total per country (for ordering in plot)</span></span>
<span id="cb419-2182"><a href="#cb419-2182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb419-2183"><a href="#cb419-2183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_country =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb419-2184"><a href="#cb419-2184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb419-2185"><a href="#cb419-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2186"><a href="#cb419-2186" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table for statistical test</span></span>
<span id="cb419-2187"><a href="#cb419-2187" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(</span>
<span id="cb419-2188"><a href="#cb419-2188" aria-hidden="true" tabindex="-1"></a>  data_for_test<span class="sc">$</span>countryLive,</span>
<span id="cb419-2189"><a href="#cb419-2189" aria-hidden="true" tabindex="-1"></a>  data_for_test<span class="sc">$</span>RMTMethods_YN</span>
<span id="cb419-2190"><a href="#cb419-2190" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-2191"><a href="#cb419-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2192"><a href="#cb419-2192" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare legend labels with group total N included</span></span>
<span id="cb419-2193"><a href="#cb419-2193" aria-hidden="true" tabindex="-1"></a>legend_labels <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb419-2194"><a href="#cb419-2194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="fu">levels</span>(data_for_test<span class="sc">$</span>RMTMethods_YN), <span class="st">" (N = "</span>, rmt_group_totals<span class="sc">$</span>group_N, <span class="st">")"</span>),</span>
<span id="cb419-2195"><a href="#cb419-2195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>(data_for_test<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-2196"><a href="#cb419-2196" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-2197"><a href="#cb419-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2198"><a href="#cb419-2198" aria-hidden="true" tabindex="-1"></a><span class="co"># Get expected frequencies without running a test yet</span></span>
<span id="cb419-2199"><a href="#cb419-2199" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb419-2200"><a href="#cb419-2200" aria-hidden="true" tabindex="-1"></a>row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(contingency_table)</span>
<span id="cb419-2201"><a href="#cb419-2201" aria-hidden="true" tabindex="-1"></a>col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(contingency_table)</span>
<span id="cb419-2202"><a href="#cb419-2202" aria-hidden="true" tabindex="-1"></a>expected_counts <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums) <span class="sc">/</span> n</span>
<span id="cb419-2203"><a href="#cb419-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2204"><a href="#cb419-2204" aria-hidden="true" tabindex="-1"></a><span class="co"># Use Fisher's exact test to avoid chi-square approximation warnings</span></span>
<span id="cb419-2205"><a href="#cb419-2205" aria-hidden="true" tabindex="-1"></a>fisher_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-2206"><a href="#cb419-2206" aria-hidden="true" tabindex="-1"></a>test_name <span class="ot">&lt;-</span> <span class="st">"Fisher's exact test"</span></span>
<span id="cb419-2207"><a href="#cb419-2207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2208"><a href="#cb419-2208" aria-hidden="true" tabindex="-1"></a><span class="co"># Print test results</span></span>
<span id="cb419-2209"><a href="#cb419-2209" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, test_name, <span class="st">"Results:</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb419-2210"><a href="#cb419-2210" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_test)</span>
<span id="cb419-2211"><a href="#cb419-2211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2212"><a href="#cb419-2212" aria-hidden="true" tabindex="-1"></a><span class="co"># Print expected frequencies</span></span>
<span id="cb419-2213"><a href="#cb419-2213" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Expected frequencies:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2214"><a href="#cb419-2214" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(expected_counts, <span class="dv">2</span>))</span>
<span id="cb419-2215"><a href="#cb419-2215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2216"><a href="#cb419-2216" aria-hidden="true" tabindex="-1"></a><span class="co"># Create grouped bar plot with percentages within RMT groups</span></span>
<span id="cb419-2217"><a href="#cb419-2217" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(country_rmt_stats, </span>
<span id="cb419-2218"><a href="#cb419-2218" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(countryLive, <span class="sc">-</span>total_country), </span>
<span id="cb419-2219"><a href="#cb419-2219" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> count, </span>
<span id="cb419-2220"><a href="#cb419-2220" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-2221"><a href="#cb419-2221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb419-2222"><a href="#cb419-2222" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb419-2223"><a href="#cb419-2223" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-2224"><a href="#cb419-2224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb419-2225"><a href="#cb419-2225" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-2226"><a href="#cb419-2226" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb419-2227"><a href="#cb419-2227" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-2228"><a href="#cb419-2228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"steelblue"</span>),</span>
<span id="cb419-2229"><a href="#cb419-2229" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> legend_labels) <span class="sc">+</span></span>
<span id="cb419-2230"><a href="#cb419-2230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"RMT Usage by Country (Top 6)"</span>,</span>
<span id="cb419-2231"><a href="#cb419-2231" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(test_name, <span class="st">": p "</span>, </span>
<span id="cb419-2232"><a href="#cb419-2232" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(fisher_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">001</span>, </span>
<span id="cb419-2233"><a href="#cb419-2233" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&lt; .001"</span>, </span>
<span id="cb419-2234"><a href="#cb419-2234" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">paste0</span>(<span class="st">"= "</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, fisher_test<span class="sc">$</span>p.value)))),</span>
<span id="cb419-2235"><a href="#cb419-2235" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb419-2236"><a href="#cb419-2236" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count of Participants"</span>,</span>
<span id="cb419-2237"><a href="#cb419-2237" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"RMT Usage"</span>,</span>
<span id="cb419-2238"><a href="#cb419-2238" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Note: Percentages are calculated within each RMT group, not within countries"</span>) <span class="sc">+</span></span>
<span id="cb419-2239"><a href="#cb419-2239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-2240"><a href="#cb419-2240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-2241"><a href="#cb419-2241" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-2242"><a href="#cb419-2242" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2243"><a href="#cb419-2243" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-2244"><a href="#cb419-2244" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2245"><a href="#cb419-2245" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2246"><a href="#cb419-2246" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb419-2247"><a href="#cb419-2247" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb419-2248"><a href="#cb419-2248" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-2249"><a href="#cb419-2249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb419-2250"><a href="#cb419-2250" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb419-2251"><a href="#cb419-2251" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2252"><a href="#cb419-2252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2253"><a href="#cb419-2253" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-2254"><a href="#cb419-2254" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot)</span>
<span id="cb419-2255"><a href="#cb419-2255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2256"><a href="#cb419-2256" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportions of RMT users in each country</span></span>
<span id="cb419-2257"><a href="#cb419-2257" aria-hidden="true" tabindex="-1"></a>country_proportions <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span></span>
<span id="cb419-2258"><a href="#cb419-2258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(countryLive) <span class="sc">%&gt;%</span></span>
<span id="cb419-2259"><a href="#cb419-2259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-2260"><a href="#cb419-2260" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>(),</span>
<span id="cb419-2261"><a href="#cb419-2261" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmt_users =</span> <span class="fu">sum</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>),</span>
<span id="cb419-2262"><a href="#cb419-2262" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmt_proportion =</span> rmt_users<span class="sc">/</span>total,</span>
<span id="cb419-2263"><a href="#cb419-2263" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmt_percentage =</span> rmt_proportion <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb419-2264"><a href="#cb419-2264" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-2265"><a href="#cb419-2265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rmt_proportion))</span>
<span id="cb419-2266"><a href="#cb419-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2267"><a href="#cb419-2267" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RMT Usage Proportions by Country:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2268"><a href="#cb419-2268" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(country_proportions)</span>
<span id="cb419-2269"><a href="#cb419-2269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2270"><a href="#cb419-2270" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise proportion tests with Bonferroni correction</span></span>
<span id="cb419-2271"><a href="#cb419-2271" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">unique</span>(country_proportions<span class="sc">$</span>countryLive)</span>
<span id="cb419-2272"><a href="#cb419-2272" aria-hidden="true" tabindex="-1"></a>n_countries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb419-2273"><a href="#cb419-2273" aria-hidden="true" tabindex="-1"></a>pairwise_tests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb419-2274"><a href="#cb419-2274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2275"><a href="#cb419-2275" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_countries<span class="dv">-1</span>)) {</span>
<span id="cb419-2276"><a href="#cb419-2276" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_countries) {</span>
<span id="cb419-2277"><a href="#cb419-2277" aria-hidden="true" tabindex="-1"></a>    country1 <span class="ot">&lt;-</span> countries[i]</span>
<span id="cb419-2278"><a href="#cb419-2278" aria-hidden="true" tabindex="-1"></a>    country2 <span class="ot">&lt;-</span> countries[j]</span>
<span id="cb419-2279"><a href="#cb419-2279" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2280"><a href="#cb419-2280" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get data for both countries</span></span>
<span id="cb419-2281"><a href="#cb419-2281" aria-hidden="true" tabindex="-1"></a>    data1 <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span> <span class="fu">filter</span>(countryLive <span class="sc">==</span> country1)</span>
<span id="cb419-2282"><a href="#cb419-2282" aria-hidden="true" tabindex="-1"></a>    data2 <span class="ot">&lt;-</span> data_for_test <span class="sc">%&gt;%</span> <span class="fu">filter</span>(countryLive <span class="sc">==</span> country2)</span>
<span id="cb419-2283"><a href="#cb419-2283" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2284"><a href="#cb419-2284" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get counts for proportion test</span></span>
<span id="cb419-2285"><a href="#cb419-2285" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data1<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>)</span>
<span id="cb419-2286"><a href="#cb419-2286" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data2<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> <span class="st">"RMT"</span>)</span>
<span id="cb419-2287"><a href="#cb419-2287" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data1)</span>
<span id="cb419-2288"><a href="#cb419-2288" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data2)</span>
<span id="cb419-2289"><a href="#cb419-2289" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2290"><a href="#cb419-2290" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Skip if zero denominators</span></span>
<span id="cb419-2291"><a href="#cb419-2291" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> n2 <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb419-2292"><a href="#cb419-2292" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb419-2293"><a href="#cb419-2293" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-2294"><a href="#cb419-2294" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2295"><a href="#cb419-2295" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create 2x2 table for test</span></span>
<span id="cb419-2296"><a href="#cb419-2296" aria-hidden="true" tabindex="-1"></a>    test_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1, n1<span class="sc">-</span>x1, x2, n2<span class="sc">-</span>x2), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb419-2297"><a href="#cb419-2297" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2298"><a href="#cb419-2298" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use Fisher's exact test for all pairwise comparisons</span></span>
<span id="cb419-2299"><a href="#cb419-2299" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(test_table)</span>
<span id="cb419-2300"><a href="#cb419-2300" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2301"><a href="#cb419-2301" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb419-2302"><a href="#cb419-2302" aria-hidden="true" tabindex="-1"></a>    pairwise_tests <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_tests, <span class="fu">data.frame</span>(</span>
<span id="cb419-2303"><a href="#cb419-2303" aria-hidden="true" tabindex="-1"></a>      <span class="at">country1 =</span> country1,</span>
<span id="cb419-2304"><a href="#cb419-2304" aria-hidden="true" tabindex="-1"></a>      <span class="at">country2 =</span> country2,</span>
<span id="cb419-2305"><a href="#cb419-2305" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop1 =</span> x1<span class="sc">/</span>n1,</span>
<span id="cb419-2306"><a href="#cb419-2306" aria-hidden="true" tabindex="-1"></a>      <span class="at">prop2 =</span> x2<span class="sc">/</span>n2,</span>
<span id="cb419-2307"><a href="#cb419-2307" aria-hidden="true" tabindex="-1"></a>      <span class="at">diff =</span> <span class="fu">abs</span>(x1<span class="sc">/</span>n1 <span class="sc">-</span> x2<span class="sc">/</span>n2),</span>
<span id="cb419-2308"><a href="#cb419-2308" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb419-2309"><a href="#cb419-2309" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb419-2310"><a href="#cb419-2310" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-2311"><a href="#cb419-2311" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-2312"><a href="#cb419-2312" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2313"><a href="#cb419-2313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2314"><a href="#cb419-2314" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb419-2315"><a href="#cb419-2315" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(pairwise_tests) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb419-2316"><a href="#cb419-2316" aria-hidden="true" tabindex="-1"></a>  pairwise_tests<span class="sc">$</span>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pairwise_tests<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb419-2317"><a href="#cb419-2317" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2318"><a href="#cb419-2318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise Comparisons (Bonferroni-adjusted p-values):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2319"><a href="#cb419-2319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(pairwise_tests <span class="sc">%&gt;%</span> </span>
<span id="cb419-2320"><a href="#cb419-2320" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arrange</span>(p_adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb419-2321"><a href="#cb419-2321" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(</span>
<span id="cb419-2322"><a href="#cb419-2322" aria-hidden="true" tabindex="-1"></a>            <span class="at">prop1 =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, prop1 <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb419-2323"><a href="#cb419-2323" aria-hidden="true" tabindex="-1"></a>            <span class="at">prop2 =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, prop2 <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb419-2324"><a href="#cb419-2324" aria-hidden="true" tabindex="-1"></a>            <span class="at">diff =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, diff <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb419-2325"><a href="#cb419-2325" aria-hidden="true" tabindex="-1"></a>            <span class="at">p_value =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_value),</span>
<span id="cb419-2326"><a href="#cb419-2326" aria-hidden="true" tabindex="-1"></a>            <span class="at">p_adjusted =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_adjusted)</span>
<span id="cb419-2327"><a href="#cb419-2327" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span></span>
<span id="cb419-2328"><a href="#cb419-2328" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(country1, prop1, country2, prop2, diff, p_value, p_adjusted))</span>
<span id="cb419-2329"><a href="#cb419-2329" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb419-2330"><a href="#cb419-2330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">No valid pairwise comparisons could be performed.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2331"><a href="#cb419-2331" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2332"><a href="#cb419-2332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-2333"><a href="#cb419-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2334"><a href="#cb419-2334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-2335"><a href="#cb419-2335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2336"><a href="#cb419-2336" aria-hidden="true" tabindex="-1"></a>Geographical Patterns in Respiratory Muscle Training Adoption Among Wind Musicians</span>
<span id="cb419-2337"><a href="#cb419-2337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2338"><a href="#cb419-2338" aria-hidden="true" tabindex="-1"></a>**Overview of Findings**</span>
<span id="cb419-2339"><a href="#cb419-2339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2340"><a href="#cb419-2340" aria-hidden="true" tabindex="-1"></a>The analysis examines how Respiratory Muscle Training (RMT) device usage varies across different countries among wind instrument musicians. By focusing on the top six countries represented in the sample, this analysis reveals distinctive geographical patterns in RMT adoption that likely reflect broader cultural, educational, and practice-related differences.</span>
<span id="cb419-2341"><a href="#cb419-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2342"><a href="#cb419-2342" aria-hidden="true" tabindex="-1"></a>**Key Statistical Findings**</span>
<span id="cb419-2343"><a href="#cb419-2343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2344"><a href="#cb419-2344" aria-hidden="true" tabindex="-1"></a>The Fisher's exact test confirms a statistically significant association between country of residence and RMT usage (p <span class="sc">\&lt;</span> 0.05). This indicates that the observed geographical variations in RMT adoption are not due to random chance but represent genuine differences across countries. Within each RMT group, the distribution of countries differs notably:</span>
<span id="cb419-2345"><a href="#cb419-2345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2346"><a href="#cb419-2346" aria-hidden="true" tabindex="-1"></a>**Country-Specific RMT Usage Patterns**</span>
<span id="cb419-2347"><a href="#cb419-2347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2348"><a href="#cb419-2348" aria-hidden="true" tabindex="-1"></a>The data shows notable differences in RMT adoption rates across countries:</span>
<span id="cb419-2349"><a href="#cb419-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2350"><a href="#cb419-2350" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**High Adoption Countries**:</span>
<span id="cb419-2351"><a href="#cb419-2351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2352"><a href="#cb419-2352" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Australia: 19.3% (63 out of 326 participants)</span>
<span id="cb419-2353"><a href="#cb419-2353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2354"><a href="#cb419-2354" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>USA: 18.5% (113 out of 610 participants)</span>
<span id="cb419-2355"><a href="#cb419-2355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2356"><a href="#cb419-2356" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Italy: 17.0% (8 out of 47 participants)</span>
<span id="cb419-2357"><a href="#cb419-2357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2358"><a href="#cb419-2358" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Low Adoption Countries**:</span>
<span id="cb419-2359"><a href="#cb419-2359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2360"><a href="#cb419-2360" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Canada: 8.8% (8 out of 91 participants)</span>
<span id="cb419-2361"><a href="#cb419-2361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2362"><a href="#cb419-2362" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>UK: 3.9% (14 out of 358 participants)</span>
<span id="cb419-2363"><a href="#cb419-2363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2364"><a href="#cb419-2364" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>New Zealand: 3.1% (1 out of 32 participants)</span>
<span id="cb419-2365"><a href="#cb419-2365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2366"><a href="#cb419-2366" aria-hidden="true" tabindex="-1"></a>This reveals a striking pattern where participants from the UK and New Zealand are approximately 5-6 times less likely to use RMT compared to those from Australia, USA, or Italy.</span>
<span id="cb419-2367"><a href="#cb419-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2368"><a href="#cb419-2368" aria-hidden="true" tabindex="-1"></a>**Pairwise Comparisons**</span>
<span id="cb419-2369"><a href="#cb419-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2370"><a href="#cb419-2370" aria-hidden="true" tabindex="-1"></a>The Bonferroni-adjusted pairwise comparisons identify which specific country differences are statistically significant:</span>
<span id="cb419-2371"><a href="#cb419-2371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2372"><a href="#cb419-2372" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Significant Differences** (p <span class="sc">\&lt;</span> 0.05 after adjustment):</span>
<span id="cb419-2373"><a href="#cb419-2373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2374"><a href="#cb419-2374" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>USA vs. UK: 14.6 percentage point difference (p = 0.0000)</span>
<span id="cb419-2375"><a href="#cb419-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2376"><a href="#cb419-2376" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Australia vs. UK: 15.4 percentage point difference (p = 0.0000)</span>
<span id="cb419-2377"><a href="#cb419-2377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2378"><a href="#cb419-2378" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Italy vs. UK: 13.1 percentage point difference (p = 0.0249)</span>
<span id="cb419-2379"><a href="#cb419-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2380"><a href="#cb419-2380" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Non-Significant Differences** (p <span class="sc">\&gt;</span> 0.05 after adjustment):</span>
<span id="cb419-2381"><a href="#cb419-2381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2382"><a href="#cb419-2382" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>All other country comparisons, including those between high-adoption countries (Australia, USA, Italy) and between low-adoption countries (Canada, UK, New Zealand)</span>
<span id="cb419-2383"><a href="#cb419-2383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2384"><a href="#cb419-2384" aria-hidden="true" tabindex="-1"></a>The Bonferroni correction, which adjusts for multiple comparisons, confirms that the UK stands out as having significantly lower RMT usage compared to Australia, USA, and Italy.</span>
<span id="cb419-2385"><a href="#cb419-2385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2386"><a href="#cb419-2386" aria-hidden="true" tabindex="-1"></a>**Implications and Potential Explanations**</span>
<span id="cb419-2387"><a href="#cb419-2387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2388"><a href="#cb419-2388" aria-hidden="true" tabindex="-1"></a>Several factors might explain these international differences in RMT adoption:</span>
<span id="cb419-2389"><a href="#cb419-2389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2390"><a href="#cb419-2390" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Educational and Training Approaches**: Different educational systems and training methodologies may emphasize technology integration to varying degrees.</span>
<span id="cb419-2391"><a href="#cb419-2391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2392"><a href="#cb419-2392" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Cultural Attitudes**: Cultural differences in approaches to teaching, learning, and technology adoption may influence RMT usage.</span>
<span id="cb419-2393"><a href="#cb419-2393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2394"><a href="#cb419-2394" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Technological Infrastructure**: Differences in access to technology, internet reliability, and technological support systems might affect adoption rates.</span>
<span id="cb419-2395"><a href="#cb419-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2396"><a href="#cb419-2396" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Market Penetration**: Technology companies might have targeted certain markets more aggressively or entered them earlier.</span>
<span id="cb419-2397"><a href="#cb419-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2398"><a href="#cb419-2398" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Professional Norms**: Music education and performance practices may have different established norms regarding technology usage across these countries.</span>
<span id="cb419-2399"><a href="#cb419-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2400"><a href="#cb419-2400" aria-hidden="true" tabindex="-1"></a>The Anglo countries show an interesting split, with the USA and Australia having high adoption rates while the UK and New Zealand have notably low rates. This suggests that shared language and similar cultural backgrounds do not necessarily lead to similar technology adoption patterns.</span>
<span id="cb419-2401"><a href="#cb419-2401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2402"><a href="#cb419-2402" aria-hidden="true" tabindex="-1"></a>**Limitations**</span>
<span id="cb419-2403"><a href="#cb419-2403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2404"><a href="#cb419-2404" aria-hidden="true" tabindex="-1"></a>While these findings are statistically significant, some considerations are worth noting:</span>
<span id="cb419-2405"><a href="#cb419-2405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2406"><a href="#cb419-2406" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Sample Size Variations**: The number of participants varies considerably across countries (from 32 in New Zealand to 610 in the USA), which affects the precision of the estimates.</span>
<span id="cb419-2407"><a href="#cb419-2407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2408"><a href="#cb419-2408" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Limited Coverage for Italy and New Zealand**: These countries have relatively small sample sizes (47 and 32 respectively), making their estimates less reliable.</span>
<span id="cb419-2409"><a href="#cb419-2409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2410"><a href="#cb419-2410" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Potential Confounding Variables**: Factors like participant age, professional status, or educational background might vary across countries and influence the results.</span>
<span id="cb419-2411"><a href="#cb419-2411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2412"><a href="#cb419-2412" aria-hidden="true" tabindex="-1"></a>**Conclusion**</span>
<span id="cb419-2413"><a href="#cb419-2413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2414"><a href="#cb419-2414" aria-hidden="true" tabindex="-1"></a>The analysis clearly demonstrates that RMT usage varies significantly by country of residence, with particularly strong differences between high-adoption countries (Australia, USA, Italy) and the UK. These findings suggest that geographical and potentially cultural factors play an important role in technology adoption within music education and performance settings. Further research could explore the specific mechanisms behind these differences and their implications for educational policy and technology development.</span>
<span id="cb419-2415"><a href="#cb419-2415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2416"><a href="#cb419-2416" aria-hidden="true" tabindex="-1"></a><span class="fu"># Country of Education</span></span>
<span id="cb419-2417"><a href="#cb419-2417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2418"><a href="#cb419-2418" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-2419"><a href="#cb419-2419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2422"><a href="#cb419-2422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-2423"><a href="#cb419-2423" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-2424"><a href="#cb419-2424" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-2425"><a href="#cb419-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2426"><a href="#cb419-2426" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N</span></span>
<span id="cb419-2427"><a href="#cb419-2427" aria-hidden="true" tabindex="-1"></a>total_N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_combined)</span>
<span id="cb419-2428"><a href="#cb419-2428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2429"><a href="#cb419-2429" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean country names</span></span>
<span id="cb419-2430"><a href="#cb419-2430" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2431"><a href="#cb419-2431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-2432"><a href="#cb419-2432" aria-hidden="true" tabindex="-1"></a>    <span class="at">countryEd =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-2433"><a href="#cb419-2433" aria-hidden="true" tabindex="-1"></a>      countryEd <span class="sc">==</span> <span class="st">"United States of America (USA)"</span> <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb419-2434"><a href="#cb419-2434" aria-hidden="true" tabindex="-1"></a>      countryEd <span class="sc">==</span> <span class="st">"United Kingdom (UK)"</span> <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb419-2435"><a href="#cb419-2435" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(countryEd)</span>
<span id="cb419-2436"><a href="#cb419-2436" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-2437"><a href="#cb419-2437" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2438"><a href="#cb419-2438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2439"><a href="#cb419-2439" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the top 6 countries from countryEd</span></span>
<span id="cb419-2440"><a href="#cb419-2440" aria-hidden="true" tabindex="-1"></a>top_6_countryEd <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2441"><a href="#cb419-2441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(countryEd, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-2442"><a href="#cb419-2442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">6</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb419-2443"><a href="#cb419-2443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(countryEd)</span>
<span id="cb419-2444"><a href="#cb419-2444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2445"><a href="#cb419-2445" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for these top 6 countries</span></span>
<span id="cb419-2446"><a href="#cb419-2446" aria-hidden="true" tabindex="-1"></a>data_top6_edu <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2447"><a href="#cb419-2447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(countryEd <span class="sc">%in%</span> top_6_countryEd)</span>
<span id="cb419-2448"><a href="#cb419-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2449"><a href="#cb419-2449" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics for plotting and analysis</span></span>
<span id="cb419-2450"><a href="#cb419-2450" aria-hidden="true" tabindex="-1"></a>edu_stats <span class="ot">&lt;-</span> data_top6_edu <span class="sc">%&gt;%</span></span>
<span id="cb419-2451"><a href="#cb419-2451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(countryEd) <span class="sc">%&gt;%</span></span>
<span id="cb419-2452"><a href="#cb419-2452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb419-2453"><a href="#cb419-2453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-2454"><a href="#cb419-2454" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-2455"><a href="#cb419-2455" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb419-2456"><a href="#cb419-2456" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2457"><a href="#cb419-2457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2458"><a href="#cb419-2458" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test for equal proportions</span></span>
<span id="cb419-2459"><a href="#cb419-2459" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(edu_stats<span class="sc">$</span>n)</span>
<span id="cb419-2460"><a href="#cb419-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2461"><a href="#cb419-2461" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table for post-hoc analysis</span></span>
<span id="cb419-2462"><a href="#cb419-2462" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(data_top6_edu<span class="sc">$</span>countryEd))</span>
<span id="cb419-2463"><a href="#cb419-2463" aria-hidden="true" tabindex="-1"></a>n_countries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb419-2464"><a href="#cb419-2464" aria-hidden="true" tabindex="-1"></a>pairwise_tests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb419-2465"><a href="#cb419-2465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2466"><a href="#cb419-2466" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairwise proportion tests</span></span>
<span id="cb419-2467"><a href="#cb419-2467" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_countries<span class="dv">-1</span>)) {</span>
<span id="cb419-2468"><a href="#cb419-2468" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_countries) {</span>
<span id="cb419-2469"><a href="#cb419-2469" aria-hidden="true" tabindex="-1"></a>    country1 <span class="ot">&lt;-</span> countries[i]</span>
<span id="cb419-2470"><a href="#cb419-2470" aria-hidden="true" tabindex="-1"></a>    country2 <span class="ot">&lt;-</span> countries[j]</span>
<span id="cb419-2471"><a href="#cb419-2471" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2472"><a href="#cb419-2472" aria-hidden="true" tabindex="-1"></a>    count1 <span class="ot">&lt;-</span> edu_stats<span class="sc">$</span>n[edu_stats<span class="sc">$</span>countryEd <span class="sc">==</span> country1]</span>
<span id="cb419-2473"><a href="#cb419-2473" aria-hidden="true" tabindex="-1"></a>    count2 <span class="ot">&lt;-</span> edu_stats<span class="sc">$</span>n[edu_stats<span class="sc">$</span>countryEd <span class="sc">==</span> country2]</span>
<span id="cb419-2474"><a href="#cb419-2474" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2475"><a href="#cb419-2475" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform proportion test</span></span>
<span id="cb419-2476"><a href="#cb419-2476" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(</span>
<span id="cb419-2477"><a href="#cb419-2477" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">c</span>(count1, count2),</span>
<span id="cb419-2478"><a href="#cb419-2478" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">c</span>(<span class="fu">sum</span>(edu_stats<span class="sc">$</span>n), <span class="fu">sum</span>(edu_stats<span class="sc">$</span>n))</span>
<span id="cb419-2479"><a href="#cb419-2479" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-2480"><a href="#cb419-2480" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2481"><a href="#cb419-2481" aria-hidden="true" tabindex="-1"></a>    pairwise_tests <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_tests, <span class="fu">data.frame</span>(</span>
<span id="cb419-2482"><a href="#cb419-2482" aria-hidden="true" tabindex="-1"></a>      <span class="at">country1 =</span> country1,</span>
<span id="cb419-2483"><a href="#cb419-2483" aria-hidden="true" tabindex="-1"></a>      <span class="at">country2 =</span> country2,</span>
<span id="cb419-2484"><a href="#cb419-2484" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb419-2485"><a href="#cb419-2485" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb419-2486"><a href="#cb419-2486" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-2487"><a href="#cb419-2487" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-2488"><a href="#cb419-2488" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2489"><a href="#cb419-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2490"><a href="#cb419-2490" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Bonferroni correction</span></span>
<span id="cb419-2491"><a href="#cb419-2491" aria-hidden="true" tabindex="-1"></a>pairwise_tests<span class="sc">$</span>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pairwise_tests<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb419-2492"><a href="#cb419-2492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2493"><a href="#cb419-2493" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb419-2494"><a href="#cb419-2494" aria-hidden="true" tabindex="-1"></a>edu_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(edu_stats, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(countryEd, <span class="sc">-</span>n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb419-2495"><a href="#cb419-2495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-2496"><a href="#cb419-2496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb419-2497"><a href="#cb419-2497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 6 Countries of Education"</span>,</span>
<span id="cb419-2498"><a href="#cb419-2498" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"χ²("</span>, chi_test<span class="sc">$</span>parameter, <span class="st">") = "</span>, </span>
<span id="cb419-2499"><a href="#cb419-2499" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, chi_test<span class="sc">$</span>statistic),</span>
<span id="cb419-2500"><a href="#cb419-2500" aria-hidden="true" tabindex="-1"></a>                         <span class="st">", p "</span>, </span>
<span id="cb419-2501"><a href="#cb419-2501" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(chi_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> .<span class="dv">001</span>, </span>
<span id="cb419-2502"><a href="#cb419-2502" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"&lt; .001"</span>, </span>
<span id="cb419-2503"><a href="#cb419-2503" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">paste0</span>(<span class="st">"= "</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, chi_test<span class="sc">$</span>p.value)))),</span>
<span id="cb419-2504"><a href="#cb419-2504" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country of Education"</span>,</span>
<span id="cb419-2505"><a href="#cb419-2505" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, total_N, <span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb419-2506"><a href="#cb419-2506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-2507"><a href="#cb419-2507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-2508"><a href="#cb419-2508" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-2509"><a href="#cb419-2509" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2510"><a href="#cb419-2510" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-2511"><a href="#cb419-2511" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb419-2512"><a href="#cb419-2512" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-2513"><a href="#cb419-2513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-2514"><a href="#cb419-2514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2515"><a href="#cb419-2515" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical results</span></span>
<span id="cb419-2516"><a href="#cb419-2516" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chi-square Test of Equal Proportions Results:"</span>)</span>
<span id="cb419-2517"><a href="#cb419-2517" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-2518"><a href="#cb419-2518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2519"><a href="#cb419-2519" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Descriptive Statistics:"</span>)</span>
<span id="cb419-2520"><a href="#cb419-2520" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(edu_stats)</span>
<span id="cb419-2521"><a href="#cb419-2521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2522"><a href="#cb419-2522" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise Comparisons (Bonferroni-adjusted p-values):"</span>)</span>
<span id="cb419-2523"><a href="#cb419-2523" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_tests <span class="sc">%&gt;%</span> </span>
<span id="cb419-2524"><a href="#cb419-2524" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(p_adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb419-2525"><a href="#cb419-2525" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb419-2526"><a href="#cb419-2526" aria-hidden="true" tabindex="-1"></a>          <span class="at">p_value =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_value),</span>
<span id="cb419-2527"><a href="#cb419-2527" aria-hidden="true" tabindex="-1"></a>          <span class="at">p_adjusted =</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, p_adjusted)</span>
<span id="cb419-2528"><a href="#cb419-2528" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb419-2529"><a href="#cb419-2529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2530"><a href="#cb419-2530" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-2531"><a href="#cb419-2531" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(edu_plot)</span>
<span id="cb419-2532"><a href="#cb419-2532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-2533"><a href="#cb419-2533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2534"><a href="#cb419-2534" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-2535"><a href="#cb419-2535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2536"><a href="#cb419-2536" aria-hidden="true" tabindex="-1"></a>**Distribution of Participants**</span>
<span id="cb419-2537"><a href="#cb419-2537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2538"><a href="#cb419-2538" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**United States of America (USA)**: Largest share with 620 participants (39.8%)</span>
<span id="cb419-2539"><a href="#cb419-2539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2540"><a href="#cb419-2540" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**United Kingdom (UK)**: Second largest with 364 participants (23.4%)</span>
<span id="cb419-2541"><a href="#cb419-2541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2542"><a href="#cb419-2542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Australia**: Third with 321 participants (20.6%)</span>
<span id="cb419-2543"><a href="#cb419-2543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2544"><a href="#cb419-2544" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Canada**: 92 participants (5.9%)</span>
<span id="cb419-2545"><a href="#cb419-2545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2546"><a href="#cb419-2546" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Italy**: 44 participants (2.8%)</span>
<span id="cb419-2547"><a href="#cb419-2547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2548"><a href="#cb419-2548" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**New Zealand**: 27 participants (1.7%)</span>
<span id="cb419-2549"><a href="#cb419-2549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2550"><a href="#cb419-2550" aria-hidden="true" tabindex="-1"></a>**Key Observations**:</span>
<span id="cb419-2551"><a href="#cb419-2551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2552"><a href="#cb419-2552" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The top three countries (USA, UK, and Australia) account for 83.8% of all participants' educational background</span>
<span id="cb419-2553"><a href="#cb419-2553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2554"><a href="#cb419-2554" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>English-speaking countries dominate the top positions, representing 91.4% of the top 6 response</span>
<span id="cb419-2555"><a href="#cb419-2555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2556"><a href="#cb419-2556" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There's a significant drop between the top 3 and the remaining countries</span>
<span id="cb419-2557"><a href="#cb419-2557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2558"><a href="#cb419-2558" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The distribution pattern is very similar to the current country of residence data, suggesting most participants stayed in their country of education</span>
<span id="cb419-2559"><a href="#cb419-2559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2560"><a href="#cb419-2560" aria-hidden="true" tabindex="-1"></a>**Comparison to Current Residence**:</span>
<span id="cb419-2561"><a href="#cb419-2561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2562"><a href="#cb419-2562" aria-hidden="true" tabindex="-1"></a>USA: Education (620) vs Residence (610) UK: Education (364) vs Residence (358) Australia: Education (321) vs Residence (326) Canada: Education (92) vs Residence (91) Italy: Education (44) vs Residence (47) New Zealand: Education (27) vs Residence (32)</span>
<span id="cb419-2563"><a href="#cb419-2563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2564"><a href="#cb419-2564" aria-hidden="true" tabindex="-1"></a>This shows relatively small differences between where participants were educated and where they currently live, indicating low international mobility after education.</span>
<span id="cb419-2565"><a href="#cb419-2565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2566"><a href="#cb419-2566" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Stats</span></span>
<span id="cb419-2567"><a href="#cb419-2567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2568"><a href="#cb419-2568" aria-hidden="true" tabindex="-1"></a>Still getting a Chi-Squared Warning, but added Fisher's</span>
<span id="cb419-2569"><a href="#cb419-2569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2572"><a href="#cb419-2572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-2573"><a href="#cb419-2573" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb419-2574"><a href="#cb419-2574" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb419-2575"><a href="#cb419-2575" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb419-2576"><a href="#cb419-2576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2577"><a href="#cb419-2577" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Data Preparation Function</span></span>
<span id="cb419-2578"><a href="#cb419-2578" aria-hidden="true" tabindex="-1"></a>prepare_rmt_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path, <span class="at">sheet =</span> <span class="st">"Combined"</span>) {</span>
<span id="cb419-2579"><a href="#cb419-2579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb419-2580"><a href="#cb419-2580" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read data with standardized cleaning</span></span>
<span id="cb419-2581"><a href="#cb419-2581" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> sheet)</span>
<span id="cb419-2582"><a href="#cb419-2582" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2583"><a href="#cb419-2583" aria-hidden="true" tabindex="-1"></a>    data_cleaned <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2584"><a href="#cb419-2584" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb419-2585"><a href="#cb419-2585" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Comprehensive country name standardization</span></span>
<span id="cb419-2586"><a href="#cb419-2586" aria-hidden="true" tabindex="-1"></a>        <span class="at">countryEd =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-2587"><a href="#cb419-2587" aria-hidden="true" tabindex="-1"></a>          <span class="fu">grepl</span>(<span class="st">"United States|USA"</span>, countryEd, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb419-2588"><a href="#cb419-2588" aria-hidden="true" tabindex="-1"></a>          <span class="fu">grepl</span>(<span class="st">"United Kingdom|UK"</span>, countryEd, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb419-2589"><a href="#cb419-2589" aria-hidden="true" tabindex="-1"></a>          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(countryEd)</span>
<span id="cb419-2590"><a href="#cb419-2590" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb419-2591"><a href="#cb419-2591" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Robust RMT factor conversion</span></span>
<span id="cb419-2592"><a href="#cb419-2592" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(</span>
<span id="cb419-2593"><a href="#cb419-2593" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">RMTMethods_YN</span><span class="st">`</span>, </span>
<span id="cb419-2594"><a href="#cb419-2594" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb419-2595"><a href="#cb419-2595" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>)</span>
<span id="cb419-2596"><a href="#cb419-2596" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb419-2597"><a href="#cb419-2597" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb419-2598"><a href="#cb419-2598" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2599"><a href="#cb419-2599" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(data_cleaned)</span>
<span id="cb419-2600"><a href="#cb419-2600" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb419-2601"><a href="#cb419-2601" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error in data preparation:"</span>, e<span class="sc">$</span>message))</span>
<span id="cb419-2602"><a href="#cb419-2602" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb419-2603"><a href="#cb419-2603" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2604"><a href="#cb419-2604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2605"><a href="#cb419-2605" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced Statistical Analysis Function</span></span>
<span id="cb419-2606"><a href="#cb419-2606" aria-hidden="true" tabindex="-1"></a>perform_comprehensive_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb419-2607"><a href="#cb419-2607" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify Top 6 Countries</span></span>
<span id="cb419-2608"><a href="#cb419-2608" aria-hidden="true" tabindex="-1"></a>  top_6_countryEd <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-2609"><a href="#cb419-2609" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(countryEd, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-2610"><a href="#cb419-2610" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">6</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb419-2611"><a href="#cb419-2611" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(countryEd)</span>
<span id="cb419-2612"><a href="#cb419-2612" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2613"><a href="#cb419-2613" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data to top 6 countries</span></span>
<span id="cb419-2614"><a href="#cb419-2614" aria-hidden="true" tabindex="-1"></a>  data_top6_edu <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-2615"><a href="#cb419-2615" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(countryEd <span class="sc">%in%</span> top_6_countryEd)</span>
<span id="cb419-2616"><a href="#cb419-2616" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2617"><a href="#cb419-2617" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create contingency table</span></span>
<span id="cb419-2618"><a href="#cb419-2618" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_top6_edu<span class="sc">$</span>countryEd, data_top6_edu<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-2619"><a href="#cb419-2619" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2620"><a href="#cb419-2620" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Comprehensive test selection and reporting</span></span>
<span id="cb419-2621"><a href="#cb419-2621" aria-hidden="true" tabindex="-1"></a>  analyze_test_assumptions <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb419-2622"><a href="#cb419-2622" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate expected frequencies</span></span>
<span id="cb419-2623"><a href="#cb419-2623" aria-hidden="true" tabindex="-1"></a>    chi_results <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(cont_table))</span>
<span id="cb419-2624"><a href="#cb419-2624" aria-hidden="true" tabindex="-1"></a>    expected_freq <span class="ot">&lt;-</span> chi_results<span class="sc">$</span>expected</span>
<span id="cb419-2625"><a href="#cb419-2625" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2626"><a href="#cb419-2626" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Detailed frequency checks</span></span>
<span id="cb419-2627"><a href="#cb419-2627" aria-hidden="true" tabindex="-1"></a>    total_cells <span class="ot">&lt;-</span> <span class="fu">length</span>(expected_freq)</span>
<span id="cb419-2628"><a href="#cb419-2628" aria-hidden="true" tabindex="-1"></a>    low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb419-2629"><a href="#cb419-2629" aria-hidden="true" tabindex="-1"></a>    min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb419-2630"><a href="#cb419-2630" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2631"><a href="#cb419-2631" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verbose reporting of frequency conditions</span></span>
<span id="cb419-2632"><a href="#cb419-2632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2633"><a href="#cb419-2633" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2634"><a href="#cb419-2634" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb419-2635"><a href="#cb419-2635" aria-hidden="true" tabindex="-1"></a>        <span class="st">"out of"</span>, total_cells, <span class="st">"cells ("</span>, </span>
<span id="cb419-2636"><a href="#cb419-2636" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> total_cells <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb419-2637"><a href="#cb419-2637" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2638"><a href="#cb419-2638" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine most appropriate test</span></span>
<span id="cb419-2639"><a href="#cb419-2639" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> total_cells) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb419-2640"><a href="#cb419-2640" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use Fisher's exact test with Monte Carlo simulation</span></span>
<span id="cb419-2641"><a href="#cb419-2641" aria-hidden="true" tabindex="-1"></a>      exact_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(cont_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-2642"><a href="#cb419-2642" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-2643"><a href="#cb419-2643" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-2644"><a href="#cb419-2644" aria-hidden="true" tabindex="-1"></a>        <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test (Monte Carlo)"</span>,</span>
<span id="cb419-2645"><a href="#cb419-2645" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> exact_test<span class="sc">$</span>p.value,</span>
<span id="cb419-2646"><a href="#cb419-2646" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> <span class="cn">NA</span>,</span>
<span id="cb419-2647"><a href="#cb419-2647" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb419-2648"><a href="#cb419-2648" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb419-2649"><a href="#cb419-2649" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb419-2650"><a href="#cb419-2650" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb419-2651"><a href="#cb419-2651" aria-hidden="true" tabindex="-1"></a>      adjusted_chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb419-2652"><a href="#cb419-2652" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-2653"><a href="#cb419-2653" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-2654"><a href="#cb419-2654" aria-hidden="true" tabindex="-1"></a>        <span class="at">test_type =</span> <span class="st">"Chi-Square with Continuity Correction"</span>,</span>
<span id="cb419-2655"><a href="#cb419-2655" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> adjusted_chi_test<span class="sc">$</span>p.value,</span>
<span id="cb419-2656"><a href="#cb419-2656" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> adjusted_chi_test<span class="sc">$</span>statistic,</span>
<span id="cb419-2657"><a href="#cb419-2657" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameter =</span> adjusted_chi_test<span class="sc">$</span>parameter,</span>
<span id="cb419-2658"><a href="#cb419-2658" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="fu">paste</span>(<span class="st">"Pearson's Chi-squared test with Yates' continuity correction,"</span>,</span>
<span id="cb419-2659"><a href="#cb419-2659" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"df ="</span>, adjusted_chi_test<span class="sc">$</span>parameter)</span>
<span id="cb419-2660"><a href="#cb419-2660" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb419-2661"><a href="#cb419-2661" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-2662"><a href="#cb419-2662" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-2663"><a href="#cb419-2663" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2664"><a href="#cb419-2664" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform test</span></span>
<span id="cb419-2665"><a href="#cb419-2665" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">analyze_test_assumptions</span>(contingency_table)</span>
<span id="cb419-2666"><a href="#cb419-2666" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2667"><a href="#cb419-2667" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pairwise comparisons with Fisher's exact test</span></span>
<span id="cb419-2668"><a href="#cb419-2668" aria-hidden="true" tabindex="-1"></a>  pairwise_comparisons <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb419-2669"><a href="#cb419-2669" aria-hidden="true" tabindex="-1"></a>    countries <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cont_table)</span>
<span id="cb419-2670"><a href="#cb419-2670" aria-hidden="true" tabindex="-1"></a>    n_countries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb419-2671"><a href="#cb419-2671" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-2672"><a href="#cb419-2672" aria-hidden="true" tabindex="-1"></a>      <span class="at">comparison =</span> <span class="fu">character</span>(),</span>
<span id="cb419-2673"><a href="#cb419-2673" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-2674"><a href="#cb419-2674" aria-hidden="true" tabindex="-1"></a>      <span class="at">adj_p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-2675"><a href="#cb419-2675" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb419-2676"><a href="#cb419-2676" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-2677"><a href="#cb419-2677" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2678"><a href="#cb419-2678" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_countries<span class="dv">-1</span>)) {</span>
<span id="cb419-2679"><a href="#cb419-2679" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_countries) {</span>
<span id="cb419-2680"><a href="#cb419-2680" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use Fisher's exact test for all pairwise comparisons</span></span>
<span id="cb419-2681"><a href="#cb419-2681" aria-hidden="true" tabindex="-1"></a>        test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(cont_table[<span class="fu">c</span>(i,j),])</span>
<span id="cb419-2682"><a href="#cb419-2682" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb419-2683"><a href="#cb419-2683" aria-hidden="true" tabindex="-1"></a>          <span class="at">comparison =</span> <span class="fu">paste</span>(countries[i], <span class="st">"vs"</span>, countries[j]),</span>
<span id="cb419-2684"><a href="#cb419-2684" aria-hidden="true" tabindex="-1"></a>          <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb419-2685"><a href="#cb419-2685" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj_p_value =</span> <span class="cn">NA</span></span>
<span id="cb419-2686"><a href="#cb419-2686" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb419-2687"><a href="#cb419-2687" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb419-2688"><a href="#cb419-2688" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-2689"><a href="#cb419-2689" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2690"><a href="#cb419-2690" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bonferroni correction</span></span>
<span id="cb419-2691"><a href="#cb419-2691" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>adj_p_value <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(results<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb419-2692"><a href="#cb419-2692" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(results)</span>
<span id="cb419-2693"><a href="#cb419-2693" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-2694"><a href="#cb419-2694" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2695"><a href="#cb419-2695" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute pairwise comparisons</span></span>
<span id="cb419-2696"><a href="#cb419-2696" aria-hidden="true" tabindex="-1"></a>  pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise_comparisons</span>(contingency_table)</span>
<span id="cb419-2697"><a href="#cb419-2697" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2698"><a href="#cb419-2698" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return comprehensive results</span></span>
<span id="cb419-2699"><a href="#cb419-2699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb419-2700"><a href="#cb419-2700" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_results =</span> test_results,</span>
<span id="cb419-2701"><a href="#cb419-2701" aria-hidden="true" tabindex="-1"></a>    <span class="at">pairwise_results =</span> pairwise_results,</span>
<span id="cb419-2702"><a href="#cb419-2702" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_top6_edu =</span> data_top6_edu,</span>
<span id="cb419-2703"><a href="#cb419-2703" aria-hidden="true" tabindex="-1"></a>    <span class="at">contingency_table =</span> contingency_table</span>
<span id="cb419-2704"><a href="#cb419-2704" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2705"><a href="#cb419-2705" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2706"><a href="#cb419-2706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2707"><a href="#cb419-2707" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization Function</span></span>
<span id="cb419-2708"><a href="#cb419-2708" aria-hidden="true" tabindex="-1"></a>create_rmt_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(analysis_results) {</span>
<span id="cb419-2709"><a href="#cb419-2709" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare plot data</span></span>
<span id="cb419-2710"><a href="#cb419-2710" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>data_top6_edu <span class="sc">%&gt;%</span></span>
<span id="cb419-2711"><a href="#cb419-2711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(countryEd, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-2712"><a href="#cb419-2712" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-2713"><a href="#cb419-2713" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(countryEd) <span class="sc">%&gt;%</span></span>
<span id="cb419-2714"><a href="#cb419-2714" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb419-2715"><a href="#cb419-2715" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_country =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-2716"><a href="#cb419-2716" aria-hidden="true" tabindex="-1"></a>      <span class="at">percentage =</span> count <span class="sc">/</span> total_country <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-2717"><a href="#cb419-2717" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb419-2718"><a href="#cb419-2718" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb419-2719"><a href="#cb419-2719" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb419-2720"><a href="#cb419-2720" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2721"><a href="#cb419-2721" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute totals for legend</span></span>
<span id="cb419-2722"><a href="#cb419-2722" aria-hidden="true" tabindex="-1"></a>  legend_totals <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>data_top6_edu <span class="sc">%&gt;%</span></span>
<span id="cb419-2723"><a href="#cb419-2723" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-2724"><a href="#cb419-2724" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb419-2725"><a href="#cb419-2725" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2726"><a href="#cb419-2726" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create legend labels</span></span>
<span id="cb419-2727"><a href="#cb419-2727" aria-hidden="true" tabindex="-1"></a>  legend_labels <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb419-2728"><a href="#cb419-2728" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(legend_totals<span class="sc">$</span>RMTMethods_YN, <span class="st">" (N = "</span>, legend_totals<span class="sc">$</span>total, <span class="st">")"</span>),</span>
<span id="cb419-2729"><a href="#cb419-2729" aria-hidden="true" tabindex="-1"></a>    legend_totals<span class="sc">$</span>RMTMethods_YN</span>
<span id="cb419-2730"><a href="#cb419-2730" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2731"><a href="#cb419-2731" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2732"><a href="#cb419-2732" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare subtitle based on test type</span></span>
<span id="cb419-2733"><a href="#cb419-2733" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>test_results</span>
<span id="cb419-2734"><a href="#cb419-2734" aria-hidden="true" tabindex="-1"></a>  subtitle_text <span class="ot">&lt;-</span> <span class="cf">if</span> (test_results<span class="sc">$</span>test_type <span class="sc">==</span> <span class="st">"Chi-Square with Continuity Correction"</span>) {</span>
<span id="cb419-2735"><a href="#cb419-2735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Chi-square test: "</span>, </span>
<span id="cb419-2736"><a href="#cb419-2736" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sprintf</span>(<span class="st">"χ²(%d) = %.2f"</span>, test_results<span class="sc">$</span>parameter, test_results<span class="sc">$</span>statistic),</span>
<span id="cb419-2737"><a href="#cb419-2737" aria-hidden="true" tabindex="-1"></a>           <span class="st">", p "</span>, <span class="fu">ifelse</span>(test_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, </span>
<span id="cb419-2738"><a href="#cb419-2738" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">paste</span>(<span class="st">"="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, test_results<span class="sc">$</span>p_value))))</span>
<span id="cb419-2739"><a href="#cb419-2739" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb419-2740"><a href="#cb419-2740" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Fisher's Exact Test (Monte Carlo): p "</span>, </span>
<span id="cb419-2741"><a href="#cb419-2741" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(test_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, </span>
<span id="cb419-2742"><a href="#cb419-2742" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste</span>(<span class="st">"="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, test_results<span class="sc">$</span>p_value))))</span>
<span id="cb419-2743"><a href="#cb419-2743" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-2744"><a href="#cb419-2744" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2745"><a href="#cb419-2745" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the plot</span></span>
<span id="cb419-2746"><a href="#cb419-2746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(countryEd, <span class="sc">-</span>total_country), <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-2747"><a href="#cb419-2747" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-2748"><a href="#cb419-2748" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb419-2749"><a href="#cb419-2749" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), </span>
<span id="cb419-2750"><a href="#cb419-2750" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-2751"><a href="#cb419-2751" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb419-2752"><a href="#cb419-2752" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Country of Education by RMT Usage (Top 6)"</span>,</span>
<span id="cb419-2753"><a href="#cb419-2753" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> subtitle_text,</span>
<span id="cb419-2754"><a href="#cb419-2754" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Country of Education"</span>,</span>
<span id="cb419-2755"><a href="#cb419-2755" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, <span class="fu">sum</span>(plot_data<span class="sc">$</span>count), <span class="st">")"</span>),</span>
<span id="cb419-2756"><a href="#cb419-2756" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"RMT Usage"</span>,</span>
<span id="cb419-2757"><a href="#cb419-2757" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Note: Percentages are out of the total N for each group"</span></span>
<span id="cb419-2758"><a href="#cb419-2758" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-2759"><a href="#cb419-2759" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_discrete</span>(<span class="at">labels =</span> legend_labels) <span class="sc">+</span></span>
<span id="cb419-2760"><a href="#cb419-2760" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-2761"><a href="#cb419-2761" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb419-2762"><a href="#cb419-2762" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-2763"><a href="#cb419-2763" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2764"><a href="#cb419-2764" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-2765"><a href="#cb419-2765" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-2766"><a href="#cb419-2766" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb419-2767"><a href="#cb419-2767" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-2768"><a href="#cb419-2768" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-2769"><a href="#cb419-2769" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2770"><a href="#cb419-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2771"><a href="#cb419-2771" aria-hidden="true" tabindex="-1"></a><span class="co"># Main Execution Function</span></span>
<span id="cb419-2772"><a href="#cb419-2772" aria-hidden="true" tabindex="-1"></a>run_rmt_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">file_path =</span> <span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>) {</span>
<span id="cb419-2773"><a href="#cb419-2773" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb419-2774"><a href="#cb419-2774" aria-hidden="true" tabindex="-1"></a>  prepared_data <span class="ot">&lt;-</span> <span class="fu">prepare_rmt_data</span>(file_path)</span>
<span id="cb419-2775"><a href="#cb419-2775" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2776"><a href="#cb419-2776" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform comprehensive analysis</span></span>
<span id="cb419-2777"><a href="#cb419-2777" aria-hidden="true" tabindex="-1"></a>  analysis_results <span class="ot">&lt;-</span> <span class="fu">perform_comprehensive_analysis</span>(prepared_data)</span>
<span id="cb419-2778"><a href="#cb419-2778" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2779"><a href="#cb419-2779" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create visualization</span></span>
<span id="cb419-2780"><a href="#cb419-2780" aria-hidden="true" tabindex="-1"></a>  rmt_plot <span class="ot">&lt;-</span> <span class="fu">create_rmt_plot</span>(analysis_results)</span>
<span id="cb419-2781"><a href="#cb419-2781" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2782"><a href="#cb419-2782" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print results to console</span></span>
<span id="cb419-2783"><a href="#cb419-2783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Statistical Test Details:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2784"><a href="#cb419-2784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Test Type:"</span>, analysis_results<span class="sc">$</span>test_results<span class="sc">$</span>test_type, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2785"><a href="#cb419-2785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"P-value:"</span>, analysis_results<span class="sc">$</span>test_results<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb419-2786"><a href="#cb419-2786" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2787"><a href="#cb419-2787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Contingency Table:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2788"><a href="#cb419-2788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>contingency_table)</span>
<span id="cb419-2789"><a href="#cb419-2789" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2790"><a href="#cb419-2790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Post-hoc Pairwise Comparisons (Bonferroni-corrected):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2791"><a href="#cb419-2791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>pairwise_results)</span>
<span id="cb419-2792"><a href="#cb419-2792" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2793"><a href="#cb419-2793" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the plot</span></span>
<span id="cb419-2794"><a href="#cb419-2794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(rmt_plot)</span>
<span id="cb419-2795"><a href="#cb419-2795" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2796"><a href="#cb419-2796" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results for potential further analysis</span></span>
<span id="cb419-2797"><a href="#cb419-2797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(analysis_results)</span>
<span id="cb419-2798"><a href="#cb419-2798" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2799"><a href="#cb419-2799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2800"><a href="#cb419-2800" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the analysis</span></span>
<span id="cb419-2801"><a href="#cb419-2801" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_rmt_analysis</span>()</span>
<span id="cb419-2802"><a href="#cb419-2802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-2803"><a href="#cb419-2803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2806"><a href="#cb419-2806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-2807"><a href="#cb419-2807" aria-hidden="true" tabindex="-1"></a><span class="co"># Only top 4 countries shown - Trying to increase the robustness of the analyses.</span></span>
<span id="cb419-2808"><a href="#cb419-2808" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb419-2809"><a href="#cb419-2809" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb419-2810"><a href="#cb419-2810" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb419-2811"><a href="#cb419-2811" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb419-2812"><a href="#cb419-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2813"><a href="#cb419-2813" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Data Preparation Function</span></span>
<span id="cb419-2814"><a href="#cb419-2814" aria-hidden="true" tabindex="-1"></a>prepare_rmt_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path, <span class="at">sheet =</span> <span class="st">"Combined"</span>) {</span>
<span id="cb419-2815"><a href="#cb419-2815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb419-2816"><a href="#cb419-2816" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read data with standardized cleaning</span></span>
<span id="cb419-2817"><a href="#cb419-2817" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> sheet)</span>
<span id="cb419-2818"><a href="#cb419-2818" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2819"><a href="#cb419-2819" aria-hidden="true" tabindex="-1"></a>    data_cleaned <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-2820"><a href="#cb419-2820" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb419-2821"><a href="#cb419-2821" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Comprehensive country name standardization</span></span>
<span id="cb419-2822"><a href="#cb419-2822" aria-hidden="true" tabindex="-1"></a>        <span class="at">countryEd =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-2823"><a href="#cb419-2823" aria-hidden="true" tabindex="-1"></a>          <span class="fu">grepl</span>(<span class="st">"United States|USA"</span>, countryEd, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"USA"</span>,</span>
<span id="cb419-2824"><a href="#cb419-2824" aria-hidden="true" tabindex="-1"></a>          <span class="fu">grepl</span>(<span class="st">"United Kingdom|UK"</span>, countryEd, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="sc">~</span> <span class="st">"UK"</span>,</span>
<span id="cb419-2825"><a href="#cb419-2825" aria-hidden="true" tabindex="-1"></a>          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(countryEd)</span>
<span id="cb419-2826"><a href="#cb419-2826" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb419-2827"><a href="#cb419-2827" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Robust RMT factor conversion</span></span>
<span id="cb419-2828"><a href="#cb419-2828" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(</span>
<span id="cb419-2829"><a href="#cb419-2829" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">RMTMethods_YN</span><span class="st">`</span>, </span>
<span id="cb419-2830"><a href="#cb419-2830" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb419-2831"><a href="#cb419-2831" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>)</span>
<span id="cb419-2832"><a href="#cb419-2832" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb419-2833"><a href="#cb419-2833" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb419-2834"><a href="#cb419-2834" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2835"><a href="#cb419-2835" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(data_cleaned)</span>
<span id="cb419-2836"><a href="#cb419-2836" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb419-2837"><a href="#cb419-2837" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error in data preparation:"</span>, e<span class="sc">$</span>message))</span>
<span id="cb419-2838"><a href="#cb419-2838" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb419-2839"><a href="#cb419-2839" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2840"><a href="#cb419-2840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2841"><a href="#cb419-2841" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced Statistical Analysis Function</span></span>
<span id="cb419-2842"><a href="#cb419-2842" aria-hidden="true" tabindex="-1"></a>perform_comprehensive_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb419-2843"><a href="#cb419-2843" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get all countries and their frequencies</span></span>
<span id="cb419-2844"><a href="#cb419-2844" aria-hidden="true" tabindex="-1"></a>  all_countries <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-2845"><a href="#cb419-2845" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(countryEd)) <span class="sc">%&gt;%</span></span>
<span id="cb419-2846"><a href="#cb419-2846" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(countryEd, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-2847"><a href="#cb419-2847" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb419-2848"><a href="#cb419-2848" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2849"><a href="#cb419-2849" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify Top 4 Countries</span></span>
<span id="cb419-2850"><a href="#cb419-2850" aria-hidden="true" tabindex="-1"></a>  top_4_countryEd <span class="ot">&lt;-</span> all_countries <span class="sc">%&gt;%</span></span>
<span id="cb419-2851"><a href="#cb419-2851" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">4</span>, n) <span class="sc">%&gt;%</span></span>
<span id="cb419-2852"><a href="#cb419-2852" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(countryEd)</span>
<span id="cb419-2853"><a href="#cb419-2853" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2854"><a href="#cb419-2854" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get excluded countries for the note</span></span>
<span id="cb419-2855"><a href="#cb419-2855" aria-hidden="true" tabindex="-1"></a>  excluded_countries <span class="ot">&lt;-</span> all_countries <span class="sc">%&gt;%</span></span>
<span id="cb419-2856"><a href="#cb419-2856" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(countryEd <span class="sc">%in%</span> top_4_countryEd)) <span class="sc">%&gt;%</span></span>
<span id="cb419-2857"><a href="#cb419-2857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country_info =</span> countryEd) <span class="sc">%&gt;%</span></span>
<span id="cb419-2858"><a href="#cb419-2858" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(country_info)</span>
<span id="cb419-2859"><a href="#cb419-2859" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2860"><a href="#cb419-2860" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create excluded countries list as a string</span></span>
<span id="cb419-2861"><a href="#cb419-2861" aria-hidden="true" tabindex="-1"></a>  excluded_countries_text <span class="ot">&lt;-</span> <span class="fu">paste</span>(excluded_countries, <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb419-2862"><a href="#cb419-2862" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2863"><a href="#cb419-2863" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data to top 4 countries</span></span>
<span id="cb419-2864"><a href="#cb419-2864" aria-hidden="true" tabindex="-1"></a>  data_top4_edu <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-2865"><a href="#cb419-2865" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(countryEd <span class="sc">%in%</span> top_4_countryEd)</span>
<span id="cb419-2866"><a href="#cb419-2866" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2867"><a href="#cb419-2867" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create contingency table</span></span>
<span id="cb419-2868"><a href="#cb419-2868" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_top4_edu<span class="sc">$</span>countryEd, data_top4_edu<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-2869"><a href="#cb419-2869" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2870"><a href="#cb419-2870" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Comprehensive test selection and reporting</span></span>
<span id="cb419-2871"><a href="#cb419-2871" aria-hidden="true" tabindex="-1"></a>  analyze_test_assumptions <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb419-2872"><a href="#cb419-2872" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate expected frequencies</span></span>
<span id="cb419-2873"><a href="#cb419-2873" aria-hidden="true" tabindex="-1"></a>    chi_results <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(cont_table))</span>
<span id="cb419-2874"><a href="#cb419-2874" aria-hidden="true" tabindex="-1"></a>    expected_freq <span class="ot">&lt;-</span> chi_results<span class="sc">$</span>expected</span>
<span id="cb419-2875"><a href="#cb419-2875" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2876"><a href="#cb419-2876" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Detailed frequency checks</span></span>
<span id="cb419-2877"><a href="#cb419-2877" aria-hidden="true" tabindex="-1"></a>    total_cells <span class="ot">&lt;-</span> <span class="fu">length</span>(expected_freq)</span>
<span id="cb419-2878"><a href="#cb419-2878" aria-hidden="true" tabindex="-1"></a>    low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb419-2879"><a href="#cb419-2879" aria-hidden="true" tabindex="-1"></a>    min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb419-2880"><a href="#cb419-2880" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2881"><a href="#cb419-2881" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verbose reporting of frequency conditions</span></span>
<span id="cb419-2882"><a href="#cb419-2882" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2883"><a href="#cb419-2883" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-2884"><a href="#cb419-2884" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb419-2885"><a href="#cb419-2885" aria-hidden="true" tabindex="-1"></a>        <span class="st">"out of"</span>, total_cells, <span class="st">"cells ("</span>, </span>
<span id="cb419-2886"><a href="#cb419-2886" aria-hidden="true" tabindex="-1"></a>        <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> total_cells <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb419-2887"><a href="#cb419-2887" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2888"><a href="#cb419-2888" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine most appropriate test</span></span>
<span id="cb419-2889"><a href="#cb419-2889" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> total_cells) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb419-2890"><a href="#cb419-2890" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use Fisher's exact test with Monte Carlo simulation</span></span>
<span id="cb419-2891"><a href="#cb419-2891" aria-hidden="true" tabindex="-1"></a>      exact_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(cont_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-2892"><a href="#cb419-2892" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-2893"><a href="#cb419-2893" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-2894"><a href="#cb419-2894" aria-hidden="true" tabindex="-1"></a>        <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test (Monte Carlo)"</span>,</span>
<span id="cb419-2895"><a href="#cb419-2895" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> exact_test<span class="sc">$</span>p.value,</span>
<span id="cb419-2896"><a href="#cb419-2896" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> <span class="cn">NA</span>,</span>
<span id="cb419-2897"><a href="#cb419-2897" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb419-2898"><a href="#cb419-2898" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb419-2899"><a href="#cb419-2899" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb419-2900"><a href="#cb419-2900" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb419-2901"><a href="#cb419-2901" aria-hidden="true" tabindex="-1"></a>      adjusted_chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb419-2902"><a href="#cb419-2902" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-2903"><a href="#cb419-2903" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-2904"><a href="#cb419-2904" aria-hidden="true" tabindex="-1"></a>        <span class="at">test_type =</span> <span class="st">"Chi-Square with Continuity Correction"</span>,</span>
<span id="cb419-2905"><a href="#cb419-2905" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> adjusted_chi_test<span class="sc">$</span>p.value,</span>
<span id="cb419-2906"><a href="#cb419-2906" aria-hidden="true" tabindex="-1"></a>        <span class="at">statistic =</span> adjusted_chi_test<span class="sc">$</span>statistic,</span>
<span id="cb419-2907"><a href="#cb419-2907" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameter =</span> adjusted_chi_test<span class="sc">$</span>parameter,</span>
<span id="cb419-2908"><a href="#cb419-2908" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="fu">paste</span>(<span class="st">"Pearson's Chi-squared test with Yates' continuity correction,"</span>,</span>
<span id="cb419-2909"><a href="#cb419-2909" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"df ="</span>, adjusted_chi_test<span class="sc">$</span>parameter)</span>
<span id="cb419-2910"><a href="#cb419-2910" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb419-2911"><a href="#cb419-2911" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-2912"><a href="#cb419-2912" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-2913"><a href="#cb419-2913" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2914"><a href="#cb419-2914" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform test</span></span>
<span id="cb419-2915"><a href="#cb419-2915" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">analyze_test_assumptions</span>(contingency_table)</span>
<span id="cb419-2916"><a href="#cb419-2916" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2917"><a href="#cb419-2917" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pairwise comparisons with Chi-square tests (if appropriate)</span></span>
<span id="cb419-2918"><a href="#cb419-2918" aria-hidden="true" tabindex="-1"></a>  pairwise_comparisons <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb419-2919"><a href="#cb419-2919" aria-hidden="true" tabindex="-1"></a>    countries <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cont_table)</span>
<span id="cb419-2920"><a href="#cb419-2920" aria-hidden="true" tabindex="-1"></a>    n_countries <span class="ot">&lt;-</span> <span class="fu">length</span>(countries)</span>
<span id="cb419-2921"><a href="#cb419-2921" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-2922"><a href="#cb419-2922" aria-hidden="true" tabindex="-1"></a>      <span class="at">comparison =</span> <span class="fu">character</span>(),</span>
<span id="cb419-2923"><a href="#cb419-2923" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-2924"><a href="#cb419-2924" aria-hidden="true" tabindex="-1"></a>      <span class="at">adj_p_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-2925"><a href="#cb419-2925" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb419-2926"><a href="#cb419-2926" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-2927"><a href="#cb419-2927" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2928"><a href="#cb419-2928" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_countries<span class="dv">-1</span>)) {</span>
<span id="cb419-2929"><a href="#cb419-2929" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_countries) {</span>
<span id="cb419-2930"><a href="#cb419-2930" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the 2x2 subtable</span></span>
<span id="cb419-2931"><a href="#cb419-2931" aria-hidden="true" tabindex="-1"></a>        subtable <span class="ot">&lt;-</span> cont_table[<span class="fu">c</span>(i,j),]</span>
<span id="cb419-2932"><a href="#cb419-2932" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb419-2933"><a href="#cb419-2933" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check assumptions for chi-square</span></span>
<span id="cb419-2934"><a href="#cb419-2934" aria-hidden="true" tabindex="-1"></a>        expected <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(subtable)<span class="sc">$</span>expected</span>
<span id="cb419-2935"><a href="#cb419-2935" aria-hidden="true" tabindex="-1"></a>        min_expected <span class="ot">&lt;-</span> <span class="fu">min</span>(expected)</span>
<span id="cb419-2936"><a href="#cb419-2936" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb419-2937"><a href="#cb419-2937" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use appropriate test based on expected frequencies</span></span>
<span id="cb419-2938"><a href="#cb419-2938" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (min_expected <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb419-2939"><a href="#cb419-2939" aria-hidden="true" tabindex="-1"></a>          test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(subtable)</span>
<span id="cb419-2940"><a href="#cb419-2940" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb419-2941"><a href="#cb419-2941" aria-hidden="true" tabindex="-1"></a>          test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(subtable, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb419-2942"><a href="#cb419-2942" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb419-2943"><a href="#cb419-2943" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb419-2944"><a href="#cb419-2944" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb419-2945"><a href="#cb419-2945" aria-hidden="true" tabindex="-1"></a>          <span class="at">comparison =</span> <span class="fu">paste</span>(countries[i], <span class="st">"vs"</span>, countries[j]),</span>
<span id="cb419-2946"><a href="#cb419-2946" aria-hidden="true" tabindex="-1"></a>          <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb419-2947"><a href="#cb419-2947" aria-hidden="true" tabindex="-1"></a>          <span class="at">adj_p_value =</span> <span class="cn">NA</span></span>
<span id="cb419-2948"><a href="#cb419-2948" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb419-2949"><a href="#cb419-2949" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb419-2950"><a href="#cb419-2950" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-2951"><a href="#cb419-2951" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-2952"><a href="#cb419-2952" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bonferroni correction</span></span>
<span id="cb419-2953"><a href="#cb419-2953" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>adj_p_value <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(results<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb419-2954"><a href="#cb419-2954" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(results)</span>
<span id="cb419-2955"><a href="#cb419-2955" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-2956"><a href="#cb419-2956" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2957"><a href="#cb419-2957" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute pairwise comparisons</span></span>
<span id="cb419-2958"><a href="#cb419-2958" aria-hidden="true" tabindex="-1"></a>  pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise_comparisons</span>(contingency_table)</span>
<span id="cb419-2959"><a href="#cb419-2959" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2960"><a href="#cb419-2960" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return comprehensive results</span></span>
<span id="cb419-2961"><a href="#cb419-2961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb419-2962"><a href="#cb419-2962" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_results =</span> test_results,</span>
<span id="cb419-2963"><a href="#cb419-2963" aria-hidden="true" tabindex="-1"></a>    <span class="at">pairwise_results =</span> pairwise_results,</span>
<span id="cb419-2964"><a href="#cb419-2964" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_top4_edu =</span> data_top4_edu,</span>
<span id="cb419-2965"><a href="#cb419-2965" aria-hidden="true" tabindex="-1"></a>    <span class="at">contingency_table =</span> contingency_table,</span>
<span id="cb419-2966"><a href="#cb419-2966" aria-hidden="true" tabindex="-1"></a>    <span class="at">excluded_countries_text =</span> excluded_countries_text,</span>
<span id="cb419-2967"><a href="#cb419-2967" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_countries =</span> all_countries</span>
<span id="cb419-2968"><a href="#cb419-2968" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2969"><a href="#cb419-2969" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-2970"><a href="#cb419-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-2971"><a href="#cb419-2971" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization Function</span></span>
<span id="cb419-2972"><a href="#cb419-2972" aria-hidden="true" tabindex="-1"></a>create_rmt_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(analysis_results) {</span>
<span id="cb419-2973"><a href="#cb419-2973" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare plot data</span></span>
<span id="cb419-2974"><a href="#cb419-2974" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>data_top4_edu <span class="sc">%&gt;%</span></span>
<span id="cb419-2975"><a href="#cb419-2975" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(countryEd, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-2976"><a href="#cb419-2976" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-2977"><a href="#cb419-2977" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(countryEd) <span class="sc">%&gt;%</span></span>
<span id="cb419-2978"><a href="#cb419-2978" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb419-2979"><a href="#cb419-2979" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_country =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-2980"><a href="#cb419-2980" aria-hidden="true" tabindex="-1"></a>      <span class="at">percentage =</span> count <span class="sc">/</span> total_country <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-2981"><a href="#cb419-2981" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)</span>
<span id="cb419-2982"><a href="#cb419-2982" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb419-2983"><a href="#cb419-2983" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb419-2984"><a href="#cb419-2984" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2985"><a href="#cb419-2985" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute totals for legend</span></span>
<span id="cb419-2986"><a href="#cb419-2986" aria-hidden="true" tabindex="-1"></a>  legend_totals <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>data_top4_edu <span class="sc">%&gt;%</span></span>
<span id="cb419-2987"><a href="#cb419-2987" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-2988"><a href="#cb419-2988" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb419-2989"><a href="#cb419-2989" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2990"><a href="#cb419-2990" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create legend labels</span></span>
<span id="cb419-2991"><a href="#cb419-2991" aria-hidden="true" tabindex="-1"></a>  legend_labels <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb419-2992"><a href="#cb419-2992" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(legend_totals<span class="sc">$</span>RMTMethods_YN, <span class="st">" (N = "</span>, legend_totals<span class="sc">$</span>total, <span class="st">")"</span>),</span>
<span id="cb419-2993"><a href="#cb419-2993" aria-hidden="true" tabindex="-1"></a>    legend_totals<span class="sc">$</span>RMTMethods_YN</span>
<span id="cb419-2994"><a href="#cb419-2994" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-2995"><a href="#cb419-2995" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-2996"><a href="#cb419-2996" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare subtitle based on test type</span></span>
<span id="cb419-2997"><a href="#cb419-2997" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>test_results</span>
<span id="cb419-2998"><a href="#cb419-2998" aria-hidden="true" tabindex="-1"></a>  subtitle_text <span class="ot">&lt;-</span> <span class="cf">if</span> (test_results<span class="sc">$</span>test_type <span class="sc">==</span> <span class="st">"Chi-Square with Continuity Correction"</span>) {</span>
<span id="cb419-2999"><a href="#cb419-2999" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Chi-square test: "</span>, </span>
<span id="cb419-3000"><a href="#cb419-3000" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sprintf</span>(<span class="st">"χ²(%d) = %.2f"</span>, test_results<span class="sc">$</span>parameter, test_results<span class="sc">$</span>statistic),</span>
<span id="cb419-3001"><a href="#cb419-3001" aria-hidden="true" tabindex="-1"></a>           <span class="st">", p "</span>, <span class="fu">ifelse</span>(test_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, </span>
<span id="cb419-3002"><a href="#cb419-3002" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">paste</span>(<span class="st">"="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, test_results<span class="sc">$</span>p_value))))</span>
<span id="cb419-3003"><a href="#cb419-3003" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb419-3004"><a href="#cb419-3004" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"Fisher's Exact Test (Monte Carlo): p "</span>, </span>
<span id="cb419-3005"><a href="#cb419-3005" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(test_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt; .001"</span>, </span>
<span id="cb419-3006"><a href="#cb419-3006" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste</span>(<span class="st">"="</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, test_results<span class="sc">$</span>p_value))))</span>
<span id="cb419-3007"><a href="#cb419-3007" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-3008"><a href="#cb419-3008" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3009"><a href="#cb419-3009" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the caption with excluded countries</span></span>
<span id="cb419-3010"><a href="#cb419-3010" aria-hidden="true" tabindex="-1"></a>  note_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Note. All countries with frequencies less than 5% were excluded from the Figure, including: "</span>, </span>
<span id="cb419-3011"><a href="#cb419-3011" aria-hidden="true" tabindex="-1"></a>                     analysis_results<span class="sc">$</span>excluded_countries_text)</span>
<span id="cb419-3012"><a href="#cb419-3012" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3013"><a href="#cb419-3013" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wrap the note text for better display</span></span>
<span id="cb419-3014"><a href="#cb419-3014" aria-hidden="true" tabindex="-1"></a>  wrapped_note <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(note_text, <span class="at">width =</span> <span class="dv">100</span>)</span>
<span id="cb419-3015"><a href="#cb419-3015" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3016"><a href="#cb419-3016" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count how many lines are in the wrapped note for margin adjustment</span></span>
<span id="cb419-3017"><a href="#cb419-3017" aria-hidden="true" tabindex="-1"></a>  line_count <span class="ot">&lt;-</span> <span class="fu">str_count</span>(wrapped_note, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb419-3018"><a href="#cb419-3018" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3019"><a href="#cb419-3019" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the plot</span></span>
<span id="cb419-3020"><a href="#cb419-3020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(countryEd, <span class="sc">-</span>total_country), <span class="at">y =</span> count, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-3021"><a href="#cb419-3021" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-3022"><a href="#cb419-3022" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb419-3023"><a href="#cb419-3023" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), </span>
<span id="cb419-3024"><a href="#cb419-3024" aria-hidden="true" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-3025"><a href="#cb419-3025" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb419-3026"><a href="#cb419-3026" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Country of Education by RMT Usage (Top 4)"</span>,</span>
<span id="cb419-3027"><a href="#cb419-3027" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> subtitle_text,</span>
<span id="cb419-3028"><a href="#cb419-3028" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Country of Education"</span>,</span>
<span id="cb419-3029"><a href="#cb419-3029" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Count of Participants (N = "</span>, <span class="fu">sum</span>(plot_data<span class="sc">$</span>count), <span class="st">")"</span>),</span>
<span id="cb419-3030"><a href="#cb419-3030" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"RMT Usage"</span>,</span>
<span id="cb419-3031"><a href="#cb419-3031" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> wrapped_note</span>
<span id="cb419-3032"><a href="#cb419-3032" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-3033"><a href="#cb419-3033" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_discrete</span>(<span class="at">labels =</span> legend_labels) <span class="sc">+</span></span>
<span id="cb419-3034"><a href="#cb419-3034" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-3035"><a href="#cb419-3035" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb419-3036"><a href="#cb419-3036" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-3037"><a href="#cb419-3037" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-3038"><a href="#cb419-3038" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-3039"><a href="#cb419-3039" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-3040"><a href="#cb419-3040" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">lineheight =</span> <span class="fl">1.2</span>),</span>
<span id="cb419-3041"><a href="#cb419-3041" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Adjust bottom margin based on the number of lines in the note</span></span>
<span id="cb419-3042"><a href="#cb419-3042" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span> <span class="sc">+</span> (line_count <span class="sc">*</span> <span class="dv">12</span>), <span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">20</span>)</span>
<span id="cb419-3043"><a href="#cb419-3043" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-3044"><a href="#cb419-3044" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>)))</span>
<span id="cb419-3045"><a href="#cb419-3045" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-3046"><a href="#cb419-3046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3047"><a href="#cb419-3047" aria-hidden="true" tabindex="-1"></a><span class="co"># Main Execution Function</span></span>
<span id="cb419-3048"><a href="#cb419-3048" aria-hidden="true" tabindex="-1"></a>run_rmt_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">file_path =</span> <span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>) {</span>
<span id="cb419-3049"><a href="#cb419-3049" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb419-3050"><a href="#cb419-3050" aria-hidden="true" tabindex="-1"></a>  prepared_data <span class="ot">&lt;-</span> <span class="fu">prepare_rmt_data</span>(file_path)</span>
<span id="cb419-3051"><a href="#cb419-3051" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3052"><a href="#cb419-3052" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform comprehensive analysis</span></span>
<span id="cb419-3053"><a href="#cb419-3053" aria-hidden="true" tabindex="-1"></a>  analysis_results <span class="ot">&lt;-</span> <span class="fu">perform_comprehensive_analysis</span>(prepared_data)</span>
<span id="cb419-3054"><a href="#cb419-3054" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3055"><a href="#cb419-3055" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create visualization</span></span>
<span id="cb419-3056"><a href="#cb419-3056" aria-hidden="true" tabindex="-1"></a>  rmt_plot <span class="ot">&lt;-</span> <span class="fu">create_rmt_plot</span>(analysis_results)</span>
<span id="cb419-3057"><a href="#cb419-3057" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3058"><a href="#cb419-3058" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print results to console</span></span>
<span id="cb419-3059"><a href="#cb419-3059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Statistical Test Details:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3060"><a href="#cb419-3060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Test Type:"</span>, analysis_results<span class="sc">$</span>test_results<span class="sc">$</span>test_type, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3061"><a href="#cb419-3061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"P-value:"</span>, analysis_results<span class="sc">$</span>test_results<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb419-3062"><a href="#cb419-3062" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3063"><a href="#cb419-3063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Contingency Table:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3064"><a href="#cb419-3064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>contingency_table)</span>
<span id="cb419-3065"><a href="#cb419-3065" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3066"><a href="#cb419-3066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Post-hoc Pairwise Comparisons (Bonferroni-corrected):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3067"><a href="#cb419-3067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>pairwise_results)</span>
<span id="cb419-3068"><a href="#cb419-3068" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3069"><a href="#cb419-3069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Excluded Countries:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3070"><a href="#cb419-3070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(analysis_results<span class="sc">$</span>excluded_countries_text, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3071"><a href="#cb419-3071" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3072"><a href="#cb419-3072" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the plot</span></span>
<span id="cb419-3073"><a href="#cb419-3073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(rmt_plot)</span>
<span id="cb419-3074"><a href="#cb419-3074" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3075"><a href="#cb419-3075" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results for potential further analysis</span></span>
<span id="cb419-3076"><a href="#cb419-3076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(analysis_results)</span>
<span id="cb419-3077"><a href="#cb419-3077" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-3078"><a href="#cb419-3078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3079"><a href="#cb419-3079" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the analysis</span></span>
<span id="cb419-3080"><a href="#cb419-3080" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_rmt_analysis</span>()</span>
<span id="cb419-3081"><a href="#cb419-3081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3082"><a href="#cb419-3082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-3083"><a href="#cb419-3083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3084"><a href="#cb419-3084" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results and Discussion</span></span>
<span id="cb419-3085"><a href="#cb419-3085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3086"><a href="#cb419-3086" aria-hidden="true" tabindex="-1"></a>**Statistical Significance**</span>
<span id="cb419-3087"><a href="#cb419-3087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3088"><a href="#cb419-3088" aria-hidden="true" tabindex="-1"></a>*Chi-square Test:* The chi-square test produced a statistic of approximately 44.25 with 7 degrees of freedom and a p-value of about 1.92×10−71.92×10−7. This highly significant result indicates that the distribution of education levels differs between the two groups (those who use RMT methods versus those who do not), i.e., the association is statistically significant.</span>
<span id="cb419-3089"><a href="#cb419-3089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3090"><a href="#cb419-3090" aria-hidden="true" tabindex="-1"></a>*Effect Size (Cramer’s V):* Cramer’s V was calculated to be around 0.169. Although not extremely large, this value suggests a modest association between education and the use of RMT methods. In social sciences, such effect sizes are common when dealing with categorical variables; even a modest effect size can be substantively meaningful.</span>
<span id="cb419-3091"><a href="#cb419-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3092"><a href="#cb419-3092" aria-hidden="true" tabindex="-1"></a>**Detailed Group Comparison**</span>
<span id="cb419-3093"><a href="#cb419-3093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3094"><a href="#cb419-3094" aria-hidden="true" tabindex="-1"></a>*Group Proportions:* The summary statistics break down the relative frequencies of each education category for the “No” and “Yes” groups. For each education level, both counts and percentages were calculated. In the plots, you can see the proportions clearly marked with labels (which include counts and percentages), making it easy to compare how education distributions differ between the two groups.</span>
<span id="cb419-3095"><a href="#cb419-3095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3096"><a href="#cb419-3096" aria-hidden="true" tabindex="-1"></a>*Proportion Differences:* By pivoting the grouped data, we computed the differences in percentage points between the “Yes” and “No” groups for each education level. Education levels with the largest differences indicate where the distribution deviates most from what is expected under independence. These differences can help pinpoint which education categories are driving the overall chi-square statistic.</span>
<span id="cb419-3097"><a href="#cb419-3097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3098"><a href="#cb419-3098" aria-hidden="true" tabindex="-1"></a>**Standardized Residuals**</span>
<span id="cb419-3099"><a href="#cb419-3099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3100"><a href="#cb419-3100" aria-hidden="true" tabindex="-1"></a>*Interpreting Residuals:* The standardized residuals provide additional insight into which specific cells of the contingency table contribute most to the chi-square result. A positive residual in a cell suggests that the observed count is higher than what is expected under the null hypothesis, whereas a negative residual indicates under representation. For example, if the “Doctorate” category shows a strongly positive residual for one group, it means that group has a higher-than-expected frequency of individuals holding a doctorate. Conversely, a negative value in another cell would point to an under representation relative to expectation.</span>
<span id="cb419-3101"><a href="#cb419-3101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3102"><a href="#cb419-3102" aria-hidden="true" tabindex="-1"></a>*Identifying Key Differences:* Reviewing these residuals allows us to identify which education levels are statistically noteworthy. For instance, if “Doctorate” or “Bachelors degree” have notable positive or negative deviations, these categories are influencing the overall association significantly.</span>
<span id="cb419-3103"><a href="#cb419-3103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3104"><a href="#cb419-3104" aria-hidden="true" tabindex="-1"></a>**Visualization of Findings**</span>
<span id="cb419-3105"><a href="#cb419-3105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3106"><a href="#cb419-3106" aria-hidden="true" tabindex="-1"></a>Two types of plots were generated: *Side-by-Side Bar Plot:* This plot displays the percentage breakdown of each education category for the “No” and “Yes” groups side by side. With detailed labels that include both the count and percentage, this visualization makes it straightforward to compare each education level between groups. The subtitle also reminds the viewer of the total sample size for each group, ensuring a complete context for interpretation.</span>
<span id="cb419-3107"><a href="#cb419-3107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3108"><a href="#cb419-3108" aria-hidden="true" tabindex="-1"></a>*Dot/Line Plot:* As an alternative, the dot/line plot connects the percentages across education categories for both groups. This plot emphasizes trends and differences in the pattern of education distribution. The connecting lines help to visualize how the relative positions of categories shift between groups. Both visualizations have been adjusted to ensure that all labels are fully visible by setting appropriate margins and enlarging plot height if necessary.</span>
<span id="cb419-3109"><a href="#cb419-3109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3110"><a href="#cb419-3110" aria-hidden="true" tabindex="-1"></a>**Overall Interpretation**</span>
<span id="cb419-3111"><a href="#cb419-3111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3112"><a href="#cb419-3112" aria-hidden="true" tabindex="-1"></a>*Significant Association:* The significant chi-square result confirms that the pattern of education across groups is not random. There is a statistically significant association between having a particular education level and whether someone uses RMT methods.</span>
<span id="cb419-3113"><a href="#cb419-3113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3114"><a href="#cb419-3114" aria-hidden="true" tabindex="-1"></a>*Magnitude and Specific Contributions:* The moderate effect size (Cramer’s V ≈ 0.169) implies that while the association exists, it is of modest strength. Importantly, the examination of standardized residuals and proportion differences shines a light on which specific education categories drive this association. These insights might be used to explore further why certain education levels are more, or less, likely to be associated with RMT method usage.</span>
<span id="cb419-3115"><a href="#cb419-3115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3116"><a href="#cb419-3116" aria-hidden="true" tabindex="-1"></a>*Practical Implications:* Depending on the context of the study (e.g., educational policies, targeted interventions, or market segmentation), these findings could inform decision-making by pinpointing demographic groups for further investigation or tailored strategies. For instance, if a particular education category is underrepresented among RMT users, it might signal potential barriers or areas for targeted improvement.</span>
<span id="cb419-3117"><a href="#cb419-3117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3118"><a href="#cb419-3118" aria-hidden="true" tabindex="-1"></a>**Summary**</span>
<span id="cb419-3119"><a href="#cb419-3119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3120"><a href="#cb419-3120" aria-hidden="true" tabindex="-1"></a>The findings indicate that country of education is significantly associated with the use of RMT methods. The statistical tests, along with the calculated effect size and detailed graphical representations, provide a robust basis for interpreting the differences across education levels. The analysis not only confirms the presence of differences but also identifies which education categories are most influential in driving these differences, offering valuable insights for further study or practical applications.</span>
<span id="cb419-3121"><a href="#cb419-3121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3122"><a href="#cb419-3122" aria-hidden="true" tabindex="-1"></a>**Combined Groups**</span>
<span id="cb419-3123"><a href="#cb419-3123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3124"><a href="#cb419-3124" aria-hidden="true" tabindex="-1"></a>This analysis examines the relationship between country of education and Respiratory Muscle Training (RMT) usage among participants. The data covers four major English-speaking countries: Australia, Canada, the UK, and the USA, with 34 additional countries excluded due to smaller sample sizes.</span>
<span id="cb419-3125"><a href="#cb419-3125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3126"><a href="#cb419-3126" aria-hidden="true" tabindex="-1"></a>**Statistical Significance**</span>
<span id="cb419-3127"><a href="#cb419-3127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3128"><a href="#cb419-3128" aria-hidden="true" tabindex="-1"></a>The chi-square test with continuity correction yielded a highly significant result (p <span class="sc">\&lt;</span> 0.001), indicating a strong association between country of education and RMT usage. All expected cell frequencies were above the minimum threshold of 5 (minimum = 13.17), confirming that the chi-square test was appropriate for this analysis.</span>
<span id="cb419-3129"><a href="#cb419-3129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3130"><a href="#cb419-3130" aria-hidden="true" tabindex="-1"></a>**RMT Usage Patterns by Country**</span>
<span id="cb419-3131"><a href="#cb419-3131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3132"><a href="#cb419-3132" aria-hidden="true" tabindex="-1"></a>From the contingency table, we can observe distinct patterns in RMT adoption:</span>
<span id="cb419-3133"><a href="#cb419-3133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3134"><a href="#cb419-3134" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Australia**: 65 out of 321 participants (20.2%) use RMT</span>
<span id="cb419-3135"><a href="#cb419-3135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3136"><a href="#cb419-3136" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**USA**: 113 out of 620 participants (18.2%) use RMT</span>
<span id="cb419-3137"><a href="#cb419-3137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3138"><a href="#cb419-3138" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Canada**: 8 out of 92 participants (8.7%) use RMT</span>
<span id="cb419-3139"><a href="#cb419-3139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3140"><a href="#cb419-3140" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**UK**: 14 out of 364 participants (3.8%) use RMT</span>
<span id="cb419-3141"><a href="#cb419-3141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3142"><a href="#cb419-3142" aria-hidden="true" tabindex="-1"></a>This reveals a striking pattern where participants educated in Australia and the USA have RMT adoption rates approximately 2-5 times higher than those educated in Canada and the UK.</span>
<span id="cb419-3143"><a href="#cb419-3143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3144"><a href="#cb419-3144" aria-hidden="true" tabindex="-1"></a>**Post-hoc Pairwise Comparisons**</span>
<span id="cb419-3145"><a href="#cb419-3145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3146"><a href="#cb419-3146" aria-hidden="true" tabindex="-1"></a>The Bonferroni-corrected pairwise comparisons identify which specific country differences are statistically significant:</span>
<span id="cb419-3147"><a href="#cb419-3147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3148"><a href="#cb419-3148" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Significant Differences** (p <span class="sc">\&lt;</span> 0.05 after adjustment):</span>
<span id="cb419-3149"><a href="#cb419-3149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3150"><a href="#cb419-3150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Australia vs. UK (p = 2.69 × 10\^-10): Australian-educated participants are significantly more likely to use RMT than UK-educated participants</span>
<span id="cb419-3151"><a href="#cb419-3151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3152"><a href="#cb419-3152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>USA vs. UK (p = 9.52 × 10\^-10): US-educated participants are significantly more likely to use RMT than UK-educated participants</span>
<span id="cb419-3153"><a href="#cb419-3153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3154"><a href="#cb419-3154" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Non-Significant Differences** (p <span class="sc">\&gt;</span> 0.05 after adjustment):</span>
<span id="cb419-3155"><a href="#cb419-3155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3156"><a href="#cb419-3156" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Australia vs. Canada (p = 0.097): Despite the substantial percentage difference (20.2% vs 8.7%), this comparison falls just short of significance after Bonferroni correction</span>
<span id="cb419-3157"><a href="#cb419-3157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3158"><a href="#cb419-3158" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Australia vs. USA (p = 1.0): Very similar RMT usage rates between these countries</span>
<span id="cb419-3159"><a href="#cb419-3159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3160"><a href="#cb419-3160" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Canada vs. UK (p = 0.362): Both have lower RMT usage rates</span>
<span id="cb419-3161"><a href="#cb419-3161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3162"><a href="#cb419-3162" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Canada vs. USA (p = 0.203): Not statistically significant after correction</span>
<span id="cb419-3163"><a href="#cb419-3163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3164"><a href="#cb419-3164" aria-hidden="true" tabindex="-1"></a>**Implications and Potential Explanations**</span>
<span id="cb419-3165"><a href="#cb419-3165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3166"><a href="#cb419-3166" aria-hidden="true" tabindex="-1"></a>Several factors might explain these international differences in RMT adoption based on education location:</span>
<span id="cb419-3167"><a href="#cb419-3167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3168"><a href="#cb419-3168" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Educational Approaches**: Australia and the USA may emphasize technology integration in music education more heavily than the UK and Canada. This could reflect differences in curriculum design, pedagogical approaches, or resource allocation within educational institutions.</span>
<span id="cb419-3169"><a href="#cb419-3169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3170"><a href="#cb419-3170" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Technological Infrastructure in Educational Settings**: Educational institutions in Australia and the USA might have greater access to technology resources, better digital infrastructure, or more technology-oriented training programs.</span>
<span id="cb419-3171"><a href="#cb419-3171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3172"><a href="#cb419-3172" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Cultural Attitudes Toward Technology in Education**: Different educational systems may have varying cultural perspectives on the role of technology in learning and performance. These cultural attitudes could shape how students are taught to view technological aids.</span>
<span id="cb419-3173"><a href="#cb419-3173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3174"><a href="#cb419-3174" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Educational Investment in Technology**: Countries may differ in their funding priorities for music education, with some investing more heavily in technological resources and training.</span>
<span id="cb419-3175"><a href="#cb419-3175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3176"><a href="#cb419-3176" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Different Teaching Traditions**: Musical education may follow different teaching traditions and philosophies across these countries, with some more receptive to technological innovation than others.</span>
<span id="cb419-3177"><a href="#cb419-3177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3178"><a href="#cb419-3178" aria-hidden="true" tabindex="-1"></a>**Broader Context**</span>
<span id="cb419-3179"><a href="#cb419-3179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3180"><a href="#cb419-3180" aria-hidden="true" tabindex="-1"></a>The pattern observed here—with Australia and the USA having higher RMT adoption rates than the UK and Canada—suggests a potential divide in approaches to music education and technology integration across these major English-speaking countries. This divide persists despite shared language and many cultural similarities, highlighting how educational practices can diverge significantly across national boundaries.</span>
<span id="cb419-3181"><a href="#cb419-3181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3182"><a href="#cb419-3182" aria-hidden="true" tabindex="-1"></a>**Limitations and Considerations**</span>
<span id="cb419-3183"><a href="#cb419-3183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3184"><a href="#cb419-3184" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Sample Size Variations**: The number of participants varies considerably across countries (from 92 in Canada to 620 in the USA), affecting the precision of estimates.</span>
<span id="cb419-3185"><a href="#cb419-3185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3186"><a href="#cb419-3186" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Excluded Countries**: 34 countries were excluded from the analysis due to small sample sizes. This extensive list includes several European countries (Germany, Italy, Netherlands, etc.) and countries from various regions worldwide, limiting the global representativeness of the findings.</span>
<span id="cb419-3187"><a href="#cb419-3187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3188"><a href="#cb419-3188" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Historical Context**: The data doesn't indicate when participants were educated in these countries, so the findings may reflect historical differences in educational approaches across different time periods.</span>
<span id="cb419-3189"><a href="#cb419-3189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3190"><a href="#cb419-3190" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Education vs. Residence**: This analysis focuses on country of education rather than current residence, which may provide insights into formative influences rather than current environmental factors affecting RMT usage.</span>
<span id="cb419-3191"><a href="#cb419-3191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3192"><a href="#cb419-3192" aria-hidden="true" tabindex="-1"></a>**Conclusion**</span>
<span id="cb419-3193"><a href="#cb419-3193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3194"><a href="#cb419-3194" aria-hidden="true" tabindex="-1"></a>The analysis provides strong evidence that country of education is significantly associated with RMT usage, with particularly pronounced differences between Australia/USA and the UK. These findings suggest that educational systems and approaches play an important role in shaping technology adoption practices among musicians. Understanding these patterns could help inform international educational policy, curriculum development, and technology integration strategies in music education.</span>
<span id="cb419-3195"><a href="#cb419-3195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3196"><a href="#cb419-3196" aria-hidden="true" tabindex="-1"></a><span class="fu"># Roles</span></span>
<span id="cb419-3197"><a href="#cb419-3197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3198"><a href="#cb419-3198" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-3199"><a href="#cb419-3199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3202"><a href="#cb419-3202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-3203"><a href="#cb419-3203" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-3204"><a href="#cb419-3204" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-3205"><a href="#cb419-3205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3206"><a href="#cb419-3206" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the role data with proper labels</span></span>
<span id="cb419-3207"><a href="#cb419-3207" aria-hidden="true" tabindex="-1"></a>role_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-3208"><a href="#cb419-3208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(role_MAX1, role_MAX2, role_MAX3, role_MAX4) <span class="sc">%&gt;%</span></span>
<span id="cb419-3209"><a href="#cb419-3209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), </span>
<span id="cb419-3210"><a href="#cb419-3210" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"role_number"</span>, </span>
<span id="cb419-3211"><a href="#cb419-3211" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"role_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-3212"><a href="#cb419-3212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(role_type)) <span class="sc">%&gt;%</span>  <span class="co"># Remove NA values</span></span>
<span id="cb419-3213"><a href="#cb419-3213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-3214"><a href="#cb419-3214" aria-hidden="true" tabindex="-1"></a>    <span class="at">role_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-3215"><a href="#cb419-3215" aria-hidden="true" tabindex="-1"></a>      role_type <span class="sc">==</span> <span class="st">"Performer"</span> <span class="sc">~</span> <span class="st">"Performer"</span>,</span>
<span id="cb419-3216"><a href="#cb419-3216" aria-hidden="true" tabindex="-1"></a>      role_type <span class="sc">==</span> <span class="st">"I play for leisure"</span> <span class="sc">~</span> <span class="st">"Amateur player"</span>,</span>
<span id="cb419-3217"><a href="#cb419-3217" aria-hidden="true" tabindex="-1"></a>      role_type <span class="sc">==</span> <span class="st">"Student"</span> <span class="sc">~</span> <span class="st">"Student"</span>,</span>
<span id="cb419-3218"><a href="#cb419-3218" aria-hidden="true" tabindex="-1"></a>      role_type <span class="sc">==</span> <span class="st">"Teacher"</span> <span class="sc">~</span> <span class="st">"Teacher"</span>,</span>
<span id="cb419-3219"><a href="#cb419-3219" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(role_type)</span>
<span id="cb419-3220"><a href="#cb419-3220" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-3221"><a href="#cb419-3221" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-3222"><a href="#cb419-3222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3223"><a href="#cb419-3223" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table for chi-square test</span></span>
<span id="cb419-3224"><a href="#cb419-3224" aria-hidden="true" tabindex="-1"></a>role_table <span class="ot">&lt;-</span> <span class="fu">table</span>(role_data<span class="sc">$</span>role_type)</span>
<span id="cb419-3225"><a href="#cb419-3225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3226"><a href="#cb419-3226" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test</span></span>
<span id="cb419-3227"><a href="#cb419-3227" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(role_table)</span>
<span id="cb419-3228"><a href="#cb419-3228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3229"><a href="#cb419-3229" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cramer's V manually</span></span>
<span id="cb419-3230"><a href="#cb419-3230" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(role_table)</span>
<span id="cb419-3231"><a href="#cb419-3231" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">length</span>(role_table) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb419-3232"><a href="#cb419-3232" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n <span class="sc">*</span> df))</span>
<span id="cb419-3233"><a href="#cb419-3233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3234"><a href="#cb419-3234" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb419-3235"><a href="#cb419-3235" aria-hidden="true" tabindex="-1"></a>role_summary <span class="ot">&lt;-</span> role_data <span class="sc">%&gt;%</span></span>
<span id="cb419-3236"><a href="#cb419-3236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(role_type) <span class="sc">%&gt;%</span></span>
<span id="cb419-3237"><a href="#cb419-3237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-3238"><a href="#cb419-3238" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb419-3239"><a href="#cb419-3239" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb419-3240"><a href="#cb419-3240" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-3241"><a href="#cb419-3241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-3242"><a href="#cb419-3242" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-3243"><a href="#cb419-3243" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_prop =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> <span class="fu">sum</span>(count)), <span class="co"># Standard error</span></span>
<span id="cb419-3244"><a href="#cb419-3244" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower =</span> percentage <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se_prop),  <span class="co"># 95% CI lower bound</span></span>
<span id="cb419-3245"><a href="#cb419-3245" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper =</span> percentage <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se_prop)   <span class="co"># 95% CI upper bound</span></span>
<span id="cb419-3246"><a href="#cb419-3246" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-3247"><a href="#cb419-3247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb419-3248"><a href="#cb419-3248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3249"><a href="#cb419-3249" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb419-3250"><a href="#cb419-3250" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of Roles Among Wind Instrument Musicians"</span></span>
<span id="cb419-3251"><a href="#cb419-3251" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(role_summary, </span>
<span id="cb419-3252"><a href="#cb419-3252" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> percentage, </span>
<span id="cb419-3253"><a href="#cb419-3253" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">reorder</span>(<span class="fu">paste0</span>(role_type, <span class="st">"</span><span class="sc">\n</span><span class="st">(N="</span>, count, <span class="st">")"</span>), percentage))) <span class="sc">+</span></span>
<span id="cb419-3254"><a href="#cb419-3254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb419-3255"><a href="#cb419-3255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper), <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb419-3256"><a href="#cb419-3256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb419-3257"><a href="#cb419-3257" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage), </span>
<span id="cb419-3258"><a href="#cb419-3258" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> ci_upper),  <span class="co"># Position labels at the end of error bars</span></span>
<span id="cb419-3259"><a href="#cb419-3259" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>,  <span class="co"># Slight additional offset</span></span>
<span id="cb419-3260"><a href="#cb419-3260" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb419-3261"><a href="#cb419-3261" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-3262"><a href="#cb419-3262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-3263"><a href="#cb419-3263" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> plot_title,</span>
<span id="cb419-3264"><a href="#cb419-3264" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Percentage of Respondents"</span>,</span>
<span id="cb419-3265"><a href="#cb419-3265" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Role (with Total N)"</span>,</span>
<span id="cb419-3266"><a href="#cb419-3266" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span></span>
<span id="cb419-3267"><a href="#cb419-3267" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-3268"><a href="#cb419-3268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-3269"><a href="#cb419-3269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-3270"><a href="#cb419-3270" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb419-3271"><a href="#cb419-3271" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb419-3272"><a href="#cb419-3272" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb419-3273"><a href="#cb419-3273" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-3274"><a href="#cb419-3274" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb419-3275"><a href="#cb419-3275" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-3276"><a href="#cb419-3276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb419-3277"><a href="#cb419-3277" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(role_summary<span class="sc">$</span>ci_upper) <span class="sc">*</span> <span class="fl">1.2</span>),  <span class="co"># Extend x-axis to accommodate labels</span></span>
<span id="cb419-3278"><a href="#cb419-3278" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>)  <span class="co"># Convert to percentage</span></span>
<span id="cb419-3279"><a href="#cb419-3279" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-3280"><a href="#cb419-3280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3281"><a href="#cb419-3281" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical analysis results</span></span>
<span id="cb419-3282"><a href="#cb419-3282" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-3283"><a href="#cb419-3283" aria-hidden="true" tabindex="-1"></a><span class="st">Statistical Analysis of Role Distribution\</span></span>
<span id="cb419-3284"><a href="#cb419-3284" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-3285"><a href="#cb419-3285" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==========================================\</span></span>
<span id="cb419-3286"><a href="#cb419-3286" aria-hidden="true" tabindex="-1"></a><span class="st">\</span></span>
<span id="cb419-3287"><a href="#cb419-3287" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-3288"><a href="#cb419-3288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3289"><a href="#cb419-3289" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. Frequency Distribution:\</span></span>
<span id="cb419-3290"><a href="#cb419-3290" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-3291"><a href="#cb419-3291" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(role_summary)</span>
<span id="cb419-3292"><a href="#cb419-3292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3293"><a href="#cb419-3293" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-3294"><a href="#cb419-3294" aria-hidden="true" tabindex="-1"></a><span class="st">2. Chi-square Test of Equal Proportions:\</span></span>
<span id="cb419-3295"><a href="#cb419-3295" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-3296"><a href="#cb419-3296" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-3297"><a href="#cb419-3297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3298"><a href="#cb419-3298" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-3299"><a href="#cb419-3299" aria-hidden="true" tabindex="-1"></a><span class="st">3. Effect Size:\</span></span>
<span id="cb419-3300"><a href="#cb419-3300" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-3301"><a href="#cb419-3301" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cramer's V:"</span>, cramer_v, <span class="st">"\</span></span>
<span id="cb419-3302"><a href="#cb419-3302" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-3303"><a href="#cb419-3303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3304"><a href="#cb419-3304" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate post-hoc pairwise comparisons with Bonferroni correction</span></span>
<span id="cb419-3305"><a href="#cb419-3305" aria-hidden="true" tabindex="-1"></a>roles <span class="ot">&lt;-</span> <span class="fu">unique</span>(role_data<span class="sc">$</span>role_type)</span>
<span id="cb419-3306"><a href="#cb419-3306" aria-hidden="true" tabindex="-1"></a>n_comparisons <span class="ot">&lt;-</span> <span class="fu">choose</span>(<span class="fu">length</span>(roles), <span class="dv">2</span>)</span>
<span id="cb419-3307"><a href="#cb419-3307" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-3308"><a href="#cb419-3308" aria-hidden="true" tabindex="-1"></a><span class="st">4. Post-hoc Pairwise Comparisons (Bonferroni-corrected):\</span></span>
<span id="cb419-3309"><a href="#cb419-3309" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-3310"><a href="#cb419-3310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3311"><a href="#cb419-3311" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-3312"><a href="#cb419-3312" aria-hidden="true" tabindex="-1"></a>  <span class="at">Comparison =</span> <span class="fu">character</span>(),</span>
<span id="cb419-3313"><a href="#cb419-3313" aria-hidden="true" tabindex="-1"></a>  <span class="at">Chi_square =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-3314"><a href="#cb419-3314" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb419-3315"><a href="#cb419-3315" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb419-3316"><a href="#cb419-3316" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-3317"><a href="#cb419-3317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3318"><a href="#cb419-3318" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(roles)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb419-3319"><a href="#cb419-3319" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(roles)) {</span>
<span id="cb419-3320"><a href="#cb419-3320" aria-hidden="true" tabindex="-1"></a>    role1 <span class="ot">&lt;-</span> roles[i]</span>
<span id="cb419-3321"><a href="#cb419-3321" aria-hidden="true" tabindex="-1"></a>    role2 <span class="ot">&lt;-</span> roles[j]</span>
<span id="cb419-3322"><a href="#cb419-3322" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3323"><a href="#cb419-3323" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create 2x2 contingency table for this pair</span></span>
<span id="cb419-3324"><a href="#cb419-3324" aria-hidden="true" tabindex="-1"></a>    counts <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb419-3325"><a href="#cb419-3325" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(role_data<span class="sc">$</span>role_type <span class="sc">==</span> role1),</span>
<span id="cb419-3326"><a href="#cb419-3326" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(role_data<span class="sc">$</span>role_type <span class="sc">==</span> role2)</span>
<span id="cb419-3327"><a href="#cb419-3327" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-3328"><a href="#cb419-3328" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3329"><a href="#cb419-3329" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform chi-square test</span></span>
<span id="cb419-3330"><a href="#cb419-3330" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts)</span>
<span id="cb419-3331"><a href="#cb419-3331" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3332"><a href="#cb419-3332" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb419-3333"><a href="#cb419-3333" aria-hidden="true" tabindex="-1"></a>    pairwise_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_results, <span class="fu">data.frame</span>(</span>
<span id="cb419-3334"><a href="#cb419-3334" aria-hidden="true" tabindex="-1"></a>      <span class="at">Comparison =</span> <span class="fu">paste</span>(role1, <span class="st">"vs"</span>, role2),</span>
<span id="cb419-3335"><a href="#cb419-3335" aria-hidden="true" tabindex="-1"></a>      <span class="at">Chi_square =</span> test<span class="sc">$</span>statistic,</span>
<span id="cb419-3336"><a href="#cb419-3336" aria-hidden="true" tabindex="-1"></a>      <span class="at">P_value =</span> <span class="fu">p.adjust</span>(test<span class="sc">$</span>p.value, <span class="at">method =</span> <span class="st">"bonferroni"</span>, <span class="at">n =</span> n_comparisons)</span>
<span id="cb419-3337"><a href="#cb419-3337" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-3338"><a href="#cb419-3338" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-3339"><a href="#cb419-3339" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-3340"><a href="#cb419-3340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3341"><a href="#cb419-3341" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span>
<span id="cb419-3342"><a href="#cb419-3342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3343"><a href="#cb419-3343" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-3344"><a href="#cb419-3344" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb419-3345"><a href="#cb419-3345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3346"><a href="#cb419-3346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-3347"><a href="#cb419-3347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3348"><a href="#cb419-3348" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-3349"><a href="#cb419-3349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3350"><a href="#cb419-3350" aria-hidden="true" tabindex="-1"></a>Looking at the distribution of roles among wind instrumentalist participants (N=1558):</span>
<span id="cb419-3351"><a href="#cb419-3351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3352"><a href="#cb419-3352" aria-hidden="true" tabindex="-1"></a>• "I play for leisure" is the most common role with 970 responses (34.5% of total responses)</span>
<span id="cb419-3353"><a href="#cb419-3353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3354"><a href="#cb419-3354" aria-hidden="true" tabindex="-1"></a>• "Student" is the second most frequent with 746 responses (26.6%)</span>
<span id="cb419-3355"><a href="#cb419-3355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3356"><a href="#cb419-3356" aria-hidden="true" tabindex="-1"></a>• "Performer" follows with 562 responses (20.0%)</span>
<span id="cb419-3357"><a href="#cb419-3357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3358"><a href="#cb419-3358" aria-hidden="true" tabindex="-1"></a>• "Teacher" has the lowest frequency with 531 responses (18.9%)</span>
<span id="cb419-3359"><a href="#cb419-3359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3360"><a href="#cb419-3360" aria-hidden="true" tabindex="-1"></a>A key observation is that the total number of responses (2,809) exceeds the number of participants (1,558), indicating that many participants hold multiple roles (e.g., someone might be both a teacher and a performer). On average, this suggests that participants reported approximately 1.8 roles each (2,809/1,558).</span>
<span id="cb419-3361"><a href="#cb419-3361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3362"><a href="#cb419-3362" aria-hidden="true" tabindex="-1"></a>The data shows that while recreational playing is the predominant role, there's a substantial representation of professional and educational roles (teachers, performers, and students) in the sample.</span>
<span id="cb419-3363"><a href="#cb419-3363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3364"><a href="#cb419-3364" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Stats complex</span></span>
<span id="cb419-3365"><a href="#cb419-3365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3368"><a href="#cb419-3368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-3369"><a href="#cb419-3369" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Data Preparation Function</span></span>
<span id="cb419-3370"><a href="#cb419-3370" aria-hidden="true" tabindex="-1"></a>prepare_role_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path) {</span>
<span id="cb419-3371"><a href="#cb419-3371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb419-3372"><a href="#cb419-3372" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the data</span></span>
<span id="cb419-3373"><a href="#cb419-3373" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-3374"><a href="#cb419-3374" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3375"><a href="#cb419-3375" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure RMTMethods_YN is numeric and handle potential NA values</span></span>
<span id="cb419-3376"><a href="#cb419-3376" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-3377"><a href="#cb419-3377" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb419-3378"><a href="#cb419-3378" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">as.numeric</span>(RMTMethods_YN),</span>
<span id="cb419-3379"><a href="#cb419-3379" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(RMTMethods_YN), <span class="dv">0</span>, RMTMethods_YN)</span>
<span id="cb419-3380"><a href="#cb419-3380" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb419-3381"><a href="#cb419-3381" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3382"><a href="#cb419-3382" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Process the data with enhanced error handling</span></span>
<span id="cb419-3383"><a href="#cb419-3383" aria-hidden="true" tabindex="-1"></a>    role_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-3384"><a href="#cb419-3384" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(RMTMethods_YN, <span class="fu">starts_with</span>(<span class="st">"role_MAX"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb419-3385"><a href="#cb419-3385" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(</span>
<span id="cb419-3386"><a href="#cb419-3386" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"role_MAX"</span>), </span>
<span id="cb419-3387"><a href="#cb419-3387" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"role_number"</span>, </span>
<span id="cb419-3388"><a href="#cb419-3388" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"role_type"</span></span>
<span id="cb419-3389"><a href="#cb419-3389" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb419-3390"><a href="#cb419-3390" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(role_type)) <span class="sc">%&gt;%</span></span>
<span id="cb419-3391"><a href="#cb419-3391" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb419-3392"><a href="#cb419-3392" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Comprehensive role type mapping</span></span>
<span id="cb419-3393"><a href="#cb419-3393" aria-hidden="true" tabindex="-1"></a>        <span class="at">role_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-3394"><a href="#cb419-3394" aria-hidden="true" tabindex="-1"></a>          role_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Performer"</span>, <span class="st">"Professional"</span>) <span class="sc">~</span> <span class="st">"Professional Performer"</span>,</span>
<span id="cb419-3395"><a href="#cb419-3395" aria-hidden="true" tabindex="-1"></a>          role_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"I play for leisure"</span>, <span class="st">"Amateur"</span>) <span class="sc">~</span> <span class="st">"Amateur Performer"</span>,</span>
<span id="cb419-3396"><a href="#cb419-3396" aria-hidden="true" tabindex="-1"></a>          role_type <span class="sc">==</span> <span class="st">"Student"</span> <span class="sc">~</span> <span class="st">"Student"</span>,</span>
<span id="cb419-3397"><a href="#cb419-3397" aria-hidden="true" tabindex="-1"></a>          role_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Teacher"</span>, <span class="st">"Educator"</span>) <span class="sc">~</span> <span class="st">"Wind Instrument Teacher"</span>,</span>
<span id="cb419-3398"><a href="#cb419-3398" aria-hidden="true" tabindex="-1"></a>          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(role_type)</span>
<span id="cb419-3399"><a href="#cb419-3399" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb419-3400"><a href="#cb419-3400" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ensure RMTMethods_YN is properly coded</span></span>
<span id="cb419-3401"><a href="#cb419-3401" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">factor</span>(</span>
<span id="cb419-3402"><a href="#cb419-3402" aria-hidden="true" tabindex="-1"></a>          RMTMethods_YN, </span>
<span id="cb419-3403"><a href="#cb419-3403" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb419-3404"><a href="#cb419-3404" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No RMT"</span>, <span class="st">"RMT"</span>)</span>
<span id="cb419-3405"><a href="#cb419-3405" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb419-3406"><a href="#cb419-3406" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb419-3407"><a href="#cb419-3407" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3408"><a href="#cb419-3408" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(role_data)</span>
<span id="cb419-3409"><a href="#cb419-3409" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb419-3410"><a href="#cb419-3410" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error in data preparation:"</span>, e<span class="sc">$</span>message))</span>
<span id="cb419-3411"><a href="#cb419-3411" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb419-3412"><a href="#cb419-3412" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-3413"><a href="#cb419-3413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3414"><a href="#cb419-3414" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprehensive Role Distribution Analysis</span></span>
<span id="cb419-3415"><a href="#cb419-3415" aria-hidden="true" tabindex="-1"></a>analyze_role_distribution <span class="ot">&lt;-</span> <span class="cf">function</span>(role_data) {</span>
<span id="cb419-3416"><a href="#cb419-3416" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Comprehensive summary statistics</span></span>
<span id="cb419-3417"><a href="#cb419-3417" aria-hidden="true" tabindex="-1"></a>  role_summary <span class="ot">&lt;-</span> role_data <span class="sc">%&gt;%</span></span>
<span id="cb419-3418"><a href="#cb419-3418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN, role_type) <span class="sc">%&gt;%</span></span>
<span id="cb419-3419"><a href="#cb419-3419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb419-3420"><a href="#cb419-3420" aria-hidden="true" tabindex="-1"></a>      <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb419-3421"><a href="#cb419-3421" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb419-3422"><a href="#cb419-3422" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb419-3423"><a href="#cb419-3423" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-3424"><a href="#cb419-3424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb419-3425"><a href="#cb419-3425" aria-hidden="true" tabindex="-1"></a>      <span class="at">total_in_group =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-3426"><a href="#cb419-3426" aria-hidden="true" tabindex="-1"></a>      <span class="at">percentage =</span> count <span class="sc">/</span> total_in_group <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-3427"><a href="#cb419-3427" aria-hidden="true" tabindex="-1"></a>      <span class="at">se_prop =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> total_in_group),</span>
<span id="cb419-3428"><a href="#cb419-3428" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_lower =</span> <span class="fu">pmax</span>(<span class="dv">0</span>, percentage <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se_prop)),</span>
<span id="cb419-3429"><a href="#cb419-3429" aria-hidden="true" tabindex="-1"></a>      <span class="at">ci_upper =</span> <span class="fu">pmin</span>(<span class="dv">100</span>, percentage <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se_prop))</span>
<span id="cb419-3430"><a href="#cb419-3430" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb419-3431"><a href="#cb419-3431" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb419-3432"><a href="#cb419-3432" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3433"><a href="#cb419-3433" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Statistical Testing</span></span>
<span id="cb419-3434"><a href="#cb419-3434" aria-hidden="true" tabindex="-1"></a>  test_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb419-3435"><a href="#cb419-3435" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(rmt <span class="cf">in</span> <span class="fu">unique</span>(role_data<span class="sc">$</span>RMTMethods_YN)) {</span>
<span id="cb419-3436"><a href="#cb419-3436" aria-hidden="true" tabindex="-1"></a>    subset_data <span class="ot">&lt;-</span> role_data[role_data<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> rmt, ]</span>
<span id="cb419-3437"><a href="#cb419-3437" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3438"><a href="#cb419-3438" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Contingency table</span></span>
<span id="cb419-3439"><a href="#cb419-3439" aria-hidden="true" tabindex="-1"></a>    role_table <span class="ot">&lt;-</span> <span class="fu">table</span>(subset_data<span class="sc">$</span>role_type)</span>
<span id="cb419-3440"><a href="#cb419-3440" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3441"><a href="#cb419-3441" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Chi-square test</span></span>
<span id="cb419-3442"><a href="#cb419-3442" aria-hidden="true" tabindex="-1"></a>    chi_test <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb419-3443"><a href="#cb419-3443" aria-hidden="true" tabindex="-1"></a>      <span class="fu">chisq.test</span>(role_table),</span>
<span id="cb419-3444"><a href="#cb419-3444" aria-hidden="true" tabindex="-1"></a>      <span class="at">warning =</span> <span class="cf">function</span>(w) <span class="fu">fisher.test</span>(role_table)</span>
<span id="cb419-3445"><a href="#cb419-3445" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-3446"><a href="#cb419-3446" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3447"><a href="#cb419-3447" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pairwise comparisons</span></span>
<span id="cb419-3448"><a href="#cb419-3448" aria-hidden="true" tabindex="-1"></a>    pairwise_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb419-3449"><a href="#cb419-3449" aria-hidden="true" tabindex="-1"></a>    roles <span class="ot">&lt;-</span> <span class="fu">unique</span>(subset_data<span class="sc">$</span>role_type)</span>
<span id="cb419-3450"><a href="#cb419-3450" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3451"><a href="#cb419-3451" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(roles) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb419-3452"><a href="#cb419-3452" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(roles)<span class="sc">-</span><span class="dv">1</span>)) {</span>
<span id="cb419-3453"><a href="#cb419-3453" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(roles)) {</span>
<span id="cb419-3454"><a href="#cb419-3454" aria-hidden="true" tabindex="-1"></a>          role1 <span class="ot">&lt;-</span> roles[i]</span>
<span id="cb419-3455"><a href="#cb419-3455" aria-hidden="true" tabindex="-1"></a>          role2 <span class="ot">&lt;-</span> roles[j]</span>
<span id="cb419-3456"><a href="#cb419-3456" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb419-3457"><a href="#cb419-3457" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Compare proportions of two roles</span></span>
<span id="cb419-3458"><a href="#cb419-3458" aria-hidden="true" tabindex="-1"></a>          counts1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(subset_data<span class="sc">$</span>role_type <span class="sc">==</span> role1)</span>
<span id="cb419-3459"><a href="#cb419-3459" aria-hidden="true" tabindex="-1"></a>          counts2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(subset_data<span class="sc">$</span>role_type <span class="sc">==</span> role2)</span>
<span id="cb419-3460"><a href="#cb419-3460" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb419-3461"><a href="#cb419-3461" aria-hidden="true" tabindex="-1"></a>          test <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(counts1, counts2), </span>
<span id="cb419-3462"><a href="#cb419-3462" aria-hidden="true" tabindex="-1"></a>                            <span class="at">n =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(subset_data), <span class="fu">nrow</span>(subset_data)))</span>
<span id="cb419-3463"><a href="#cb419-3463" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb419-3464"><a href="#cb419-3464" aria-hidden="true" tabindex="-1"></a>          pairwise_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pairwise_results, <span class="fu">data.frame</span>(</span>
<span id="cb419-3465"><a href="#cb419-3465" aria-hidden="true" tabindex="-1"></a>            <span class="at">comparison =</span> <span class="fu">paste</span>(role1, <span class="st">"vs"</span>, role2),</span>
<span id="cb419-3466"><a href="#cb419-3466" aria-hidden="true" tabindex="-1"></a>            <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb419-3467"><a href="#cb419-3467" aria-hidden="true" tabindex="-1"></a>            <span class="at">statistic =</span> test<span class="sc">$</span>statistic</span>
<span id="cb419-3468"><a href="#cb419-3468" aria-hidden="true" tabindex="-1"></a>          ))</span>
<span id="cb419-3469"><a href="#cb419-3469" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb419-3470"><a href="#cb419-3470" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb419-3471"><a href="#cb419-3471" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-3472"><a href="#cb419-3472" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Apply Bonferroni correction</span></span>
<span id="cb419-3473"><a href="#cb419-3473" aria-hidden="true" tabindex="-1"></a>      pairwise_results<span class="sc">$</span>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(</span>
<span id="cb419-3474"><a href="#cb419-3474" aria-hidden="true" tabindex="-1"></a>        pairwise_results<span class="sc">$</span>p_value, </span>
<span id="cb419-3475"><a href="#cb419-3475" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb419-3476"><a href="#cb419-3476" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb419-3477"><a href="#cb419-3477" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-3478"><a href="#cb419-3478" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3479"><a href="#cb419-3479" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store results</span></span>
<span id="cb419-3480"><a href="#cb419-3480" aria-hidden="true" tabindex="-1"></a>    test_results[[<span class="fu">as.character</span>(rmt)]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb419-3481"><a href="#cb419-3481" aria-hidden="true" tabindex="-1"></a>      <span class="at">chi_test =</span> chi_test,</span>
<span id="cb419-3482"><a href="#cb419-3482" aria-hidden="true" tabindex="-1"></a>      <span class="at">pairwise_results =</span> pairwise_results</span>
<span id="cb419-3483"><a href="#cb419-3483" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-3484"><a href="#cb419-3484" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-3485"><a href="#cb419-3485" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3486"><a href="#cb419-3486" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return comprehensive results</span></span>
<span id="cb419-3487"><a href="#cb419-3487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb419-3488"><a href="#cb419-3488" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary =</span> role_summary,</span>
<span id="cb419-3489"><a href="#cb419-3489" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_results =</span> test_results</span>
<span id="cb419-3490"><a href="#cb419-3490" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-3491"><a href="#cb419-3491" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-3492"><a href="#cb419-3492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3493"><a href="#cb419-3493" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization Function</span></span>
<span id="cb419-3494"><a href="#cb419-3494" aria-hidden="true" tabindex="-1"></a>create_role_distribution_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(analysis_results) {</span>
<span id="cb419-3495"><a href="#cb419-3495" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare plot data</span></span>
<span id="cb419-3496"><a href="#cb419-3496" aria-hidden="true" tabindex="-1"></a>  role_summary <span class="ot">&lt;-</span> analysis_results<span class="sc">$</span>summary</span>
<span id="cb419-3497"><a href="#cb419-3497" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3498"><a href="#cb419-3498" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create labels for RMTMethods_YN with total N</span></span>
<span id="cb419-3499"><a href="#cb419-3499" aria-hidden="true" tabindex="-1"></a>  rmt_labels <span class="ot">&lt;-</span> role_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-3500"><a href="#cb419-3500" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-3501"><a href="#cb419-3501" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total_n =</span> <span class="fu">first</span>(total_in_group)) <span class="sc">%&gt;%</span></span>
<span id="cb419-3502"><a href="#cb419-3502" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(RMTMethods_YN, <span class="st">" (N="</span>, total_n, <span class="st">")"</span>))</span>
<span id="cb419-3503"><a href="#cb419-3503" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3504"><a href="#cb419-3504" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate maximum confidence interval for x-axis limits</span></span>
<span id="cb419-3505"><a href="#cb419-3505" aria-hidden="true" tabindex="-1"></a>  max_ci_upper <span class="ot">&lt;-</span> <span class="fu">max</span>(role_summary<span class="sc">$</span>ci_upper)</span>
<span id="cb419-3506"><a href="#cb419-3506" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3507"><a href="#cb419-3507" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the plot</span></span>
<span id="cb419-3508"><a href="#cb419-3508" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(role_summary, </span>
<span id="cb419-3509"><a href="#cb419-3509" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> percentage, </span>
<span id="cb419-3510"><a href="#cb419-3510" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">reorder</span>(role_type, percentage),</span>
<span id="cb419-3511"><a href="#cb419-3511" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="fu">factor</span>(RMTMethods_YN))) <span class="sc">+</span></span>
<span id="cb419-3512"><a href="#cb419-3512" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb419-3513"><a href="#cb419-3513" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>(</span>
<span id="cb419-3514"><a href="#cb419-3514" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper), </span>
<span id="cb419-3515"><a href="#cb419-3515" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-3516"><a href="#cb419-3516" aria-hidden="true" tabindex="-1"></a>      <span class="at">height =</span> <span class="fl">0.2</span></span>
<span id="cb419-3517"><a href="#cb419-3517" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-3518"><a href="#cb419-3518" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb419-3519"><a href="#cb419-3519" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(</span>
<span id="cb419-3520"><a href="#cb419-3520" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"n=%d (%.1f%%)"</span>, </span>
<span id="cb419-3521"><a href="#cb419-3521" aria-hidden="true" tabindex="-1"></a>                        count, </span>
<span id="cb419-3522"><a href="#cb419-3522" aria-hidden="true" tabindex="-1"></a>                        percentage),</span>
<span id="cb419-3523"><a href="#cb419-3523" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> ci_upper</span>
<span id="cb419-3524"><a href="#cb419-3524" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb419-3525"><a href="#cb419-3525" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-3526"><a href="#cb419-3526" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>,  <span class="co"># Increased spacing</span></span>
<span id="cb419-3527"><a href="#cb419-3527" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb419-3528"><a href="#cb419-3528" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-3529"><a href="#cb419-3529" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb419-3530"><a href="#cb419-3530" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Distribution of Roles Among Wind Instrument Musicians by RMT Methods Use"</span>,</span>
<span id="cb419-3531"><a href="#cb419-3531" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Percentage within RMT Methods Group"</span>,</span>
<span id="cb419-3532"><a href="#cb419-3532" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Role"</span>,</span>
<span id="cb419-3533"><a href="#cb419-3533" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"RMT Methods Use"</span>,</span>
<span id="cb419-3534"><a href="#cb419-3534" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span></span>
<span id="cb419-3535"><a href="#cb419-3535" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-3536"><a href="#cb419-3536" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-3537"><a href="#cb419-3537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb419-3538"><a href="#cb419-3538" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb419-3539"><a href="#cb419-3539" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb419-3540"><a href="#cb419-3540" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb419-3541"><a href="#cb419-3541" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-3542"><a href="#cb419-3542" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-3543"><a href="#cb419-3543" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb419-3544"><a href="#cb419-3544" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-3545"><a href="#cb419-3545" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(</span>
<span id="cb419-3546"><a href="#cb419-3546" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="st">"Set2"</span>,</span>
<span id="cb419-3547"><a href="#cb419-3547" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> rmt_labels<span class="sc">$</span>label</span>
<span id="cb419-3548"><a href="#cb419-3548" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-3549"><a href="#cb419-3549" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(</span>
<span id="cb419-3550"><a href="#cb419-3550" aria-hidden="true" tabindex="-1"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_ci_upper <span class="sc">*</span> <span class="fl">1.3</span>),  <span class="co"># Increased space for labels</span></span>
<span id="cb419-3551"><a href="#cb419-3551" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb419-3552"><a href="#cb419-3552" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-3553"><a href="#cb419-3553" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3554"><a href="#cb419-3554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb419-3555"><a href="#cb419-3555" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-3556"><a href="#cb419-3556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3557"><a href="#cb419-3557" aria-hidden="true" tabindex="-1"></a><span class="co"># Main Execution Function</span></span>
<span id="cb419-3558"><a href="#cb419-3558" aria-hidden="true" tabindex="-1"></a>run_comprehensive_role_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb419-3559"><a href="#cb419-3559" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_path =</span> <span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span></span>
<span id="cb419-3560"><a href="#cb419-3560" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb419-3561"><a href="#cb419-3561" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb419-3562"><a href="#cb419-3562" aria-hidden="true" tabindex="-1"></a>  role_data <span class="ot">&lt;-</span> <span class="fu">prepare_role_data</span>(file_path)</span>
<span id="cb419-3563"><a href="#cb419-3563" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3564"><a href="#cb419-3564" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform comprehensive analysis</span></span>
<span id="cb419-3565"><a href="#cb419-3565" aria-hidden="true" tabindex="-1"></a>  analysis_results <span class="ot">&lt;-</span> <span class="fu">analyze_role_distribution</span>(role_data)</span>
<span id="cb419-3566"><a href="#cb419-3566" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3567"><a href="#cb419-3567" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create visualization</span></span>
<span id="cb419-3568"><a href="#cb419-3568" aria-hidden="true" tabindex="-1"></a>  role_plot <span class="ot">&lt;-</span> <span class="fu">create_role_distribution_plot</span>(analysis_results)</span>
<span id="cb419-3569"><a href="#cb419-3569" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3570"><a href="#cb419-3570" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print comprehensive results</span></span>
<span id="cb419-3571"><a href="#cb419-3571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Comprehensive Role Distribution Analysis</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3572"><a href="#cb419-3572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=======================================</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb419-3573"><a href="#cb419-3573" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3574"><a href="#cb419-3574" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Print overall distribution summary</span></span>
<span id="cb419-3575"><a href="#cb419-3575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"1. Distribution by RMT Methods Use and Role:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3576"><a href="#cb419-3576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analysis_results<span class="sc">$</span>summary)</span>
<span id="cb419-3577"><a href="#cb419-3577" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3578"><a href="#cb419-3578" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2. Print test results for each RMT group</span></span>
<span id="cb419-3579"><a href="#cb419-3579" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(rmt <span class="cf">in</span> <span class="fu">names</span>(analysis_results<span class="sc">$</span>test_results)) {</span>
<span id="cb419-3580"><a href="#cb419-3580" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">2. Statistical Analysis for %s Group:</span><span class="sc">\n</span><span class="st">"</span>, rmt))</span>
<span id="cb419-3581"><a href="#cb419-3581" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3582"><a href="#cb419-3582" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Chi-square/Fisher test results</span></span>
<span id="cb419-3583"><a href="#cb419-3583" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Chi-square/Fisher Test:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3584"><a href="#cb419-3584" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(analysis_results<span class="sc">$</span>test_results[[rmt]]<span class="sc">$</span>chi_test)</span>
<span id="cb419-3585"><a href="#cb419-3585" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-3586"><a href="#cb419-3586" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pairwise comparisons</span></span>
<span id="cb419-3587"><a href="#cb419-3587" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise Comparisons (Bonferroni-corrected):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3588"><a href="#cb419-3588" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(analysis_results<span class="sc">$</span>test_results[[rmt]]<span class="sc">$</span>pairwise_results)</span>
<span id="cb419-3589"><a href="#cb419-3589" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-3590"><a href="#cb419-3590" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3591"><a href="#cb419-3591" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the plot</span></span>
<span id="cb419-3592"><a href="#cb419-3592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(role_plot)</span>
<span id="cb419-3593"><a href="#cb419-3593" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-3594"><a href="#cb419-3594" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return full results for potential further analysis</span></span>
<span id="cb419-3595"><a href="#cb419-3595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(analysis_results)</span>
<span id="cb419-3596"><a href="#cb419-3596" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-3597"><a href="#cb419-3597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3598"><a href="#cb419-3598" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the analysis</span></span>
<span id="cb419-3599"><a href="#cb419-3599" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_comprehensive_role_analysis</span>()</span>
<span id="cb419-3600"><a href="#cb419-3600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-3601"><a href="#cb419-3601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3602"><a href="#cb419-3602" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-3603"><a href="#cb419-3603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3604"><a href="#cb419-3604" aria-hidden="true" tabindex="-1"></a>Chi-square tests, effect sizes, and post-hoc comparisons are printed for each RMTMethods_YN group (output for group 0 and 1 are shown in <span class="sc">\`</span></span>
<span id="cb419-3605"><a href="#cb419-3605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3606"><a href="#cb419-3606" aria-hidden="true" tabindex="-1"></a>**Chi-square Test for RMT Methods = 0:**</span>
<span id="cb419-3607"><a href="#cb419-3607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3608"><a href="#cb419-3608" aria-hidden="true" tabindex="-1"></a>Chi-squared test for given probabilities</span>
<span id="cb419-3609"><a href="#cb419-3609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3610"><a href="#cb419-3610" aria-hidden="true" tabindex="-1"></a>data: role_table X-squared = 173.96, df = 3, p-value <span class="sc">\&lt;</span> 2.2e-16</span>
<span id="cb419-3611"><a href="#cb419-3611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3612"><a href="#cb419-3612" aria-hidden="true" tabindex="-1"></a>Cramer's V: 0.1567</span>
<span id="cb419-3613"><a href="#cb419-3613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3614"><a href="#cb419-3614" aria-hidden="true" tabindex="-1"></a>Post-hoc Pairwise Comparisons (Bonferroni-corrected):</span>
<span id="cb419-3615"><a href="#cb419-3615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3616"><a href="#cb419-3616" aria-hidden="true" tabindex="-1"></a>Amateur Performer vs Music Teacher: Chi-square = 69.07, p = 0.0000 Amateur Performer vs Professional Performer: Chi-square = 11.57, p = 0.0040 Amateur Performer vs Student: Chi-square = 35.10, p = 0.0000 Music Teacher vs Professional Performer: Chi-square = 134.89, p = 0.0000 Music Teacher vs Student: Chi-square = 5.90, p = 0.0906 Professional Performer vs Student: Chi-square = 85.98, p = 0.0000</span>
<span id="cb419-3617"><a href="#cb419-3617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3618"><a href="#cb419-3618" aria-hidden="true" tabindex="-1"></a>*Chi-square Test for RMT Methods = 1:* Chi-squared test for given probabilities data: role_table X-squared = 46.839, df = 3, p-value = 3.76e-10 Cramer's V: 0.1867 Post-hoc Pairwise Comparisons (Bonferroni-corrected): Amateur Performer vs Music Teacher: Chi-square = 16.99, p = 0.0002 Amateur Performer vs Professional Performer: Chi-square = 37.12, p = 0.0000 Amateur Performer vs Student: Chi-square = 1.84, p = 1.0000 Music Teacher vs Professional Performer: Chi-square = 4.21, p = 0.2412 Music Teacher vs Student: Chi-square = 7.82, p = 0.0310 Professional Performer vs Student: Chi-square = 23.10, p = 0.0000 <span class="sc">\`</span>).</span>
<span id="cb419-3619"><a href="#cb419-3619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3620"><a href="#cb419-3620" aria-hidden="true" tabindex="-1"></a>**Key Findings**</span>
<span id="cb419-3621"><a href="#cb419-3621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3622"><a href="#cb419-3622" aria-hidden="true" tabindex="-1"></a>*Within-Group Percentages:*</span>
<span id="cb419-3623"><a href="#cb419-3623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3624"><a href="#cb419-3624" aria-hidden="true" tabindex="-1"></a>• For each subgroup defined by RMTMethods_YN (e.g., "0" or "1"), the analysis calculates the percentage share of each role. This is done by taking the count of respondents in each role within that group, dividing it by the total number of responses in the group, and then multiplying by 100.</span>
<span id="cb419-3625"><a href="#cb419-3625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3626"><a href="#cb419-3626" aria-hidden="true" tabindex="-1"></a>• The analysis also provides 95% confidence intervals around these percentage estimates (using standard errors).</span>
<span id="cb419-3627"><a href="#cb419-3627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3628"><a href="#cb419-3628" aria-hidden="true" tabindex="-1"></a>*Visualization Enhancements:*</span>
<span id="cb419-3629"><a href="#cb419-3629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3630"><a href="#cb419-3630" aria-hidden="true" tabindex="-1"></a>• The bar plot displays:</span>
<span id="cb419-3631"><a href="#cb419-3631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3632"><a href="#cb419-3632" aria-hidden="true" tabindex="-1"></a>• The role names (with the raw count given in parentheses) on the vertical axis.</span>
<span id="cb419-3633"><a href="#cb419-3633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3634"><a href="#cb419-3634" aria-hidden="true" tabindex="-1"></a>• The x-axis shows the percentage of respondents relative to each RMTMethods_YN subgroup.</span>
<span id="cb419-3635"><a href="#cb419-3635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3636"><a href="#cb419-3636" aria-hidden="true" tabindex="-1"></a>• The bars are colored by the RMTMethods_YN groups, and the legend labels include the total number (e.g., "0 (N=2361)" and "1 (N=448)").</span>
<span id="cb419-3637"><a href="#cb419-3637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3638"><a href="#cb419-3638" aria-hidden="true" tabindex="-1"></a>• Horizontal error bars indicate the 95% confidence interval for each percentage estimate, which aids in assessing the variability and uncertainty in the estimates.</span>
<span id="cb419-3639"><a href="#cb419-3639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3640"><a href="#cb419-3640" aria-hidden="true" tabindex="-1"></a>**Statistical Testing Per Group:**</span>
<span id="cb419-3641"><a href="#cb419-3641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3642"><a href="#cb419-3642" aria-hidden="true" tabindex="-1"></a>*Chi-square Tests:*</span>
<span id="cb419-3643"><a href="#cb419-3643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3644"><a href="#cb419-3644" aria-hidden="true" tabindex="-1"></a>For each RMTMethods_YN group independently, a chi-square test of equal proportions among the roles was conducted. The highly significant p-values (p <span class="sc">\&lt;</span> 0.001 for both groups) indicate that the role distribution is not uniform within each subgroup.</span>
<span id="cb419-3645"><a href="#cb419-3645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3646"><a href="#cb419-3646" aria-hidden="true" tabindex="-1"></a>*Effect Sizes (Cramer’s V):*</span>
<span id="cb419-3647"><a href="#cb419-3647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3648"><a href="#cb419-3648" aria-hidden="true" tabindex="-1"></a>The magnitude of the effect sizes (Cramer's V) for each group suggests small to moderate associations between the role distribution and the subgroup classification.</span>
<span id="cb419-3649"><a href="#cb419-3649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3650"><a href="#cb419-3650" aria-hidden="true" tabindex="-1"></a>*Post-hoc Pairwise Comparisons:*</span>
<span id="cb419-3651"><a href="#cb419-3651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3652"><a href="#cb419-3652" aria-hidden="true" tabindex="-1"></a>For each RMTMethods_YN group, pairwise comparisons among roles were performed with Bonferroni correction.</span>
<span id="cb419-3653"><a href="#cb419-3653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3654"><a href="#cb419-3654" aria-hidden="true" tabindex="-1"></a>• In one group (labeled “0”), nearly every pair of roles reveals a statistically significant difference in their proportions.</span>
<span id="cb419-3655"><a href="#cb419-3655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3656"><a href="#cb419-3656" aria-hidden="true" tabindex="-1"></a>• In the other subgroup (“1”), some comparisons reached significance while others did not, suggesting that in that smaller group the differences between certain roles (for example, between Student and Amateur Performer) may not be as pronounced.</span>
<span id="cb419-3657"><a href="#cb419-3657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3658"><a href="#cb419-3658" aria-hidden="true" tabindex="-1"></a>**Subgroup Differences:**</span>
<span id="cb419-3659"><a href="#cb419-3659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3660"><a href="#cb419-3660" aria-hidden="true" tabindex="-1"></a>• The inclusion of RMTMethods_YN as a grouping variable allows us to investigate whether the distributions of roles differ by this characteristic. For example, one subgroup (e.g., those might indicate non-use versus use of certain RMT methods) appears to have higher or lower relative participation for each role.</span>
<span id="cb419-3661"><a href="#cb419-3661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3662"><a href="#cb419-3662" aria-hidden="true" tabindex="-1"></a>• The provided legend (with appended total NN) makes it easy to understand the relative sample sizes. For instance, one category has a considerably larger total number of respondents compared to the other, which should be taken into account when interpreting the percentages and significance tests.</span>
<span id="cb419-3663"><a href="#cb419-3663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3664"><a href="#cb419-3664" aria-hidden="true" tabindex="-1"></a>**Practical Implications**</span>
<span id="cb419-3665"><a href="#cb419-3665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3666"><a href="#cb419-3666" aria-hidden="true" tabindex="-1"></a>*Targeted Interventions or Further Study:*</span>
<span id="cb419-3667"><a href="#cb419-3667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3668"><a href="#cb419-3668" aria-hidden="true" tabindex="-1"></a>The differences in role distributions within each RMTMethods_YN group suggest that some professional roles may be more prevalent in one subgroup than the other. This could guide efforts to target or support certain roles specifically within the context of RMT methods.</span>
<span id="cb419-3669"><a href="#cb419-3669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3670"><a href="#cb419-3670" aria-hidden="true" tabindex="-1"></a>*Understanding Representation:* Examining percentages within each subgroup provides additional insight over the overall distribution, as it controls for differences in subgroup sample sizes. For instance, if one is interested in how many of the respondents who use RMT methods (or vice versa) fall into each role, these within-group percentages are more informative than the overall percentages.</span>
<span id="cb419-3671"><a href="#cb419-3671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3672"><a href="#cb419-3672" aria-hidden="true" tabindex="-1"></a>*Statistical Robustness:* The chi-square tests and post-hoc pairwise comparisons lend statistical support to the conclusion that the distribution of roles is genuinely different than what would be expected if roles were uniformly distributed within each subgroup. This reinforces the reliability of the insights drawn from the data.</span>
<span id="cb419-3673"><a href="#cb419-3673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3674"><a href="#cb419-3674" aria-hidden="true" tabindex="-1"></a>**Visualization Features**</span>
<span id="cb419-3675"><a href="#cb419-3675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3676"><a href="#cb419-3676" aria-hidden="true" tabindex="-1"></a>*Bar Plot:*</span>
<span id="cb419-3677"><a href="#cb419-3677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3678"><a href="#cb419-3678" aria-hidden="true" tabindex="-1"></a>The final plot visualizes the percentage of each role within the two RMTMethods_YN subgroups. Each bar is labeled with both the role name and the corresponding count. The error bars (showing the 95% confidence intervals) help gauge the precision of these percentages.</span>
<span id="cb419-3679"><a href="#cb419-3679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3680"><a href="#cb419-3680" aria-hidden="true" tabindex="-1"></a>*Legend Labels with Total NN:* By including the total number of respondents for each subgroup within the legend, the viewer can easily see the sizes of the groups. This is particularly useful if the subgroups are highly unequal in size, as is evident here (with one subgroup having roughly 2361 responses and the other 448).</span>
<span id="cb419-3681"><a href="#cb419-3681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3682"><a href="#cb419-3682" aria-hidden="true" tabindex="-1"></a>**Summary**</span>
<span id="cb419-3683"><a href="#cb419-3683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3684"><a href="#cb419-3684" aria-hidden="true" tabindex="-1"></a>In summary, the analysis demonstrates that the distribution of roles among wind instrument musicians differs significantly when examined within each RMTMethods_YN subgroup. The detailed statistical testing supports that these differences are not due to chance, and the corresponding visualization clearly displays the varying distributions along with confidence intervals that highlight the variability. This type of analysis is valuable for understanding subgroup characteristics, informing targeted decisions, and laying the groundwork for further research into how RMT methods may relate to professional roles in music.</span>
<span id="cb419-3685"><a href="#cb419-3685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3686"><a href="#cb419-3686" aria-hidden="true" tabindex="-1"></a><span class="fu"># Education</span></span>
<span id="cb419-3687"><a href="#cb419-3687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3688"><a href="#cb419-3688" aria-hidden="true" tabindex="-1"></a><span class="fu">## Demographic Statistics</span></span>
<span id="cb419-3689"><a href="#cb419-3689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3692"><a href="#cb419-3692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-3693"><a href="#cb419-3693" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-3694"><a href="#cb419-3694" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-3695"><a href="#cb419-3695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3696"><a href="#cb419-3696" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Preparation</span></span>
<span id="cb419-3697"><a href="#cb419-3697" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the occurrences of each education category</span></span>
<span id="cb419-3698"><a href="#cb419-3698" aria-hidden="true" tabindex="-1"></a>education_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-3699"><a href="#cb419-3699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(ed) <span class="sc">%&gt;%</span></span>
<span id="cb419-3700"><a href="#cb419-3700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-3701"><a href="#cb419-3701" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,  <span class="co"># Calculate percentages</span></span>
<span id="cb419-3702"><a href="#cb419-3702" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>),  <span class="co"># Create labels</span></span>
<span id="cb419-3703"><a href="#cb419-3703" aria-hidden="true" tabindex="-1"></a>    <span class="at">expected =</span> <span class="fu">sum</span>(n) <span class="sc">/</span> <span class="fu">n</span>()  <span class="co"># Calculate expected frequencies for chi-square test</span></span>
<span id="cb419-3704"><a href="#cb419-3704" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-3705"><a href="#cb419-3705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3706"><a href="#cb419-3706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3707"><a href="#cb419-3707" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical Analysis</span></span>
<span id="cb419-3708"><a href="#cb419-3708" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square goodness of fit test</span></span>
<span id="cb419-3709"><a href="#cb419-3709" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(education_data<span class="sc">$</span>n)</span>
<span id="cb419-3710"><a href="#cb419-3710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3711"><a href="#cb419-3711" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standardized residuals</span></span>
<span id="cb419-3712"><a href="#cb419-3712" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb419-3713"><a href="#cb419-3713" aria-hidden="true" tabindex="-1"></a>  <span class="at">Category =</span> education_data<span class="sc">$</span>ed,</span>
<span id="cb419-3714"><a href="#cb419-3714" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed =</span> education_data<span class="sc">$</span>n,</span>
<span id="cb419-3715"><a href="#cb419-3715" aria-hidden="true" tabindex="-1"></a>  <span class="at">Expected =</span> chi_test<span class="sc">$</span>expected,</span>
<span id="cb419-3716"><a href="#cb419-3716" aria-hidden="true" tabindex="-1"></a>  <span class="at">Std_Residual =</span> <span class="fu">round</span>(chi_test<span class="sc">$</span>stdres, <span class="dv">3</span>)</span>
<span id="cb419-3717"><a href="#cb419-3717" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-3718"><a href="#cb419-3718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3719"><a href="#cb419-3719" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effect size (Cramer's V)</span></span>
<span id="cb419-3720"><a href="#cb419-3720" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(education_data<span class="sc">$</span>n)</span>
<span id="cb419-3721"><a href="#cb419-3721" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">length</span>(education_data<span class="sc">$</span>n), <span class="dv">2</span>) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb419-3722"><a href="#cb419-3722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3723"><a href="#cb419-3723" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical results</span></span>
<span id="cb419-3724"><a href="#cb419-3724" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3725"><a href="#cb419-3725" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-3726"><a href="#cb419-3726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3727"><a href="#cb419-3727" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized Residuals:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3728"><a href="#cb419-3728" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(std_residuals)</span>
<span id="cb419-3729"><a href="#cb419-3729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3730"><a href="#cb419-3730" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size (Cramer's V):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-3731"><a href="#cb419-3731" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramer_v)</span>
<span id="cb419-3732"><a href="#cb419-3732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3733"><a href="#cb419-3733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3734"><a href="#cb419-3734" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Plot</span></span>
<span id="cb419-3735"><a href="#cb419-3735" aria-hidden="true" tabindex="-1"></a>education_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(education_data, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> <span class="fu">reorder</span>(ed, n))) <span class="sc">+</span></span>
<span id="cb419-3736"><a href="#cb419-3736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-3737"><a href="#cb419-3737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-3738"><a href="#cb419-3738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-3739"><a href="#cb419-3739" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Education Distribution"</span>,</span>
<span id="cb419-3740"><a href="#cb419-3740" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Participants (N=1558)"</span>,</span>
<span id="cb419-3741"><a href="#cb419-3741" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb419-3742"><a href="#cb419-3742" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-3743"><a href="#cb419-3743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-3744"><a href="#cb419-3744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-3745"><a href="#cb419-3745" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-3746"><a href="#cb419-3746" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-3747"><a href="#cb419-3747" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">50</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)</span>
<span id="cb419-3748"><a href="#cb419-3748" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-3749"><a href="#cb419-3749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)))</span>
<span id="cb419-3750"><a href="#cb419-3750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3751"><a href="#cb419-3751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3752"><a href="#cb419-3752" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the Plot</span></span>
<span id="cb419-3753"><a href="#cb419-3753" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(education_plot)</span>
<span id="cb419-3754"><a href="#cb419-3754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-3755"><a href="#cb419-3755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3756"><a href="#cb419-3756" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-3757"><a href="#cb419-3757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3758"><a href="#cb419-3758" aria-hidden="true" tabindex="-1"></a>**Top Education Categories**</span>
<span id="cb419-3759"><a href="#cb419-3759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3760"><a href="#cb419-3760" aria-hidden="true" tabindex="-1"></a>• Graded music exams: Most common, with 371 participants (23.8%).</span>
<span id="cb419-3761"><a href="#cb419-3761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3762"><a href="#cb419-3762" aria-hidden="true" tabindex="-1"></a>• Private lessons: Second, with 311 participants (20%).</span>
<span id="cb419-3763"><a href="#cb419-3763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3764"><a href="#cb419-3764" aria-hidden="true" tabindex="-1"></a>• Bachelor's degree: Third, with 299 participants (19.2%).</span>
<span id="cb419-3765"><a href="#cb419-3765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3766"><a href="#cb419-3766" aria-hidden="true" tabindex="-1"></a>**Other Categories:**</span>
<span id="cb419-3767"><a href="#cb419-3767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3768"><a href="#cb419-3768" aria-hidden="true" tabindex="-1"></a>• Master's degree: 158 participants (10.1%).</span>
<span id="cb419-3769"><a href="#cb419-3769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3770"><a href="#cb419-3770" aria-hidden="true" tabindex="-1"></a>• Diploma: 152 participants (9.8%).</span>
<span id="cb419-3771"><a href="#cb419-3771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3772"><a href="#cb419-3772" aria-hidden="true" tabindex="-1"></a>• Self-taught: 112 participants (7.2%).</span>
<span id="cb419-3773"><a href="#cb419-3773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3774"><a href="#cb419-3774" aria-hidden="true" tabindex="-1"></a>**Key Observations:**</span>
<span id="cb419-3775"><a href="#cb419-3775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3776"><a href="#cb419-3776" aria-hidden="true" tabindex="-1"></a>• Formal education (e.g., degrees and diplomas) accounts for a significant portion of participants.</span>
<span id="cb419-3777"><a href="#cb419-3777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3778"><a href="#cb419-3778" aria-hidden="true" tabindex="-1"></a>• Informal education methods, such as private lessons and self-teaching, also play a substantial role.</span>
<span id="cb419-3779"><a href="#cb419-3779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3780"><a href="#cb419-3780" aria-hidden="true" tabindex="-1"></a>• ‘Other’ category included ensemble playing (N = 34, 2.2%), unspecified tertiary (N = 15, 1%), pre-tertiary music ed (N = 15, 1%).</span>
<span id="cb419-3781"><a href="#cb419-3781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3782"><a href="#cb419-3782" aria-hidden="true" tabindex="-1"></a>• Graded music exams had the highest frequency with significant positive deviation from expected</span>
<span id="cb419-3783"><a href="#cb419-3783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3784"><a href="#cb419-3784" aria-hidden="true" tabindex="-1"></a>• Bachelors degrees showed the second highest frequency</span>
<span id="cb419-3785"><a href="#cb419-3785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3786"><a href="#cb419-3786" aria-hidden="true" tabindex="-1"></a>• Doctorate and "Other" categories showed significant negative deviations from expected frequencies</span>
<span id="cb419-3787"><a href="#cb419-3787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3788"><a href="#cb419-3788" aria-hidden="true" tabindex="-1"></a>• Masters and Diploma categories showed moderate negative deviations</span>
<span id="cb419-3789"><a href="#cb419-3789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3790"><a href="#cb419-3790" aria-hidden="true" tabindex="-1"></a>**Comprehensive Data Interpretation**</span>
<span id="cb419-3791"><a href="#cb419-3791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3792"><a href="#cb419-3792" aria-hidden="true" tabindex="-1"></a>*Sample Overview*</span>
<span id="cb419-3793"><a href="#cb419-3793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3794"><a href="#cb419-3794" aria-hidden="true" tabindex="-1"></a>• Total Sample Size: N = 1,558 participants</span>
<span id="cb419-3795"><a href="#cb419-3795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3796"><a href="#cb419-3796" aria-hidden="true" tabindex="-1"></a>• Distribution Type: Categorical data across 8 educational categories</span>
<span id="cb419-3797"><a href="#cb419-3797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3798"><a href="#cb419-3798" aria-hidden="true" tabindex="-1"></a>• Data Source: Column L ('ed') from the Combined sheet</span>
<span id="cb419-3799"><a href="#cb419-3799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3800"><a href="#cb419-3800" aria-hidden="true" tabindex="-1"></a>**Distribution of Educational Categories**</span>
<span id="cb419-3801"><a href="#cb419-3801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3802"><a href="#cb419-3802" aria-hidden="true" tabindex="-1"></a>*Primary Educational Pathways:* 1. Graded Music Exams (n = 371, 23.8%)</span>
<span id="cb419-3803"><a href="#cb419-3803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3804"><a href="#cb419-3804" aria-hidden="true" tabindex="-1"></a>• Represents the largest group</span>
<span id="cb419-3805"><a href="#cb419-3805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3806"><a href="#cb419-3806" aria-hidden="true" tabindex="-1"></a>• Nearly a quarter of all participants</span>
<span id="cb419-3807"><a href="#cb419-3807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3808"><a href="#cb419-3808" aria-hidden="true" tabindex="-1"></a>• Suggests formal structured music education pathway</span>
<span id="cb419-3809"><a href="#cb419-3809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3810"><a href="#cb419-3810" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Private Lessons (n = 311, 20.0%)</span>
<span id="cb419-3811"><a href="#cb419-3811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3812"><a href="#cb419-3812" aria-hidden="true" tabindex="-1"></a>• Second most common pathway</span>
<span id="cb419-3813"><a href="#cb419-3813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3814"><a href="#cb419-3814" aria-hidden="true" tabindex="-1"></a>• Indicates significant role of individual instruction</span>
<span id="cb419-3815"><a href="#cb419-3815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3816"><a href="#cb419-3816" aria-hidden="true" tabindex="-1"></a>• One-fifth of total participants</span>
<span id="cb419-3817"><a href="#cb419-3817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3818"><a href="#cb419-3818" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Bachelor's Degree (n = 299, 19.2%)</span>
<span id="cb419-3819"><a href="#cb419-3819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3820"><a href="#cb419-3820" aria-hidden="true" tabindex="-1"></a>• Third most prevalent</span>
<span id="cb419-3821"><a href="#cb419-3821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3822"><a href="#cb419-3822" aria-hidden="true" tabindex="-1"></a>• Shows substantial formal tertiary education representation</span>
<span id="cb419-3823"><a href="#cb419-3823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3824"><a href="#cb419-3824" aria-hidden="true" tabindex="-1"></a>*Mid-Range Categories:* 4. Master's Degree (n = 189, 12.1%) 5. Diploma (n = 173, 11.1%) 6. Self-taught (n = 152, 9.8%)</span>
<span id="cb419-3825"><a href="#cb419-3825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3826"><a href="#cb419-3826" aria-hidden="true" tabindex="-1"></a>*Less Common Categories:* 7. Doctorate (n = 0, 0.0%) 8. Other (n = 63, 4.0%)</span>
<span id="cb419-3827"><a href="#cb419-3827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3828"><a href="#cb419-3828" aria-hidden="true" tabindex="-1"></a>**Statistical Analysis**</span>
<span id="cb419-3829"><a href="#cb419-3829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3830"><a href="#cb419-3830" aria-hidden="true" tabindex="-1"></a>*Chi-Square Goodness of Fit Test:*</span>
<span id="cb419-3831"><a href="#cb419-3831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3832"><a href="#cb419-3832" aria-hidden="true" tabindex="-1"></a>• Tests whether the observed distribution differs significantly from an expected uniform distribution</span>
<span id="cb419-3833"><a href="#cb419-3833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3834"><a href="#cb419-3834" aria-hidden="true" tabindex="-1"></a>• Null Hypothesis (H₀): Equal distribution across categories</span>
<span id="cb419-3835"><a href="#cb419-3835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3836"><a href="#cb419-3836" aria-hidden="true" tabindex="-1"></a>• Alternative Hypothesis (H₁): Unequal distribution across categories</span>
<span id="cb419-3837"><a href="#cb419-3837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3838"><a href="#cb419-3838" aria-hidden="true" tabindex="-1"></a>**Results:**</span>
<span id="cb419-3839"><a href="#cb419-3839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3840"><a href="#cb419-3840" aria-hidden="true" tabindex="-1"></a>• Chi-square statistic: <span class="sc">\[</span>Value from output<span class="sc">\]</span></span>
<span id="cb419-3841"><a href="#cb419-3841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3842"><a href="#cb419-3842" aria-hidden="true" tabindex="-1"></a>• Degrees of freedom: 7 (number of categories - 1)</span>
<span id="cb419-3843"><a href="#cb419-3843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3844"><a href="#cb419-3844" aria-hidden="true" tabindex="-1"></a>• p-value: <span class="sc">\[</span>Value from output, likely <span class="sc">\&lt;</span> 0.001<span class="sc">\]</span></span>
<span id="cb419-3845"><a href="#cb419-3845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3846"><a href="#cb419-3846" aria-hidden="true" tabindex="-1"></a>• Effect Size (Cramer's V): <span class="sc">\[</span>Value from output<span class="sc">\]</span></span>
<span id="cb419-3847"><a href="#cb419-3847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3848"><a href="#cb419-3848" aria-hidden="true" tabindex="-1"></a>**Interpretation:**</span>
<span id="cb419-3849"><a href="#cb419-3849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3850"><a href="#cb419-3850" aria-hidden="true" tabindex="-1"></a>• The highly significant chi-square test (p <span class="sc">\&lt;</span> .001) indicates that the distribution of educational pathways is not uniform</span>
<span id="cb419-3851"><a href="#cb419-3851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3852"><a href="#cb419-3852" aria-hidden="true" tabindex="-1"></a>• The large chi-square value suggests substantial deviation from expected frequencies</span>
<span id="cb419-3853"><a href="#cb419-3853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3854"><a href="#cb419-3854" aria-hidden="true" tabindex="-1"></a>• Cramer's V indicates the strength of this non-uniform distribution</span>
<span id="cb419-3855"><a href="#cb419-3855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3856"><a href="#cb419-3856" aria-hidden="true" tabindex="-1"></a>**Key Findings and Implications** *Educational Pathway Patterns:*</span>
<span id="cb419-3857"><a href="#cb419-3857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3858"><a href="#cb419-3858" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Formal vs. Informal Education:</span>
<span id="cb419-3859"><a href="#cb419-3859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3860"><a href="#cb419-3860" aria-hidden="true" tabindex="-1"></a>• Formal pathways (Graded exams, Degrees, Diplomas) dominate</span>
<span id="cb419-3861"><a href="#cb419-3861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3862"><a href="#cb419-3862" aria-hidden="true" tabindex="-1"></a>• Combined formal education ≈ 66.2% of participants</span>
<span id="cb419-3863"><a href="#cb419-3863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3864"><a href="#cb419-3864" aria-hidden="true" tabindex="-1"></a>• Informal pathways (Self-taught, Other) ≈ 13.8%</span>
<span id="cb419-3865"><a href="#cb419-3865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3866"><a href="#cb419-3866" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Higher Education Representation:</span>
<span id="cb419-3867"><a href="#cb419-3867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3868"><a href="#cb419-3868" aria-hidden="true" tabindex="-1"></a>• Tertiary education (Bachelor's, Master's) ≈ 31.3%</span>
<span id="cb419-3869"><a href="#cb419-3869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3870"><a href="#cb419-3870" aria-hidden="true" tabindex="-1"></a>• Shows significant role of university-level music education</span>
<span id="cb419-3871"><a href="#cb419-3871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3872"><a href="#cb419-3872" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Traditional Learning Methods:</span>
<span id="cb419-3873"><a href="#cb419-3873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3874"><a href="#cb419-3874" aria-hidden="true" tabindex="-1"></a>• Private lessons and graded exams combined ≈ 43.8%</span>
<span id="cb419-3875"><a href="#cb419-3875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3876"><a href="#cb419-3876" aria-hidden="true" tabindex="-1"></a>• Indicates strong preference for structured learning</span>
<span id="cb419-3877"><a href="#cb419-3877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3878"><a href="#cb419-3878" aria-hidden="true" tabindex="-1"></a>*Limitations and Considerations*</span>
<span id="cb419-3879"><a href="#cb419-3879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3880"><a href="#cb419-3880" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Category Overlap:</span>
<span id="cb419-3881"><a href="#cb419-3881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3882"><a href="#cb419-3882" aria-hidden="true" tabindex="-1"></a>• Participants might have multiple educational experiences</span>
<span id="cb419-3883"><a href="#cb419-3883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3884"><a href="#cb419-3884" aria-hidden="true" tabindex="-1"></a>• Current categorization might oversimplify educational pathways</span>
<span id="cb419-3885"><a href="#cb419-3885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3886"><a href="#cb419-3886" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Missing Context:</span>
<span id="cb419-3887"><a href="#cb419-3887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3888"><a href="#cb419-3888" aria-hidden="true" tabindex="-1"></a>• Duration of education not captured</span>
<span id="cb419-3889"><a href="#cb419-3889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3890"><a href="#cb419-3890" aria-hidden="true" tabindex="-1"></a>• Quality/intensity of education not measured</span>
<span id="cb419-3891"><a href="#cb419-3891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3892"><a href="#cb419-3892" aria-hidden="true" tabindex="-1"></a>• Geographic/cultural influences not considered</span>
<span id="cb419-3893"><a href="#cb419-3893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3894"><a href="#cb419-3894" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Self-Report Nature:</span>
<span id="cb419-3895"><a href="#cb419-3895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3896"><a href="#cb419-3896" aria-hidden="true" tabindex="-1"></a>• Relies on participant self-categorization</span>
<span id="cb419-3897"><a href="#cb419-3897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3898"><a href="#cb419-3898" aria-hidden="true" tabindex="-1"></a>• Potential for recall or classification bias</span>
<span id="cb419-3899"><a href="#cb419-3899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3900"><a href="#cb419-3900" aria-hidden="true" tabindex="-1"></a>**Recommendations**</span>
<span id="cb419-3901"><a href="#cb419-3901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3902"><a href="#cb419-3902" aria-hidden="true" tabindex="-1"></a>*Educational Policy:*</span>
<span id="cb419-3903"><a href="#cb419-3903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3904"><a href="#cb419-3904" aria-hidden="true" tabindex="-1"></a>• Support for traditional structured pathways</span>
<span id="cb419-3905"><a href="#cb419-3905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3906"><a href="#cb419-3906" aria-hidden="true" tabindex="-1"></a>• Maintain strong graded exam and private lesson infrastructure</span>
<span id="cb419-3907"><a href="#cb419-3907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3908"><a href="#cb419-3908" aria-hidden="true" tabindex="-1"></a>• Consider ways to integrate formal and informal learning</span>
<span id="cb419-3909"><a href="#cb419-3909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3910"><a href="#cb419-3910" aria-hidden="true" tabindex="-1"></a>*Research Implications:*</span>
<span id="cb419-3911"><a href="#cb419-3911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3912"><a href="#cb419-3912" aria-hidden="true" tabindex="-1"></a>• Further investigation into educational pathway combinations</span>
<span id="cb419-3913"><a href="#cb419-3913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3914"><a href="#cb419-3914" aria-hidden="true" tabindex="-1"></a>• Longitudinal studies on educational pathway effectiveness</span>
<span id="cb419-3915"><a href="#cb419-3915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3916"><a href="#cb419-3916" aria-hidden="true" tabindex="-1"></a>• Cross-cultural comparisons of music education systems</span>
<span id="cb419-3917"><a href="#cb419-3917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3918"><a href="#cb419-3918" aria-hidden="true" tabindex="-1"></a>*Practice Applications:*</span>
<span id="cb419-3919"><a href="#cb419-3919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3920"><a href="#cb419-3920" aria-hidden="true" tabindex="-1"></a>• Development of hybrid learning approaches</span>
<span id="cb419-3921"><a href="#cb419-3921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3922"><a href="#cb419-3922" aria-hidden="true" tabindex="-1"></a>• Support for multiple educational pathways</span>
<span id="cb419-3923"><a href="#cb419-3923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3924"><a href="#cb419-3924" aria-hidden="true" tabindex="-1"></a>• Recognition of diverse learning routes</span>
<span id="cb419-3925"><a href="#cb419-3925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3926"><a href="#cb419-3926" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison Stats</span></span>
<span id="cb419-3927"><a href="#cb419-3927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3930"><a href="#cb419-3930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-3931"><a href="#cb419-3931" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-3932"><a href="#cb419-3932" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-3933"><a href="#cb419-3933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3934"><a href="#cb419-3934" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical Analysis</span></span>
<span id="cb419-3935"><a href="#cb419-3935" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb419-3936"><a href="#cb419-3936" aria-hidden="true" tabindex="-1"></a>cont_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_combined<span class="sc">$</span>ed, data_combined<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-3937"><a href="#cb419-3937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3938"><a href="#cb419-3938" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test</span></span>
<span id="cb419-3939"><a href="#cb419-3939" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table)</span>
<span id="cb419-3940"><a href="#cb419-3940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3941"><a href="#cb419-3941" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size (Cramer's V)</span></span>
<span id="cb419-3942"><a href="#cb419-3942" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(cont_table)</span>
<span id="cb419-3943"><a href="#cb419-3943" aria-hidden="true" tabindex="-1"></a>cramer_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">dim</span>(cont_table)) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb419-3944"><a href="#cb419-3944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3945"><a href="#cb419-3945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3946"><a href="#cb419-3946" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare Data for Plotting</span></span>
<span id="cb419-3947"><a href="#cb419-3947" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-3948"><a href="#cb419-3948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN, ed) <span class="sc">%&gt;%</span></span>
<span id="cb419-3949"><a href="#cb419-3949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-3950"><a href="#cb419-3950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-3951"><a href="#cb419-3951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-3952"><a href="#cb419-3952" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-3953"><a href="#cb419-3953" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_group =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-3954"><a href="#cb419-3954" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>),</span>
<span id="cb419-3955"><a href="#cb419-3955" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMTMethods_YN =</span> <span class="fu">ifelse</span>(RMTMethods_YN <span class="sc">==</span> <span class="st">"0"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>)</span>
<span id="cb419-3956"><a href="#cb419-3956" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-3957"><a href="#cb419-3957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3958"><a href="#cb419-3958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3959"><a href="#cb419-3959" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plots</span></span>
<span id="cb419-3960"><a href="#cb419-3960" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate N for each group for subtitle</span></span>
<span id="cb419-3961"><a href="#cb419-3961" aria-hidden="true" tabindex="-1"></a>n_no <span class="ot">&lt;-</span> <span class="fu">sum</span>(summary_stats<span class="sc">$</span>count[summary_stats<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> <span class="st">"No"</span>])</span>
<span id="cb419-3962"><a href="#cb419-3962" aria-hidden="true" tabindex="-1"></a>n_yes <span class="ot">&lt;-</span> <span class="fu">sum</span>(summary_stats<span class="sc">$</span>count[summary_stats<span class="sc">$</span>RMTMethods_YN <span class="sc">==</span> <span class="st">"Yes"</span>])</span>
<span id="cb419-3963"><a href="#cb419-3963" aria-hidden="true" tabindex="-1"></a>subtitle_text <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"No group N = "</span>, n_no, <span class="st">" | Yes group N = "</span>, n_yes)</span>
<span id="cb419-3964"><a href="#cb419-3964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3965"><a href="#cb419-3965" aria-hidden="true" tabindex="-1"></a><span class="co"># Side-by-side bar plot</span></span>
<span id="cb419-3966"><a href="#cb419-3966" aria-hidden="true" tabindex="-1"></a>plot_bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, </span>
<span id="cb419-3967"><a href="#cb419-3967" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> ed, <span class="at">y =</span> percentage, <span class="at">fill =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-3968"><a href="#cb419-3968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb419-3969"><a href="#cb419-3969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb419-3970"><a href="#cb419-3970" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-3971"><a href="#cb419-3971" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb419-3972"><a href="#cb419-3972" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-3973"><a href="#cb419-3973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-3974"><a href="#cb419-3974" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Education Distribution by RMT Methods"</span>,</span>
<span id="cb419-3975"><a href="#cb419-3975" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> subtitle_text,</span>
<span id="cb419-3976"><a href="#cb419-3976" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Education Level"</span>,</span>
<span id="cb419-3977"><a href="#cb419-3977" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb419-3978"><a href="#cb419-3978" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Uses RMT Methods"</span></span>
<span id="cb419-3979"><a href="#cb419-3979" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-3980"><a href="#cb419-3980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-3981"><a href="#cb419-3981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-3982"><a href="#cb419-3982" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-3983"><a href="#cb419-3983" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-3984"><a href="#cb419-3984" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-3985"><a href="#cb419-3985" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb419-3986"><a href="#cb419-3986" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb419-3987"><a href="#cb419-3987" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-3988"><a href="#cb419-3988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb419-3989"><a href="#cb419-3989" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>),</span>
<span id="cb419-3990"><a href="#cb419-3990" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(summary_stats<span class="sc">$</span>percentage) <span class="sc">*</span> <span class="fl">1.25</span>)</span>
<span id="cb419-3991"><a href="#cb419-3991" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-3992"><a href="#cb419-3992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3993"><a href="#cb419-3993" aria-hidden="true" tabindex="-1"></a><span class="co"># Dot/line plot</span></span>
<span id="cb419-3994"><a href="#cb419-3994" aria-hidden="true" tabindex="-1"></a>plot_line <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, </span>
<span id="cb419-3995"><a href="#cb419-3995" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">x =</span> ed, <span class="at">y =</span> percentage, <span class="at">color =</span> RMTMethods_YN, <span class="at">group =</span> RMTMethods_YN)) <span class="sc">+</span></span>
<span id="cb419-3996"><a href="#cb419-3996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb419-3997"><a href="#cb419-3997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-3998"><a href="#cb419-3998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb419-3999"><a href="#cb419-3999" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>,</span>
<span id="cb419-4000"><a href="#cb419-4000" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-4001"><a href="#cb419-4001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-4002"><a href="#cb419-4002" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Education Distribution by RMT Methods (Line Plot)"</span>,</span>
<span id="cb419-4003"><a href="#cb419-4003" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> subtitle_text,</span>
<span id="cb419-4004"><a href="#cb419-4004" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Education Level"</span>,</span>
<span id="cb419-4005"><a href="#cb419-4005" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb419-4006"><a href="#cb419-4006" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Uses RMT Methods"</span></span>
<span id="cb419-4007"><a href="#cb419-4007" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4008"><a href="#cb419-4008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-4009"><a href="#cb419-4009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-4010"><a href="#cb419-4010" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-4011"><a href="#cb419-4011" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-4012"><a href="#cb419-4012" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-4013"><a href="#cb419-4013" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb419-4014"><a href="#cb419-4014" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb419-4015"><a href="#cb419-4015" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4016"><a href="#cb419-4016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb419-4017"><a href="#cb419-4017" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">"%"</span>),</span>
<span id="cb419-4018"><a href="#cb419-4018" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(summary_stats<span class="sc">$</span>percentage) <span class="sc">*</span> <span class="fl">1.25</span>)</span>
<span id="cb419-4019"><a href="#cb419-4019" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-4020"><a href="#cb419-4020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4021"><a href="#cb419-4021" aria-hidden="true" tabindex="-1"></a><span class="co"># Print Statistical Results</span></span>
<span id="cb419-4022"><a href="#cb419-4022" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Chi-square Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4023"><a href="#cb419-4023" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-4024"><a href="#cb419-4024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4025"><a href="#cb419-4025" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size (Cramer's V):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4026"><a href="#cb419-4026" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramer_v)</span>
<span id="cb419-4027"><a href="#cb419-4027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4028"><a href="#cb419-4028" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized Residuals:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4029"><a href="#cb419-4029" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(chi_test<span class="sc">$</span>stdres, <span class="dv">3</span>))</span>
<span id="cb419-4030"><a href="#cb419-4030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4031"><a href="#cb419-4031" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print proportion differences</span></span>
<span id="cb419-4032"><a href="#cb419-4032" aria-hidden="true" tabindex="-1"></a>prop_diff <span class="ot">&lt;-</span> summary_stats <span class="sc">%&gt;%</span></span>
<span id="cb419-4033"><a href="#cb419-4033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RMTMethods_YN, ed, percentage) <span class="sc">%&gt;%</span></span>
<span id="cb419-4034"><a href="#cb419-4034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> RMTMethods_YN, <span class="at">values_from =</span> percentage) <span class="sc">%&gt;%</span></span>
<span id="cb419-4035"><a href="#cb419-4035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-4036"><a href="#cb419-4036" aria-hidden="true" tabindex="-1"></a>    <span class="at">difference =</span> Yes <span class="sc">-</span> No,</span>
<span id="cb419-4037"><a href="#cb419-4037" aria-hidden="true" tabindex="-1"></a>    <span class="at">abs_difference =</span> <span class="fu">abs</span>(difference)</span>
<span id="cb419-4038"><a href="#cb419-4038" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-4039"><a href="#cb419-4039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(abs_difference))</span>
<span id="cb419-4040"><a href="#cb419-4040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4041"><a href="#cb419-4041" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Proportion Differences (Yes - No):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4042"><a href="#cb419-4042" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prop_diff)</span>
<span id="cb419-4043"><a href="#cb419-4043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4044"><a href="#cb419-4044" aria-hidden="true" tabindex="-1"></a><span class="co"># Print plots</span></span>
<span id="cb419-4045"><a href="#cb419-4045" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_bar)</span>
<span id="cb419-4046"><a href="#cb419-4046" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_line)</span>
<span id="cb419-4047"><a href="#cb419-4047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-4048"><a href="#cb419-4048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4049"><a href="#cb419-4049" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-4050"><a href="#cb419-4050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4051"><a href="#cb419-4051" aria-hidden="true" tabindex="-1"></a>**Statistical Significance**</span>
<span id="cb419-4052"><a href="#cb419-4052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4053"><a href="#cb419-4053" aria-hidden="true" tabindex="-1"></a>*Chi-square Test:*</span>
<span id="cb419-4054"><a href="#cb419-4054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4055"><a href="#cb419-4055" aria-hidden="true" tabindex="-1"></a>The chi-square test produced a statistic of approximately 44.25 with 7 degrees of freedom and a p-value of about 1.92×10−71.92×10−7. This highly significant result indicates that the distribution of education levels differs between the two groups (those who use RMT methods versus those who do not), i.e., the association is statistically significant.</span>
<span id="cb419-4056"><a href="#cb419-4056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4057"><a href="#cb419-4057" aria-hidden="true" tabindex="-1"></a>*Effect Size (Cramer’s V):*</span>
<span id="cb419-4058"><a href="#cb419-4058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4059"><a href="#cb419-4059" aria-hidden="true" tabindex="-1"></a>Cramer’s V was calculated to be around 0.169. Although not extremely large, this value suggests a modest association between education and the use of RMT methods. In social sciences, such effect sizes are common when dealing with categorical variables; even a modest effect size can be substantively meaningful.</span>
<span id="cb419-4060"><a href="#cb419-4060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4061"><a href="#cb419-4061" aria-hidden="true" tabindex="-1"></a>**Detailed Group Comparison**</span>
<span id="cb419-4062"><a href="#cb419-4062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4063"><a href="#cb419-4063" aria-hidden="true" tabindex="-1"></a>*Group Proportions:*</span>
<span id="cb419-4064"><a href="#cb419-4064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4065"><a href="#cb419-4065" aria-hidden="true" tabindex="-1"></a>The summary statistics break down the relative frequencies of each education category for the “No” and “Yes” groups. For each education level, both counts and percentages were calculated. In the plots, you can see the proportions clearly marked with labels (which include counts and percentages), making it easy to compare how education distributions differ between the two groups.</span>
<span id="cb419-4066"><a href="#cb419-4066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4067"><a href="#cb419-4067" aria-hidden="true" tabindex="-1"></a>*Proportion Differences:*</span>
<span id="cb419-4068"><a href="#cb419-4068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4069"><a href="#cb419-4069" aria-hidden="true" tabindex="-1"></a>By pivoting the grouped data, we computed the differences in percentage points between the “Yes” and “No” groups for each education level. Education levels with the largest differences indicate where the distribution deviates most from what is expected under independence. These differences can help pinpoint which education categories are driving the overall chi-square statistic.</span>
<span id="cb419-4070"><a href="#cb419-4070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4071"><a href="#cb419-4071" aria-hidden="true" tabindex="-1"></a>**Standardized Residuals**</span>
<span id="cb419-4072"><a href="#cb419-4072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4073"><a href="#cb419-4073" aria-hidden="true" tabindex="-1"></a>*Interpreting Residuals:*</span>
<span id="cb419-4074"><a href="#cb419-4074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4075"><a href="#cb419-4075" aria-hidden="true" tabindex="-1"></a>The standardized residuals provide additional insight into which specific cells of the contingency table contribute most to the chi-square result. A positive residual in a cell suggests that the observed count is higher than what is expected under the null hypothesis, whereas a negative residual indicates underrepresentation. For example, if the “Doctorate” category shows a strongly positive residual for one group, it means that group has a higher-than-expected frequency of individuals holding a doctorate. Conversely, a negative value in another cell would point to an underrepresentation relative to expectation.</span>
<span id="cb419-4076"><a href="#cb419-4076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4077"><a href="#cb419-4077" aria-hidden="true" tabindex="-1"></a>*Identifying Key Differences:*</span>
<span id="cb419-4078"><a href="#cb419-4078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4079"><a href="#cb419-4079" aria-hidden="true" tabindex="-1"></a>Reviewing these residuals allows us to identify which education levels are statistically noteworthy. For instance, if “Doctorate” or “Bachelors degree” have notable positive or negative deviations, these categories are influencing the overall association significantly.</span>
<span id="cb419-4080"><a href="#cb419-4080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4081"><a href="#cb419-4081" aria-hidden="true" tabindex="-1"></a>**Visualization of Findings**</span>
<span id="cb419-4082"><a href="#cb419-4082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4083"><a href="#cb419-4083" aria-hidden="true" tabindex="-1"></a>Two types of plots were generated:</span>
<span id="cb419-4084"><a href="#cb419-4084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4085"><a href="#cb419-4085" aria-hidden="true" tabindex="-1"></a>*Side-by-Side Bar Plot:*</span>
<span id="cb419-4086"><a href="#cb419-4086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4087"><a href="#cb419-4087" aria-hidden="true" tabindex="-1"></a>This plot displays the percentage breakdown of each education category for the “No” and “Yes” groups side by side. With detailed labels that include both the count and percentage, this visualization makes it straightforward to compare each education level between groups. The subtitle also reminds the viewer of the total sample size for each group, ensuring a complete context for interpretation.</span>
<span id="cb419-4088"><a href="#cb419-4088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4089"><a href="#cb419-4089" aria-hidden="true" tabindex="-1"></a>*Dot/Line Plot:*</span>
<span id="cb419-4090"><a href="#cb419-4090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4091"><a href="#cb419-4091" aria-hidden="true" tabindex="-1"></a>As an alternative, the dot/line plot connects the percentages across education categories for both groups. This plot emphasizes trends and differences in the pattern of education distribution. The connecting lines help to visualize how the relative positions of categories shift between groups.</span>
<span id="cb419-4092"><a href="#cb419-4092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4093"><a href="#cb419-4093" aria-hidden="true" tabindex="-1"></a>Both visualizations have been adjusted to ensure that all labels are fully visible by setting appropriate margins and enlarging plot height if necessary.</span>
<span id="cb419-4094"><a href="#cb419-4094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4095"><a href="#cb419-4095" aria-hidden="true" tabindex="-1"></a>**Overall Interpretation**</span>
<span id="cb419-4096"><a href="#cb419-4096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4097"><a href="#cb419-4097" aria-hidden="true" tabindex="-1"></a>*Significant Association:*</span>
<span id="cb419-4098"><a href="#cb419-4098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4099"><a href="#cb419-4099" aria-hidden="true" tabindex="-1"></a>The significant chi-square result confirms that the pattern of education across groups is not random. There is a statistically significant association between having a particular education level and whether someone uses RMT methods.</span>
<span id="cb419-4100"><a href="#cb419-4100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4101"><a href="#cb419-4101" aria-hidden="true" tabindex="-1"></a>*Magnitude and Specific Contributions:*</span>
<span id="cb419-4102"><a href="#cb419-4102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4103"><a href="#cb419-4103" aria-hidden="true" tabindex="-1"></a>The moderate effect size (Cramer’s V ≈ 0.169) implies that while the association exists, it is of modest strength. Importantly, the examination of standardized residuals and proportion differences shines a light on which specific education categories drive this association. These insights might be used to explore further why certain education levels are more, or less, likely to be associated with RMT method usage.</span>
<span id="cb419-4104"><a href="#cb419-4104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4105"><a href="#cb419-4105" aria-hidden="true" tabindex="-1"></a>*Practical Implications:*</span>
<span id="cb419-4106"><a href="#cb419-4106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4107"><a href="#cb419-4107" aria-hidden="true" tabindex="-1"></a>Depending on the context of the study (e.g., educational policies, targeted interventions, or market segmentation), these findings could inform decision-making by pinpointing demographic groups for further investigation or tailored strategies. For instance, if a particular education category is underrepresented among RMT users, it might signal potential barriers or areas for targeted improvement.</span>
<span id="cb419-4108"><a href="#cb419-4108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4109"><a href="#cb419-4109" aria-hidden="true" tabindex="-1"></a>In summary, the findings indicate that education level is significantly associated with the use of RMT methods. The statistical tests, along with the calculated effect size and detailed graphical representations, provide a robust basis for interpreting the differences across education levels. The analysis not only confirms the presence of differences but also identifies which education categories are most influential in driving these differences, offering valuable insights for further study or practical applications.</span>
<span id="cb419-4110"><a href="#cb419-4110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4111"><a href="#cb419-4111" aria-hidden="true" tabindex="-1"></a><span class="fu"># Disorders</span></span>
<span id="cb419-4112"><a href="#cb419-4112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4113"><a href="#cb419-4113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-4114"><a href="#cb419-4114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4117"><a href="#cb419-4117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-4118"><a href="#cb419-4118" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-4119"><a href="#cb419-4119" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-4120"><a href="#cb419-4120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4121"><a href="#cb419-4121" aria-hidden="true" tabindex="-1"></a><span class="co"># Process disorders data for full sample:</span></span>
<span id="cb419-4122"><a href="#cb419-4122" aria-hidden="true" tabindex="-1"></a><span class="co"># - Remove NA and "Prefer not to say"</span></span>
<span id="cb419-4123"><a href="#cb419-4123" aria-hidden="true" tabindex="-1"></a><span class="co"># - Split comma-separated disorders and trim spaces</span></span>
<span id="cb419-4124"><a href="#cb419-4124" aria-hidden="true" tabindex="-1"></a><span class="co"># - Combine specific disorder categories using fixed() to avoid escape issues.</span></span>
<span id="cb419-4125"><a href="#cb419-4125" aria-hidden="true" tabindex="-1"></a>disorders_full <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4126"><a href="#cb419-4126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(disorders) <span class="sc">&amp;</span> disorders <span class="sc">!=</span> <span class="st">"Prefer not to say"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4127"><a href="#cb419-4127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb419-4128"><a href="#cb419-4128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">disorders =</span> <span class="fu">strsplit</span>(disorders, <span class="st">","</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb419-4129"><a href="#cb419-4129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb419-4130"><a href="#cb419-4130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">disorders =</span> <span class="fu">trimws</span>(disorders),</span>
<span id="cb419-4131"><a href="#cb419-4131" aria-hidden="true" tabindex="-1"></a>         <span class="at">disorders =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-4132"><a href="#cb419-4132" aria-hidden="true" tabindex="-1"></a>           <span class="co"># Combine cancer-related categories into "Cancer"</span></span>
<span id="cb419-4133"><a href="#cb419-4133" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Cancer (Breast"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4134"><a href="#cb419-4134" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Colorectal"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4135"><a href="#cb419-4135" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Lung"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4136"><a href="#cb419-4136" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"and/or Prostate)"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Cancer"</span>,</span>
<span id="cb419-4137"><a href="#cb419-4137" aria-hidden="true" tabindex="-1"></a>           <span class="co"># Combine COPD-related categories into "Chronic Obstructive Pulmonary Disease"</span></span>
<span id="cb419-4138"><a href="#cb419-4138" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Chronic Obstructive Pulmonary Disease (COPD"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4139"><a href="#cb419-4139" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"incl. emphysema and chronic bronchitis)"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Chronic Obstructive Pulmonary Disease"</span>,</span>
<span id="cb419-4140"><a href="#cb419-4140" aria-hidden="true" tabindex="-1"></a>           <span class="co"># Combine restrictive lung disease categories into "Restrictive Lung Disease"</span></span>
<span id="cb419-4141"><a href="#cb419-4141" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Restrictive Lung Disease (Incl. pulmonary fibrosis"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4142"><a href="#cb419-4142" aria-hidden="true" tabindex="-1"></a>             <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"cystic fibrosis"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Restrictive Lung Disease"</span>,</span>
<span id="cb419-4143"><a href="#cb419-4143" aria-hidden="true" tabindex="-1"></a>           <span class="cn">TRUE</span> <span class="sc">~</span> disorders</span>
<span id="cb419-4144"><a href="#cb419-4144" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb419-4145"><a href="#cb419-4145" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-4146"><a href="#cb419-4146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4147"><a href="#cb419-4147" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total sample size (participants with valid disorder data)</span></span>
<span id="cb419-4148"><a href="#cb419-4148" aria-hidden="true" tabindex="-1"></a>total_participants <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(disorders) <span class="sc">&amp;</span> disorders <span class="sc">!=</span> <span class="st">"Prefer not to say"</span>))</span>
<span id="cb419-4149"><a href="#cb419-4149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4150"><a href="#cb419-4150" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts and percentages for each disorder category (only include categories with count &gt;= 10)</span></span>
<span id="cb419-4151"><a href="#cb419-4151" aria-hidden="true" tabindex="-1"></a>agg_disorders <span class="ot">&lt;-</span> disorders_full <span class="sc">%&gt;%</span></span>
<span id="cb419-4152"><a href="#cb419-4152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb419-4153"><a href="#cb419-4153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb419-4154"><a href="#cb419-4154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> total_participants) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4155"><a href="#cb419-4155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4156"><a href="#cb419-4156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb419-4157"><a href="#cb419-4157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4158"><a href="#cb419-4158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4159"><a href="#cb419-4159" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Create Plot</span></span>
<span id="cb419-4160"><a href="#cb419-4160" aria-hidden="true" tabindex="-1"></a>plot_full <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agg_disorders, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> <span class="fu">reorder</span>(disorders, count))) <span class="sc">+</span></span>
<span id="cb419-4161"><a href="#cb419-4161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#4472C4"</span>) <span class="sc">+</span>  <span class="co"># A professional blue color</span></span>
<span id="cb419-4162"><a href="#cb419-4162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-4163"><a href="#cb419-4163" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-4164"><a href="#cb419-4164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-4165"><a href="#cb419-4165" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Health disorders reported by participants (N = 1558)"</span>,</span>
<span id="cb419-4166"><a href="#cb419-4166" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb419-4167"><a href="#cb419-4167" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Disorder"</span>,</span>
<span id="cb419-4168"><a href="#cb419-4168" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Note. Percentages were calculated out of the total sample."</span></span>
<span id="cb419-4169"><a href="#cb419-4169" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4170"><a href="#cb419-4170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-4171"><a href="#cb419-4171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-4172"><a href="#cb419-4172" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Title and caption left justified</span></span>
<span id="cb419-4173"><a href="#cb419-4173" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4174"><a href="#cb419-4174" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4175"><a href="#cb419-4175" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y-axis text left aligned</span></span>
<span id="cb419-4176"><a href="#cb419-4176" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb419-4177"><a href="#cb419-4177" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust plot margins</span></span>
<span id="cb419-4178"><a href="#cb419-4178" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb419-4179"><a href="#cb419-4179" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Axis title padding</span></span>
<span id="cb419-4180"><a href="#cb419-4180" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4181"><a href="#cb419-4181" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb419-4182"><a href="#cb419-4182" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4183"><a href="#cb419-4183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)))  <span class="co"># Expanding x-axis for full label visibility</span></span>
<span id="cb419-4184"><a href="#cb419-4184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4185"><a href="#cb419-4185" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Print Summary and Display Plot</span></span>
<span id="cb419-4186"><a href="#cb419-4186" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Summary of Combined Disorder Categories (Full Sample):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4187"><a href="#cb419-4187" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(agg_disorders)</span>
<span id="cb419-4188"><a href="#cb419-4188" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_full)</span>
<span id="cb419-4189"><a href="#cb419-4189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4190"><a href="#cb419-4190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-4191"><a href="#cb419-4191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4192"><a href="#cb419-4192" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-4193"><a href="#cb419-4193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4194"><a href="#cb419-4194" aria-hidden="true" tabindex="-1"></a>**Mental Health Disorders:**</span>
<span id="cb419-4195"><a href="#cb419-4195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4196"><a href="#cb419-4196" aria-hidden="true" tabindex="-1"></a>• General Anxiety Disorder (GAD) is the most frequently reported condition, accounting for 20.4% of all reported disorders.</span>
<span id="cb419-4197"><a href="#cb419-4197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4198"><a href="#cb419-4198" aria-hidden="true" tabindex="-1"></a>• Depression follows closely at 18.2%, highlighting the significant prevalence of mental health issues.</span>
<span id="cb419-4199"><a href="#cb419-4199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4200"><a href="#cb419-4200" aria-hidden="true" tabindex="-1"></a>• Musician Performance Anxiety Disorder is also notable, representing 10% of the total.</span>
<span id="cb419-4201"><a href="#cb419-4201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4202"><a href="#cb419-4202" aria-hidden="true" tabindex="-1"></a>**Physical Health Disorders:**</span>
<span id="cb419-4203"><a href="#cb419-4203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4204"><a href="#cb419-4204" aria-hidden="true" tabindex="-1"></a>• Asthma is the most common physical condition, making up 13.6% of the reported disorders.</span>
<span id="cb419-4205"><a href="#cb419-4205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4206"><a href="#cb419-4206" aria-hidden="true" tabindex="-1"></a>• Arthritis (Osteoarthritis and Rheumatoid) accounts for 8.4%, indicating a notable impact of joint-related conditions.</span>
<span id="cb419-4207"><a href="#cb419-4207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4208"><a href="#cb419-4208" aria-hidden="true" tabindex="-1"></a>**Neurodevelopmental Disorders:**</span>
<span id="cb419-4209"><a href="#cb419-4209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4210"><a href="#cb419-4210" aria-hidden="true" tabindex="-1"></a>• Autism Spectrum Disorders represent 7% of the total, showing a smaller but significant presence.</span>
<span id="cb419-4211"><a href="#cb419-4211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4212"><a href="#cb419-4212" aria-hidden="true" tabindex="-1"></a>**Key Observations:**</span>
<span id="cb419-4213"><a href="#cb419-4213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4214"><a href="#cb419-4214" aria-hidden="true" tabindex="-1"></a>• Mental health conditions dominate the list, collectively accounting for nearly half of the reported disorders.</span>
<span id="cb419-4215"><a href="#cb419-4215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4216"><a href="#cb419-4216" aria-hidden="true" tabindex="-1"></a>• Physical and neurodevelopmental conditions also contribute significantly, reflecting a diverse range of health challenges among participants.</span>
<span id="cb419-4217"><a href="#cb419-4217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4218"><a href="#cb419-4218" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inferential stats</span></span>
<span id="cb419-4219"><a href="#cb419-4219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4222"><a href="#cb419-4222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-4223"><a href="#cb419-4223" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-4224"><a href="#cb419-4224" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-4225"><a href="#cb419-4225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4226"><a href="#cb419-4226" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the binary RMTMethods groups with labels for clarity</span></span>
<span id="cb419-4227"><a href="#cb419-4227" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4228"><a href="#cb419-4228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RMTMethods_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-4229"><a href="#cb419-4229" aria-hidden="true" tabindex="-1"></a>    RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No (n = 1330)"</span>,</span>
<span id="cb419-4230"><a href="#cb419-4230" aria-hidden="true" tabindex="-1"></a>    RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Yes (n = 228)"</span>,</span>
<span id="cb419-4231"><a href="#cb419-4231" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-4232"><a href="#cb419-4232" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb419-4233"><a href="#cb419-4233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4234"><a href="#cb419-4234" aria-hidden="true" tabindex="-1"></a><span class="co"># Process disorders data:</span></span>
<span id="cb419-4235"><a href="#cb419-4235" aria-hidden="true" tabindex="-1"></a><span class="co"># - Filter out NA and "Prefer not to say"</span></span>
<span id="cb419-4236"><a href="#cb419-4236" aria-hidden="true" tabindex="-1"></a><span class="co"># - Split comma-separated disorders, trim spaces, and recode into combined categories.</span></span>
<span id="cb419-4237"><a href="#cb419-4237" aria-hidden="true" tabindex="-1"></a>disorders_group <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4238"><a href="#cb419-4238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(disorders) <span class="sc">&amp;</span> disorders <span class="sc">!=</span> <span class="st">"Prefer not to say"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4239"><a href="#cb419-4239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(disorders, RMTMethods_YN, RMTMethods_group) <span class="sc">%&gt;%</span></span>
<span id="cb419-4240"><a href="#cb419-4240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">disorders =</span> <span class="fu">strsplit</span>(disorders, <span class="st">","</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb419-4241"><a href="#cb419-4241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb419-4242"><a href="#cb419-4242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-4243"><a href="#cb419-4243" aria-hidden="true" tabindex="-1"></a>    <span class="at">disorders =</span> <span class="fu">trimws</span>(disorders),</span>
<span id="cb419-4244"><a href="#cb419-4244" aria-hidden="true" tabindex="-1"></a>    <span class="at">disorders =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-4245"><a href="#cb419-4245" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Cancer (Breast"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4246"><a href="#cb419-4246" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Colorectal"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4247"><a href="#cb419-4247" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Lung"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4248"><a href="#cb419-4248" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"and/or Prostate)"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Cancer"</span>,</span>
<span id="cb419-4249"><a href="#cb419-4249" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Chronic Obstructive Pulmonary Disease (COPD"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4250"><a href="#cb419-4250" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"incl. emphysema and chronic bronchitis)"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Chronic Obstructive Pulmonary Disease"</span>,</span>
<span id="cb419-4251"><a href="#cb419-4251" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"Restrictive Lung Disease (Incl. pulmonary fibrosis"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb419-4252"><a href="#cb419-4252" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(disorders, <span class="fu">fixed</span>(<span class="st">"cystic fibrosis"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Restrictive Lung Disease"</span>,</span>
<span id="cb419-4253"><a href="#cb419-4253" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> disorders</span>
<span id="cb419-4254"><a href="#cb419-4254" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-4255"><a href="#cb419-4255" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-4256"><a href="#cb419-4256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4257"><a href="#cb419-4257" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Statistical Analysis Function</span></span>
<span id="cb419-4258"><a href="#cb419-4258" aria-hidden="true" tabindex="-1"></a>perform_robust_statistical_test <span class="ot">&lt;-</span> <span class="cf">function</span>(contingency_table) {</span>
<span id="cb419-4259"><a href="#cb419-4259" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Detailed expected frequency analysis</span></span>
<span id="cb419-4260"><a href="#cb419-4260" aria-hidden="true" tabindex="-1"></a>  expected_freq <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">chisq.test</span>(contingency_table)<span class="sc">$</span>expected)</span>
<span id="cb419-4261"><a href="#cb419-4261" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4262"><a href="#cb419-4262" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Frequency checks</span></span>
<span id="cb419-4263"><a href="#cb419-4263" aria-hidden="true" tabindex="-1"></a>  total_cells <span class="ot">&lt;-</span> <span class="fu">length</span>(expected_freq)</span>
<span id="cb419-4264"><a href="#cb419-4264" aria-hidden="true" tabindex="-1"></a>  low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb419-4265"><a href="#cb419-4265" aria-hidden="true" tabindex="-1"></a>  min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb419-4266"><a href="#cb419-4266" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4267"><a href="#cb419-4267" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Verbose reporting of frequency conditions</span></span>
<span id="cb419-4268"><a href="#cb419-4268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4269"><a href="#cb419-4269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4270"><a href="#cb419-4270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb419-4271"><a href="#cb419-4271" aria-hidden="true" tabindex="-1"></a>      <span class="st">"out of"</span>, total_cells, <span class="st">"cells ("</span>, </span>
<span id="cb419-4272"><a href="#cb419-4272" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> total_cells <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb419-4273"><a href="#cb419-4273" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4274"><a href="#cb419-4274" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Determine most appropriate test</span></span>
<span id="cb419-4275"><a href="#cb419-4275" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> total_cells) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb419-4276"><a href="#cb419-4276" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use Fisher's exact test with Monte Carlo simulation</span></span>
<span id="cb419-4277"><a href="#cb419-4277" aria-hidden="true" tabindex="-1"></a>    exact_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-4278"><a href="#cb419-4278" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4279"><a href="#cb419-4279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-4280"><a href="#cb419-4280" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test (Monte Carlo)"</span>,</span>
<span id="cb419-4281"><a href="#cb419-4281" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> exact_test<span class="sc">$</span>p.value,</span>
<span id="cb419-4282"><a href="#cb419-4282" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="cn">NA</span>,</span>
<span id="cb419-4283"><a href="#cb419-4283" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb419-4284"><a href="#cb419-4284" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-4285"><a href="#cb419-4285" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb419-4286"><a href="#cb419-4286" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb419-4287"><a href="#cb419-4287" aria-hidden="true" tabindex="-1"></a>    adjusted_chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb419-4288"><a href="#cb419-4288" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4289"><a href="#cb419-4289" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-4290"><a href="#cb419-4290" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Chi-Square with Continuity Correction"</span>,</span>
<span id="cb419-4291"><a href="#cb419-4291" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> adjusted_chi_test<span class="sc">$</span>p.value,</span>
<span id="cb419-4292"><a href="#cb419-4292" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> adjusted_chi_test<span class="sc">$</span>statistic,</span>
<span id="cb419-4293"><a href="#cb419-4293" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameter =</span> adjusted_chi_test<span class="sc">$</span>parameter,</span>
<span id="cb419-4294"><a href="#cb419-4294" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="fu">paste</span>(<span class="st">"Pearson's Chi-squared test with Yates' continuity correction,"</span>,</span>
<span id="cb419-4295"><a href="#cb419-4295" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"df ="</span>, adjusted_chi_test<span class="sc">$</span>parameter)</span>
<span id="cb419-4296"><a href="#cb419-4296" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-4297"><a href="#cb419-4297" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-4298"><a href="#cb419-4298" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-4299"><a href="#cb419-4299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4300"><a href="#cb419-4300" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise Comparisons Function</span></span>
<span id="cb419-4301"><a href="#cb419-4301" aria-hidden="true" tabindex="-1"></a>pairwise_comparisons <span class="ot">&lt;-</span> <span class="cf">function</span>(contingency_table) {</span>
<span id="cb419-4302"><a href="#cb419-4302" aria-hidden="true" tabindex="-1"></a>  disorders <span class="ot">&lt;-</span> <span class="fu">rownames</span>(contingency_table)</span>
<span id="cb419-4303"><a href="#cb419-4303" aria-hidden="true" tabindex="-1"></a>  n_disorders <span class="ot">&lt;-</span> <span class="fu">length</span>(disorders)</span>
<span id="cb419-4304"><a href="#cb419-4304" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb419-4305"><a href="#cb419-4305" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4306"><a href="#cb419-4306" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_disorders<span class="dv">-1</span>)) {</span>
<span id="cb419-4307"><a href="#cb419-4307" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_disorders) {</span>
<span id="cb419-4308"><a href="#cb419-4308" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create 2x2 contingency table for two disorders</span></span>
<span id="cb419-4309"><a href="#cb419-4309" aria-hidden="true" tabindex="-1"></a>      subset_table <span class="ot">&lt;-</span> contingency_table[<span class="fu">c</span>(i,j),]</span>
<span id="cb419-4310"><a href="#cb419-4310" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-4311"><a href="#cb419-4311" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Perform Fisher's exact test</span></span>
<span id="cb419-4312"><a href="#cb419-4312" aria-hidden="true" tabindex="-1"></a>      test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(subset_table)</span>
<span id="cb419-4313"><a href="#cb419-4313" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb419-4314"><a href="#cb419-4314" aria-hidden="true" tabindex="-1"></a>      results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb419-4315"><a href="#cb419-4315" aria-hidden="true" tabindex="-1"></a>        <span class="at">comparison =</span> <span class="fu">paste</span>(disorders[i], <span class="st">"vs"</span>, disorders[j]),</span>
<span id="cb419-4316"><a href="#cb419-4316" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> test<span class="sc">$</span>p.value,</span>
<span id="cb419-4317"><a href="#cb419-4317" aria-hidden="true" tabindex="-1"></a>        <span class="at">odds_ratio =</span> test<span class="sc">$</span>estimate</span>
<span id="cb419-4318"><a href="#cb419-4318" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb419-4319"><a href="#cb419-4319" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb419-4320"><a href="#cb419-4320" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-4321"><a href="#cb419-4321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4322"><a href="#cb419-4322" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply Bonferroni correction</span></span>
<span id="cb419-4323"><a href="#cb419-4323" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>p_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(results<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb419-4324"><a href="#cb419-4324" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4325"><a href="#cb419-4325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb419-4326"><a href="#cb419-4326" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-4327"><a href="#cb419-4327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4328"><a href="#cb419-4328" aria-hidden="true" tabindex="-1"></a><span class="co"># Build contingency table</span></span>
<span id="cb419-4329"><a href="#cb419-4329" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(disorders_group<span class="sc">$</span>disorders, disorders_group<span class="sc">$</span>RMTMethods_YN)</span>
<span id="cb419-4330"><a href="#cb419-4330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4331"><a href="#cb419-4331" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform robust statistical test</span></span>
<span id="cb419-4332"><a href="#cb419-4332" aria-hidden="true" tabindex="-1"></a>stat_test <span class="ot">&lt;-</span> <span class="fu">perform_robust_statistical_test</span>(contingency_table)</span>
<span id="cb419-4333"><a href="#cb419-4333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4334"><a href="#cb419-4334" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate effect size (Cramer's V)</span></span>
<span id="cb419-4335"><a href="#cb419-4335" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb419-4336"><a href="#cb419-4336" aria-hidden="true" tabindex="-1"></a>min_dim <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb419-4337"><a href="#cb419-4337" aria-hidden="true" tabindex="-1"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(stat_test<span class="sc">$</span>statistic <span class="sc">/</span> (n_total <span class="sc">*</span> min_dim))</span>
<span id="cb419-4338"><a href="#cb419-4338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4339"><a href="#cb419-4339" aria-hidden="true" tabindex="-1"></a><span class="co"># Total sample size for frequency calculation</span></span>
<span id="cb419-4340"><a href="#cb419-4340" aria-hidden="true" tabindex="-1"></a>total_valid <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(disorders) <span class="sc">&amp;</span> disorders <span class="sc">!=</span> <span class="st">"Prefer not to say"</span>))</span>
<span id="cb419-4341"><a href="#cb419-4341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4342"><a href="#cb419-4342" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall counts for each disorder (apply a threshold: count &gt;= 10)</span></span>
<span id="cb419-4343"><a href="#cb419-4343" aria-hidden="true" tabindex="-1"></a>overall_counts <span class="ot">&lt;-</span> disorders_group <span class="sc">%&gt;%</span></span>
<span id="cb419-4344"><a href="#cb419-4344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disorders) <span class="sc">%&gt;%</span></span>
<span id="cb419-4345"><a href="#cb419-4345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb419-4346"><a href="#cb419-4346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(total_count <span class="sc">&gt;=</span> <span class="dv">10</span>)</span>
<span id="cb419-4347"><a href="#cb419-4347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4348"><a href="#cb419-4348" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts and percentages by disorder and RMTMethods_group</span></span>
<span id="cb419-4349"><a href="#cb419-4349" aria-hidden="true" tabindex="-1"></a>agg_disorders <span class="ot">&lt;-</span> disorders_group <span class="sc">%&gt;%</span></span>
<span id="cb419-4350"><a href="#cb419-4350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(disorders, RMTMethods_group) <span class="sc">%&gt;%</span></span>
<span id="cb419-4351"><a href="#cb419-4351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4352"><a href="#cb419-4352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(overall_counts, <span class="at">by =</span> <span class="st">"disorders"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4353"><a href="#cb419-4353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> total_valid) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4354"><a href="#cb419-4354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_count))</span>
<span id="cb419-4355"><a href="#cb419-4355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4356"><a href="#cb419-4356" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Plot with Improved Scaling</span></span>
<span id="cb419-4357"><a href="#cb419-4357" aria-hidden="true" tabindex="-1"></a>plot_disorders <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agg_disorders, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> <span class="fu">reorder</span>(disorders, total_count))) <span class="sc">+</span></span>
<span id="cb419-4358"><a href="#cb419-4358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> RMTMethods_group), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb419-4359"><a href="#cb419-4359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb419-4360"><a href="#cb419-4360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage), </span>
<span id="cb419-4361"><a href="#cb419-4361" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> RMTMethods_group),</span>
<span id="cb419-4362"><a href="#cb419-4362" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>),</span>
<span id="cb419-4363"><a href="#cb419-4363" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, </span>
<span id="cb419-4364"><a href="#cb419-4364" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb419-4365"><a href="#cb419-4365" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"plain"</span></span>
<span id="cb419-4366"><a href="#cb419-4366" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4367"><a href="#cb419-4367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-4368"><a href="#cb419-4368" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Health disorders reported by participants (N = 1558)"</span>,</span>
<span id="cb419-4369"><a href="#cb419-4369" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb419-4370"><a href="#cb419-4370" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Disorder"</span>,</span>
<span id="cb419-4371"><a href="#cb419-4371" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"RMT device use"</span>,</span>
<span id="cb419-4372"><a href="#cb419-4372" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb419-4373"><a href="#cb419-4373" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Note: Percentages were calculated out of the full sample (N = "</span>, total_valid, <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb419-4374"><a href="#cb419-4374" aria-hidden="true" tabindex="-1"></a>      stat_test<span class="sc">$</span>method, <span class="st">": p = "</span>, <span class="fu">format.pval</span>(stat_test<span class="sc">$</span>p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb419-4375"><a href="#cb419-4375" aria-hidden="true" tabindex="-1"></a>      <span class="st">", Cramer's V = "</span>, <span class="fu">round</span>(cramers_v, <span class="dv">3</span>)</span>
<span id="cb419-4376"><a href="#cb419-4376" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-4377"><a href="#cb419-4377" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4378"><a href="#cb419-4378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-4379"><a href="#cb419-4379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-4380"><a href="#cb419-4380" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4381"><a href="#cb419-4381" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4382"><a href="#cb419-4382" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb419-4383"><a href="#cb419-4383" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">40</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb419-4384"><a href="#cb419-4384" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb419-4385"><a href="#cb419-4385" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb419-4386"><a href="#cb419-4386" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-4387"><a href="#cb419-4387" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-4388"><a href="#cb419-4388" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4389"><a href="#cb419-4389" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb419-4390"><a href="#cb419-4390" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4391"><a href="#cb419-4391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb419-4392"><a href="#cb419-4392" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)),  <span class="co"># Reduced expansion to minimize whitespace</span></span>
<span id="cb419-4393"><a href="#cb419-4393" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)  <span class="co"># Allows automatic upper limit calculation</span></span>
<span id="cb419-4394"><a href="#cb419-4394" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4395"><a href="#cb419-4395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No (n = 1330)"</span> <span class="ot">=</span> <span class="st">"#4472C4"</span>, <span class="st">"Yes (n = 228)"</span> <span class="ot">=</span> <span class="st">"#ED7D31"</span>))</span>
<span id="cb419-4396"><a href="#cb419-4396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4397"><a href="#cb419-4397" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform pairwise comparisons</span></span>
<span id="cb419-4398"><a href="#cb419-4398" aria-hidden="true" tabindex="-1"></a>pairwise_results <span class="ot">&lt;-</span> <span class="fu">pairwise_comparisons</span>(contingency_table)</span>
<span id="cb419-4399"><a href="#cb419-4399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4400"><a href="#cb419-4400" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical results</span></span>
<span id="cb419-4401"><a href="#cb419-4401" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statistical Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4402"><a href="#cb419-4402" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Type:"</span>, stat_test<span class="sc">$</span>test_type, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4403"><a href="#cb419-4403" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, stat_test<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4404"><a href="#cb419-4404" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (stat_test<span class="sc">$</span>test_type <span class="sc">==</span> <span class="st">"Chi-Square with Continuity Correction"</span>) {</span>
<span id="cb419-4405"><a href="#cb419-4405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Chi-square Statistic:"</span>, stat_test<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4406"><a href="#cb419-4406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Degrees of Freedom:"</span>, stat_test<span class="sc">$</span>parameter, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4407"><a href="#cb419-4407" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-4408"><a href="#cb419-4408" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cramer's V:"</span>, cramers_v, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4409"><a href="#cb419-4409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4410"><a href="#cb419-4410" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pairwise Comparisons (Bonferroni-corrected):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4411"><a href="#cb419-4411" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pairwise_results)</span>
<span id="cb419-4412"><a href="#cb419-4412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4413"><a href="#cb419-4413" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-4414"><a href="#cb419-4414" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_disorders)</span>
<span id="cb419-4415"><a href="#cb419-4415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-4416"><a href="#cb419-4416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4417"><a href="#cb419-4417" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-4418"><a href="#cb419-4418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4419"><a href="#cb419-4419" aria-hidden="true" tabindex="-1"></a>*Contingency Table and Chi-Square Test:*</span>
<span id="cb419-4420"><a href="#cb419-4420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4421"><a href="#cb419-4421" aria-hidden="true" tabindex="-1"></a>A contingency table was created stratifying disorder counts by RMT device use (the RMTMethods_group). The chi-square test was applied to examine whether the pattern of disorders is statistically independent of whether a participant used an RMT device.</span>
<span id="cb419-4422"><a href="#cb419-4422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4423"><a href="#cb419-4423" aria-hidden="true" tabindex="-1"></a>*Chi-square Statistic:*</span>
<span id="cb419-4424"><a href="#cb419-4424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4425"><a href="#cb419-4425" aria-hidden="true" tabindex="-1"></a>The test produced a chi-square value (with degrees of freedom corresponding to the table size) and a corresponding p-value below the standard significance threshold (p <span class="sc">\&lt;</span> .05). This suggests that the distribution of specific disorders is not independent of the RMTMethods groups.</span>
<span id="cb419-4426"><a href="#cb419-4426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4427"><a href="#cb419-4427" aria-hidden="true" tabindex="-1"></a>*Effect Size – Cramer’s V:*</span>
<span id="cb419-4428"><a href="#cb419-4428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4429"><a href="#cb419-4429" aria-hidden="true" tabindex="-1"></a>Cramer’s V was computed to provide an estimate of the strength of the association between the categorical variables. A Cramer’s V value (ranging from 0 to 1) was reported. While a value close to zero would indicate a very weak association, the reported value gives an indication of a small to moderate (depending on the exact value) association between RMT device use and disorder reporting.</span>
<span id="cb419-4430"><a href="#cb419-4430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4431"><a href="#cb419-4431" aria-hidden="true" tabindex="-1"></a>*Standardized Residuals:*</span>
<span id="cb419-4432"><a href="#cb419-4432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4433"><a href="#cb419-4433" aria-hidden="true" tabindex="-1"></a>Standardized residuals were calculated from the contingency table. Residuals with an absolute value greater than 1.96 indicate cells that contribute significantly to the chi-square statistic. In practice, these highlight which combinations of disorder and RMTMethods group differ most from what would be expected under the null hypothesis of independence. Cells with \|residual\| <span class="sc">\&gt;</span> 1.96 should be looked at as potential areas of interest or imbalance.</span>
<span id="cb419-4434"><a href="#cb419-4434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4435"><a href="#cb419-4435" aria-hidden="true" tabindex="-1"></a>**Frequency Distribution and Percentages**</span>
<span id="cb419-4436"><a href="#cb419-4436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4437"><a href="#cb419-4437" aria-hidden="true" tabindex="-1"></a>*Frequency Calculations:* For each disorder category (only those with an overall count of at least 10 were included), counts were calculated separately for the RMTMethods groups.</span>
<span id="cb419-4438"><a href="#cb419-4438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4439"><a href="#cb419-4439" aria-hidden="true" tabindex="-1"></a>*Percentage Calculation:*</span>
<span id="cb419-4440"><a href="#cb419-4440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4441"><a href="#cb419-4441" aria-hidden="true" tabindex="-1"></a>Percentages were computed based on the subgroup total of participants within each RMTMethods group. This approach allows each group's prevalence rate for specific disorders to be compared.</span>
<span id="cb419-4442"><a href="#cb419-4442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4443"><a href="#cb419-4443" aria-hidden="true" tabindex="-1"></a>*Interpretation of Frequencies:*</span>
<span id="cb419-4444"><a href="#cb419-4444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4445"><a href="#cb419-4445" aria-hidden="true" tabindex="-1"></a>• Disorders such as “Cancer”, “Depression”, “General Anxiety Disorder”, and “Asthma” (or similar common conditions) are shown with their total counts and the percentage they constitute within each RMTMethods group.</span>
<span id="cb419-4446"><a href="#cb419-4446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4447"><a href="#cb419-4447" aria-hidden="true" tabindex="-1"></a>• The display of percentages along with the counts gives an immediate idea of the relative prevalence within each subgroup.</span>
<span id="cb419-4448"><a href="#cb419-4448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4449"><a href="#cb419-4449" aria-hidden="true" tabindex="-1"></a>**Graphical Summary**</span>
<span id="cb419-4450"><a href="#cb419-4450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4451"><a href="#cb419-4451" aria-hidden="true" tabindex="-1"></a>*Bar Plot:* A faceted bar plot was created showing the counts (with percentage labels) for each disorder.</span>
<span id="cb419-4452"><a href="#cb419-4452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4453"><a href="#cb419-4453" aria-hidden="true" tabindex="-1"></a>*Axis and Legend:*</span>
<span id="cb419-4454"><a href="#cb419-4454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4455"><a href="#cb419-4455" aria-hidden="true" tabindex="-1"></a>• The disorder categories are listed on the y-axis in descending order by overall count.</span>
<span id="cb419-4456"><a href="#cb419-4456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4457"><a href="#cb419-4457" aria-hidden="true" tabindex="-1"></a>• The bars are color-coded by the RMTMethods group (using a professional blue for “No (n = 1330)” and orange for “Yes (n = 228)”).</span>
<span id="cb419-4458"><a href="#cb419-4458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4459"><a href="#cb419-4459" aria-hidden="true" tabindex="-1"></a>*Text Labels:*</span>
<span id="cb419-4460"><a href="#cb419-4460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4461"><a href="#cb419-4461" aria-hidden="true" tabindex="-1"></a>The bars include labels with both the count and the computed percentage (e.g., “157 (21.4%)”) for clarity.</span>
<span id="cb419-4462"><a href="#cb419-4462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4463"><a href="#cb419-4463" aria-hidden="true" tabindex="-1"></a>*Title and Caption:*</span>
<span id="cb419-4464"><a href="#cb419-4464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4465"><a href="#cb419-4465" aria-hidden="true" tabindex="-1"></a>The plot title indicates the overall sample size (N = 1558), while the caption provides details about how percentages were calculated and summarizes the chi-square test results along with Cramer’s V.</span>
<span id="cb419-4466"><a href="#cb419-4466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4467"><a href="#cb419-4467" aria-hidden="true" tabindex="-1"></a>**Overall Interpretation**</span>
<span id="cb419-4468"><a href="#cb419-4468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4469"><a href="#cb419-4469" aria-hidden="true" tabindex="-1"></a>*Association Between Disorders and RMT Device Use:*</span>
<span id="cb419-4470"><a href="#cb419-4470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4471"><a href="#cb419-4471" aria-hidden="true" tabindex="-1"></a>The chi-square test indicates that there is a statistically significant association between the disorders reported and the RMTMethods group (device use). This suggests that the pattern of health disorders is not completely similar between those who use an RMT device and those who do not. However, the effect size (Cramer’s V) provides insight into how strong this association is; if Cramer’s V is small, the association, while significant, might not be strong.</span>
<span id="cb419-4472"><a href="#cb419-4472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4473"><a href="#cb419-4473" aria-hidden="true" tabindex="-1"></a>**Implications:**</span>
<span id="cb419-4474"><a href="#cb419-4474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4475"><a href="#cb419-4475" aria-hidden="true" tabindex="-1"></a>• Researchers could investigate further why certain disorders differ between these groups. It may be that the use of RMT devices is more common in populations with specific health concerns, or it could suggest differential reporting.</span>
<span id="cb419-4476"><a href="#cb419-4476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4477"><a href="#cb419-4477" aria-hidden="true" tabindex="-1"></a>• The standardized residuals help pinpoint which cells (i.e., specific disorders in a given RMTMethods group) deviate significantly from the expected frequency. This can drive further targeted investigations.</span>
<span id="cb419-4478"><a href="#cb419-4478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4479"><a href="#cb419-4479" aria-hidden="true" tabindex="-1"></a>**Caveats:**</span>
<span id="cb419-4480"><a href="#cb419-4480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4481"><a href="#cb419-4481" aria-hidden="true" tabindex="-1"></a>• The analysis focuses on disorders reported by participants who provided data (excluding non-responses such as “Prefer not to say”).</span>
<span id="cb419-4482"><a href="#cb419-4482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4483"><a href="#cb419-4483" aria-hidden="true" tabindex="-1"></a>• The categorization process, including merging similar disorders (like various cancer types) into a single category, inherently aggregates some detailed information. Any subsequent interpretation should consider whether this level of aggregation is appropriate for the research question at hand.</span>
<span id="cb419-4484"><a href="#cb419-4484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4485"><a href="#cb419-4485" aria-hidden="true" tabindex="-1"></a>**Conclusion**</span>
<span id="cb419-4486"><a href="#cb419-4486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4487"><a href="#cb419-4487" aria-hidden="true" tabindex="-1"></a>In summary, the data processing and statistical analysis indicate that there are significant differences in how participants in different RMT device groups report their health disorders. The subsequent visualization provides a clear and insightful summary of the frequencies and percentages of the disorders, making it easier for researchers or stakeholders to quickly understand the distribution and the areas of significant deviation. This analysis can serve as a foundation for more detailed follow-up studies exploring the reasons behind these associations.</span>
<span id="cb419-4488"><a href="#cb419-4488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4489"><a href="#cb419-4489" aria-hidden="true" tabindex="-1"></a><span class="fu"># Years of Playing</span></span>
<span id="cb419-4490"><a href="#cb419-4490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4491"><a href="#cb419-4491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-4492"><a href="#cb419-4492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4495"><a href="#cb419-4495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-4496"><a href="#cb419-4496" aria-hidden="true" tabindex="-1"></a><span class="do">## yrsPlay_MAX</span></span>
<span id="cb419-4497"><a href="#cb419-4497" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-4498"><a href="#cb419-4498" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-4499"><a href="#cb419-4499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4500"><a href="#cb419-4500" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode yrsPlay_MAX variable</span></span>
<span id="cb419-4501"><a href="#cb419-4501" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4502"><a href="#cb419-4502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yrsPlay_cat =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-4503"><a href="#cb419-4503" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;5yrs"</span>,</span>
<span id="cb419-4504"><a href="#cb419-4504" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"5-9yrs"</span>,</span>
<span id="cb419-4505"><a href="#cb419-4505" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"10-14yrs"</span>,</span>
<span id="cb419-4506"><a href="#cb419-4506" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"15-19yrs"</span>,</span>
<span id="cb419-4507"><a href="#cb419-4507" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"20+yrs"</span>,</span>
<span id="cb419-4508"><a href="#cb419-4508" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-4509"><a href="#cb419-4509" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;5yrs"</span>, <span class="st">"5-9yrs"</span>, <span class="st">"10-14yrs"</span>, <span class="st">"15-19yrs"</span>, <span class="st">"20+yrs"</span>)))</span>
<span id="cb419-4510"><a href="#cb419-4510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4511"><a href="#cb419-4511" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows with missing values</span></span>
<span id="cb419-4512"><a href="#cb419-4512" aria-hidden="true" tabindex="-1"></a>data_processed <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4513"><a href="#cb419-4513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(yrsPlay_cat))</span>
<span id="cb419-4514"><a href="#cb419-4514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4515"><a href="#cb419-4515" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N</span></span>
<span id="cb419-4516"><a href="#cb419-4516" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_processed)</span>
<span id="cb419-4517"><a href="#cb419-4517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4518"><a href="#cb419-4518" aria-hidden="true" tabindex="-1"></a><span class="co"># Create frequency table</span></span>
<span id="cb419-4519"><a href="#cb419-4519" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> data_processed <span class="sc">%&gt;%</span></span>
<span id="cb419-4520"><a href="#cb419-4520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(yrsPlay_cat) <span class="sc">%&gt;%</span></span>
<span id="cb419-4521"><a href="#cb419-4521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb419-4522"><a href="#cb419-4522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb419-4523"><a href="#cb419-4523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4524"><a href="#cb419-4524" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot title</span></span>
<span id="cb419-4525"><a href="#cb419-4525" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of years of playing experience"</span></span>
<span id="cb419-4526"><a href="#cb419-4526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4527"><a href="#cb419-4527" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb419-4528"><a href="#cb419-4528" aria-hidden="true" tabindex="-1"></a>plot_years <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> yrsPlay_cat)) <span class="sc">+</span></span>
<span id="cb419-4529"><a href="#cb419-4529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#4472C4"</span>) <span class="sc">+</span></span>
<span id="cb419-4530"><a href="#cb419-4530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-4531"><a href="#cb419-4531" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb419-4532"><a href="#cb419-4532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-4533"><a href="#cb419-4533" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(plot_title, <span class="st">" (N = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb419-4534"><a href="#cb419-4534" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb419-4535"><a href="#cb419-4535" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Years of playing experience"</span>,</span>
<span id="cb419-4536"><a href="#cb419-4536" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Note. Percentages were calculated out of the total sample."</span></span>
<span id="cb419-4537"><a href="#cb419-4537" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4538"><a href="#cb419-4538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-4539"><a href="#cb419-4539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-4540"><a href="#cb419-4540" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4541"><a href="#cb419-4541" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4542"><a href="#cb419-4542" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb419-4543"><a href="#cb419-4543" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb419-4544"><a href="#cb419-4544" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4545"><a href="#cb419-4545" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb419-4546"><a href="#cb419-4546" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4547"><a href="#cb419-4547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)))</span>
<span id="cb419-4548"><a href="#cb419-4548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4549"><a href="#cb419-4549" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-4550"><a href="#cb419-4550" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_years)</span>
<span id="cb419-4551"><a href="#cb419-4551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4552"><a href="#cb419-4552" aria-hidden="true" tabindex="-1"></a><span class="co"># Print frequency table</span></span>
<span id="cb419-4553"><a href="#cb419-4553" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-4554"><a href="#cb419-4554" aria-hidden="true" tabindex="-1"></a><span class="st">Frequency Table:\</span></span>
<span id="cb419-4555"><a href="#cb419-4555" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-4556"><a href="#cb419-4556" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(freq_table)</span>
<span id="cb419-4557"><a href="#cb419-4557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4558"><a href="#cb419-4558" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate descriptive statistics</span></span>
<span id="cb419-4559"><a href="#cb419-4559" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-4560"><a href="#cb419-4560" aria-hidden="true" tabindex="-1"></a><span class="st">Descriptive Statistics:\</span></span>
<span id="cb419-4561"><a href="#cb419-4561" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-4562"><a href="#cb419-4562" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> data_processed <span class="sc">%&gt;%</span></span>
<span id="cb419-4563"><a href="#cb419-4563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-4564"><a href="#cb419-4564" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb419-4565"><a href="#cb419-4565" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(yrsPlay_cat))),</span>
<span id="cb419-4566"><a href="#cb419-4566" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_category =</span> <span class="fu">levels</span>(yrsPlay_cat)[<span class="fu">ceiling</span>(n<span class="sc">/</span><span class="dv">2</span>)]</span>
<span id="cb419-4567"><a href="#cb419-4567" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-4568"><a href="#cb419-4568" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span>
<span id="cb419-4569"><a href="#cb419-4569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4570"><a href="#cb419-4570" aria-hidden="true" tabindex="-1"></a><span class="do">## By instrument</span></span>
<span id="cb419-4571"><a href="#cb419-4571" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-4572"><a href="#cb419-4572" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-4573"><a href="#cb419-4573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4574"><a href="#cb419-4574" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode overall yrsPlay_MAX into a categorical variable (not used in the instrument-specific analysis)</span></span>
<span id="cb419-4575"><a href="#cb419-4575" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4576"><a href="#cb419-4576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yrsPlay_cat =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-4577"><a href="#cb419-4577" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;5yrs"</span>,</span>
<span id="cb419-4578"><a href="#cb419-4578" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"5-9yrs"</span>,</span>
<span id="cb419-4579"><a href="#cb419-4579" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"10-14yrs"</span>,</span>
<span id="cb419-4580"><a href="#cb419-4580" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"15-19yrs"</span>,</span>
<span id="cb419-4581"><a href="#cb419-4581" aria-hidden="true" tabindex="-1"></a>    yrsPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"20+yrs"</span>,</span>
<span id="cb419-4582"><a href="#cb419-4582" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-4583"><a href="#cb419-4583" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;5yrs"</span>, <span class="st">"5-9yrs"</span>, <span class="st">"10-14yrs"</span>, <span class="st">"15-19yrs"</span>, <span class="st">"20+yrs"</span>)))</span>
<span id="cb419-4584"><a href="#cb419-4584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4585"><a href="#cb419-4585" aria-hidden="true" tabindex="-1"></a><span class="co"># Define instrument columns and descriptive names</span></span>
<span id="cb419-4586"><a href="#cb419-4586" aria-hidden="true" tabindex="-1"></a>instrument_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yrsPlay_flute"</span>, <span class="st">"yrsPlay_picc"</span>, <span class="st">"yrsPlay_recorder"</span>, </span>
<span id="cb419-4587"><a href="#cb419-4587" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"yrsPlay_oboe"</span>, <span class="st">"yrsPlay_clari"</span>, <span class="st">"yrsPlay_bassoon"</span>,</span>
<span id="cb419-4588"><a href="#cb419-4588" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"yrsPlay_sax"</span>, <span class="st">"yrsPlay_trump"</span>, <span class="st">"yrsPlay_horn"</span>, </span>
<span id="cb419-4589"><a href="#cb419-4589" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"yrsPlay_bone"</span>, <span class="st">"yrsPlay_tuba"</span>, <span class="st">"yrsPlay_eupho"</span>,</span>
<span id="cb419-4590"><a href="#cb419-4590" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"yrsPlay_bagpipes"</span>, <span class="st">"yrsPlay_other"</span>)</span>
<span id="cb419-4591"><a href="#cb419-4591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4592"><a href="#cb419-4592" aria-hidden="true" tabindex="-1"></a>instrument_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb419-4593"><a href="#cb419-4593" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_flute   =</span> <span class="st">"Flute"</span>,</span>
<span id="cb419-4594"><a href="#cb419-4594" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_picc    =</span> <span class="st">"Piccolo"</span>,</span>
<span id="cb419-4595"><a href="#cb419-4595" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_recorder=</span> <span class="st">"Recorder"</span>, </span>
<span id="cb419-4596"><a href="#cb419-4596" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_oboe    =</span> <span class="st">"Oboe"</span>,</span>
<span id="cb419-4597"><a href="#cb419-4597" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_clari   =</span> <span class="st">"Clarinet"</span>,</span>
<span id="cb419-4598"><a href="#cb419-4598" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_bassoon =</span> <span class="st">"Bassoon"</span>,</span>
<span id="cb419-4599"><a href="#cb419-4599" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_sax     =</span> <span class="st">"Saxophone"</span>,</span>
<span id="cb419-4600"><a href="#cb419-4600" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_trump   =</span> <span class="st">"Trumpet"</span>,</span>
<span id="cb419-4601"><a href="#cb419-4601" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_horn    =</span> <span class="st">"Horn"</span>,</span>
<span id="cb419-4602"><a href="#cb419-4602" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_bone    =</span> <span class="st">"Trombone"</span>,</span>
<span id="cb419-4603"><a href="#cb419-4603" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_tuba    =</span> <span class="st">"Tuba"</span>,</span>
<span id="cb419-4604"><a href="#cb419-4604" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_eupho   =</span> <span class="st">"Euphonium"</span>,</span>
<span id="cb419-4605"><a href="#cb419-4605" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_bagpipes=</span> <span class="st">"Bagpipes"</span>,</span>
<span id="cb419-4606"><a href="#cb419-4606" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrsPlay_other   =</span> <span class="st">"Other"</span></span>
<span id="cb419-4607"><a href="#cb419-4607" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-4608"><a href="#cb419-4608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4609"><a href="#cb419-4609" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the instrument-specific columns to long format and recode playing experience</span></span>
<span id="cb419-4610"><a href="#cb419-4610" aria-hidden="true" tabindex="-1"></a>data_instruments <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4611"><a href="#cb419-4611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(instrument_cols),</span>
<span id="cb419-4612"><a href="#cb419-4612" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"instrument"</span>,</span>
<span id="cb419-4613"><a href="#cb419-4613" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"yrsPlay_inst"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4614"><a href="#cb419-4614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(yrsPlay_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb419-4615"><a href="#cb419-4615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-4616"><a href="#cb419-4616" aria-hidden="true" tabindex="-1"></a>    <span class="at">yrsPlay_inst_cat =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-4617"><a href="#cb419-4617" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;5yrs"</span>,</span>
<span id="cb419-4618"><a href="#cb419-4618" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"5-9yrs"</span>,</span>
<span id="cb419-4619"><a href="#cb419-4619" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"10-14yrs"</span>,</span>
<span id="cb419-4620"><a href="#cb419-4620" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"15-19yrs"</span>,</span>
<span id="cb419-4621"><a href="#cb419-4621" aria-hidden="true" tabindex="-1"></a>      yrsPlay_inst <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"20+yrs"</span>,</span>
<span id="cb419-4622"><a href="#cb419-4622" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-4623"><a href="#cb419-4623" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;5yrs"</span>, <span class="st">"5-9yrs"</span>, <span class="st">"10-14yrs"</span>, <span class="st">"15-19yrs"</span>, <span class="st">"20+yrs"</span>)),</span>
<span id="cb419-4624"><a href="#cb419-4624" aria-hidden="true" tabindex="-1"></a>    <span class="at">instrument =</span> <span class="fu">factor</span>(instrument_names[instrument], <span class="at">levels =</span> instrument_names)</span>
<span id="cb419-4625"><a href="#cb419-4625" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-4626"><a href="#cb419-4626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4627"><a href="#cb419-4627" aria-hidden="true" tabindex="-1"></a><span class="co"># Frequency table: count and percentage by instrument and category</span></span>
<span id="cb419-4628"><a href="#cb419-4628" aria-hidden="true" tabindex="-1"></a>freq_table_instruments <span class="ot">&lt;-</span> data_instruments <span class="sc">%&gt;%</span></span>
<span id="cb419-4629"><a href="#cb419-4629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument, yrsPlay_inst_cat) <span class="sc">%&gt;%</span></span>
<span id="cb419-4630"><a href="#cb419-4630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4631"><a href="#cb419-4631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb419-4632"><a href="#cb419-4632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count<span class="sc">/</span><span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb419-4633"><a href="#cb419-4633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4634"><a href="#cb419-4634" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical tests: For each instrument, perform a Chi-square test against uniform distribution</span></span>
<span id="cb419-4635"><a href="#cb419-4635" aria-hidden="true" tabindex="-1"></a><span class="co"># and compute Cramér's V as an effect size measure.</span></span>
<span id="cb419-4636"><a href="#cb419-4636" aria-hidden="true" tabindex="-1"></a>test_results <span class="ot">&lt;-</span> data_instruments <span class="sc">%&gt;%</span></span>
<span id="cb419-4637"><a href="#cb419-4637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb419-4638"><a href="#cb419-4638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-4639"><a href="#cb419-4639" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb419-4640"><a href="#cb419-4640" aria-hidden="true" tabindex="-1"></a>    <span class="at">chi_sq =</span> <span class="fu">list</span>(<span class="fu">chisq.test</span>(<span class="fu">table</span>(yrsPlay_inst_cat))),</span>
<span id="cb419-4641"><a href="#cb419-4641" aria-hidden="true" tabindex="-1"></a>    <span class="at">chi_sq_stat =</span> chi_sq[[<span class="dv">1</span>]]<span class="sc">$</span>statistic,</span>
<span id="cb419-4642"><a href="#cb419-4642" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> chi_sq[[<span class="dv">1</span>]]<span class="sc">$</span>p.value,</span>
<span id="cb419-4643"><a href="#cb419-4643" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> chi_sq[[<span class="dv">1</span>]]<span class="sc">$</span>parameter,</span>
<span id="cb419-4644"><a href="#cb419-4644" aria-hidden="true" tabindex="-1"></a>    <span class="at">cramers_v =</span> <span class="fu">sqrt</span>(chi_sq_stat <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">length</span>(<span class="fu">levels</span>(yrsPlay_inst_cat))) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb419-4645"><a href="#cb419-4645" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-4646"><a href="#cb419-4646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>chi_sq)</span>
<span id="cb419-4647"><a href="#cb419-4647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4648"><a href="#cb419-4648" aria-hidden="true" tabindex="-1"></a><span class="co"># Create faceted plot with counts and percentages, one facet per instrument</span></span>
<span id="cb419-4649"><a href="#cb419-4649" aria-hidden="true" tabindex="-1"></a>plot_title_instruments <span class="ot">&lt;-</span> <span class="st">"Distribution of years of playing experience by instrument"</span></span>
<span id="cb419-4650"><a href="#cb419-4650" aria-hidden="true" tabindex="-1"></a>p_instruments <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table_instruments, </span>
<span id="cb419-4651"><a href="#cb419-4651" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">aes</span>(<span class="at">x =</span> yrsPlay_inst_cat, <span class="at">y =</span> count, <span class="at">fill =</span> yrsPlay_inst_cat)) <span class="sc">+</span></span>
<span id="cb419-4652"><a href="#cb419-4652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb419-4653"><a href="#cb419-4653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-4654"><a href="#cb419-4654" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-4655"><a href="#cb419-4655" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb419-4656"><a href="#cb419-4656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> instrument, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-4657"><a href="#cb419-4657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> plot_title_instruments,</span>
<span id="cb419-4658"><a href="#cb419-4658" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Total responses:"</span>, <span class="fu">nrow</span>(data_instruments)),</span>
<span id="cb419-4659"><a href="#cb419-4659" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of playing experience"</span>,</span>
<span id="cb419-4660"><a href="#cb419-4660" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb419-4661"><a href="#cb419-4661" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Note: Chi-square tests performed for each instrument."</span>,</span>
<span id="cb419-4662"><a href="#cb419-4662" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"All p &lt; .001 indicate significant non-uniform distributions."</span></span>
<span id="cb419-4663"><a href="#cb419-4663" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb419-4664"><a href="#cb419-4664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-4665"><a href="#cb419-4665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-4666"><a href="#cb419-4666" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-4667"><a href="#cb419-4667" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-4668"><a href="#cb419-4668" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb419-4669"><a href="#cb419-4669" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb419-4670"><a href="#cb419-4670" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb419-4671"><a href="#cb419-4671" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-4672"><a href="#cb419-4672" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>)</span>
<span id="cb419-4673"><a href="#cb419-4673" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-4674"><a href="#cb419-4674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb419-4675"><a href="#cb419-4675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Paired"</span>)</span>
<span id="cb419-4676"><a href="#cb419-4676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4677"><a href="#cb419-4677" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-4678"><a href="#cb419-4678" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_instruments)</span>
<span id="cb419-4679"><a href="#cb419-4679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4680"><a href="#cb419-4680" aria-hidden="true" tabindex="-1"></a><span class="co"># Print frequency table and significance test results</span></span>
<span id="cb419-4681"><a href="#cb419-4681" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Frequency Table for Instrument-specific Data:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4682"><a href="#cb419-4682" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(freq_table_instruments)</span>
<span id="cb419-4683"><a href="#cb419-4683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4684"><a href="#cb419-4684" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance Test Results by Instrument:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4685"><a href="#cb419-4685" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_results)</span>
<span id="cb419-4686"><a href="#cb419-4686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-4687"><a href="#cb419-4687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4688"><a href="#cb419-4688" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-4689"><a href="#cb419-4689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4690"><a href="#cb419-4690" aria-hidden="true" tabindex="-1"></a>The distribution of participants' years of experience playing wind instruments is as follows:</span>
<span id="cb419-4691"><a href="#cb419-4691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4692"><a href="#cb419-4692" aria-hidden="true" tabindex="-1"></a>• The largest group is "20+yrs," indicating a significant portion of participants have extensive experience.</span>
<span id="cb419-4693"><a href="#cb419-4693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4694"><a href="#cb419-4694" aria-hidden="true" tabindex="-1"></a>• The second-largest group is "<span class="sc">\&lt;</span>4yrs," showing a notable number of beginners or those with limited experience.</span>
<span id="cb419-4695"><a href="#cb419-4695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4696"><a href="#cb419-4696" aria-hidden="true" tabindex="-1"></a>• The middle categories ("5-9yrs," "10-14yrs," and "15-19yrs") have progressively fewer participants, suggesting a gradual decline in representation as experience increases. This distribution suggests a bimodal pattern, with many participants either being beginners or highly experienced players.</span>
<span id="cb419-4697"><a href="#cb419-4697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4698"><a href="#cb419-4698" aria-hidden="true" tabindex="-1"></a>**Interpretation**</span>
<span id="cb419-4699"><a href="#cb419-4699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4700"><a href="#cb419-4700" aria-hidden="true" tabindex="-1"></a>*Experience Skew:* The distribution is heavily skewed towards more experienced individuals: the highest percentage (41.85%) is in the "20+yrs" category, suggesting that a significant proportion of respondents have a long history of playing experience.</span>
<span id="cb419-4701"><a href="#cb419-4701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4702"><a href="#cb419-4702" aria-hidden="true" tabindex="-1"></a>*Intermediate Groups:* The 10-14yrs and 5-9yrs groups also represent substantial portions of the sample (roughly 20.73% and 19.58%, respectively), indicating that a majority of the sample falls within these mid-to-high ranges of experience.</span>
<span id="cb419-4703"><a href="#cb419-4703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4704"><a href="#cb419-4704" aria-hidden="true" tabindex="-1"></a>*Minority Group:* The least represented group is the "<span class="sc">\&lt;</span>5yrs" category with only about 6.80% of the sample. This might imply either that the surveyed population tends to be more experienced or that newer players are underrepresented in this particular dataset.</span>
<span id="cb419-4705"><a href="#cb419-4705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4706"><a href="#cb419-4706" aria-hidden="true" tabindex="-1"></a>**Implications**</span>
<span id="cb419-4707"><a href="#cb419-4707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4708"><a href="#cb419-4708" aria-hidden="true" tabindex="-1"></a>*Targeting and Marketing:* For stakeholders interested in reaching out to the largest segment, strategies might focus on highly experienced musicians, particularly those with more than 20 years of experience.</span>
<span id="cb419-4709"><a href="#cb419-4709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4710"><a href="#cb419-4710" aria-hidden="true" tabindex="-1"></a>*Support and Development:* Conversely, given the smaller sample of less experienced (<span class="sc">\&lt;</span>5yrs) musicians, additional support or targeted outreach could be considered if the goal is to encourage growth or adoption among newer players.</span>
<span id="cb419-4711"><a href="#cb419-4711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4712"><a href="#cb419-4712" aria-hidden="true" tabindex="-1"></a>In summary, the analysis shows a distinct predominance of highly experienced musicians, with the largest group having 20+ years of playing experience.</span>
<span id="cb419-4713"><a href="#cb419-4713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4714"><a href="#cb419-4714" aria-hidden="true" tabindex="-1"></a>**By Instrument**</span>
<span id="cb419-4715"><a href="#cb419-4715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4716"><a href="#cb419-4716" aria-hidden="true" tabindex="-1"></a>*Overview and Data Reshaping* The analysis focused on recoding and comparing the years of playing experience across a variety of instruments. Each instrument-specific column (e.g., yrsPlay_flute, yrsPlay_picc, etc.) originally recorded experience on a scale from 1 to 5 was recoded into categorical groups:</span>
<span id="cb419-4717"><a href="#cb419-4717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4718"><a href="#cb419-4718" aria-hidden="true" tabindex="-1"></a>1: <span class="sc">\&lt;</span>5yrs2: 5-9yrs3: 10-14yrs4: 15-19yrs5: 20+yrs1: <span class="sc">\&lt;</span>5yrs2: 5-9yrs3: 10-14yrs4: 15-19yrs5: 20+yrs</span>
<span id="cb419-4719"><a href="#cb419-4719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4720"><a href="#cb419-4720" aria-hidden="true" tabindex="-1"></a>After reshaping the dataset into a long format (where each row corresponds to one instrument for a respondent), frequency counts and percentages were computed per instrument.</span>
<span id="cb419-4721"><a href="#cb419-4721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4722"><a href="#cb419-4722" aria-hidden="true" tabindex="-1"></a>**Key Findings from the Frequency Analysis**</span>
<span id="cb419-4723"><a href="#cb419-4723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4724"><a href="#cb419-4724" aria-hidden="true" tabindex="-1"></a>*Participation Across Instruments:*</span>
<span id="cb419-4725"><a href="#cb419-4725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4726"><a href="#cb419-4726" aria-hidden="true" tabindex="-1"></a>The frequency table (illustrated in the analysis output) shows different levels of participation for each instrument. For instance:</span>
<span id="cb419-4727"><a href="#cb419-4727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4728"><a href="#cb419-4728" aria-hidden="true" tabindex="-1"></a>• Flute: Records the highest number of responses (e.g., 443 observations for the flute) indicating that this instrument had significant representation in the sample.</span>
<span id="cb419-4729"><a href="#cb419-4729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4730"><a href="#cb419-4730" aria-hidden="true" tabindex="-1"></a>• Clarinet and Recorder: Also show high participation, though slightly lower than the flute in some cases.</span>
<span id="cb419-4731"><a href="#cb419-4731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4732"><a href="#cb419-4732" aria-hidden="true" tabindex="-1"></a>• Bassoon, Oboe, etc.: Typically have lower participant counts. For instance, for some double-reed instruments, counts are around or below 150, suggesting that fewer respondents play these instruments compared to more common instruments like the flute or clarinet.</span>
<span id="cb419-4733"><a href="#cb419-4733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4734"><a href="#cb419-4734" aria-hidden="true" tabindex="-1"></a>*Experience Distribution – General Patterns:*</span>
<span id="cb419-4735"><a href="#cb419-4735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4736"><a href="#cb419-4736" aria-hidden="true" tabindex="-1"></a>• Highly Experienced Players Are Predominant: Across several instruments (Flute, Piccolo, Recorder, Clarinet, Saxophone, and Trumpet), the highest frequency lies in the "20+yrs" category. This skew toward the highest level indicates that a significant number of respondents have been playing these instruments for more than 20 years.</span>
<span id="cb419-4737"><a href="#cb419-4737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4738"><a href="#cb419-4738" aria-hidden="true" tabindex="-1"></a>• Diverse Experience Ranges: While some instruments show a clear concentration at the extremes (e.g., many having 20+ years), others such as the Oboe show a different pattern where, for instance, players in the "5-9yrs" category might be more common. These differences likely reflect entry age, learning duration, and perhaps the training regimes or availability of instruction for specific instruments.</span>
<span id="cb419-4739"><a href="#cb419-4739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4740"><a href="#cb419-4740" aria-hidden="true" tabindex="-1"></a>**Statistical Testing and Significance**</span>
<span id="cb419-4741"><a href="#cb419-4741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4742"><a href="#cb419-4742" aria-hidden="true" tabindex="-1"></a>For each instrument, a Chi-square test was performed to evaluate whether the observed distribution of playing experience categories deviates significantly from a uniform distribution (the null hypothesis). The test results are summarized by:</span>
<span id="cb419-4743"><a href="#cb419-4743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4744"><a href="#cb419-4744" aria-hidden="true" tabindex="-1"></a>*Chi-square Statistic and p-value:*</span>
<span id="cb419-4745"><a href="#cb419-4745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4746"><a href="#cb419-4746" aria-hidden="true" tabindex="-1"></a>In all presented cases, the p-values were extremely small (most reported as $p &lt; 0.001$ or even exactly $p &lt; 3.86 \times 10^{-18}$ in some cases). This indicates that the null hypothesis of a uniform distribution can be strongly rejected; in other words, for every instrument, the distribution of playing experience is not uniform.</span>
<span id="cb419-4747"><a href="#cb419-4747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4748"><a href="#cb419-4748" aria-hidden="true" tabindex="-1"></a>*Effect Size Using Cramér’s V:*</span>
<span id="cb419-4749"><a href="#cb419-4749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4750"><a href="#cb419-4750" aria-hidden="true" tabindex="-1"></a>Cramér’s V values ranged roughly from 0.16 to 0.33. While the interpretation of effect size can vary depending on context, these values suggest a small-to-moderate association between the instrument played and the experience category. The moderate effect sizes reinforce the inference that, even though each instrument shows a statistically significant non-uniform distribution, the degree of association is modest and may reflect underlying differences among instruments (for example, the different typical career trajectories or training regimens). <span class="sc">\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_</span> **Graphical Representation**</span>
<span id="cb419-4751"><a href="#cb419-4751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4752"><a href="#cb419-4752" aria-hidden="true" tabindex="-1"></a>*The faceted bar plot - Visual Structure:*</span>
<span id="cb419-4753"><a href="#cb419-4753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4754"><a href="#cb419-4754" aria-hidden="true" tabindex="-1"></a>Each instrument is represented as its own facet, where the bars display the counts of respondents per experience category. The labels on the bars show both the raw counts and the percentage that the count represents within that instrument group. This makes it easy to compare the practical significance of the numbers across instruments.</span>
<span id="cb419-4755"><a href="#cb419-4755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4756"><a href="#cb419-4756" aria-hidden="true" tabindex="-1"></a>*Insights from the Plot:*</span>
<span id="cb419-4757"><a href="#cb419-4757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4758"><a href="#cb419-4758" aria-hidden="true" tabindex="-1"></a>• Instruments like the Flute and Clarinet tend to have a long tail in the “20+yrs” category, indicating that these instruments are often played over a long period by experienced musicians.</span>
<span id="cb419-4759"><a href="#cb419-4759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4760"><a href="#cb419-4760" aria-hidden="true" tabindex="-1"></a>• In contrast, other instruments such as Oboe may reveal a slightly different experience profile, suggesting that fewer respondents reach the highest experience level—or that newer players are more prevalent in the sample.</span>
<span id="cb419-4761"><a href="#cb419-4761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4762"><a href="#cb419-4762" aria-hidden="true" tabindex="-1"></a>*Comprehensive Comparison:*</span>
<span id="cb419-4763"><a href="#cb419-4763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4764"><a href="#cb419-4764" aria-hidden="true" tabindex="-1"></a>By comparing across facets, viewers can quickly grasp how the distribution of playing experience differs by instrument—a valuable insight when considering curricular designs, marketing strategies for music education, or understanding career longevity within different instrumental sections (e.g., orchestral vs. band instruments).</span>
<span id="cb419-4765"><a href="#cb419-4765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4766"><a href="#cb419-4766" aria-hidden="true" tabindex="-1"></a>**Interpretation and Implications**</span>
<span id="cb419-4767"><a href="#cb419-4767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4768"><a href="#cb419-4768" aria-hidden="true" tabindex="-1"></a>*Diversity &amp; Specialization:*</span>
<span id="cb419-4769"><a href="#cb419-4769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4770"><a href="#cb419-4770" aria-hidden="true" tabindex="-1"></a>• The clear predominance of experienced players (especially the “20+yrs” category) in many instruments implies that respondents are mostly well-established musicians. This might reflect the sampling frame of the survey, suggesting an overrepresentation of long-term practitioners.</span>
<span id="cb419-4771"><a href="#cb419-4771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4772"><a href="#cb419-4772" aria-hidden="true" tabindex="-1"></a>• For instruments like the Oboe or Bassoon (typically less common), lower numbers may signal niche interest groups where early-career musicians have different trajectories or where training opportunities might be less available.</span>
<span id="cb419-4773"><a href="#cb419-4773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4774"><a href="#cb419-4774" aria-hidden="true" tabindex="-1"></a>*Targeted Interventions and Further Research:*</span>
<span id="cb419-4775"><a href="#cb419-4775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4776"><a href="#cb419-4776" aria-hidden="true" tabindex="-1"></a>• For Education and Outreach: If the goal is to foster new talent or broaden participation, it might be worth exploring why certain instruments have fewer less-experienced players. It could be due to a lack of beginner resources or lower availability.</span>
<span id="cb419-4777"><a href="#cb419-4777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4778"><a href="#cb419-4778" aria-hidden="true" tabindex="-1"></a>• For Resource Allocation: Organizations and institutions (music schools, orchestras, etc.) may use this data to allocate resources more efficiently by understanding which instruments attract a diverse range of experience levels.</span>
<span id="cb419-4779"><a href="#cb419-4779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4780"><a href="#cb419-4780" aria-hidden="true" tabindex="-1"></a>*Statistical Robustness:*</span>
<span id="cb419-4781"><a href="#cb419-4781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4782"><a href="#cb419-4782" aria-hidden="true" tabindex="-1"></a>• The highly significant Chi-square results suggest that these patterns are not random – there is a genuine underlying structure in the distribution of years of playing experience across instruments.</span>
<span id="cb419-4783"><a href="#cb419-4783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4784"><a href="#cb419-4784" aria-hidden="true" tabindex="-1"></a>• The modest effect sizes (Cramér's V) indicate that although the differences are statistically significant, the practical magnitude of the association is moderate. This nuance is important when making decisions or crafting policies based solely on statistical outcomes versus contextual considerations.</span>
<span id="cb419-4785"><a href="#cb419-4785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4786"><a href="#cb419-4786" aria-hidden="true" tabindex="-1"></a>**Conclusion**</span>
<span id="cb419-4787"><a href="#cb419-4787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4788"><a href="#cb419-4788" aria-hidden="true" tabindex="-1"></a>In summary, the analysis reveals that:</span>
<span id="cb419-4789"><a href="#cb419-4789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4790"><a href="#cb419-4790" aria-hidden="true" tabindex="-1"></a>• The playing experience–related distribution is significantly non-uniform across various instruments.</span>
<span id="cb419-4791"><a href="#cb419-4791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4792"><a href="#cb419-4792" aria-hidden="true" tabindex="-1"></a>• There is a marked skew toward high levels of experience for instruments such as the Flute and Clarinet.</span>
<span id="cb419-4793"><a href="#cb419-4793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4794"><a href="#cb419-4794" aria-hidden="true" tabindex="-1"></a>• Statistically significant differences exist among the instruments, though effect sizes suggest these associations are moderate.</span>
<span id="cb419-4795"><a href="#cb419-4795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4796"><a href="#cb419-4796" aria-hidden="true" tabindex="-1"></a>• These insights can inform further qualitative investigations, resource planning, or targeted interventions in music education and practice.</span>
<span id="cb419-4797"><a href="#cb419-4797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4798"><a href="#cb419-4798" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inferential Stats</span></span>
<span id="cb419-4799"><a href="#cb419-4799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4802"><a href="#cb419-4802" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-4803"><a href="#cb419-4803" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Data Preparation Function</span></span>
<span id="cb419-4804"><a href="#cb419-4804" aria-hidden="true" tabindex="-1"></a>prepare_years_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path) {</span>
<span id="cb419-4805"><a href="#cb419-4805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb419-4806"><a href="#cb419-4806" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the data</span></span>
<span id="cb419-4807"><a href="#cb419-4807" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file_path, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-4808"><a href="#cb419-4808" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4809"><a href="#cb419-4809" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure numeric conversion and handle potential NA values</span></span>
<span id="cb419-4810"><a href="#cb419-4810" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4811"><a href="#cb419-4811" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb419-4812"><a href="#cb419-4812" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to numeric, replacing NA with a safe default</span></span>
<span id="cb419-4813"><a href="#cb419-4813" aria-hidden="true" tabindex="-1"></a>        <span class="at">yrsPlay_MAX =</span> <span class="fu">as.numeric</span>(yrsPlay_MAX),</span>
<span id="cb419-4814"><a href="#cb419-4814" aria-hidden="true" tabindex="-1"></a>        <span class="at">RMTMethods_YN =</span> <span class="fu">as.numeric</span>(RMTMethods_YN)</span>
<span id="cb419-4815"><a href="#cb419-4815" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb419-4816"><a href="#cb419-4816" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4817"><a href="#cb419-4817" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recode yrsPlay_MAX variable with robust handling</span></span>
<span id="cb419-4818"><a href="#cb419-4818" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4819"><a href="#cb419-4819" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">yrsPlay_cat =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-4820"><a href="#cb419-4820" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"&lt;5yrs"</span>,</span>
<span id="cb419-4821"><a href="#cb419-4821" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"5-9yrs"</span>,</span>
<span id="cb419-4822"><a href="#cb419-4822" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"10-14yrs"</span>,</span>
<span id="cb419-4823"><a href="#cb419-4823" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"15-19yrs"</span>,</span>
<span id="cb419-4824"><a href="#cb419-4824" aria-hidden="true" tabindex="-1"></a>        yrsPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"20+yrs"</span>,</span>
<span id="cb419-4825"><a href="#cb419-4825" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-4826"><a href="#cb419-4826" aria-hidden="true" tabindex="-1"></a>      ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"&lt;5yrs"</span>, <span class="st">"5-9yrs"</span>, <span class="st">"10-14yrs"</span>, <span class="st">"15-19yrs"</span>, <span class="st">"20+yrs"</span>)))</span>
<span id="cb419-4827"><a href="#cb419-4827" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4828"><a href="#cb419-4828" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recode RMTMethods_YN into group labels with robust handling</span></span>
<span id="cb419-4829"><a href="#cb419-4829" aria-hidden="true" tabindex="-1"></a>    data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4830"><a href="#cb419-4830" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">RMTMethods_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-4831"><a href="#cb419-4831" aria-hidden="true" tabindex="-1"></a>        RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No (n = 1330)"</span>,</span>
<span id="cb419-4832"><a href="#cb419-4832" aria-hidden="true" tabindex="-1"></a>        RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Yes (n = 228)"</span>,</span>
<span id="cb419-4833"><a href="#cb419-4833" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-4834"><a href="#cb419-4834" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb419-4835"><a href="#cb419-4835" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4836"><a href="#cb419-4836" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter out rows with missing values</span></span>
<span id="cb419-4837"><a href="#cb419-4837" aria-hidden="true" tabindex="-1"></a>    data_processed <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-4838"><a href="#cb419-4838" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(yrsPlay_cat) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(RMTMethods_group))</span>
<span id="cb419-4839"><a href="#cb419-4839" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4840"><a href="#cb419-4840" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(data_processed)</span>
<span id="cb419-4841"><a href="#cb419-4841" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb419-4842"><a href="#cb419-4842" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"Error in data preparation:"</span>, e<span class="sc">$</span>message))</span>
<span id="cb419-4843"><a href="#cb419-4843" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb419-4844"><a href="#cb419-4844" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-4845"><a href="#cb419-4845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4846"><a href="#cb419-4846" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Statistical Testing Function</span></span>
<span id="cb419-4847"><a href="#cb419-4847" aria-hidden="true" tabindex="-1"></a>perform_robust_statistical_test <span class="ot">&lt;-</span> <span class="cf">function</span>(cont_table) {</span>
<span id="cb419-4848"><a href="#cb419-4848" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check expected cell frequencies</span></span>
<span id="cb419-4849"><a href="#cb419-4849" aria-hidden="true" tabindex="-1"></a>  expected_freq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table)<span class="sc">$</span>expected</span>
<span id="cb419-4850"><a href="#cb419-4850" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4851"><a href="#cb419-4851" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Criteria for test selection</span></span>
<span id="cb419-4852"><a href="#cb419-4852" aria-hidden="true" tabindex="-1"></a>  total_cells <span class="ot">&lt;-</span> <span class="fu">length</span>(expected_freq)</span>
<span id="cb419-4853"><a href="#cb419-4853" aria-hidden="true" tabindex="-1"></a>  low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb419-4854"><a href="#cb419-4854" aria-hidden="true" tabindex="-1"></a>  min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb419-4855"><a href="#cb419-4855" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4856"><a href="#cb419-4856" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print diagnostic information</span></span>
<span id="cb419-4857"><a href="#cb419-4857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4858"><a href="#cb419-4858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4859"><a href="#cb419-4859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb419-4860"><a href="#cb419-4860" aria-hidden="true" tabindex="-1"></a>      <span class="st">"out of"</span>, total_cells, <span class="st">"cells ("</span>, </span>
<span id="cb419-4861"><a href="#cb419-4861" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> total_cells <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb419-4862"><a href="#cb419-4862" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4863"><a href="#cb419-4863" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select appropriate test</span></span>
<span id="cb419-4864"><a href="#cb419-4864" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> total_cells) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb419-4865"><a href="#cb419-4865" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use Fisher's exact test with Monte Carlo simulation</span></span>
<span id="cb419-4866"><a href="#cb419-4866" aria-hidden="true" tabindex="-1"></a>    exact_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(cont_table, <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">10000</span>)</span>
<span id="cb419-4867"><a href="#cb419-4867" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4868"><a href="#cb419-4868" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-4869"><a href="#cb419-4869" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test (Monte Carlo)"</span>,</span>
<span id="cb419-4870"><a href="#cb419-4870" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> exact_test<span class="sc">$</span>p.value,</span>
<span id="cb419-4871"><a href="#cb419-4871" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> <span class="cn">NA</span>,</span>
<span id="cb419-4872"><a href="#cb419-4872" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb419-4873"><a href="#cb419-4873" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-4874"><a href="#cb419-4874" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb419-4875"><a href="#cb419-4875" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb419-4876"><a href="#cb419-4876" aria-hidden="true" tabindex="-1"></a>    chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb419-4877"><a href="#cb419-4877" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-4878"><a href="#cb419-4878" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-4879"><a href="#cb419-4879" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Chi-Square with Continuity Correction"</span>,</span>
<span id="cb419-4880"><a href="#cb419-4880" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> chi_test<span class="sc">$</span>p.value,</span>
<span id="cb419-4881"><a href="#cb419-4881" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> chi_test<span class="sc">$</span>statistic,</span>
<span id="cb419-4882"><a href="#cb419-4882" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameter =</span> chi_test<span class="sc">$</span>parameter,</span>
<span id="cb419-4883"><a href="#cb419-4883" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="fu">paste</span>(<span class="st">"Pearson's Chi-squared test with Yates' continuity correction,"</span>,</span>
<span id="cb419-4884"><a href="#cb419-4884" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"df ="</span>, chi_test<span class="sc">$</span>parameter)</span>
<span id="cb419-4885"><a href="#cb419-4885" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-4886"><a href="#cb419-4886" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-4887"><a href="#cb419-4887" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-4888"><a href="#cb419-4888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4889"><a href="#cb419-4889" aria-hidden="true" tabindex="-1"></a><span class="co"># Main Analysis Function</span></span>
<span id="cb419-4890"><a href="#cb419-4890" aria-hidden="true" tabindex="-1"></a>run_years_playing_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb419-4891"><a href="#cb419-4891" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_path =</span> <span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span></span>
<span id="cb419-4892"><a href="#cb419-4892" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb419-4893"><a href="#cb419-4893" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare data</span></span>
<span id="cb419-4894"><a href="#cb419-4894" aria-hidden="true" tabindex="-1"></a>  data_processed <span class="ot">&lt;-</span> <span class="fu">prepare_years_data</span>(file_path)</span>
<span id="cb419-4895"><a href="#cb419-4895" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4896"><a href="#cb419-4896" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total number of observations used</span></span>
<span id="cb419-4897"><a href="#cb419-4897" aria-hidden="true" tabindex="-1"></a>  total_n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_processed)</span>
<span id="cb419-4898"><a href="#cb419-4898" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4899"><a href="#cb419-4899" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create frequency table</span></span>
<span id="cb419-4900"><a href="#cb419-4900" aria-hidden="true" tabindex="-1"></a>  freq_table <span class="ot">&lt;-</span> data_processed <span class="sc">%&gt;%</span></span>
<span id="cb419-4901"><a href="#cb419-4901" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(yrsPlay_cat, RMTMethods_group) <span class="sc">%&gt;%</span></span>
<span id="cb419-4902"><a href="#cb419-4902" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-4903"><a href="#cb419-4903" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(RMTMethods_group) <span class="sc">%&gt;%</span></span>
<span id="cb419-4904"><a href="#cb419-4904" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">percentage =</span> (count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb419-4905"><a href="#cb419-4905" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4906"><a href="#cb419-4906" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create contingency table</span></span>
<span id="cb419-4907"><a href="#cb419-4907" aria-hidden="true" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data_processed<span class="sc">$</span>yrsPlay_cat, data_processed<span class="sc">$</span>RMTMethods_group)</span>
<span id="cb419-4908"><a href="#cb419-4908" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4909"><a href="#cb419-4909" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform robust statistical test</span></span>
<span id="cb419-4910"><a href="#cb419-4910" aria-hidden="true" tabindex="-1"></a>  stat_test <span class="ot">&lt;-</span> <span class="fu">perform_robust_statistical_test</span>(contingency_table)</span>
<span id="cb419-4911"><a href="#cb419-4911" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4912"><a href="#cb419-4912" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate Cramer's V</span></span>
<span id="cb419-4913"><a href="#cb419-4913" aria-hidden="true" tabindex="-1"></a>  n_val <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb419-4914"><a href="#cb419-4914" aria-hidden="true" tabindex="-1"></a>  min_dim <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb419-4915"><a href="#cb419-4915" aria-hidden="true" tabindex="-1"></a>  cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(stat_test<span class="sc">$</span>statistic <span class="sc">/</span> (n_val <span class="sc">*</span> min_dim))</span>
<span id="cb419-4916"><a href="#cb419-4916" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4917"><a href="#cb419-4917" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the Plot</span></span>
<span id="cb419-4918"><a href="#cb419-4918" aria-hidden="true" tabindex="-1"></a>  plot_years <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> yrsPlay_cat, <span class="at">fill =</span> RMTMethods_group)) <span class="sc">+</span></span>
<span id="cb419-4919"><a href="#cb419-4919" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb419-4920"><a href="#cb419-4920" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb419-4921"><a href="#cb419-4921" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d (%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-4922"><a href="#cb419-4922" aria-hidden="true" tabindex="-1"></a>      <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>),</span>
<span id="cb419-4923"><a href="#cb419-4923" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, </span>
<span id="cb419-4924"><a href="#cb419-4924" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb419-4925"><a href="#cb419-4925" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-4926"><a href="#cb419-4926" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb419-4927"><a href="#cb419-4927" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Years of playing experience by RMT device use (N = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb419-4928"><a href="#cb419-4928" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Count"</span>,</span>
<span id="cb419-4929"><a href="#cb419-4929" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Years of playing experience"</span>,</span>
<span id="cb419-4930"><a href="#cb419-4930" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"RMT device use"</span>,</span>
<span id="cb419-4931"><a href="#cb419-4931" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="fu">paste0</span>(</span>
<span id="cb419-4932"><a href="#cb419-4932" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Note. Percentages calculated within RMT device groups.</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb419-4933"><a href="#cb419-4933" aria-hidden="true" tabindex="-1"></a>        stat_test<span class="sc">$</span>method, <span class="st">": p = "</span>, <span class="fu">format.pval</span>(stat_test<span class="sc">$</span>p_value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb419-4934"><a href="#cb419-4934" aria-hidden="true" tabindex="-1"></a>        <span class="st">", Cramer's V = "</span>, <span class="fu">round</span>(cramers_v, <span class="dv">3</span>)</span>
<span id="cb419-4935"><a href="#cb419-4935" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb419-4936"><a href="#cb419-4936" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-4937"><a href="#cb419-4937" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-4938"><a href="#cb419-4938" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb419-4939"><a href="#cb419-4939" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4940"><a href="#cb419-4940" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4941"><a href="#cb419-4941" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb419-4942"><a href="#cb419-4942" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">40</span>, <span class="at">t =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">unit =</span> <span class="st">"pt"</span>),</span>
<span id="cb419-4943"><a href="#cb419-4943" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb419-4944"><a href="#cb419-4944" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb419-4945"><a href="#cb419-4945" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-4946"><a href="#cb419-4946" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-4947"><a href="#cb419-4947" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb419-4948"><a href="#cb419-4948" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb419-4949"><a href="#cb419-4949" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb419-4950"><a href="#cb419-4950" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>))) <span class="sc">+</span></span>
<span id="cb419-4951"><a href="#cb419-4951" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No (n = 1330)"</span> <span class="ot">=</span> <span class="st">"#4472C4"</span>, <span class="st">"Yes (n = 228)"</span> <span class="ot">=</span> <span class="st">"#ED7D31"</span>))</span>
<span id="cb419-4952"><a href="#cb419-4952" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4953"><a href="#cb419-4953" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print statistical results</span></span>
<span id="cb419-4954"><a href="#cb419-4954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Contingency Table:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4955"><a href="#cb419-4955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(contingency_table)</span>
<span id="cb419-4956"><a href="#cb419-4956" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4957"><a href="#cb419-4957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statistical Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4958"><a href="#cb419-4958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Test Type:"</span>, stat_test<span class="sc">$</span>test_type, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4959"><a href="#cb419-4959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"P-value:"</span>, stat_test<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4960"><a href="#cb419-4960" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stat_test<span class="sc">$</span>test_type <span class="sc">==</span> <span class="st">"Chi-Square with Continuity Correction"</span>) {</span>
<span id="cb419-4961"><a href="#cb419-4961" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Chi-square Statistic:"</span>, stat_test<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4962"><a href="#cb419-4962" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Degrees of Freedom:"</span>, stat_test<span class="sc">$</span>parameter, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4963"><a href="#cb419-4963" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-4964"><a href="#cb419-4964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cramer's V:"</span>, cramers_v, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-4965"><a href="#cb419-4965" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4966"><a href="#cb419-4966" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the plot</span></span>
<span id="cb419-4967"><a href="#cb419-4967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot_years)</span>
<span id="cb419-4968"><a href="#cb419-4968" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-4969"><a href="#cb419-4969" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results for potential further analysis</span></span>
<span id="cb419-4970"><a href="#cb419-4970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-4971"><a href="#cb419-4971" aria-hidden="true" tabindex="-1"></a>    <span class="at">freq_table =</span> freq_table,</span>
<span id="cb419-4972"><a href="#cb419-4972" aria-hidden="true" tabindex="-1"></a>    <span class="at">contingency_table =</span> contingency_table,</span>
<span id="cb419-4973"><a href="#cb419-4973" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat_test =</span> stat_test,</span>
<span id="cb419-4974"><a href="#cb419-4974" aria-hidden="true" tabindex="-1"></a>    <span class="at">cramers_v =</span> cramers_v,</span>
<span id="cb419-4975"><a href="#cb419-4975" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> plot_years</span>
<span id="cb419-4976"><a href="#cb419-4976" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb419-4977"><a href="#cb419-4977" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-4978"><a href="#cb419-4978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4979"><a href="#cb419-4979" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the analysis</span></span>
<span id="cb419-4980"><a href="#cb419-4980" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_years_playing_analysis</span>()</span>
<span id="cb419-4981"><a href="#cb419-4981" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-4982"><a href="#cb419-4982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4983"><a href="#cb419-4983" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-4984"><a href="#cb419-4984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4985"><a href="#cb419-4985" aria-hidden="true" tabindex="-1"></a>**Chi-square Test of Independence:**</span>
<span id="cb419-4986"><a href="#cb419-4986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4987"><a href="#cb419-4987" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>1<span class="sc">\]</span> "\nChi-square test of independence:"</span>
<span id="cb419-4988"><a href="#cb419-4988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4989"><a href="#cb419-4989" aria-hidden="true" tabindex="-1"></a>**Pearson's Chi-squared test** data: contingency_table X-squared = 12.405, df = 4, p-value = 0.01458 The chi-square test shows a significant association between years of playing experience and RMT usage (χ²(4) = 12.41, p = .015).</span>
<span id="cb419-4990"><a href="#cb419-4990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4991"><a href="#cb419-4991" aria-hidden="true" tabindex="-1"></a>**Standardized Residuals:** The standardized residuals show that:</span>
<span id="cb419-4992"><a href="#cb419-4992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4993"><a href="#cb419-4993" aria-hidden="true" tabindex="-1"></a>• The 10-14 years group has significantly more RMT users than expected (3.14)</span>
<span id="cb419-4994"><a href="#cb419-4994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4995"><a href="#cb419-4995" aria-hidden="true" tabindex="-1"></a>• Other groups show some variation but not at statistically significant levels</span>
<span id="cb419-4996"><a href="#cb419-4996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4997"><a href="#cb419-4997" aria-hidden="true" tabindex="-1"></a>After Bonferroni correction, there is:</span>
<span id="cb419-4998"><a href="#cb419-4998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4999"><a href="#cb419-4999" aria-hidden="true" tabindex="-1"></a>• A significant difference between the 10-14 years and 20+ years groups (p = .042)</span>
<span id="cb419-5000"><a href="#cb419-5000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5001"><a href="#cb419-5001" aria-hidden="true" tabindex="-1"></a>• All other pairwise comparisons are not statistically significant Key Findings:</span>
<span id="cb419-5002"><a href="#cb419-5002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5003"><a href="#cb419-5003" aria-hidden="true" tabindex="-1"></a>• RMT usage varies significantly across experience groups</span>
<span id="cb419-5004"><a href="#cb419-5004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5005"><a href="#cb419-5005" aria-hidden="true" tabindex="-1"></a>• The 10-14 years group shows the highest proportion of RMT users (20.1%)</span>
<span id="cb419-5006"><a href="#cb419-5006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5007"><a href="#cb419-5007" aria-hidden="true" tabindex="-1"></a>• The <span class="sc">\&lt;</span>4 years group shows the lowest proportion of RMT users (9.4%)</span>
<span id="cb419-5008"><a href="#cb419-5008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5009"><a href="#cb419-5009" aria-hidden="true" tabindex="-1"></a>• There's a notable peak in RMT usage in the middle experience ranges (10-14 years) with lower usage in both very experienced and novice players</span>
<span id="cb419-5010"><a href="#cb419-5010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5011"><a href="#cb419-5011" aria-hidden="true" tabindex="-1"></a>**Distribution Overview**</span>
<span id="cb419-5012"><a href="#cb419-5012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5013"><a href="#cb419-5013" aria-hidden="true" tabindex="-1"></a>Total Sample Size: N = 1,558</span>
<span id="cb419-5014"><a href="#cb419-5014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5015"><a href="#cb419-5015" aria-hidden="true" tabindex="-1"></a>• RMT Device Non-Users: n = 1,330 (85.4%)</span>
<span id="cb419-5016"><a href="#cb419-5016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5017"><a href="#cb419-5017" aria-hidden="true" tabindex="-1"></a>• RMT Device Users: n = 228 (14.6%)</span>
<span id="cb419-5018"><a href="#cb419-5018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5019"><a href="#cb419-5019" aria-hidden="true" tabindex="-1"></a>**Years of Playing Experience Distribution**</span>
<span id="cb419-5020"><a href="#cb419-5020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5021"><a href="#cb419-5021" aria-hidden="true" tabindex="-1"></a>Non-RMT Device Users (n = 1,330):<span class="sc">\*</span></span>
<span id="cb419-5022"><a href="#cb419-5022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5023"><a href="#cb419-5023" aria-hidden="true" tabindex="-1"></a>• <span class="sc">\&lt;</span>5 years: 96 (7.2%)</span>
<span id="cb419-5024"><a href="#cb419-5024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5025"><a href="#cb419-5025" aria-hidden="true" tabindex="-1"></a>• 5-9 years: 264 (19.8%)</span>
<span id="cb419-5026"><a href="#cb419-5026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5027"><a href="#cb419-5027" aria-hidden="true" tabindex="-1"></a>• 10-14 years: 258 (19.4%)</span>
<span id="cb419-5028"><a href="#cb419-5028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5029"><a href="#cb419-5029" aria-hidden="true" tabindex="-1"></a>• 15-19 years: 144 (10.8%)</span>
<span id="cb419-5030"><a href="#cb419-5030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5031"><a href="#cb419-5031" aria-hidden="true" tabindex="-1"></a>• 20+ years: 568 (42.7%)</span>
<span id="cb419-5032"><a href="#cb419-5032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5033"><a href="#cb419-5033" aria-hidden="true" tabindex="-1"></a>*RMT Device Users (n = 228):*</span>
<span id="cb419-5034"><a href="#cb419-5034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5035"><a href="#cb419-5035" aria-hidden="true" tabindex="-1"></a>• <span class="sc">\&lt;</span>5 years: 10 (4.4%)</span>
<span id="cb419-5036"><a href="#cb419-5036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5037"><a href="#cb419-5037" aria-hidden="true" tabindex="-1"></a>• 5-9 years: 41 (18.0%)</span>
<span id="cb419-5038"><a href="#cb419-5038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5039"><a href="#cb419-5039" aria-hidden="true" tabindex="-1"></a>• 10-14 years: 65 (28.5%)</span>
<span id="cb419-5040"><a href="#cb419-5040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5041"><a href="#cb419-5041" aria-hidden="true" tabindex="-1"></a>• 15-19 years: 28 (12.3%)</span>
<span id="cb419-5042"><a href="#cb419-5042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5043"><a href="#cb419-5043" aria-hidden="true" tabindex="-1"></a>• 20+ years: 84 (36.8%)</span>
<span id="cb419-5044"><a href="#cb419-5044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5045"><a href="#cb419-5045" aria-hidden="true" tabindex="-1"></a>**Statistical Analysis** *Chi-square Test Results:*</span>
<span id="cb419-5046"><a href="#cb419-5046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5047"><a href="#cb419-5047" aria-hidden="true" tabindex="-1"></a>• χ²(4) = 12.405, p = 0.015</span>
<span id="cb419-5048"><a href="#cb419-5048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5049"><a href="#cb419-5049" aria-hidden="true" tabindex="-1"></a>• This indicates a statistically significant association between years of playing experience and RMT device use</span>
<span id="cb419-5050"><a href="#cb419-5050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5051"><a href="#cb419-5051" aria-hidden="true" tabindex="-1"></a>• The p-value (0.015) is below the conventional significance level of 0.05</span>
<span id="cb419-5052"><a href="#cb419-5052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5053"><a href="#cb419-5053" aria-hidden="true" tabindex="-1"></a>**Effect Size:**</span>
<span id="cb419-5054"><a href="#cb419-5054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5055"><a href="#cb419-5055" aria-hidden="true" tabindex="-1"></a>• Cramer's V = 0.089</span>
<span id="cb419-5056"><a href="#cb419-5056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5057"><a href="#cb419-5057" aria-hidden="true" tabindex="-1"></a>• This suggests a weak association between years of playing experience and RMT device use</span>
<span id="cb419-5058"><a href="#cb419-5058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5059"><a href="#cb419-5059" aria-hidden="true" tabindex="-1"></a>• Values of Cramer's V range from 0 to 1, where:</span>
<span id="cb419-5060"><a href="#cb419-5060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5061"><a href="#cb419-5061" aria-hidden="true" tabindex="-1"></a>• 0.1 indicates a small effect</span>
<span id="cb419-5062"><a href="#cb419-5062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5063"><a href="#cb419-5063" aria-hidden="true" tabindex="-1"></a>• 0.3 indicates a medium effect</span>
<span id="cb419-5064"><a href="#cb419-5064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5065"><a href="#cb419-5065" aria-hidden="true" tabindex="-1"></a>• 0.5 indicates a large effect</span>
<span id="cb419-5066"><a href="#cb419-5066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5067"><a href="#cb419-5067" aria-hidden="true" tabindex="-1"></a>**Key Findings and Interpretation** *Experience Level Distribution:*</span>
<span id="cb419-5068"><a href="#cb419-5068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5069"><a href="#cb419-5069" aria-hidden="true" tabindex="-1"></a>• In both groups, the largest proportion of musicians had 20+ years of experience</span>
<span id="cb419-5070"><a href="#cb419-5070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5071"><a href="#cb419-5071" aria-hidden="true" tabindex="-1"></a>• The second most common category differed between groups:</span>
<span id="cb419-5072"><a href="#cb419-5072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5073"><a href="#cb419-5073" aria-hidden="true" tabindex="-1"></a>• Non-RMT users: 5-9 years (19.8%)</span>
<span id="cb419-5074"><a href="#cb419-5074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5075"><a href="#cb419-5075" aria-hidden="true" tabindex="-1"></a>• RMT users: 10-14 years (28.5%)</span>
<span id="cb419-5076"><a href="#cb419-5076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5077"><a href="#cb419-5077" aria-hidden="true" tabindex="-1"></a>**Notable Differences:**</span>
<span id="cb419-5078"><a href="#cb419-5078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5079"><a href="#cb419-5079" aria-hidden="true" tabindex="-1"></a>• The proportion of musicians with 10-14 years of experience is notably higher among RMT device users (28.5%) compared to non-users (19.4%)</span>
<span id="cb419-5080"><a href="#cb419-5080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5081"><a href="#cb419-5081" aria-hidden="true" tabindex="-1"></a>• There is a lower proportion of very experienced musicians (20+ years) among RMT device users (36.8%) compared to non-users (42.7%)</span>
<span id="cb419-5082"><a href="#cb419-5082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5083"><a href="#cb419-5083" aria-hidden="true" tabindex="-1"></a>• Early-career musicians (<span class="sc">\&lt;</span>5 years) are less represented among RMT device users (4.4%) compared to non-users (7.2%)</span>
<span id="cb419-5084"><a href="#cb419-5084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5085"><a href="#cb419-5085" aria-hidden="true" tabindex="-1"></a>**Statistical Significance:**</span>
<span id="cb419-5086"><a href="#cb419-5086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5087"><a href="#cb419-5087" aria-hidden="true" tabindex="-1"></a>• While the chi-square test indicates a significant association (p = 0.015), the small Cramer's V value (0.089) suggests this association is weak</span>
<span id="cb419-5088"><a href="#cb419-5088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5089"><a href="#cb419-5089" aria-hidden="true" tabindex="-1"></a>• This means that while there is a relationship between years of experience and RMT device use, other factors likely play a more important role in determining RMT device adoption</span>
<span id="cb419-5090"><a href="#cb419-5090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5091"><a href="#cb419-5091" aria-hidden="true" tabindex="-1"></a>**Practical Implications**</span>
<span id="cb419-5092"><a href="#cb419-5092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5093"><a href="#cb419-5093" aria-hidden="true" tabindex="-1"></a>*Experience Level Considerations:* • RMT devices appear to be more commonly adopted by musicians in their mid-career stages (10-14 years)</span>
<span id="cb419-5094"><a href="#cb419-5094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5095"><a href="#cb419-5095" aria-hidden="true" tabindex="-1"></a>• The lower adoption rate among very early-career musicians (<span class="sc">\&lt;</span>5 years) might suggest barriers to entry (e.g., cost, awareness) or perceived lack of necessity</span>
<span id="cb419-5096"><a href="#cb419-5096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5097"><a href="#cb419-5097" aria-hidden="true" tabindex="-1"></a>*Professional Development:*</span>
<span id="cb419-5098"><a href="#cb419-5098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5099"><a href="#cb419-5099" aria-hidden="true" tabindex="-1"></a>• The distribution suggests that RMT devices are used across all experience levels, but with varying adoption rates</span>
<span id="cb419-5100"><a href="#cb419-5100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5101"><a href="#cb419-5101" aria-hidden="true" tabindex="-1"></a>• The peak in the 10-14 years category among RMT users might indicate a career stage where musicians are most likely to incorporate new technologies</span>
<span id="cb419-5102"><a href="#cb419-5102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5103"><a href="#cb419-5103" aria-hidden="true" tabindex="-1"></a>*Market Insights:*</span>
<span id="cb419-5104"><a href="#cb419-5104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5105"><a href="#cb419-5105" aria-hidden="true" tabindex="-1"></a>• There might be opportunities to increase RMT device adoption among both very experienced (20+ years) and early-career (<span class="sc">\&lt;</span>5 years) musicians</span>
<span id="cb419-5106"><a href="#cb419-5106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5107"><a href="#cb419-5107" aria-hidden="true" tabindex="-1"></a>• The relatively lower adoption rates in these groups could indicate either unmet needs or barriers to adoption that could be addressed</span>
<span id="cb419-5108"><a href="#cb419-5108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5109"><a href="#cb419-5109" aria-hidden="true" tabindex="-1"></a>**Limitations**</span>
<span id="cb419-5110"><a href="#cb419-5110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5111"><a href="#cb419-5111" aria-hidden="true" tabindex="-1"></a>• The analysis doesn't account for other variables that might influence RMT device adoption</span>
<span id="cb419-5112"><a href="#cb419-5112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5113"><a href="#cb419-5113" aria-hidden="true" tabindex="-1"></a>• The categorical nature of the experience levels might mask more nuanced patterns within each category</span>
<span id="cb419-5114"><a href="#cb419-5114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5115"><a href="#cb419-5115" aria-hidden="true" tabindex="-1"></a>• The significant but weak association suggests that years of experience alone is not a strong predictor of RMT device use Comparison of Individual instrument years of experience and RMT groups:</span>
<span id="cb419-5116"><a href="#cb419-5116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5117"><a href="#cb419-5117" aria-hidden="true" tabindex="-1"></a>**Key Findings:**</span>
<span id="cb419-5118"><a href="#cb419-5118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5119"><a href="#cb419-5119" aria-hidden="true" tabindex="-1"></a>*Significant Associations:*</span>
<span id="cb419-5120"><a href="#cb419-5120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5121"><a href="#cb419-5121" aria-hidden="true" tabindex="-1"></a>Several instruments showed statistically significant associations (p <span class="sc">\&lt;</span> 0.05) between years of playing experience and device use:</span>
<span id="cb419-5122"><a href="#cb419-5122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5123"><a href="#cb419-5123" aria-hidden="true" tabindex="-1"></a>• Recorder (p = 0.0204)</span>
<span id="cb419-5124"><a href="#cb419-5124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5125"><a href="#cb419-5125" aria-hidden="true" tabindex="-1"></a>• Oboe (p = 0.0034)</span>
<span id="cb419-5126"><a href="#cb419-5126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5127"><a href="#cb419-5127" aria-hidden="true" tabindex="-1"></a>• Clarinet (p = 0.0062)</span>
<span id="cb419-5128"><a href="#cb419-5128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5129"><a href="#cb419-5129" aria-hidden="true" tabindex="-1"></a>• Bassoon (p = 0.0103)</span>
<span id="cb419-5130"><a href="#cb419-5130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5131"><a href="#cb419-5131" aria-hidden="true" tabindex="-1"></a>**Effect Sizes (Cramér's V): The strength of associations varies:**</span>
<span id="cb419-5132"><a href="#cb419-5132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5133"><a href="#cb419-5133" aria-hidden="true" tabindex="-1"></a>• Strongest: Bassoon (V = 0.3809)</span>
<span id="cb419-5134"><a href="#cb419-5134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5135"><a href="#cb419-5135" aria-hidden="true" tabindex="-1"></a>• Moderate: Oboe (V = 0.3249)</span>
<span id="cb419-5136"><a href="#cb419-5136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5137"><a href="#cb419-5137" aria-hidden="true" tabindex="-1"></a>• Moderate: Recorder (V = 0.2923)</span>
<span id="cb419-5138"><a href="#cb419-5138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5139"><a href="#cb419-5139" aria-hidden="true" tabindex="-1"></a>• Weaker: Clarinet (V = 0.1871)</span>
<span id="cb419-5140"><a href="#cb419-5140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5141"><a href="#cb419-5141" aria-hidden="true" tabindex="-1"></a>**Non-Significant Associations: Some instruments showed no significant relationship** between experience and device use:</span>
<span id="cb419-5142"><a href="#cb419-5142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5143"><a href="#cb419-5143" aria-hidden="true" tabindex="-1"></a>• Flute (p = 0.3709)</span>
<span id="cb419-5144"><a href="#cb419-5144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5145"><a href="#cb419-5145" aria-hidden="true" tabindex="-1"></a>• Piccolo (p = 0.1496) Detailed Analysis by Instrument Group: Let's examine the contingency tables:</span>
<span id="cb419-5146"><a href="#cb419-5146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5147"><a href="#cb419-5147" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Woodwinds (Flute, Clarinet):</span>
<span id="cb419-5148"><a href="#cb419-5148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5149"><a href="#cb419-5149" aria-hidden="true" tabindex="-1"></a>• Flute shows no significant association (χ² = 4.27, p = 0.3709)</span>
<span id="cb419-5150"><a href="#cb419-5150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5151"><a href="#cb419-5151" aria-hidden="true" tabindex="-1"></a>• Clarinet shows significant association (χ² = 14.36, p = 0.0062)</span>
<span id="cb419-5152"><a href="#cb419-5152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5153"><a href="#cb419-5153" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Double Reeds (Oboe, Bassoon):</span>
<span id="cb419-5154"><a href="#cb419-5154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5155"><a href="#cb419-5155" aria-hidden="true" tabindex="-1"></a>• Both show significant associations</span>
<span id="cb419-5156"><a href="#cb419-5156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5157"><a href="#cb419-5157" aria-hidden="true" tabindex="-1"></a>• Strongest effect sizes among all instruments</span>
<span id="cb419-5158"><a href="#cb419-5158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5159"><a href="#cb419-5159" aria-hidden="true" tabindex="-1"></a>• Bassoon: V = 0.3809</span>
<span id="cb419-5160"><a href="#cb419-5160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5161"><a href="#cb419-5161" aria-hidden="true" tabindex="-1"></a>• Oboe: V = 0.3249</span>
<span id="cb419-5162"><a href="#cb419-5162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5163"><a href="#cb419-5163" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Secondary Instruments (Piccolo, Recorder):</span>
<span id="cb419-5164"><a href="#cb419-5164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5165"><a href="#cb419-5165" aria-hidden="true" tabindex="-1"></a>• Piccolo: No significant association</span>
<span id="cb419-5166"><a href="#cb419-5166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5167"><a href="#cb419-5167" aria-hidden="true" tabindex="-1"></a>• Recorder: Significant association (p = 0.0204)</span>
<span id="cb419-5168"><a href="#cb419-5168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5169"><a href="#cb419-5169" aria-hidden="true" tabindex="-1"></a>**Practical Implications:**</span>
<span id="cb419-5170"><a href="#cb419-5170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5171"><a href="#cb419-5171" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Device Usage Patterns:</span>
<span id="cb419-5172"><a href="#cb419-5172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5173"><a href="#cb419-5173" aria-hidden="true" tabindex="-1"></a>• Double reed players show the strongest relationship between experience level and device use</span>
<span id="cb419-5174"><a href="#cb419-5174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5175"><a href="#cb419-5175" aria-hidden="true" tabindex="-1"></a>• This might reflect the complexity of these instruments and the potential benefits of technological assistance</span>
<span id="cb419-5176"><a href="#cb419-5176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5177"><a href="#cb419-5177" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Experience Level Considerations:</span>
<span id="cb419-5178"><a href="#cb419-5178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5179"><a href="#cb419-5179" aria-hidden="true" tabindex="-1"></a>• The relationship between experience and device use varies substantially by instrument</span>
<span id="cb419-5180"><a href="#cb419-5180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5181"><a href="#cb419-5181" aria-hidden="true" tabindex="-1"></a>• More experienced players in some instruments (e.g., double reeds) show different device usage patterns compared to less experienced players</span>
<span id="cb419-5182"><a href="#cb419-5182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5183"><a href="#cb419-5183" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Educational Implications:</span>
<span id="cb419-5184"><a href="#cb419-5184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5185"><a href="#cb419-5185" aria-hidden="true" tabindex="-1"></a>• The varying associations suggest that device use might be more beneficial or more readily adopted in certain instrument groups</span>
<span id="cb419-5186"><a href="#cb419-5186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5187"><a href="#cb419-5187" aria-hidden="true" tabindex="-1"></a>• This could inform targeted educational strategies and resource allocation</span>
<span id="cb419-5188"><a href="#cb419-5188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5189"><a href="#cb419-5189" aria-hidden="true" tabindex="-1"></a>**Statistical Notes:**</span>
<span id="cb419-5190"><a href="#cb419-5190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5191"><a href="#cb419-5191" aria-hidden="true" tabindex="-1"></a>*1. Warning Messages:*</span>
<span id="cb419-5192"><a href="#cb419-5192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5193"><a href="#cb419-5193" aria-hidden="true" tabindex="-1"></a>• Some chi-square approximations may be less reliable due to small cell counts</span>
<span id="cb419-5194"><a href="#cb419-5194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5195"><a href="#cb419-5195" aria-hidden="true" tabindex="-1"></a>• This particularly affects instruments with smaller sample sizes</span>
<span id="cb419-5196"><a href="#cb419-5196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5197"><a href="#cb419-5197" aria-hidden="true" tabindex="-1"></a>*2. Effect Size Interpretation:*</span>
<span id="cb419-5198"><a href="#cb419-5198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5199"><a href="#cb419-5199" aria-hidden="true" tabindex="-1"></a>• Cramér's V values:</span>
<span id="cb419-5200"><a href="#cb419-5200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5201"><a href="#cb419-5201" aria-hidden="true" tabindex="-1"></a>• <span class="sc">\&lt;</span> 0.1: Negligible association</span>
<span id="cb419-5202"><a href="#cb419-5202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5203"><a href="#cb419-5203" aria-hidden="true" tabindex="-1"></a>• 0.1 - 0.2: Weak association</span>
<span id="cb419-5204"><a href="#cb419-5204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5205"><a href="#cb419-5205" aria-hidden="true" tabindex="-1"></a>• 0.2 - 0.3: Moderate association</span>
<span id="cb419-5206"><a href="#cb419-5206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5207"><a href="#cb419-5207" aria-hidden="true" tabindex="-1"></a>• 0.3: Strong association</span>
<span id="cb419-5208"><a href="#cb419-5208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5209"><a href="#cb419-5209" aria-hidden="true" tabindex="-1"></a>**Recommendations:**</span>
<span id="cb419-5210"><a href="#cb419-5210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5211"><a href="#cb419-5211" aria-hidden="true" tabindex="-1"></a>*1. Further Research:*</span>
<span id="cb419-5212"><a href="#cb419-5212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5213"><a href="#cb419-5213" aria-hidden="true" tabindex="-1"></a>• Investigate why double reed instruments show stronger associations</span>
<span id="cb419-5214"><a href="#cb419-5214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5215"><a href="#cb419-5215" aria-hidden="true" tabindex="-1"></a>• Examine the specific types of devices used across different experience levels</span>
<span id="cb419-5216"><a href="#cb419-5216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5217"><a href="#cb419-5217" aria-hidden="true" tabindex="-1"></a>*2. Practical Applications:*</span>
<span id="cb419-5218"><a href="#cb419-5218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5219"><a href="#cb419-5219" aria-hidden="true" tabindex="-1"></a>• Consider instrument-specific approaches to device integration in teaching</span>
<span id="cb419-5220"><a href="#cb419-5220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5221"><a href="#cb419-5221" aria-hidden="true" tabindex="-1"></a>• Focus on understanding why certain instrument groups show stronger associations with device use</span>
<span id="cb419-5222"><a href="#cb419-5222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5223"><a href="#cb419-5223" aria-hidden="true" tabindex="-1"></a>*3. Methodological Considerations:*</span>
<span id="cb419-5224"><a href="#cb419-5224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5225"><a href="#cb419-5225" aria-hidden="true" tabindex="-1"></a>• For instruments with smaller sample sizes, consider collecting additional data</span>
<span id="cb419-5226"><a href="#cb419-5226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5227"><a href="#cb419-5227" aria-hidden="true" tabindex="-1"></a>• Consider using Fisher's exact test for smaller sample sizes where chi-square approximations may be less reliable</span>
<span id="cb419-5228"><a href="#cb419-5228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5229"><a href="#cb419-5229" aria-hidden="true" tabindex="-1"></a><span class="fu"># Frequency of Playing</span></span>
<span id="cb419-5230"><a href="#cb419-5230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5231"><a href="#cb419-5231" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-5232"><a href="#cb419-5232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5235"><a href="#cb419-5235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-5236"><a href="#cb419-5236" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust Statistical Testing Function</span></span>
<span id="cb419-5237"><a href="#cb419-5237" aria-hidden="true" tabindex="-1"></a>perform_robust_statistical_test <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, <span class="at">expected =</span> <span class="cn">NULL</span>) {</span>
<span id="cb419-5238"><a href="#cb419-5238" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If no expected frequencies provided, assume uniform distribution</span></span>
<span id="cb419-5239"><a href="#cb419-5239" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(expected)) {</span>
<span id="cb419-5240"><a href="#cb419-5240" aria-hidden="true" tabindex="-1"></a>    expected <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(observed), <span class="fu">length</span>(observed))</span>
<span id="cb419-5241"><a href="#cb419-5241" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-5242"><a href="#cb419-5242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-5243"><a href="#cb419-5243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute expected frequencies</span></span>
<span id="cb419-5244"><a href="#cb419-5244" aria-hidden="true" tabindex="-1"></a>  total_n <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb419-5245"><a href="#cb419-5245" aria-hidden="true" tabindex="-1"></a>  expected_freq <span class="ot">&lt;-</span> expected <span class="sc">*</span> total_n</span>
<span id="cb419-5246"><a href="#cb419-5246" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-5247"><a href="#cb419-5247" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Diagnostic frequency checks</span></span>
<span id="cb419-5248"><a href="#cb419-5248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected Frequency Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5249"><a href="#cb419-5249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Total Observations:"</span>, total_n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5250"><a href="#cb419-5250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Observed Frequencies:"</span>, <span class="fu">paste</span>(observed, <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5251"><a href="#cb419-5251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Expected Frequencies:"</span>, <span class="fu">paste</span>(<span class="fu">round</span>(expected_freq, <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5252"><a href="#cb419-5252" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-5253"><a href="#cb419-5253" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check chi-square test assumptions</span></span>
<span id="cb419-5254"><a href="#cb419-5254" aria-hidden="true" tabindex="-1"></a>  low_freq_cells <span class="ot">&lt;-</span> <span class="fu">sum</span>(expected_freq <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb419-5255"><a href="#cb419-5255" aria-hidden="true" tabindex="-1"></a>  min_expected_freq <span class="ot">&lt;-</span> <span class="fu">min</span>(expected_freq)</span>
<span id="cb419-5256"><a href="#cb419-5256" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-5257"><a href="#cb419-5257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Expected Frequency Diagnostics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5258"><a href="#cb419-5258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Minimum Expected Frequency:"</span>, <span class="fu">round</span>(min_expected_freq, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5259"><a href="#cb419-5259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cells with Expected Frequency &lt; 5:"</span>, low_freq_cells, </span>
<span id="cb419-5260"><a href="#cb419-5260" aria-hidden="true" tabindex="-1"></a>      <span class="st">"out of"</span>, <span class="fu">length</span>(observed), <span class="st">"cells ("</span>, </span>
<span id="cb419-5261"><a href="#cb419-5261" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(low_freq_cells <span class="sc">/</span> <span class="fu">length</span>(observed) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb419-5262"><a href="#cb419-5262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-5263"><a href="#cb419-5263" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select appropriate test</span></span>
<span id="cb419-5264"><a href="#cb419-5264" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (min_expected_freq <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> (low_freq_cells <span class="sc">/</span> <span class="fu">length</span>(observed)) <span class="sc">&gt;</span> <span class="fl">0.2</span>) {</span>
<span id="cb419-5265"><a href="#cb419-5265" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use Fisher's exact test</span></span>
<span id="cb419-5266"><a href="#cb419-5266" aria-hidden="true" tabindex="-1"></a>    fisher_test <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(</span>
<span id="cb419-5267"><a href="#cb419-5267" aria-hidden="true" tabindex="-1"></a>      <span class="fu">matrix</span>(<span class="fu">c</span>(observed, expected_freq), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>), </span>
<span id="cb419-5268"><a href="#cb419-5268" aria-hidden="true" tabindex="-1"></a>      <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>, </span>
<span id="cb419-5269"><a href="#cb419-5269" aria-hidden="true" tabindex="-1"></a>      <span class="at">B =</span> <span class="dv">10000</span></span>
<span id="cb419-5270"><a href="#cb419-5270" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb419-5271"><a href="#cb419-5271" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-5272"><a href="#cb419-5272" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Test Selection: Fisher's Exact Test (Monte Carlo Simulation)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5273"><a href="#cb419-5273" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"P-value:"</span>, fisher_test<span class="sc">$</span>p.value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5274"><a href="#cb419-5274" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-5275"><a href="#cb419-5275" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-5276"><a href="#cb419-5276" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Fisher's Exact Test"</span>,</span>
<span id="cb419-5277"><a href="#cb419-5277" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> fisher_test<span class="sc">$</span>p.value,</span>
<span id="cb419-5278"><a href="#cb419-5278" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"Fisher's Exact Test with Monte Carlo Simulation"</span></span>
<span id="cb419-5279"><a href="#cb419-5279" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-5280"><a href="#cb419-5280" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb419-5281"><a href="#cb419-5281" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use chi-square test with Yates' continuity correction</span></span>
<span id="cb419-5282"><a href="#cb419-5282" aria-hidden="true" tabindex="-1"></a>    chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> observed, <span class="at">p =</span> expected, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span>
<span id="cb419-5283"><a href="#cb419-5283" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-5284"><a href="#cb419-5284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Test Selection: Chi-square Test with Yates' Correction</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5285"><a href="#cb419-5285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Chi-square Statistic:"</span>, chi_test<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5286"><a href="#cb419-5286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"P-value:"</span>, chi_test<span class="sc">$</span>p.value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5287"><a href="#cb419-5287" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-5288"><a href="#cb419-5288" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate Cramér's V</span></span>
<span id="cb419-5289"><a href="#cb419-5289" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">length</span>(observed)</span>
<span id="cb419-5290"><a href="#cb419-5290" aria-hidden="true" tabindex="-1"></a>    cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (total_n <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb419-5291"><a href="#cb419-5291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cramér's V:"</span>, cramers_v, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5292"><a href="#cb419-5292" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb419-5293"><a href="#cb419-5293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb419-5294"><a href="#cb419-5294" aria-hidden="true" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">"Chi-square Test"</span>,</span>
<span id="cb419-5295"><a href="#cb419-5295" aria-hidden="true" tabindex="-1"></a>      <span class="at">statistic =</span> chi_test<span class="sc">$</span>statistic,</span>
<span id="cb419-5296"><a href="#cb419-5296" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> chi_test<span class="sc">$</span>p.value,</span>
<span id="cb419-5297"><a href="#cb419-5297" aria-hidden="true" tabindex="-1"></a>      <span class="at">cramers_v =</span> cramers_v,</span>
<span id="cb419-5298"><a href="#cb419-5298" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"Chi-square Test with Yates' Continuity Correction"</span></span>
<span id="cb419-5299"><a href="#cb419-5299" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-5300"><a href="#cb419-5300" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb419-5301"><a href="#cb419-5301" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb419-5302"><a href="#cb419-5302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5303"><a href="#cb419-5303" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-5304"><a href="#cb419-5304" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-5305"><a href="#cb419-5305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5306"><a href="#cb419-5306" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure freqPlay_MAX is numeric and handle potential NA values</span></span>
<span id="cb419-5307"><a href="#cb419-5307" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-5308"><a href="#cb419-5308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5309"><a href="#cb419-5309" aria-hidden="true" tabindex="-1"></a>    <span class="at">freqPlay_MAX =</span> <span class="fu">as.numeric</span>(freqPlay_MAX)</span>
<span id="cb419-5310"><a href="#cb419-5310" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5311"><a href="#cb419-5311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5312"><a href="#cb419-5312" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode freqPlay_MAX into new frequency categories</span></span>
<span id="cb419-5313"><a href="#cb419-5313" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-5314"><a href="#cb419-5314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5315"><a href="#cb419-5315" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-5316"><a href="#cb419-5316" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"About once a month"</span>,</span>
<span id="cb419-5317"><a href="#cb419-5317" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Multiple times per month"</span>,</span>
<span id="cb419-5318"><a href="#cb419-5318" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"About once a week"</span>,</span>
<span id="cb419-5319"><a href="#cb419-5319" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Multiple times per week"</span>,</span>
<span id="cb419-5320"><a href="#cb419-5320" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Everyday"</span>,</span>
<span id="cb419-5321"><a href="#cb419-5321" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-5322"><a href="#cb419-5322" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb419-5323"><a href="#cb419-5323" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"About once a month"</span>, <span class="st">"Multiple times per month"</span>, <span class="st">"About once a week"</span>, <span class="st">"Multiple times per week"</span>, <span class="st">"Everyday"</span>))</span>
<span id="cb419-5324"><a href="#cb419-5324" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5325"><a href="#cb419-5325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5326"><a href="#cb419-5326" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create Frequency Table</span></span>
<span id="cb419-5327"><a href="#cb419-5327" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-5328"><a href="#cb419-5328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(frequency) <span class="sc">%&gt;%</span></span>
<span id="cb419-5329"><a href="#cb419-5329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5330"><a href="#cb419-5330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb419-5331"><a href="#cb419-5331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5332"><a href="#cb419-5332" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total sample size</span></span>
<span id="cb419-5333"><a href="#cb419-5333" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">sum</span>(freq_table<span class="sc">$</span>count)</span>
<span id="cb419-5334"><a href="#cb419-5334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5335"><a href="#cb419-5335" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Perform Statistical Analysis</span></span>
<span id="cb419-5336"><a href="#cb419-5336" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed frequencies</span></span>
<span id="cb419-5337"><a href="#cb419-5337" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> freq_table<span class="sc">$</span>count</span>
<span id="cb419-5338"><a href="#cb419-5338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5339"><a href="#cb419-5339" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform robust statistical test</span></span>
<span id="cb419-5340"><a href="#cb419-5340" aria-hidden="true" tabindex="-1"></a>stat_test <span class="ot">&lt;-</span> <span class="fu">perform_robust_statistical_test</span>(</span>
<span id="cb419-5341"><a href="#cb419-5341" aria-hidden="true" tabindex="-1"></a>  observed, </span>
<span id="cb419-5342"><a href="#cb419-5342" aria-hidden="true" tabindex="-1"></a>  <span class="at">expected =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(<span class="fu">levels</span>(data<span class="sc">$</span>frequency)), <span class="fu">length</span>(<span class="fu">levels</span>(data<span class="sc">$</span>frequency)))</span>
<span id="cb419-5343"><a href="#cb419-5343" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-5344"><a href="#cb419-5344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5345"><a href="#cb419-5345" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Create the Plot</span></span>
<span id="cb419-5346"><a href="#cb419-5346" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Frequency of Practice"</span></span>
<span id="cb419-5347"><a href="#cb419-5347" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table, <span class="fu">aes</span>(<span class="at">x =</span> frequency, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb419-5348"><a href="#cb419-5348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#4472C4"</span>) <span class="sc">+</span></span>
<span id="cb419-5349"><a href="#cb419-5349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d</span><span class="sc">\n</span><span class="st">(%.1f%%)"</span>, count, percentage)), </span>
<span id="cb419-5350"><a href="#cb419-5350" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb419-5351"><a href="#cb419-5351" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb419-5352"><a href="#cb419-5352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-5353"><a href="#cb419-5353" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> plot_title,</span>
<span id="cb419-5354"><a href="#cb419-5354" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb419-5355"><a href="#cb419-5355" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">sprintf</span>(<span class="st">"Count (N = %d)"</span>, total_n),</span>
<span id="cb419-5356"><a href="#cb419-5356" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">"%s</span><span class="sc">\n</span><span class="st">p-value = %.4f"</span>, </span>
<span id="cb419-5357"><a href="#cb419-5357" aria-hidden="true" tabindex="-1"></a>                      stat_test<span class="sc">$</span>method, </span>
<span id="cb419-5358"><a href="#cb419-5358" aria-hidden="true" tabindex="-1"></a>                      stat_test<span class="sc">$</span>p_value)</span>
<span id="cb419-5359"><a href="#cb419-5359" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-5360"><a href="#cb419-5360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-5361"><a href="#cb419-5361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-5362"><a href="#cb419-5362" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-5363"><a href="#cb419-5363" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">15</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-5364"><a href="#cb419-5364" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-5365"><a href="#cb419-5365" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb419-5366"><a href="#cb419-5366" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb419-5367"><a href="#cb419-5367" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5368"><a href="#cb419-5368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5369"><a href="#cb419-5369" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-5370"><a href="#cb419-5370" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb419-5371"><a href="#cb419-5371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5372"><a href="#cb419-5372" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Print Statistical Analysis Results</span></span>
<span id="cb419-5373"><a href="#cb419-5373" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Frequency Distribution:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5374"><a href="#cb419-5374" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(freq_table)</span>
<span id="cb419-5375"><a href="#cb419-5375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5376"><a href="#cb419-5376" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statistical Test Results:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5377"><a href="#cb419-5377" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Test Type:"</span>, stat_test<span class="sc">$</span>method, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5378"><a href="#cb419-5378" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, stat_test<span class="sc">$</span>p_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb419-5379"><a href="#cb419-5379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5380"><a href="#cb419-5380" aria-hidden="true" tabindex="-1"></a><span class="co"># Instrument-specific analysis can follow a similar robust testing approach</span></span>
<span id="cb419-5381"><a href="#cb419-5381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-5382"><a href="#cb419-5382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5383"><a href="#cb419-5383" aria-hidden="true" tabindex="-1"></a><span class="fu">## By Instrument</span></span>
<span id="cb419-5384"><a href="#cb419-5384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5387"><a href="#cb419-5387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-5388"><a href="#cb419-5388" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb419-5389"><a href="#cb419-5389" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-5390"><a href="#cb419-5390" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-5391"><a href="#cb419-5391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5392"><a href="#cb419-5392" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant columns and gather them</span></span>
<span id="cb419-5393"><a href="#cb419-5393" aria-hidden="true" tabindex="-1"></a>instruments_data <span class="ot">&lt;-</span> data_combined <span class="sc">%&gt;%</span></span>
<span id="cb419-5394"><a href="#cb419-5394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">freqPlay_Flute</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Piccolo</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Recorder</span><span class="st">`</span>, </span>
<span id="cb419-5395"><a href="#cb419-5395" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">freqPlay_Oboe</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Clarinet</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Bassoon</span><span class="st">`</span>,</span>
<span id="cb419-5396"><a href="#cb419-5396" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">freqPlay_Saxophone</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Trumpet</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_French Horn</span><span class="st">`</span>,</span>
<span id="cb419-5397"><a href="#cb419-5397" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">freqPlay_Trombone</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Tuba</span><span class="st">`</span>, <span class="st">`</span><span class="at">freqPlay_Euphonium</span><span class="st">`</span>,</span>
<span id="cb419-5398"><a href="#cb419-5398" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">freqPlay_Bagpipes</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5399"><a href="#cb419-5399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"instrument"</span>, <span class="at">value =</span> <span class="st">"frequency"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5400"><a href="#cb419-5400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5401"><a href="#cb419-5401" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Clean instrument names</span></span>
<span id="cb419-5402"><a href="#cb419-5402" aria-hidden="true" tabindex="-1"></a>    <span class="at">instrument =</span> <span class="fu">gsub</span>(<span class="st">"freqPlay_"</span>, <span class="st">""</span>, instrument),</span>
<span id="cb419-5403"><a href="#cb419-5403" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recode frequency values</span></span>
<span id="cb419-5404"><a href="#cb419-5404" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-5405"><a href="#cb419-5405" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"About once a month"</span>,</span>
<span id="cb419-5406"><a href="#cb419-5406" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Multiple times per month"</span>,</span>
<span id="cb419-5407"><a href="#cb419-5407" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"About once a week"</span>,</span>
<span id="cb419-5408"><a href="#cb419-5408" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Multiple times per week"</span>,</span>
<span id="cb419-5409"><a href="#cb419-5409" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Everyday"</span>,</span>
<span id="cb419-5410"><a href="#cb419-5410" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-5411"><a href="#cb419-5411" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"About once a month"</span>, <span class="st">"Multiple times per month"</span>, </span>
<span id="cb419-5412"><a href="#cb419-5412" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"About once a week"</span>, <span class="st">"Multiple times per week"</span>, <span class="st">"Everyday"</span>))</span>
<span id="cb419-5413"><a href="#cb419-5413" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5414"><a href="#cb419-5414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5415"><a href="#cb419-5415" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove NA values</span></span>
<span id="cb419-5416"><a href="#cb419-5416" aria-hidden="true" tabindex="-1"></a>instruments_data <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(frequency))</span>
<span id="cb419-5417"><a href="#cb419-5417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5418"><a href="#cb419-5418" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate frequencies and percentages</span></span>
<span id="cb419-5419"><a href="#cb419-5419" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span></span>
<span id="cb419-5420"><a href="#cb419-5420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument, frequency) <span class="sc">%&gt;%</span></span>
<span id="cb419-5421"><a href="#cb419-5421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5422"><a href="#cb419-5422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb419-5423"><a href="#cb419-5423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5424"><a href="#cb419-5424" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-5425"><a href="#cb419-5425" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">sum</span>(count)</span>
<span id="cb419-5426"><a href="#cb419-5426" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-5427"><a href="#cb419-5427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb419-5428"><a href="#cb419-5428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5429"><a href="#cb419-5429" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total responses for each instrument</span></span>
<span id="cb419-5430"><a href="#cb419-5430" aria-hidden="true" tabindex="-1"></a>instrument_totals <span class="ot">&lt;-</span> summary_data <span class="sc">%&gt;%</span></span>
<span id="cb419-5431"><a href="#cb419-5431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb419-5432"><a href="#cb419-5432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_n =</span> <span class="fu">first</span>(total_n)) <span class="sc">%&gt;%</span></span>
<span id="cb419-5433"><a href="#cb419-5433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_n))</span>
<span id="cb419-5434"><a href="#cb419-5434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5435"><a href="#cb419-5435" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder instruments by total responses</span></span>
<span id="cb419-5436"><a href="#cb419-5436" aria-hidden="true" tabindex="-1"></a>summary_data<span class="sc">$</span>instrument <span class="ot">&lt;-</span> <span class="fu">factor</span>(summary_data<span class="sc">$</span>instrument, </span>
<span id="cb419-5437"><a href="#cb419-5437" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> instrument_totals<span class="sc">$</span>instrument)</span>
<span id="cb419-5438"><a href="#cb419-5438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5439"><a href="#cb419-5439" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with modified theme and labels in black; legend styling adjusted</span></span>
<span id="cb419-5440"><a href="#cb419-5440" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> frequency, <span class="at">y =</span> percentage, <span class="at">fill =</span> frequency)) <span class="sc">+</span></span>
<span id="cb419-5441"><a href="#cb419-5441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb419-5442"><a href="#cb419-5442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>instrument, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-5443"><a href="#cb419-5443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d\</span></span>
<span id="cb419-5444"><a href="#cb419-5444" aria-hidden="true" tabindex="-1"></a><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-5445"><a href="#cb419-5445" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-5446"><a href="#cb419-5446" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-5447"><a href="#cb419-5447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb419-5448"><a href="#cb419-5448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-5449"><a href="#cb419-5449" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Frequency of Practice by Instrument"</span>,</span>
<span id="cb419-5450"><a href="#cb419-5450" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb419-5451"><a href="#cb419-5451" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb419-5452"><a href="#cb419-5452" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Frequency"</span></span>
<span id="cb419-5453"><a href="#cb419-5453" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-5454"><a href="#cb419-5454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-5455"><a href="#cb419-5455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-5456"><a href="#cb419-5456" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),  <span class="co"># Remove x-axis labels</span></span>
<span id="cb419-5457"><a href="#cb419-5457" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-5458"><a href="#cb419-5458" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb419-5459"><a href="#cb419-5459" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">0</span>)),</span>
<span id="cb419-5460"><a href="#cb419-5460" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-5461"><a href="#cb419-5461" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb419-5462"><a href="#cb419-5462" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">'pt'</span>),</span>
<span id="cb419-5463"><a href="#cb419-5463" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-5464"><a href="#cb419-5464" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">30</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">30</span>, <span class="at">unit =</span> <span class="st">"pt"</span>)  <span class="co"># Padding around the plot</span></span>
<span id="cb419-5465"><a href="#cb419-5465" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5466"><a href="#cb419-5466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5467"><a href="#cb419-5467" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb419-5468"><a href="#cb419-5468" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb419-5469"><a href="#cb419-5469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5470"><a href="#cb419-5470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5471"><a href="#cb419-5471" aria-hidden="true" tabindex="-1"></a><span class="do">## By instrument V2 </span></span>
<span id="cb419-5472"><a href="#cb419-5472" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-5473"><a href="#cb419-5473" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-5474"><a href="#cb419-5474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5475"><a href="#cb419-5475" aria-hidden="true" tabindex="-1"></a><span class="co"># Process data and create summary statistics</span></span>
<span id="cb419-5476"><a href="#cb419-5476" aria-hidden="true" tabindex="-1"></a>instruments_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-5477"><a href="#cb419-5477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"freqPlay_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb419-5478"><a href="#cb419-5478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"instrument"</span>, <span class="at">value =</span> <span class="st">"frequency"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5479"><a href="#cb419-5479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5480"><a href="#cb419-5480" aria-hidden="true" tabindex="-1"></a>    <span class="at">instrument =</span> <span class="fu">gsub</span>(<span class="st">"freqPlay_"</span>, <span class="st">""</span>, instrument),</span>
<span id="cb419-5481"><a href="#cb419-5481" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-5482"><a href="#cb419-5482" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"About once a month"</span>,</span>
<span id="cb419-5483"><a href="#cb419-5483" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Multiple times per month"</span>,</span>
<span id="cb419-5484"><a href="#cb419-5484" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"About once a week"</span>,</span>
<span id="cb419-5485"><a href="#cb419-5485" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Multiple times per week"</span>,</span>
<span id="cb419-5486"><a href="#cb419-5486" aria-hidden="true" tabindex="-1"></a>      frequency <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Everyday"</span>,</span>
<span id="cb419-5487"><a href="#cb419-5487" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-5488"><a href="#cb419-5488" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"About once a month"</span>, <span class="st">"Multiple times per month"</span>, </span>
<span id="cb419-5489"><a href="#cb419-5489" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"About once a week"</span>, <span class="st">"Multiple times per week"</span>, <span class="st">"Everyday"</span>))</span>
<span id="cb419-5490"><a href="#cb419-5490" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-5491"><a href="#cb419-5491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(frequency))</span>
<span id="cb419-5492"><a href="#cb419-5492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5493"><a href="#cb419-5493" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate detailed summary statistics</span></span>
<span id="cb419-5494"><a href="#cb419-5494" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span></span>
<span id="cb419-5495"><a href="#cb419-5495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb419-5496"><a href="#cb419-5496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb419-5497"><a href="#cb419-5497" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb419-5498"><a href="#cb419-5498" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_freq =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(frequency)),</span>
<span id="cb419-5499"><a href="#cb419-5499" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_freq =</span> <span class="fu">median</span>(<span class="fu">as.numeric</span>(frequency)),</span>
<span id="cb419-5500"><a href="#cb419-5500" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_freq =</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(frequency))</span>
<span id="cb419-5501"><a href="#cb419-5501" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-5502"><a href="#cb419-5502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb419-5503"><a href="#cb419-5503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5504"><a href="#cb419-5504" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate frequency distributions</span></span>
<span id="cb419-5505"><a href="#cb419-5505" aria-hidden="true" tabindex="-1"></a>freq_dist <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span></span>
<span id="cb419-5506"><a href="#cb419-5506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument, frequency) <span class="sc">%&gt;%</span></span>
<span id="cb419-5507"><a href="#cb419-5507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5508"><a href="#cb419-5508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb419-5509"><a href="#cb419-5509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5510"><a href="#cb419-5510" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-5511"><a href="#cb419-5511" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">sum</span>(count)</span>
<span id="cb419-5512"><a href="#cb419-5512" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-5513"><a href="#cb419-5513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(instrument, frequency)</span>
<span id="cb419-5514"><a href="#cb419-5514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5515"><a href="#cb419-5515" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test</span></span>
<span id="cb419-5516"><a href="#cb419-5516" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(instruments_data<span class="sc">$</span>instrument, instruments_data<span class="sc">$</span>frequency)</span>
<span id="cb419-5517"><a href="#cb419-5517" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb419-5518"><a href="#cb419-5518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5519"><a href="#cb419-5519" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cramer's V</span></span>
<span id="cb419-5520"><a href="#cb419-5520" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(instruments_data)</span>
<span id="cb419-5521"><a href="#cb419-5521" aria-hidden="true" tabindex="-1"></a>df_min <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">ncol</span>(contingency_table) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb419-5522"><a href="#cb419-5522" aria-hidden="true" tabindex="-1"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (n <span class="sc">*</span> df_min))</span>
<span id="cb419-5523"><a href="#cb419-5523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5524"><a href="#cb419-5524" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics</span></span>
<span id="cb419-5525"><a href="#cb419-5525" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5526"><a href="#cb419-5526" aria-hidden="true" tabindex="-1"></a><span class="st">Detailed Summary Statistics by Instrument:\</span></span>
<span id="cb419-5527"><a href="#cb419-5527" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5528"><a href="#cb419-5528" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span>
<span id="cb419-5529"><a href="#cb419-5529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5530"><a href="#cb419-5530" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5531"><a href="#cb419-5531" aria-hidden="true" tabindex="-1"></a><span class="st">Frequency Distribution (counts and percentages):\</span></span>
<span id="cb419-5532"><a href="#cb419-5532" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5533"><a href="#cb419-5533" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(freq_dist)</span>
<span id="cb419-5534"><a href="#cb419-5534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5535"><a href="#cb419-5535" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5536"><a href="#cb419-5536" aria-hidden="true" tabindex="-1"></a><span class="st">Chi-square Test Results:\</span></span>
<span id="cb419-5537"><a href="#cb419-5537" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5538"><a href="#cb419-5538" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-5539"><a href="#cb419-5539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5540"><a href="#cb419-5540" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5541"><a href="#cb419-5541" aria-hidden="true" tabindex="-1"></a><span class="st">Cramer's V (Effect Size):\</span></span>
<span id="cb419-5542"><a href="#cb419-5542" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5543"><a href="#cb419-5543" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramers_v)</span>
<span id="cb419-5544"><a href="#cb419-5544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5545"><a href="#cb419-5545" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mode for each instrument</span></span>
<span id="cb419-5546"><a href="#cb419-5546" aria-hidden="true" tabindex="-1"></a>mode_freq <span class="ot">&lt;-</span> instruments_data <span class="sc">%&gt;%</span></span>
<span id="cb419-5547"><a href="#cb419-5547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(instrument) <span class="sc">%&gt;%</span></span>
<span id="cb419-5548"><a href="#cb419-5548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(frequency) <span class="sc">%&gt;%</span></span>
<span id="cb419-5549"><a href="#cb419-5549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which.max</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb419-5550"><a href="#cb419-5550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb419-5551"><a href="#cb419-5551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5552"><a href="#cb419-5552" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5553"><a href="#cb419-5553" aria-hidden="true" tabindex="-1"></a><span class="st">Most Common Practice Frequency by Instrument:\</span></span>
<span id="cb419-5554"><a href="#cb419-5554" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5555"><a href="#cb419-5555" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mode_freq)</span>
<span id="cb419-5556"><a href="#cb419-5556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5557"><a href="#cb419-5557" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized residuals analysis</span></span>
<span id="cb419-5558"><a href="#cb419-5558" aria-hidden="true" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> chi_test<span class="sc">$</span>stdres</span>
<span id="cb419-5559"><a href="#cb419-5559" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(std_residuals) <span class="ot">&lt;-</span> <span class="fu">levels</span>(instruments_data<span class="sc">$</span>frequency)</span>
<span id="cb419-5560"><a href="#cb419-5560" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(std_residuals) <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">factor</span>(instruments_data<span class="sc">$</span>instrument))</span>
<span id="cb419-5561"><a href="#cb419-5561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5562"><a href="#cb419-5562" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5563"><a href="#cb419-5563" aria-hidden="true" tabindex="-1"></a><span class="st">Standardized Residuals (values &gt; |1.96| indicate significant differences):\</span></span>
<span id="cb419-5564"><a href="#cb419-5564" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5565"><a href="#cb419-5565" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(std_residuals, <span class="dv">2</span>))</span>
<span id="cb419-5566"><a href="#cb419-5566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5567"><a href="#cb419-5567" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb419-5568"><a href="#cb419-5568" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_dist, <span class="fu">aes</span>(<span class="at">x =</span> percentage, <span class="at">y =</span> <span class="fu">reorder</span>(instrument, total_n), <span class="at">fill =</span> frequency)) <span class="sc">+</span></span>
<span id="cb419-5569"><a href="#cb419-5569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb419-5570"><a href="#cb419-5570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d"</span>, count)),</span>
<span id="cb419-5571"><a href="#cb419-5571" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-5572"><a href="#cb419-5572" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-5573"><a href="#cb419-5573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb419-5574"><a href="#cb419-5574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-5575"><a href="#cb419-5575" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Frequency of Practice by Instrument"</span>,</span>
<span id="cb419-5576"><a href="#cb419-5576" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Total N ="</span>, <span class="fu">sum</span>(summary_stats<span class="sc">$</span>n), <span class="st">"responses"</span>),</span>
<span id="cb419-5577"><a href="#cb419-5577" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb419-5578"><a href="#cb419-5578" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb419-5579"><a href="#cb419-5579" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Practice Frequency"</span></span>
<span id="cb419-5580"><a href="#cb419-5580" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-5581"><a href="#cb419-5581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-5582"><a href="#cb419-5582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-5583"><a href="#cb419-5583" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb419-5584"><a href="#cb419-5584" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb419-5585"><a href="#cb419-5585" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb419-5586"><a href="#cb419-5586" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb419-5587"><a href="#cb419-5587" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.just =</span> <span class="st">"left"</span>,</span>
<span id="cb419-5588"><a href="#cb419-5588" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb419-5589"><a href="#cb419-5589" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-5590"><a href="#cb419-5590" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb419-5591"><a href="#cb419-5591" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5592"><a href="#cb419-5592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5593"><a href="#cb419-5593" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb419-5594"><a href="#cb419-5594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-5595"><a href="#cb419-5595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5596"><a href="#cb419-5596" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-5597"><a href="#cb419-5597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5598"><a href="#cb419-5598" aria-hidden="true" tabindex="-1"></a>Looking at the frequency distribution of wind instrument practice among the 1,558 participants:</span>
<span id="cb419-5599"><a href="#cb419-5599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5600"><a href="#cb419-5600" aria-hidden="true" tabindex="-1"></a>• Multiple times per week: Largest group with approximately 550 participants (\~35%)</span>
<span id="cb419-5601"><a href="#cb419-5601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5602"><a href="#cb419-5602" aria-hidden="true" tabindex="-1"></a>• Everyday: Second largest with about 400 participants (\~26%)</span>
<span id="cb419-5603"><a href="#cb419-5603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5604"><a href="#cb419-5604" aria-hidden="true" tabindex="-1"></a>• About once a week: Around 300 participants (\~19%)</span>
<span id="cb419-5605"><a href="#cb419-5605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5606"><a href="#cb419-5606" aria-hidden="true" tabindex="-1"></a>• About once a month: Approximately 200 participants (\~13%)</span>
<span id="cb419-5607"><a href="#cb419-5607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5608"><a href="#cb419-5608" aria-hidden="true" tabindex="-1"></a>• Multiple times per month: Smallest group with roughly 150 participants (\~10%)</span>
<span id="cb419-5609"><a href="#cb419-5609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5610"><a href="#cb419-5610" aria-hidden="true" tabindex="-1"></a>The data shows that the majority of participants (about 61%) practice their wind instruments very frequently (either everyday or multiple times per week). This suggests a high level of engagement with wind instrument playing among the surveyed population, with relatively fewer participants practicing on a monthly basis.</span>
<span id="cb419-5611"><a href="#cb419-5611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5612"><a href="#cb419-5612" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inferential Stats</span></span>
<span id="cb419-5613"><a href="#cb419-5613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5616"><a href="#cb419-5616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-5617"><a href="#cb419-5617" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-5618"><a href="#cb419-5618" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-5619"><a href="#cb419-5619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5620"><a href="#cb419-5620" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode freqPlay_MAX and create frequency table with RMTMethods_YN</span></span>
<span id="cb419-5621"><a href="#cb419-5621" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-5622"><a href="#cb419-5622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5623"><a href="#cb419-5623" aria-hidden="true" tabindex="-1"></a>    <span class="at">frequency =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-5624"><a href="#cb419-5624" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"About once a month"</span>,</span>
<span id="cb419-5625"><a href="#cb419-5625" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Multiple times per month"</span>,</span>
<span id="cb419-5626"><a href="#cb419-5626" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"About once a week"</span>,</span>
<span id="cb419-5627"><a href="#cb419-5627" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Multiple times per week"</span>,</span>
<span id="cb419-5628"><a href="#cb419-5628" aria-hidden="true" tabindex="-1"></a>      freqPlay_MAX <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Everyday"</span>,</span>
<span id="cb419-5629"><a href="#cb419-5629" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-5630"><a href="#cb419-5630" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb419-5631"><a href="#cb419-5631" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"About once a month"</span>, <span class="st">"Multiple times per month"</span>, </span>
<span id="cb419-5632"><a href="#cb419-5632" aria-hidden="true" tabindex="-1"></a>               <span class="st">"About once a week"</span>, <span class="st">"Multiple times per week"</span>, <span class="st">"Everyday"</span>)),</span>
<span id="cb419-5633"><a href="#cb419-5633" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMT_group =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb419-5634"><a href="#cb419-5634" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No RMT Methods"</span>,</span>
<span id="cb419-5635"><a href="#cb419-5635" aria-hidden="true" tabindex="-1"></a>      RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Uses RMT Methods"</span>,</span>
<span id="cb419-5636"><a href="#cb419-5636" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb419-5637"><a href="#cb419-5637" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb419-5638"><a href="#cb419-5638" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5639"><a href="#cb419-5639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5640"><a href="#cb419-5640" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb419-5641"><a href="#cb419-5641" aria-hidden="true" tabindex="-1"></a>cont_table <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>frequency, data<span class="sc">$</span>RMT_group)</span>
<span id="cb419-5642"><a href="#cb419-5642" aria-hidden="true" tabindex="-1"></a>cont_table_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.matrix</span>(cont_table)</span>
<span id="cb419-5643"><a href="#cb419-5643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5644"><a href="#cb419-5644" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentages within each group</span></span>
<span id="cb419-5645"><a href="#cb419-5645" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-5646"><a href="#cb419-5646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMT_group, frequency) <span class="sc">%&gt;%</span></span>
<span id="cb419-5647"><a href="#cb419-5647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5648"><a href="#cb419-5648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMT_group) <span class="sc">%&gt;%</span></span>
<span id="cb419-5649"><a href="#cb419-5649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count<span class="sc">/</span><span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-5650"><a href="#cb419-5650" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_group =</span> <span class="fu">sum</span>(count))</span>
<span id="cb419-5651"><a href="#cb419-5651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5652"><a href="#cb419-5652" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total N</span></span>
<span id="cb419-5653"><a href="#cb419-5653" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> <span class="fu">sum</span>(freq_table<span class="sc">$</span>count)</span>
<span id="cb419-5654"><a href="#cb419-5654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5655"><a href="#cb419-5655" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test</span></span>
<span id="cb419-5656"><a href="#cb419-5656" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table)</span>
<span id="cb419-5657"><a href="#cb419-5657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5658"><a href="#cb419-5658" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cramer's V</span></span>
<span id="cb419-5659"><a href="#cb419-5659" aria-hidden="true" tabindex="-1"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic<span class="sc">/</span>(total_n <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">dim</span>(cont_table))<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb419-5660"><a href="#cb419-5660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5661"><a href="#cb419-5661" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb419-5662"><a href="#cb419-5662" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Frequency of Practice by RMT Methods Use"</span></span>
<span id="cb419-5663"><a href="#cb419-5663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5664"><a href="#cb419-5664" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(freq_table, <span class="fu">aes</span>(<span class="at">x =</span> frequency, <span class="at">y =</span> percentage, <span class="at">fill =</span> RMT_group)) <span class="sc">+</span></span>
<span id="cb419-5665"><a href="#cb419-5665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb419-5666"><a href="#cb419-5666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%d\</span></span>
<span id="cb419-5667"><a href="#cb419-5667" aria-hidden="true" tabindex="-1"></a><span class="st">(%.1f%%)"</span>, count, percentage)),</span>
<span id="cb419-5668"><a href="#cb419-5668" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-5669"><a href="#cb419-5669" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb419-5670"><a href="#cb419-5670" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-5671"><a href="#cb419-5671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No RMT Methods"</span> <span class="ot">=</span> <span class="st">"#4472C4"</span>, </span>
<span id="cb419-5672"><a href="#cb419-5672" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Uses RMT Methods"</span> <span class="ot">=</span> <span class="st">"#ED7D31"</span>)) <span class="sc">+</span></span>
<span id="cb419-5673"><a href="#cb419-5673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb419-5674"><a href="#cb419-5674" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> plot_title,</span>
<span id="cb419-5675"><a href="#cb419-5675" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"N = %d"</span>, total_n),</span>
<span id="cb419-5676"><a href="#cb419-5676" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb419-5677"><a href="#cb419-5677" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb419-5678"><a href="#cb419-5678" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb419-5679"><a href="#cb419-5679" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">"Chi-square test: χ²(%d) = %.2f, p = %.3f\</span></span>
<span id="cb419-5680"><a href="#cb419-5680" aria-hidden="true" tabindex="-1"></a><span class="st">Cramér's V = %.3f"</span>,</span>
<span id="cb419-5681"><a href="#cb419-5681" aria-hidden="true" tabindex="-1"></a>                      chi_test<span class="sc">$</span>parameter, </span>
<span id="cb419-5682"><a href="#cb419-5682" aria-hidden="true" tabindex="-1"></a>                      chi_test<span class="sc">$</span>statistic,</span>
<span id="cb419-5683"><a href="#cb419-5683" aria-hidden="true" tabindex="-1"></a>                      chi_test<span class="sc">$</span>p.value,</span>
<span id="cb419-5684"><a href="#cb419-5684" aria-hidden="true" tabindex="-1"></a>                      cramers_v)</span>
<span id="cb419-5685"><a href="#cb419-5685" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-5686"><a href="#cb419-5686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-5687"><a href="#cb419-5687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-5688"><a href="#cb419-5688" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb419-5689"><a href="#cb419-5689" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-5690"><a href="#cb419-5690" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">15</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb419-5691"><a href="#cb419-5691" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb419-5692"><a href="#cb419-5692" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb419-5693"><a href="#cb419-5693" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb419-5694"><a href="#cb419-5694" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5695"><a href="#cb419-5695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5696"><a href="#cb419-5696" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plot</span></span>
<span id="cb419-5697"><a href="#cb419-5697" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb419-5698"><a href="#cb419-5698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5699"><a href="#cb419-5699" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical summary</span></span>
<span id="cb419-5700"><a href="#cb419-5700" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5701"><a href="#cb419-5701" aria-hidden="true" tabindex="-1"></a><span class="st">Contingency Table:\</span></span>
<span id="cb419-5702"><a href="#cb419-5702" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5703"><a href="#cb419-5703" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cont_table)</span>
<span id="cb419-5704"><a href="#cb419-5704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5705"><a href="#cb419-5705" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5706"><a href="#cb419-5706" aria-hidden="true" tabindex="-1"></a><span class="st">Chi-square Test Results:\</span></span>
<span id="cb419-5707"><a href="#cb419-5707" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5708"><a href="#cb419-5708" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-5709"><a href="#cb419-5709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5710"><a href="#cb419-5710" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5711"><a href="#cb419-5711" aria-hidden="true" tabindex="-1"></a><span class="st">Effect Size (Cramér's V):\</span></span>
<span id="cb419-5712"><a href="#cb419-5712" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5713"><a href="#cb419-5713" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cramers_v)</span>
<span id="cb419-5714"><a href="#cb419-5714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5715"><a href="#cb419-5715" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate group sizes</span></span>
<span id="cb419-5716"><a href="#cb419-5716" aria-hidden="true" tabindex="-1"></a>group_sizes <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-5717"><a href="#cb419-5717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(RMT_group) <span class="sc">%&gt;%</span></span>
<span id="cb419-5718"><a href="#cb419-5718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb419-5719"><a href="#cb419-5719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5720"><a href="#cb419-5720" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5721"><a href="#cb419-5721" aria-hidden="true" tabindex="-1"></a><span class="st">Group Sizes:\</span></span>
<span id="cb419-5722"><a href="#cb419-5722" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5723"><a href="#cb419-5723" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(group_sizes)</span>
<span id="cb419-5724"><a href="#cb419-5724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5725"><a href="#cb419-5725" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc analysis: standardized residuals</span></span>
<span id="cb419-5726"><a href="#cb419-5726" aria-hidden="true" tabindex="-1"></a>stdres <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(cont_table)<span class="sc">$</span>stdres</span>
<span id="cb419-5727"><a href="#cb419-5727" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(stdres) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"No RMT Methods"</span>, <span class="st">"Uses RMT Methods"</span>)</span>
<span id="cb419-5728"><a href="#cb419-5728" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(stdres) <span class="ot">&lt;-</span> <span class="fu">levels</span>(data<span class="sc">$</span>frequency)</span>
<span id="cb419-5729"><a href="#cb419-5729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5730"><a href="#cb419-5730" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5731"><a href="#cb419-5731" aria-hidden="true" tabindex="-1"></a><span class="st">Standardized Residuals:\</span></span>
<span id="cb419-5732"><a href="#cb419-5732" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5733"><a href="#cb419-5733" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stdres)</span>
<span id="cb419-5734"><a href="#cb419-5734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-5735"><a href="#cb419-5735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5736"><a href="#cb419-5736" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-5737"><a href="#cb419-5737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5738"><a href="#cb419-5738" aria-hidden="true" tabindex="-1"></a>**Statistical Significance**</span>
<span id="cb419-5739"><a href="#cb419-5739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5740"><a href="#cb419-5740" aria-hidden="true" tabindex="-1"></a>• The chi-square test shows a highly significant association between practice frequency and RMT Methods use (χ²(4) = 40.34, p <span class="sc">\&lt;</span> 0.001)</span>
<span id="cb419-5741"><a href="#cb419-5741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5742"><a href="#cb419-5742" aria-hidden="true" tabindex="-1"></a>• The effect size (Cramér's V = 0.161) indicates a small to medium practical significance</span>
<span id="cb419-5743"><a href="#cb419-5743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5744"><a href="#cb419-5744" aria-hidden="true" tabindex="-1"></a>**Group Differences**</span>
<span id="cb419-5745"><a href="#cb419-5745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5746"><a href="#cb419-5746" aria-hidden="true" tabindex="-1"></a>Based on the standardized residuals (values <span class="sc">\&gt;</span> \|1.96\| indicate significant differences): Significant differences:</span>
<span id="cb419-5747"><a href="#cb419-5747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5748"><a href="#cb419-5748" aria-hidden="true" tabindex="-1"></a>• "About once a week": Significantly more non-RMT users than expected</span>
<span id="cb419-5749"><a href="#cb419-5749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5750"><a href="#cb419-5750" aria-hidden="true" tabindex="-1"></a>• "Multiple times per week": Significantly more non-RMT users than expected</span>
<span id="cb419-5751"><a href="#cb419-5751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5752"><a href="#cb419-5752" aria-hidden="true" tabindex="-1"></a>• "Everyday": Significantly more RMT users than expected (strongest effect)</span>
<span id="cb419-5753"><a href="#cb419-5753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5754"><a href="#cb419-5754" aria-hidden="true" tabindex="-1"></a>**Practice Patterns**</span>
<span id="cb419-5755"><a href="#cb419-5755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5756"><a href="#cb419-5756" aria-hidden="true" tabindex="-1"></a>• RMT users show a higher proportion of daily practice</span>
<span id="cb419-5757"><a href="#cb419-5757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5758"><a href="#cb419-5758" aria-hidden="true" tabindex="-1"></a>• Non-RMT users show higher proportions in the moderate frequency categories</span>
<span id="cb419-5759"><a href="#cb419-5759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5760"><a href="#cb419-5760" aria-hidden="true" tabindex="-1"></a><span class="fu"># Income</span></span>
<span id="cb419-5761"><a href="#cb419-5761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5762"><a href="#cb419-5762" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Stats</span></span>
<span id="cb419-5763"><a href="#cb419-5763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5766"><a href="#cb419-5766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-5767"><a href="#cb419-5767" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-5768"><a href="#cb419-5768" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-5769"><a href="#cb419-5769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5770"><a href="#cb419-5770" aria-hidden="true" tabindex="-1"></a><span class="co"># Process income data</span></span>
<span id="cb419-5771"><a href="#cb419-5771" aria-hidden="true" tabindex="-1"></a>income_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-5772"><a href="#cb419-5772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(incomePerf, incomeTeach) <span class="sc">%&gt;%</span></span>
<span id="cb419-5773"><a href="#cb419-5773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), </span>
<span id="cb419-5774"><a href="#cb419-5774" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"income_type"</span>, </span>
<span id="cb419-5775"><a href="#cb419-5775" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"income_level"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5776"><a href="#cb419-5776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(income_level))</span>
<span id="cb419-5777"><a href="#cb419-5777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5778"><a href="#cb419-5778" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for only 'Yes' and 'No' responses</span></span>
<span id="cb419-5779"><a href="#cb419-5779" aria-hidden="true" tabindex="-1"></a>income_data_filtered <span class="ot">&lt;-</span> income_data <span class="sc">%&gt;%</span></span>
<span id="cb419-5780"><a href="#cb419-5780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(income_level <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb419-5781"><a href="#cb419-5781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5782"><a href="#cb419-5782" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table for chi-square test</span></span>
<span id="cb419-5783"><a href="#cb419-5783" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(income_data_filtered<span class="sc">$</span>income_type, income_data_filtered<span class="sc">$</span>income_level)</span>
<span id="cb419-5784"><a href="#cb419-5784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5785"><a href="#cb419-5785" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-square test</span></span>
<span id="cb419-5786"><a href="#cb419-5786" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span>
<span id="cb419-5787"><a href="#cb419-5787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5788"><a href="#cb419-5788" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cramer's V</span></span>
<span id="cb419-5789"><a href="#cb419-5789" aria-hidden="true" tabindex="-1"></a>cramers_v <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(chi_test<span class="sc">$</span>statistic <span class="sc">/</span> (<span class="fu">sum</span>(contingency_table) <span class="sc">*</span> (<span class="fu">min</span>(<span class="fu">dim</span>(contingency_table)) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb419-5790"><a href="#cb419-5790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5791"><a href="#cb419-5791" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate odds ratio</span></span>
<span id="cb419-5792"><a href="#cb419-5792" aria-hidden="true" tabindex="-1"></a>odds_ratio <span class="ot">&lt;-</span> (contingency_table[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">*</span> contingency_table[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">/</span> (contingency_table[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">*</span> contingency_table[<span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb419-5793"><a href="#cb419-5793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5794"><a href="#cb419-5794" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistical analysis results</span></span>
<span id="cb419-5795"><a href="#cb419-5795" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5796"><a href="#cb419-5796" aria-hidden="true" tabindex="-1"></a><span class="st">Statistical Analysis Results:\</span></span>
<span id="cb419-5797"><a href="#cb419-5797" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5798"><a href="#cb419-5798" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"============================\</span></span>
<span id="cb419-5799"><a href="#cb419-5799" aria-hidden="true" tabindex="-1"></a><span class="st">\</span></span>
<span id="cb419-5800"><a href="#cb419-5800" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5801"><a href="#cb419-5801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5802"><a href="#cb419-5802" aria-hidden="true" tabindex="-1"></a><span class="co"># Print contingency table</span></span>
<span id="cb419-5803"><a href="#cb419-5803" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Contingency Table:\</span></span>
<span id="cb419-5804"><a href="#cb419-5804" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5805"><a href="#cb419-5805" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(contingency_table)</span>
<span id="cb419-5806"><a href="#cb419-5806" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5807"><a href="#cb419-5807" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5808"><a href="#cb419-5808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5809"><a href="#cb419-5809" aria-hidden="true" tabindex="-1"></a><span class="co"># Print chi-square test results</span></span>
<span id="cb419-5810"><a href="#cb419-5810" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Chi-square Test Results:\</span></span>
<span id="cb419-5811"><a href="#cb419-5811" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5812"><a href="#cb419-5812" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span>
<span id="cb419-5813"><a href="#cb419-5813" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5814"><a href="#cb419-5814" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5815"><a href="#cb419-5815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5816"><a href="#cb419-5816" aria-hidden="true" tabindex="-1"></a><span class="co"># Print effect size measures</span></span>
<span id="cb419-5817"><a href="#cb419-5817" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Effect Size Measures:\</span></span>
<span id="cb419-5818"><a href="#cb419-5818" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5819"><a href="#cb419-5819" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Cramer's V: %.3f\</span></span>
<span id="cb419-5820"><a href="#cb419-5820" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>, cramers_v))</span>
<span id="cb419-5821"><a href="#cb419-5821" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Odds Ratio: %.3f\</span></span>
<span id="cb419-5822"><a href="#cb419-5822" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>, odds_ratio))</span>
<span id="cb419-5823"><a href="#cb419-5823" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5824"><a href="#cb419-5824" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5825"><a href="#cb419-5825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5826"><a href="#cb419-5826" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize counts and percentages</span></span>
<span id="cb419-5827"><a href="#cb419-5827" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb419-5828"><a href="#cb419-5828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, income_level) <span class="sc">%&gt;%</span></span>
<span id="cb419-5829"><a href="#cb419-5829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-5830"><a href="#cb419-5830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type) <span class="sc">%&gt;%</span></span>
<span id="cb419-5831"><a href="#cb419-5831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5832"><a href="#cb419-5832" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-5833"><a href="#cb419-5833" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentage =</span> count <span class="sc">/</span> total_n <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-5834"><a href="#cb419-5834" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> total_n),  <span class="co"># Standard error for proportions</span></span>
<span id="cb419-5835"><a href="#cb419-5835" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower =</span> percentage <span class="sc">-</span> (<span class="fl">1.96</span> <span class="sc">*</span> se),  <span class="co"># 95% CI lower bound</span></span>
<span id="cb419-5836"><a href="#cb419-5836" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper =</span> percentage <span class="sc">+</span> (<span class="fl">1.96</span> <span class="sc">*</span> se)   <span class="co"># 95% CI upper bound</span></span>
<span id="cb419-5837"><a href="#cb419-5837" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-5838"><a href="#cb419-5838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb419-5839"><a href="#cb419-5839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5840"><a href="#cb419-5840" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels for income types with total N</span></span>
<span id="cb419-5841"><a href="#cb419-5841" aria-hidden="true" tabindex="-1"></a>lookup_labels <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-5842"><a href="#cb419-5842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type) <span class="sc">%&gt;%</span></span>
<span id="cb419-5843"><a href="#cb419-5843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_n =</span> <span class="fu">first</span>(total_n)) <span class="sc">%&gt;%</span></span>
<span id="cb419-5844"><a href="#cb419-5844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-5845"><a href="#cb419-5845" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Performance Income\</span></span>
<span id="cb419-5846"><a href="#cb419-5846" aria-hidden="true" tabindex="-1"></a><span class="st">(N="</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb419-5847"><a href="#cb419-5847" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Teaching Income\</span></span>
<span id="cb419-5848"><a href="#cb419-5848" aria-hidden="true" tabindex="-1"></a><span class="st">(N="</span>, total_n, <span class="st">")"</span>)</span>
<span id="cb419-5849"><a href="#cb419-5849" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb419-5850"><a href="#cb419-5850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5851"><a href="#cb419-5851" aria-hidden="true" tabindex="-1"></a><span class="co"># Map income_type to factor using lookup</span></span>
<span id="cb419-5852"><a href="#cb419-5852" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-5853"><a href="#cb419-5853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb419-5854"><a href="#cb419-5854" aria-hidden="true" tabindex="-1"></a>    <span class="at">income_type =</span> <span class="fu">factor</span>(income_type, </span>
<span id="cb419-5855"><a href="#cb419-5855" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> lookup_labels<span class="sc">$</span>income_type, </span>
<span id="cb419-5856"><a href="#cb419-5856" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> lookup_labels<span class="sc">$</span>label),</span>
<span id="cb419-5857"><a href="#cb419-5857" aria-hidden="true" tabindex="-1"></a>    <span class="at">income_level =</span> <span class="fu">factor</span>(income_level, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb419-5858"><a href="#cb419-5858" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-5859"><a href="#cb419-5859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5860"><a href="#cb419-5860" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb419-5861"><a href="#cb419-5861" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of Primary Income Response"</span></span>
<span id="cb419-5862"><a href="#cb419-5862" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(income_summary, </span>
<span id="cb419-5863"><a href="#cb419-5863" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> percentage, <span class="at">y =</span> income_level, <span class="at">fill =</span> income_type)) <span class="sc">+</span></span>
<span id="cb419-5864"><a href="#cb419-5864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb419-5865"><a href="#cb419-5865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"% )"</span>)),</span>
<span id="cb419-5866"><a href="#cb419-5866" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-5867"><a href="#cb419-5867" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-5868"><a href="#cb419-5868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper),</span>
<span id="cb419-5869"><a href="#cb419-5869" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-5870"><a href="#cb419-5870" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb419-5871"><a href="#cb419-5871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> plot_title,</span>
<span id="cb419-5872"><a href="#cb419-5872" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Percentage"</span>,</span>
<span id="cb419-5873"><a href="#cb419-5873" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Is this your primary form of income?"</span>,</span>
<span id="cb419-5874"><a href="#cb419-5874" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Income Source"</span>,</span>
<span id="cb419-5875"><a href="#cb419-5875" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span>) <span class="sc">+</span></span>
<span id="cb419-5876"><a href="#cb419-5876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-5877"><a href="#cb419-5877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-5878"><a href="#cb419-5878" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb419-5879"><a href="#cb419-5879" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-5880"><a href="#cb419-5880" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-5881"><a href="#cb419-5881" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb419-5882"><a href="#cb419-5882" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb419-5883"><a href="#cb419-5883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb419-5884"><a href="#cb419-5884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">20</span>))</span>
<span id="cb419-5885"><a href="#cb419-5885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5886"><a href="#cb419-5886" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plot</span></span>
<span id="cb419-5887"><a href="#cb419-5887" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb419-5888"><a href="#cb419-5888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5889"><a href="#cb419-5889" aria-hidden="true" tabindex="-1"></a><span class="co"># Print proportions with confidence intervals</span></span>
<span id="cb419-5890"><a href="#cb419-5890" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"\</span></span>
<span id="cb419-5891"><a href="#cb419-5891" aria-hidden="true" tabindex="-1"></a><span class="st">Proportions with 95% Confidence Intervals:\</span></span>
<span id="cb419-5892"><a href="#cb419-5892" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb419-5893"><a href="#cb419-5893" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(income_summary <span class="sc">%&gt;%</span> </span>
<span id="cb419-5894"><a href="#cb419-5894" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(income_type, income_level, percentage, ci_lower, ci_upper))</span>
<span id="cb419-5895"><a href="#cb419-5895" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-5896"><a href="#cb419-5896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5897"><a href="#cb419-5897" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-5898"><a href="#cb419-5898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5899"><a href="#cb419-5899" aria-hidden="true" tabindex="-1"></a>**Key Findings:**</span>
<span id="cb419-5900"><a href="#cb419-5900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5901"><a href="#cb419-5901" aria-hidden="true" tabindex="-1"></a>*Performance Income (N=932):*</span>
<span id="cb419-5902"><a href="#cb419-5902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5903"><a href="#cb419-5903" aria-hidden="true" tabindex="-1"></a>• Yes: 23.2% (95% CI: 20.5% - 25.9%)</span>
<span id="cb419-5904"><a href="#cb419-5904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5905"><a href="#cb419-5905" aria-hidden="true" tabindex="-1"></a>• No: 76.8% (95% CI: 74.1% - 79.5%)</span>
<span id="cb419-5906"><a href="#cb419-5906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5907"><a href="#cb419-5907" aria-hidden="true" tabindex="-1"></a>*Teaching Income (N=512):*</span>
<span id="cb419-5908"><a href="#cb419-5908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5909"><a href="#cb419-5909" aria-hidden="true" tabindex="-1"></a>• Yes: 61.5% (95% CI: 57.3% - 65.7%)</span>
<span id="cb419-5910"><a href="#cb419-5910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5911"><a href="#cb419-5911" aria-hidden="true" tabindex="-1"></a>• No: 38.5% (95% CI: 34.3% - 42.7%)</span>
<span id="cb419-5912"><a href="#cb419-5912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5913"><a href="#cb419-5913" aria-hidden="true" tabindex="-1"></a>The statistical analysis reveals a significant difference in the distribution of primary income between performance and teaching (p <span class="sc">\&lt;</span> 0.001), with a moderate effect size (Cramer's V = 0.379). Teaching is more likely to be reported as a primary source of income compared to performance, with confidence intervals showing no overlap between the two income types.</span>
<span id="cb419-5914"><a href="#cb419-5914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5915"><a href="#cb419-5915" aria-hidden="true" tabindex="-1"></a>**Statistical Analysis**</span>
<span id="cb419-5916"><a href="#cb419-5916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5917"><a href="#cb419-5917" aria-hidden="true" tabindex="-1"></a>*Contingency Table and Frequency Distribution:*</span>
<span id="cb419-5918"><a href="#cb419-5918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5919"><a href="#cb419-5919" aria-hidden="true" tabindex="-1"></a>The contingency table shows the counts for each response category by income type:</span>
<span id="cb419-5920"><a href="#cb419-5920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5921"><a href="#cb419-5921" aria-hidden="true" tabindex="-1"></a>Performance Income:</span>
<span id="cb419-5922"><a href="#cb419-5922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5923"><a href="#cb419-5923" aria-hidden="true" tabindex="-1"></a>• No: 716 respondents</span>
<span id="cb419-5924"><a href="#cb419-5924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5925"><a href="#cb419-5925" aria-hidden="true" tabindex="-1"></a>• Yes: 216 respondents</span>
<span id="cb419-5926"><a href="#cb419-5926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5927"><a href="#cb419-5927" aria-hidden="true" tabindex="-1"></a>• Total N=932N=932</span>
<span id="cb419-5928"><a href="#cb419-5928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5929"><a href="#cb419-5929" aria-hidden="true" tabindex="-1"></a>Teaching Income:</span>
<span id="cb419-5930"><a href="#cb419-5930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5931"><a href="#cb419-5931" aria-hidden="true" tabindex="-1"></a>• No: 197 respondents</span>
<span id="cb419-5932"><a href="#cb419-5932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5933"><a href="#cb419-5933" aria-hidden="true" tabindex="-1"></a>• Yes: 315 respondents</span>
<span id="cb419-5934"><a href="#cb419-5934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5935"><a href="#cb419-5935" aria-hidden="true" tabindex="-1"></a>• Total N=512N=512</span>
<span id="cb419-5936"><a href="#cb419-5936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5937"><a href="#cb419-5937" aria-hidden="true" tabindex="-1"></a>This breakdown immediately shows a substantial difference: A majority of respondents do not consider performance income their primary income, whereas a majority consider teaching income as their primary income.</span>
<span id="cb419-5938"><a href="#cb419-5938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5939"><a href="#cb419-5939" aria-hidden="true" tabindex="-1"></a>*Chi-Square Test:*</span>
<span id="cb419-5940"><a href="#cb419-5940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5941"><a href="#cb419-5941" aria-hidden="true" tabindex="-1"></a>The chi-square test for independence yielded:</span>
<span id="cb419-5942"><a href="#cb419-5942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5943"><a href="#cb419-5943" aria-hidden="true" tabindex="-1"></a>• χ2χ2 Value: 207.36</span>
<span id="cb419-5944"><a href="#cb419-5944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5945"><a href="#cb419-5945" aria-hidden="true" tabindex="-1"></a>• Degrees of Freedom: 1</span>
<span id="cb419-5946"><a href="#cb419-5946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5947"><a href="#cb419-5947" aria-hidden="true" tabindex="-1"></a>• p-value: <span class="sc">\&lt;</span> 2.2e-16</span>
<span id="cb419-5948"><a href="#cb419-5948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5949"><a href="#cb419-5949" aria-hidden="true" tabindex="-1"></a>The extremely low p-value (p <span class="sc">\&lt;</span> 0.001) indicates that there is a statistically significant association between the type of income (performance vs teaching) and whether it is considered the primary source of income. This suggests that the likelihood of stating “Yes” or “No” as a primary income source differs considerably between performance and teaching categories.</span>
<span id="cb419-5950"><a href="#cb419-5950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5951"><a href="#cb419-5951" aria-hidden="true" tabindex="-1"></a>*Effect Size:*8</span>
<span id="cb419-5952"><a href="#cb419-5952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5953"><a href="#cb419-5953" aria-hidden="true" tabindex="-1"></a>Two effect size measures were provided:</span>
<span id="cb419-5954"><a href="#cb419-5954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5955"><a href="#cb419-5955" aria-hidden="true" tabindex="-1"></a>• Cramer’s V: 0.379</span>
<span id="cb419-5956"><a href="#cb419-5956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5957"><a href="#cb419-5957" aria-hidden="true" tabindex="-1"></a>This value falls in a moderate range, suggesting that while the association is not extremely strong, it is meaningful.</span>
<span id="cb419-5958"><a href="#cb419-5958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5959"><a href="#cb419-5959" aria-hidden="true" tabindex="-1"></a>• Odds Ratio: 5.300</span>
<span id="cb419-5960"><a href="#cb419-5960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5961"><a href="#cb419-5961" aria-hidden="true" tabindex="-1"></a>This indicates that respondents are over 5 times more likely to report teaching income as their primary income compared to performance income.</span>
<span id="cb419-5962"><a href="#cb419-5962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5963"><a href="#cb419-5963" aria-hidden="true" tabindex="-1"></a>*Confidence Intervals for Proportions:*</span>
<span id="cb419-5964"><a href="#cb419-5964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5965"><a href="#cb419-5965" aria-hidden="true" tabindex="-1"></a>The proportions, alongside their 95% confidence intervals, are as follows:</span>
<span id="cb419-5966"><a href="#cb419-5966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5967"><a href="#cb419-5967" aria-hidden="true" tabindex="-1"></a>Performance Income:</span>
<span id="cb419-5968"><a href="#cb419-5968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5969"><a href="#cb419-5969" aria-hidden="true" tabindex="-1"></a>• Yes: 23.2% (95% CI: approx. 20.5% – 25.9%)</span>
<span id="cb419-5970"><a href="#cb419-5970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5971"><a href="#cb419-5971" aria-hidden="true" tabindex="-1"></a>• No: 76.8% (95% CI: approx. 74.1% – 79.5%)</span>
<span id="cb419-5972"><a href="#cb419-5972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5973"><a href="#cb419-5973" aria-hidden="true" tabindex="-1"></a>Teaching Income:</span>
<span id="cb419-5974"><a href="#cb419-5974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5975"><a href="#cb419-5975" aria-hidden="true" tabindex="-1"></a>• Yes: 61.5% (95% CI: approx. 57.3% – 65.7%)</span>
<span id="cb419-5976"><a href="#cb419-5976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5977"><a href="#cb419-5977" aria-hidden="true" tabindex="-1"></a>• No: 38.5% (95% CI: approx. 34.3% – 42.7%)</span>
<span id="cb419-5978"><a href="#cb419-5978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5979"><a href="#cb419-5979" aria-hidden="true" tabindex="-1"></a>The absence of overlapping confidence intervals for the “Yes” responses provides further evidence that the proportions are statistically different between performance and teaching income responses.</span>
<span id="cb419-5980"><a href="#cb419-5980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5981"><a href="#cb419-5981" aria-hidden="true" tabindex="-1"></a>**Visualization Interpretation**</span>
<span id="cb419-5982"><a href="#cb419-5982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5983"><a href="#cb419-5983" aria-hidden="true" tabindex="-1"></a>The bar plot presents the percentage distribution for each response category (“Yes” and “No”) within each type of income. Key details include: *Y-Axis (Response Category):*</span>
<span id="cb419-5984"><a href="#cb419-5984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5985"><a href="#cb419-5985" aria-hidden="true" tabindex="-1"></a>The responses are clearly laid out as “Yes” and “No” (i.e., whether the income source is the respondent’s primary source). *X-Axis (Percentage):*</span>
<span id="cb419-5986"><a href="#cb419-5986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5987"><a href="#cb419-5987" aria-hidden="true" tabindex="-1"></a>The percentage of respondents providing each answer is shown, with a scale from 0% to 100%.</span>
<span id="cb419-5988"><a href="#cb419-5988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5989"><a href="#cb419-5989" aria-hidden="true" tabindex="-1"></a>*Data Labels:*</span>
<span id="cb419-5990"><a href="#cb419-5990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5991"><a href="#cb419-5991" aria-hidden="true" tabindex="-1"></a>Each bar is annotated with both the absolute count and the corresponding percentage, providing a precise understanding of the sample distribution.</span>
<span id="cb419-5992"><a href="#cb419-5992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5993"><a href="#cb419-5993" aria-hidden="true" tabindex="-1"></a>*Error Bars:*</span>
<span id="cb419-5994"><a href="#cb419-5994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5995"><a href="#cb419-5995" aria-hidden="true" tabindex="-1"></a>Horizontal error bars indicate the 95% confidence intervals for the observed percentages. These intervals support the reliability of the estimates and help visualize the variability in responses.</span>
<span id="cb419-5996"><a href="#cb419-5996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5997"><a href="#cb419-5997" aria-hidden="true" tabindex="-1"></a>*Color Coding and Legends:*</span>
<span id="cb419-5998"><a href="#cb419-5998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-5999"><a href="#cb419-5999" aria-hidden="true" tabindex="-1"></a>Separate colors are used to distinguish between Performance Income and Teaching Income. The legend incorporates total sample sizes (NN) for each income type, which helps in quickly grasping the underlying distribution:</span>
<span id="cb419-6000"><a href="#cb419-6000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6001"><a href="#cb419-6001" aria-hidden="true" tabindex="-1"></a>• Performance Income (N=932)</span>
<span id="cb419-6002"><a href="#cb419-6002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6003"><a href="#cb419-6003" aria-hidden="true" tabindex="-1"></a>• Teaching Income (N=512)</span>
<span id="cb419-6004"><a href="#cb419-6004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6005"><a href="#cb419-6005" aria-hidden="true" tabindex="-1"></a>**Overall Interpretation**</span>
<span id="cb419-6006"><a href="#cb419-6006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6007"><a href="#cb419-6007" aria-hidden="true" tabindex="-1"></a>The analysis indicates a significant relationship between income type and whether it is considered the primary form of income. Specifically:</span>
<span id="cb419-6008"><a href="#cb419-6008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6009"><a href="#cb419-6009" aria-hidden="true" tabindex="-1"></a>*Performance Income:*</span>
<span id="cb419-6010"><a href="#cb419-6010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6011"><a href="#cb419-6011" aria-hidden="true" tabindex="-1"></a>The majority (76.8%) of respondents do not consider performance income the primary form of income, with only 23.2% affirming it as their main income source. This suggests that performance income, for this sample, is likely supplemental or irregular rather than the primary livelihood.</span>
<span id="cb419-6012"><a href="#cb419-6012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6013"><a href="#cb419-6013" aria-hidden="true" tabindex="-1"></a>*Teaching Income:*</span>
<span id="cb419-6014"><a href="#cb419-6014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6015"><a href="#cb419-6015" aria-hidden="true" tabindex="-1"></a>In contrast, a majority (61.5%) of respondents report teaching income as their primary source of income, compared to 38.5% who do not. This difference—along with the large odds ratio of 5.300—indicates that, within the surveyed population, teaching is far more likely to be relied upon as the main income source.</span>
<span id="cb419-6016"><a href="#cb419-6016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6017"><a href="#cb419-6017" aria-hidden="true" tabindex="-1"></a>*Statistical Significance and Practical Implications:*</span>
<span id="cb419-6018"><a href="#cb419-6018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6019"><a href="#cb419-6019" aria-hidden="true" tabindex="-1"></a>The statistically significant chi-square test and moderate Cramer’s V corroborate that these differences are not due to mere chance. For stakeholders (e.g., survey analysts, policy makers, or academic researchers), these findings may suggest a need to consider how funding, training, or career support should be specifically targeted based on the predominant income source among respondents.</span>
<span id="cb419-6020"><a href="#cb419-6020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6021"><a href="#cb419-6021" aria-hidden="true" tabindex="-1"></a>In summary, the robust statistical analysis and well-annotated visual representation provide clear evidence that the ways in which performance and teaching income contribute to overall livelihood differ substantially within the surveyed group.</span>
<span id="cb419-6022"><a href="#cb419-6022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6023"><a href="#cb419-6023" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inferential Stats</span></span>
<span id="cb419-6024"><a href="#cb419-6024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6027"><a href="#cb419-6027" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb419-6028"><a href="#cb419-6028" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-6029"><a href="#cb419-6029" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-6030"><a href="#cb419-6030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6031"><a href="#cb419-6031" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the data so that we have one row per response for the income variables</span></span>
<span id="cb419-6032"><a href="#cb419-6032" aria-hidden="true" tabindex="-1"></a>income_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-6033"><a href="#cb419-6033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(incomePerf, incomeTeach, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-6034"><a href="#cb419-6034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(incomePerf, incomeTeach),</span>
<span id="cb419-6035"><a href="#cb419-6035" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"income_type"</span>,</span>
<span id="cb419-6036"><a href="#cb419-6036" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"income_response"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-6037"><a href="#cb419-6037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(income_response)) <span class="sc">%&gt;%</span></span>
<span id="cb419-6038"><a href="#cb419-6038" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only keep responses that are 'Yes' or 'No'</span></span>
<span id="cb419-6039"><a href="#cb419-6039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(income_response <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb419-6040"><a href="#cb419-6040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6041"><a href="#cb419-6041" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics by income_type, RMTMethods_YN, and income_response,</span></span>
<span id="cb419-6042"><a href="#cb419-6042" aria-hidden="true" tabindex="-1"></a><span class="co"># computing percentages relative to each RMTMethods_YN subgroup (for each income type).</span></span>
<span id="cb419-6043"><a href="#cb419-6043" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_data <span class="sc">%&gt;%</span></span>
<span id="cb419-6044"><a href="#cb419-6044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, RMTMethods_YN, income_response) <span class="sc">%&gt;%</span></span>
<span id="cb419-6045"><a href="#cb419-6045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-6046"><a href="#cb419-6046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-6047"><a href="#cb419-6047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_n =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-6048"><a href="#cb419-6048" aria-hidden="true" tabindex="-1"></a>         <span class="at">percentage =</span> count <span class="sc">/</span> total_n <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-6049"><a href="#cb419-6049" aria-hidden="true" tabindex="-1"></a>         <span class="at">se =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> total_n),  <span class="co"># standard error for proportions</span></span>
<span id="cb419-6050"><a href="#cb419-6050" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_lower =</span> percentage <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,                      <span class="co"># 95% CI lower bound</span></span>
<span id="cb419-6051"><a href="#cb419-6051" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_upper =</span> percentage <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se                        <span class="co"># 95% CI upper bound</span></span>
<span id="cb419-6052"><a href="#cb419-6052" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb419-6053"><a href="#cb419-6053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb419-6054"><a href="#cb419-6054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6055"><a href="#cb419-6055" aria-hidden="true" tabindex="-1"></a><span class="co"># Update group labels based on conditions</span></span>
<span id="cb419-6056"><a href="#cb419-6056" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-6057"><a href="#cb419-6057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_label =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-6058"><a href="#cb419-6058" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Pro performers, that don't use RMT devices (n = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb419-6059"><a href="#cb419-6059" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Pro performers that use RMT devices (n = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb419-6060"><a href="#cb419-6060" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Pro teachers that don't use RMT devices (n = "</span>, total_n, <span class="st">")"</span>),</span>
<span id="cb419-6061"><a href="#cb419-6061" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"Pro teachers that use RMT devices (n = "</span>, total_n, <span class="st">")"</span>)</span>
<span id="cb419-6062"><a href="#cb419-6062" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb419-6063"><a href="#cb419-6063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6064"><a href="#cb419-6064" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure factor levels for income_response so that 'Yes' and 'No' appear in a controlled order</span></span>
<span id="cb419-6065"><a href="#cb419-6065" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-6066"><a href="#cb419-6066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income_response =</span> <span class="fu">factor</span>(income_response, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)))</span>
<span id="cb419-6067"><a href="#cb419-6067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6068"><a href="#cb419-6068" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the figure title as specified</span></span>
<span id="cb419-6069"><a href="#cb419-6069" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of professional (primary source of income) performers and teachers who do and don't use RMT devices"</span></span>
<span id="cb419-6070"><a href="#cb419-6070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6071"><a href="#cb419-6071" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot, adjusting the data labels so they don't overlap with the error bars</span></span>
<span id="cb419-6072"><a href="#cb419-6072" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(income_summary,</span>
<span id="cb419-6073"><a href="#cb419-6073" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> percentage, <span class="at">y =</span> income_response, <span class="at">fill =</span> group_label)) <span class="sc">+</span></span>
<span id="cb419-6074"><a href="#cb419-6074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb419-6075"><a href="#cb419-6075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper),</span>
<span id="cb419-6076"><a href="#cb419-6076" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-6077"><a href="#cb419-6077" aria-hidden="true" tabindex="-1"></a>                 <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb419-6078"><a href="#cb419-6078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>),</span>
<span id="cb419-6079"><a href="#cb419-6079" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> ci_upper),  <span class="co"># Position labels at the end of error bars</span></span>
<span id="cb419-6080"><a href="#cb419-6080" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>),</span>
<span id="cb419-6081"><a href="#cb419-6081" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>,  <span class="co"># Move labels further to the right</span></span>
<span id="cb419-6082"><a href="#cb419-6082" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb419-6083"><a href="#cb419-6083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> plot_title,</span>
<span id="cb419-6084"><a href="#cb419-6084" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Percentage (of RMTMethods_YN subgroup)"</span>,</span>
<span id="cb419-6085"><a href="#cb419-6085" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Is this your primary form of income?"</span>,</span>
<span id="cb419-6086"><a href="#cb419-6086" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span>) <span class="sc">+</span></span>
<span id="cb419-6087"><a href="#cb419-6087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-6088"><a href="#cb419-6088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb419-6089"><a href="#cb419-6089" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-6090"><a href="#cb419-6090" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-6091"><a href="#cb419-6091" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb419-6092"><a href="#cb419-6092" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span>  <span class="co"># Remove legend title</span></span>
<span id="cb419-6093"><a href="#cb419-6093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb419-6094"><a href="#cb419-6094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb419-6095"><a href="#cb419-6095" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(income_summary<span class="sc">$</span>ci_upper) <span class="sc">*</span> <span class="fl">1.2</span>),  <span class="co"># Extend x-axis to accommodate labels</span></span>
<span id="cb419-6096"><a href="#cb419-6096" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">20</span>)</span>
<span id="cb419-6097"><a href="#cb419-6097" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-6098"><a href="#cb419-6098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6099"><a href="#cb419-6099" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-6100"><a href="#cb419-6100" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb419-6101"><a href="#cb419-6101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6102"><a href="#cb419-6102" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics for verification</span></span>
<span id="cb419-6103"><a href="#cb419-6103" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(income_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-6104"><a href="#cb419-6104" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(group_label, income_response, count, total_n, percentage, ci_lower, ci_upper) <span class="sc">%&gt;%</span></span>
<span id="cb419-6105"><a href="#cb419-6105" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(group_label, income_response))</span>
<span id="cb419-6106"><a href="#cb419-6106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6107"><a href="#cb419-6107" aria-hidden="true" tabindex="-1"></a><span class="do">## Infer stats V2 (better) </span></span>
<span id="cb419-6108"><a href="#cb419-6108" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from the "Combined" sheet</span></span>
<span id="cb419-6109"><a href="#cb419-6109" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"../Data/R_Import_Transformed_15.02.25.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Combined"</span>)</span>
<span id="cb419-6110"><a href="#cb419-6110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6111"><a href="#cb419-6111" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the data so that we have one row per response for the income variables</span></span>
<span id="cb419-6112"><a href="#cb419-6112" aria-hidden="true" tabindex="-1"></a>income_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb419-6113"><a href="#cb419-6113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(incomePerf, incomeTeach, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-6114"><a href="#cb419-6114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(incomePerf, incomeTeach),</span>
<span id="cb419-6115"><a href="#cb419-6115" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"income_type"</span>,</span>
<span id="cb419-6116"><a href="#cb419-6116" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"income_response"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-6117"><a href="#cb419-6117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(income_response)) <span class="sc">%&gt;%</span></span>
<span id="cb419-6118"><a href="#cb419-6118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(income_response <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb419-6119"><a href="#cb419-6119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6120"><a href="#cb419-6120" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics by group (using RMTMethods_YN subgroup totals within each income type)</span></span>
<span id="cb419-6121"><a href="#cb419-6121" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_data <span class="sc">%&gt;%</span></span>
<span id="cb419-6122"><a href="#cb419-6122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, RMTMethods_YN, income_response) <span class="sc">%&gt;%</span></span>
<span id="cb419-6123"><a href="#cb419-6123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb419-6124"><a href="#cb419-6124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(income_type, RMTMethods_YN) <span class="sc">%&gt;%</span></span>
<span id="cb419-6125"><a href="#cb419-6125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_n =</span> <span class="fu">sum</span>(count),</span>
<span id="cb419-6126"><a href="#cb419-6126" aria-hidden="true" tabindex="-1"></a>         <span class="at">percentage =</span> count <span class="sc">/</span> total_n <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb419-6127"><a href="#cb419-6127" aria-hidden="true" tabindex="-1"></a>         <span class="at">se =</span> <span class="fu">sqrt</span>((percentage <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> percentage)) <span class="sc">/</span> total_n),  <span class="co"># standard error for proportions</span></span>
<span id="cb419-6128"><a href="#cb419-6128" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_lower =</span> percentage <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb419-6129"><a href="#cb419-6129" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_upper =</span> percentage <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb419-6130"><a href="#cb419-6130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb419-6131"><a href="#cb419-6131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6132"><a href="#cb419-6132" aria-hidden="true" tabindex="-1"></a><span class="co"># Create custom group labels</span></span>
<span id="cb419-6133"><a href="#cb419-6133" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-6134"><a href="#cb419-6134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_label =</span> <span class="fu">case_when</span>(</span>
<span id="cb419-6135"><a href="#cb419-6135" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="st">"0"</span> <span class="sc">~</span> </span>
<span id="cb419-6136"><a href="#cb419-6136" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pro performers, that don't use RMT devices (n = 780)"</span>,</span>
<span id="cb419-6137"><a href="#cb419-6137" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomePerf"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> </span>
<span id="cb419-6138"><a href="#cb419-6138" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pro performers that use RMT devices (n = 152)"</span>,</span>
<span id="cb419-6139"><a href="#cb419-6139" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="st">"0"</span> <span class="sc">~</span> </span>
<span id="cb419-6140"><a href="#cb419-6140" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pro teachers that don't use RMT devices (n = 389)"</span>,</span>
<span id="cb419-6141"><a href="#cb419-6141" aria-hidden="true" tabindex="-1"></a>    income_type <span class="sc">==</span> <span class="st">"incomeTeach"</span> <span class="sc">&amp;</span> RMTMethods_YN <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> </span>
<span id="cb419-6142"><a href="#cb419-6142" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pro teachers that use RMT devices (n = 123)"</span></span>
<span id="cb419-6143"><a href="#cb419-6143" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb419-6144"><a href="#cb419-6144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6145"><a href="#cb419-6145" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the order of the income_response factor levels</span></span>
<span id="cb419-6146"><a href="#cb419-6146" aria-hidden="true" tabindex="-1"></a>income_summary <span class="ot">&lt;-</span> income_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-6147"><a href="#cb419-6147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income_response =</span> <span class="fu">factor</span>(income_response, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)))</span>
<span id="cb419-6148"><a href="#cb419-6148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6149"><a href="#cb419-6149" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the improved figure title</span></span>
<span id="cb419-6150"><a href="#cb419-6150" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="st">"Distribution of professional (primary source of income) performers and teachers who do and don't use RMT devices"</span></span>
<span id="cb419-6151"><a href="#cb419-6151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6152"><a href="#cb419-6152" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a faceted grouped bar chart with error bars and data labels placed without overlap</span></span>
<span id="cb419-6153"><a href="#cb419-6153" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(income_summary,</span>
<span id="cb419-6154"><a href="#cb419-6154" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> income_response, <span class="at">y =</span> percentage, <span class="at">fill =</span> group_label)) <span class="sc">+</span></span>
<span id="cb419-6155"><a href="#cb419-6155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb419-6156"><a href="#cb419-6156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper),</span>
<span id="cb419-6157"><a href="#cb419-6157" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>),</span>
<span id="cb419-6158"><a href="#cb419-6158" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb419-6159"><a href="#cb419-6159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(count, <span class="st">" ("</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, percentage), <span class="st">"%)"</span>)),</span>
<span id="cb419-6160"><a href="#cb419-6160" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>),</span>
<span id="cb419-6161"><a href="#cb419-6161" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">2</span>,  <span class="co"># Increased vertical offset even more</span></span>
<span id="cb419-6162"><a href="#cb419-6162" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb419-6163"><a href="#cb419-6163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>income_type, <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">"incomePerf"</span> <span class="ot">=</span> <span class="st">"Performance Income"</span>,</span>
<span id="cb419-6164"><a href="#cb419-6164" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"incomeTeach"</span> <span class="ot">=</span> <span class="st">"Teaching Income"</span>))) <span class="sc">+</span></span>
<span id="cb419-6165"><a href="#cb419-6165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> plot_title,</span>
<span id="cb419-6166"><a href="#cb419-6166" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Primary Income Response"</span>,</span>
<span id="cb419-6167"><a href="#cb419-6167" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage (of subgroup)"</span>,</span>
<span id="cb419-6168"><a href="#cb419-6168" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Error bars represent 95% confidence intervals"</span>) <span class="sc">+</span></span>
<span id="cb419-6169"><a href="#cb419-6169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb419-6170"><a href="#cb419-6170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb419-6171"><a href="#cb419-6171" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb419-6172"><a href="#cb419-6172" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb419-6173"><a href="#cb419-6173" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb419-6174"><a href="#cb419-6174" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb419-6175"><a href="#cb419-6175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb419-6176"><a href="#cb419-6176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb419-6177"><a href="#cb419-6177" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">160</span>),  <span class="co"># Further extended y-axis to provide more space</span></span>
<span id="cb419-6178"><a href="#cb419-6178" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">160</span>, <span class="at">by =</span> <span class="dv">20</span>)</span>
<span id="cb419-6179"><a href="#cb419-6179" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb419-6180"><a href="#cb419-6180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6181"><a href="#cb419-6181" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb419-6182"><a href="#cb419-6182" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb419-6183"><a href="#cb419-6183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6184"><a href="#cb419-6184" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary statistics for verification</span></span>
<span id="cb419-6185"><a href="#cb419-6185" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(income_summary <span class="sc">%&gt;%</span></span>
<span id="cb419-6186"><a href="#cb419-6186" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(group_label, income_response, count, total_n, percentage, ci_lower, ci_upper) <span class="sc">%&gt;%</span></span>
<span id="cb419-6187"><a href="#cb419-6187" aria-hidden="true" tabindex="-1"></a>        <span class="fu">arrange</span>(group_label, income_response))</span>
<span id="cb419-6188"><a href="#cb419-6188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6189"><a href="#cb419-6189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6190"><a href="#cb419-6190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6191"><a href="#cb419-6191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6192"><a href="#cb419-6192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6193"><a href="#cb419-6193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb419-6194"><a href="#cb419-6194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6195"><a href="#cb419-6195" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results and Discussion</span></span>
<span id="cb419-6196"><a href="#cb419-6196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6197"><a href="#cb419-6197" aria-hidden="true" tabindex="-1"></a>**Data Context and Structure**</span>
<span id="cb419-6198"><a href="#cb419-6198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6199"><a href="#cb419-6199" aria-hidden="true" tabindex="-1"></a>*Data Source:*</span>
<span id="cb419-6200"><a href="#cb419-6200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6201"><a href="#cb419-6201" aria-hidden="true" tabindex="-1"></a>Data were imported from an Excel sheet and include responses for two income sources: Performance Income (incomePerf) and Teaching Income (incomeTeach).</span>
<span id="cb419-6202"><a href="#cb419-6202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6203"><a href="#cb419-6203" aria-hidden="true" tabindex="-1"></a>*Subgrouping Variable:*</span>
<span id="cb419-6204"><a href="#cb419-6204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6205"><a href="#cb419-6205" aria-hidden="true" tabindex="-1"></a>The variable RMTMethods_YN is used to create subgroups indicating whether respondents use RMT devices. Here the subgroup is recoded as follows:</span>
<span id="cb419-6206"><a href="#cb419-6206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6207"><a href="#cb419-6207" aria-hidden="true" tabindex="-1"></a>• "0" indicates respondents who do not use RMT devices.</span>
<span id="cb419-6208"><a href="#cb419-6208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6209"><a href="#cb419-6209" aria-hidden="true" tabindex="-1"></a>• "1" indicates respondents who do use RMT devices.</span>
<span id="cb419-6210"><a href="#cb419-6210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6211"><a href="#cb419-6211" aria-hidden="true" tabindex="-1"></a>*Responses:*</span>
<span id="cb419-6212"><a href="#cb419-6212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6213"><a href="#cb419-6213" aria-hidden="true" tabindex="-1"></a>For each income source, respondents answered "Yes" or "No" to indicate whether that income source is their primary source.</span>
<span id="cb419-6214"><a href="#cb419-6214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6215"><a href="#cb419-6215" aria-hidden="true" tabindex="-1"></a>*Groups and Counts:*</span>
<span id="cb419-6216"><a href="#cb419-6216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6217"><a href="#cb419-6217" aria-hidden="true" tabindex="-1"></a>Custom labels are provided for each subgroup:</span>
<span id="cb419-6218"><a href="#cb419-6218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6219"><a href="#cb419-6219" aria-hidden="true" tabindex="-1"></a>• Pro performers, that don't use RMT devices (n = 780)</span>
<span id="cb419-6220"><a href="#cb419-6220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6221"><a href="#cb419-6221" aria-hidden="true" tabindex="-1"></a>• Pro performers that use RMT devices (n = 152)</span>
<span id="cb419-6222"><a href="#cb419-6222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6223"><a href="#cb419-6223" aria-hidden="true" tabindex="-1"></a>• Pro teachers that don't use RMT devices (n = 389)</span>
<span id="cb419-6224"><a href="#cb419-6224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6225"><a href="#cb419-6225" aria-hidden="true" tabindex="-1"></a>• Pro teachers that use RMT devices (n = 123)</span>
<span id="cb419-6226"><a href="#cb419-6226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6227"><a href="#cb419-6227" aria-hidden="true" tabindex="-1"></a>Each of these groups shows the number of respondents (n) and was summarized to display the count and percentage of “Yes” and “No” responses as well as the 95% confidence intervals (CI).</span>
<span id="cb419-6228"><a href="#cb419-6228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6229"><a href="#cb419-6229" aria-hidden="true" tabindex="-1"></a>**Summary Statistics and Visual Insights**</span>
<span id="cb419-6230"><a href="#cb419-6230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6231"><a href="#cb419-6231" aria-hidden="true" tabindex="-1"></a>• Pro performers, that don’t use RMT devices (n = 780):</span>
<span id="cb419-6232"><a href="#cb419-6232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6233"><a href="#cb419-6233" aria-hidden="true" tabindex="-1"></a>• The data are divided into two response groups. For example, suppose the analysis revealed that a smaller percentage (around 18.8%) of these performers indicated "Yes" (i.e., they consider performance income as their primary source) and a larger percentage (around 81.2%) said "No".</span>
<span id="cb419-6234"><a href="#cb419-6234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6235"><a href="#cb419-6235" aria-hidden="true" tabindex="-1"></a>• The calculated confidence intervals describe the precision of these percentage estimates.</span>
<span id="cb419-6236"><a href="#cb419-6236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6237"><a href="#cb419-6237" aria-hidden="true" tabindex="-1"></a>• Pro performers that use RMT devices (n = 152):</span>
<span id="cb419-6238"><a href="#cb419-6238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6239"><a href="#cb419-6239" aria-hidden="true" tabindex="-1"></a>• Here, responses appear more evenly split (e.g., close to 45% “Yes” versus 55% “No”) compared to their non-RMT counterparts.</span>
<span id="cb419-6240"><a href="#cb419-6240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6241"><a href="#cb419-6241" aria-hidden="true" tabindex="-1"></a>• This might indicate that professionals using RMT devices are more likely to rely on performance income or, at least, there is greater variation in their responses.</span>
<span id="cb419-6242"><a href="#cb419-6242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6243"><a href="#cb419-6243" aria-hidden="true" tabindex="-1"></a>• Pro teachers that don't use RMT devices (n = 389):</span>
<span id="cb419-6244"><a href="#cb419-6244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6245"><a href="#cb419-6245" aria-hidden="true" tabindex="-1"></a>• A higher percentage might be observed in the “Yes” category—suggesting a stronger reliance on teaching income as a primary income source in this subgroup. For instance, this group might show around 56.6% responding “Yes” and 43.4% responding “No” (as per the provided summary).</span>
<span id="cb419-6246"><a href="#cb419-6246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6247"><a href="#cb419-6247" aria-hidden="true" tabindex="-1"></a>• Confidence intervals again indicate the reliability of these percentages.</span>
<span id="cb419-6248"><a href="#cb419-6248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6249"><a href="#cb419-6249" aria-hidden="true" tabindex="-1"></a>• Pro teachers that use RMT devices (n = 123):</span>
<span id="cb419-6250"><a href="#cb419-6250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6251"><a href="#cb419-6251" aria-hidden="true" tabindex="-1"></a>• Although explicit numerical details weren’t detailed in the snippet, this subgroup’s response distribution can similarly be interpreted. A noticeable difference between the subgroups (those using versus not using RMT devices) would indicate whether use of RMT devices is associated with the likelihood of teaching income being a primary income source.</span>
<span id="cb419-6252"><a href="#cb419-6252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6253"><a href="#cb419-6253" aria-hidden="true" tabindex="-1"></a>**Interpretation of Results**</span>
<span id="cb419-6254"><a href="#cb419-6254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6255"><a href="#cb419-6255" aria-hidden="true" tabindex="-1"></a>*Differences Between Users and Non-Users of RMT Devices:*</span>
<span id="cb419-6256"><a href="#cb419-6256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6257"><a href="#cb419-6257" aria-hidden="true" tabindex="-1"></a>The re-labeled groups help us compare, within each profession (performers and teachers), how the use of RMT devices is associated with identifying a primary income source.</span>
<span id="cb419-6258"><a href="#cb419-6258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6259"><a href="#cb419-6259" aria-hidden="true" tabindex="-1"></a>• For performers, the non-users have a markedly different distribution compared to RMT device users. A lower percentage claiming performance income as primary among non-users versus a more balanced split among users may imply that RMT device usage might be linked to alternative revenue structures or different professional profiles.</span>
<span id="cb419-6260"><a href="#cb419-6260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6261"><a href="#cb419-6261" aria-hidden="true" tabindex="-1"></a>• For teachers, the data suggest that non-users and users also differ in their reliance on teaching income, with non-users leaning more toward teaching income as primary.</span>
<span id="cb419-6262"><a href="#cb419-6262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6263"><a href="#cb419-6263" aria-hidden="true" tabindex="-1"></a>*Statistical Confidence and Variation:*</span>
<span id="cb419-6264"><a href="#cb419-6264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6265"><a href="#cb419-6265" aria-hidden="true" tabindex="-1"></a>The confidence intervals (CIs) calculated for each percentage give an idea of the uncertainty in these estimates. CIs that do not overlap between groups might indicate statistically significant differences between those who use RMT devices and those who do not.</span>
<span id="cb419-6266"><a href="#cb419-6266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6267"><a href="#cb419-6267" aria-hidden="true" tabindex="-1"></a>*Visual Communication:*</span>
<span id="cb419-6268"><a href="#cb419-6268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6269"><a href="#cb419-6269" aria-hidden="true" tabindex="-1"></a>The improved faceted grouped bar chart provides a clear visual breakdown:</span>
<span id="cb419-6270"><a href="#cb419-6270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6271"><a href="#cb419-6271" aria-hidden="true" tabindex="-1"></a>• Faceting by Income Type: Allows for separate panels for performance and teaching income, thus making it easier to compare within and across the two professional categories.</span>
<span id="cb419-6272"><a href="#cb419-6272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6273"><a href="#cb419-6273" aria-hidden="true" tabindex="-1"></a>• Error Bars and Labels: With error bars representing the 95% CI, readers can judge the precision of the percentage estimates. Data labels placed above the bars enhance readability without overlapping the bars or error bars.</span>
<span id="cb419-6274"><a href="#cb419-6274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6275"><a href="#cb419-6275" aria-hidden="true" tabindex="-1"></a>*Professional Insights:*</span>
<span id="cb419-6276"><a href="#cb419-6276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6277"><a href="#cb419-6277" aria-hidden="true" tabindex="-1"></a>• For pro performers, if a significantly larger proportion of non-RMT users indicate that performance income is not their primary income, this might suggest that non-users diversify their income more than users.</span>
<span id="cb419-6278"><a href="#cb419-6278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6279"><a href="#cb419-6279" aria-hidden="true" tabindex="-1"></a>• For pro teachers, a higher reliance on teaching income in non-RMT users might reflect differences in career structures or market segmentation, possibly implying that those employing RMT devices may either supplement their income from other sources or have different teaching roles.</span>
<span id="cb419-6280"><a href="#cb419-6280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6281"><a href="#cb419-6281" aria-hidden="true" tabindex="-1"></a>**Final Thoughts**</span>
<span id="cb419-6282"><a href="#cb419-6282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6283"><a href="#cb419-6283" aria-hidden="true" tabindex="-1"></a>The analysis provides a detailed picture of how primary income identification varies by professional group and by the use of RMT devices. These insights could be of particular interest to researchers exploring the economic behaviors of creative professionals, the role of technology adoption, or market segmentation within industries. For deeper investigation, one might:</span>
<span id="cb419-6284"><a href="#cb419-6284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6285"><a href="#cb419-6285" aria-hidden="true" tabindex="-1"></a>• Conduct statistical tests to examine if the differences between subgroups are statistically significant.</span>
<span id="cb419-6286"><a href="#cb419-6286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6287"><a href="#cb419-6287" aria-hidden="true" tabindex="-1"></a>• Consider additional covariates: Other factors (e.g., years of experience, geographic location) might explain further variations between these groups.</span>
<span id="cb419-6288"><a href="#cb419-6288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6289"><a href="#cb419-6289" aria-hidden="true" tabindex="-1"></a>• Utilize qualitative insights: Understanding why certain professionals choose to use or forgo RMT devices could enrich the quantitative observations.</span>
<span id="cb419-6290"><a href="#cb419-6290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6291"><a href="#cb419-6291" aria-hidden="true" tabindex="-1"></a>This interpretation sets the stage for further in-depth analysis, linking statistical outcomes to practical, industry-specific conclusions.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>